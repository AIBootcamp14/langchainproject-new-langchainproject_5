# ë‹´ë‹¹ì—­í• _01-2: ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ

## ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-10-31
- **ì‘ì„±ì**: ìµœí˜„í™”[íŒ€ì¥]
- **ìµœì¢… ìˆ˜ì •ì¼**: 2025-10-31
- **í”„ë¡œì íŠ¸ëª…**: ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡ (AI Agent + RAG)
- **íŒ€ëª…**: ì—°ê²°ì˜ ë¯¼ì¡±
- **ë‹´ë‹¹ ê¸°ëŠ¥**: ë¡œê¹… ì‹œìŠ¤í…œ, ì‹¤í—˜ ì¶”ì  ê´€ë¦¬, ExperimentManager êµ¬í˜„
- **ì°¸ê³ **: ì‹¤í—˜_í´ë”_êµ¬ì¡°_ìµœì¢…ì•ˆ.md, PRD 05/06 ê¸°ë°˜ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨

---

## ë‹´ë‹¹ì ì •ë³´

**ë‹´ë‹¹ì**: ìµœí˜„í™”[íŒ€ì¥]

**ì—­í• **: ë¡œê¹… ë° ì‹¤í—˜ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•

---

## ë‹´ë‹¹ ì—…ë¬´ ê°œìš”

ì´ ì—­í• ì€ í”„ë¡œì íŠ¸ ì „ì²´ì—ì„œ ì‚¬ìš©ë˜ëŠ” **ë¡œê¹… ì‹œìŠ¤í…œ êµ¬ì¶•** ë° **ì‹¤í—˜ ìë™ ì¶”ì  ê´€ë¦¬** ê¸°ëŠ¥ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.

### ì£¼ìš” ì±…ì„

1. **Logger í´ë˜ìŠ¤ êµ¬í˜„** (`src/utils/logger.py`)
   - íƒ€ì„ìŠ¤íƒ¬í”„ ìë™ ì¶”ê°€
   - íŒŒì¼ ë° ì½˜ì†” ë™ì‹œ ì¶œë ¥
   - í‘œì¤€ ì¶œë ¥ ë¦¬ë””ë ‰ì…˜
   - tqdm ì§„í–‰ë¥  í‘œì‹œ í†µí•©

2. **ExperimentManager í´ë˜ìŠ¤ êµ¬í˜„** (`src/utils/experiment_manager.py`)
   - Session ID ìë™ ë¶€ì—¬ ì‹œìŠ¤í…œ
   - í•„ìˆ˜ ì„œë¸Œ í´ë” 6ê°œ ìë™ ìƒì„± (tools, database, prompts, ui, outputs, evaluation)
   - metadata.json ê¸°ë°˜ ì¶”ì 
   - í‰ê°€ ì§€í‘œ ìë™ ì €ì¥

3. **ì‹¤í—˜ í´ë” êµ¬ì¡° ê´€ë¦¬**
   - `experiments/ë‚ ì§œ/ë‚ ì§œ_ì‹œê°„_session_XXX/` êµ¬ì¡° ìë™ ìƒì„±
   - ë„êµ¬ë³„ ë¡œê·¸, DB ì¿¼ë¦¬, í”„ë¡¬í”„íŠ¸, UI ì¸í„°ë™ì…˜ ê¸°ë¡
   - í‰ê°€ ì§€í‘œ ë° ê²°ê³¼ë¬¼ ì €ì¥

---

## ì°¸ì—¬ ê¸°ê°„ ë° ìš°ì„ ìˆœìœ„

### ì°¸ì—¬ ê¸°ê°„
- **ì „ì²´ ê¸°ê°„ ì°¸ì—¬** (2025-10-28 ~ 2025-11-06, 10ì¼)
- **ìš°ì„  ì‘ì—… ê¸°ê°„**: í”„ë¡œì íŠ¸ ì´ˆê¸° (10/28-10/30, 3ì¼)
  - Logger í´ë˜ìŠ¤ë¥¼ ë¨¼ì € êµ¬í˜„í•´ì•¼ ë‹¤ë¥¸ íŒ€ì›ë“¤ì´ ì‚¬ìš© ê°€ëŠ¥

### ìš°ì„ ìˆœìœ„
1. **ìµœìš°ì„  (Day 1-2)**: Logger í´ë˜ìŠ¤ êµ¬í˜„
2. **ìš°ì„  (Day 3-5)**: ExperimentManager í´ë˜ìŠ¤ êµ¬í˜„ (Session ID ìë™ ë¶€ì—¬, í´ë” ìë™ ìƒì„±)
3. **ì¤‘ìš” (Day 6-7)**: í‰ê°€ ì§€í‘œ ì €ì¥ ë©”ì„œë“œ êµ¬í˜„ (RAG, Agent, Latency, Cost)
4. **ì„ íƒ (Day 8+)**: ì‹¤í—˜ ê²€ìƒ‰ ìŠ¤í¬ë¦½íŠ¸, í‰ê°€ ì§€í‘œ ì§‘ê³„ ë„êµ¬

---

## ì„¸ë¶€ ì—…ë¬´ ë° êµ¬í˜„ ë‚´ìš©

### 1. Logger í´ë˜ìŠ¤ êµ¬í˜„

**íŒŒì¼ ê²½ë¡œ**: `src/utils/logger.py`

#### 1.1 í´ë˜ìŠ¤ êµ¬ì¡°

**í•„ìˆ˜ ì„í¬íŠ¸:**

| ëª¨ë“ˆ | ìš©ë„ |
|------|------|
| `sys` | í‘œì¤€ ì¶œë ¥/ì—ëŸ¬ ë¦¬ë””ë ‰ì…˜ |
| `datetime` | íƒ€ì„ìŠ¤íƒ¬í”„ ìƒì„± |
| `pathlib.Path` | íŒŒì¼ ê²½ë¡œ ê´€ë¦¬ |
| `typing.Optional` | íƒ€ì… íŒíŒ… |

**Logger í´ë˜ìŠ¤ ì£¼ìš” ê¸°ëŠ¥:**
- íƒ€ì„ìŠ¤íƒ¬í”„ ìë™ ì¶”ê°€
- íŒŒì¼ ë° ì½˜ì†” ë™ì‹œ ì¶œë ¥
- í‘œì¤€ ì¶œë ¥ ë¦¬ë””ë ‰ì…˜
- tqdm ì§„í–‰ë¥  í‘œì‹œ í†µí•©

**ë©”ì„œë“œ 1: `__init__(log_path: str, print_also: bool = True)`**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|----------|------|--------|------|
| `log_path` | `str` | - | ë¡œê·¸ íŒŒì¼ ê²½ë¡œ (ì˜ˆ: "experiments/20251030/experiment.log") |
| `print_also` | `bool` | `True` | ì½˜ì†” ì¶œë ¥ ì—¬ë¶€ |

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|------|------|------|
| 1 | Path ê°ì²´ ìƒì„± | `Path(log_path)` |
| 2 | ë¡œê·¸ í´ë” ìƒì„± | `mkdir(parents=True, exist_ok=True)` |
| 3 | ë¡œê·¸ íŒŒì¼ ì—´ê¸° | `open(log_path, 'a', encoding='utf-8')` |
| 4 | ë¦¬ë””ë ‰ì…˜ ë°±ì—… ì´ˆê¸°í™” | `_stdout_backup`, `_stderr_backup = None` |

**ë©”ì„œë“œ 2: `write(message: str, print_also: Optional[bool] = None, print_error: bool = False)`**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|----------|------|--------|------|
| `message` | `str` | - | ê¸°ë¡í•  ë©”ì‹œì§€ |
| `print_also` | `Optional[bool]` | `None` | ì½˜ì†” ì¶œë ¥ ì—¬ë¶€ (Noneì´ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©) |
| `print_error` | `bool` | `False` | Trueë©´ ì—ëŸ¬ ë©”ì‹œì§€ë¡œ í‘œì‹œ (ë¹¨ê°„ìƒ‰) |

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|------|------|------|
| 1 | ë¹ˆ ë©”ì‹œì§€ í™•ì¸ | ë¹ˆ ë©”ì‹œì§€ë©´ return |
| 2 | íƒ€ì„ìŠ¤íƒ¬í”„ ìƒì„± | `datetime.now().strftime('%Y-%m-%d %H:%M:%S')` |
| 3 | ë¡œê·¸ ë¼ì¸ ìƒì„± | `"{timestamp} \| {message}"` í˜•ì‹ |
| 4 | íŒŒì¼ì— ê¸°ë¡ | `log_file.write(log_line + '\n')` |
| 5 | ë²„í¼ í”ŒëŸ¬ì‹œ | `log_file.flush()` |
| 6 | ì½˜ì†” ì¶œë ¥ í™•ì¸ | `should_print` ê°’ ê²°ì • |
| 7 | ì—ëŸ¬ ë©”ì‹œì§€ ì²˜ë¦¬ | `print_error=True`ë©´ ë¹¨ê°„ìƒ‰(`\033[91m`) ì¶œë ¥ |
| 8 | ì¼ë°˜ ë©”ì‹œì§€ ì¶œë ¥ | ì¼ë°˜ `print()` í˜¸ì¶œ |

**ë©”ì„œë“œ 3: `start_redirect()`**

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|------|------|------|
| 1 | stdout ë°±ì—… | `_stdout_backup = sys.stdout` |
| 2 | stderr ë°±ì—… | `_stderr_backup = sys.stderr` |
| 3 | stdout ë¦¬ë””ë ‰ì…˜ | `sys.stdout = self` |
| 4 | stderr ë¦¬ë””ë ‰ì…˜ | `sys.stderr = self` |

**ë©”ì„œë“œ 4: `stop_redirect()`**

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|------|------|------|
| 1 | stdout ë³µì› | `_stdout_backup` ì¡´ì¬ì‹œ ë³µì› |
| 2 | stderr ë³µì› | `_stderr_backup` ì¡´ì¬ì‹œ ë³µì› |

**ë©”ì„œë“œ 5: `tqdm_redirect()`**

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|------|------|------|
| 1 | tqdm ì„í¬íŠ¸ ì‹œë„ | `from tqdm import tqdm` |
| 2 | ì„±ê³µ ì‹œ | `tqdm` ë°˜í™˜ |
| 3 | ImportError ì‹œ | ì—ëŸ¬ ë©”ì‹œì§€ ë¡œê·¸ í›„ `None` ë°˜í™˜ |

**ë©”ì„œë“œ 6-8: ë¦¬ì†ŒìŠ¤ ê´€ë¦¬**

| ë©”ì„œë“œ | ì‘ì—… | ì„¤ëª… |
|--------|------|------|
| `flush()` | ë²„í¼ í”ŒëŸ¬ì‹œ | `log_file.flush()` í˜¸ì¶œ |
| `close()` | íŒŒì¼ ë‹«ê¸° | `log_file` ì¡´ì¬ ì‹œ `close()` í˜¸ì¶œ |
| `__del__()` | ì†Œë©¸ì | ìë™ìœ¼ë¡œ `close()` í˜¸ì¶œ |

#### 1.2 ì‚¬ìš© ì˜ˆì‹œ

**ì‚¬ìš© íŒ¨í„´:**

| ë‹¨ê³„ | ì‘ì—… | ì½”ë“œ |
|------|------|------|
| 1 | ë‚ ì§œ/ì‹œê°„ ìƒì„± | `datetime.now().strftime("%Y%m%d")`, `strftime("%H%M%S")` |
| 2 | ì‹¤í—˜ í´ë” ê²½ë¡œ ìƒì„± | `f"experiments/{today}/{today}_{time_now}_{experiment_name}"` |
| 3 | í´ë” ìƒì„± | `os.makedirs(log_dir, exist_ok=True)` |
| 4 | Logger ì¸ìŠ¤í„´ìŠ¤ ìƒì„± | `Logger(log_path=..., print_also=True)` |
| 5 | ì¼ë°˜ ë¡œê·¸ ê¸°ë¡ | `logger.write("VectorDB êµ¬ì¶• ì‹œì‘")` |
| 6 | ë™ì  ë©”ì‹œì§€ ë¡œê·¸ | `logger.write(f"ì´ {len(documents)}ê°œ ë¬¸ì„œ ë¡œë“œ ì™„ë£Œ")` |
| 7 | ì—ëŸ¬ ë©”ì‹œì§€ ë¡œê·¸ | `logger.write("ì˜¤ë¥˜: ...", print_error=True)` (ë¹¨ê°„ìƒ‰ ì¶œë ¥) |
| 8 | Logger ì¢…ë£Œ | `logger.close()` |

**ë¡œê·¸ ì¶œë ¥ í˜•ì‹:**
```
2025-10-31 10:30:15 | VectorDB êµ¬ì¶• ì‹œì‘
2025-10-31 10:30:16 | ì´ 150ê°œ ë¬¸ì„œ ë¡œë“œ ì™„ë£Œ
2025-10-31 10:30:17 | ì˜¤ë¥˜: íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
```

#### 1.3 í‘œì¤€ ì¶œë ¥ ë¦¬ë””ë ‰ì…˜

**ì‚¬ìš© íŒ¨í„´:**

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|------|------|------|
| 1 | Logger ìƒì„± | `Logger(f"{log_dir}/training.log")` |
| 2 | ë¦¬ë””ë ‰ì…˜ ì‹œì‘ | `logger.start_redirect()` - `sys.stdout`, `sys.stderr`ë¥¼ Loggerë¡œ ë³€ê²½ |
| 3 | ì¼ë°˜ print ì‚¬ìš© | `print("...")` - ìë™ìœ¼ë¡œ ë¡œê·¸ íŒŒì¼ì— ê¸°ë¡ë¨ |
| 4 | ë¦¬ë””ë ‰ì…˜ ì¤‘ì§€ | `logger.stop_redirect()` - ì›ë˜ stdout/stderr ë³µì› |
| 5 | Logger ì¢…ë£Œ | `logger.close()` |

**ì¥ì :**
- ê¸°ì¡´ ì½”ë“œì˜ `print()` ë¬¸ì„ ìˆ˜ì •í•˜ì§€ ì•Šê³  ë¡œê·¸ íŒŒì¼ì— ê¸°ë¡ ê°€ëŠ¥
- ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì¶œë ¥ë„ ìë™ìœ¼ë¡œ ìº¡ì²˜

---

### 2. ExperimentManager í´ë˜ìŠ¤ êµ¬í˜„

**ëª©ì **: ì±—ë´‡ ì‹¤í–‰ë§ˆë‹¤ ìë™ìœ¼ë¡œ í´ë” êµ¬ì¡°ë¥¼ ìƒì„±í•˜ê³  ëª¨ë“  ì‹¤í–‰ ë‚´ìš©ì„ ì²´ê³„ì ìœ¼ë¡œ ê¸°ë¡

#### 2.1 í´ë˜ìŠ¤ êµ¬ì¡°

**íŒŒì¼ ê²½ë¡œ**: `src/utils/experiment_manager.py`

ì „ì²´ êµ¬í˜„ ì½”ë“œëŠ” `docs/references/ì‹¤í—˜_í´ë”_êµ¬ì¡°_ìµœì¢…ì•ˆ.md`ì™€ `docs/roles/ë‹´ë‹¹ì—­í• _01-1_ìµœí˜„í™”_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md`ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

**ì£¼ìš” ê¸°ëŠ¥:**
- Session ID ìë™ ë¶€ì—¬ (session_001, 002, ...)
- í•„ìˆ˜ ì„œë¸Œ í´ë” 6ê°œ ìë™ ìƒì„± (tools, database, prompts, ui, outputs, evaluation)
- debug í´ë”ëŠ” í•„ìš”ì‹œ ìƒì„± (ì„ íƒ)
- metadata.json ê¸°ë°˜ ì¶”ì 
- ë„êµ¬ë³„ Logger ìƒì„±
- DB ì¿¼ë¦¬ ë° pgvector ê²€ìƒ‰ ê¸°ë¡
- í”„ë¡¬í”„íŠ¸ ì €ì¥ (system, user, final)
- UI ì¸í„°ë™ì…˜ ê¸°ë¡
- í‰ê°€ ì§€í‘œ ì €ì¥ (RAG, Agent, Latency, Cost)
- with ë¬¸ ì§€ì› (__enter__, __exit__)

#### 2.2 í´ë” êµ¬ì¡°

```
experiments/
â””â”€â”€ 20251031/                                # ë‚ ì§œ (YYYYMMDD)
    â””â”€â”€ 20251031_103015_session_001/         # ì‹œê°„_session_ID
        â”‚
        â”œâ”€â”€ metadata.json                    # â­ ì „ì²´ ì‹¤í—˜ ë©”íƒ€ë°ì´í„°
        â”œâ”€â”€ chatbot.log                      # ë©”ì¸ ì‹¤í–‰ ë¡œê·¸
        â”œâ”€â”€ config.yaml                      # ì „ì²´ ì„¤ì •
        â”‚
        â”œâ”€â”€ tools/                           # ğŸ”§ ë„êµ¬ ì‹¤í–‰ ë¡œê·¸
        â”‚   â”œâ”€â”€ rag_paper.log
        â”‚   â”œâ”€â”€ rag_glossary.log
        â”‚   â”œâ”€â”€ web_search.log
        â”‚   â”œâ”€â”€ summary_paper.log
        â”‚   â”œâ”€â”€ file_save.log
        â”‚   â””â”€â”€ general.log
        â”‚
        â”œâ”€â”€ database/                        # ğŸ—„ï¸ DB ê´€ë ¨ ê¸°ë¡
        â”‚   â”œâ”€â”€ queries.sql
        â”‚   â”œâ”€â”€ pgvector_searches.json
        â”‚   â”œâ”€â”€ search_results.json
        â”‚   â””â”€â”€ db_performance.json
        â”‚
        â”œâ”€â”€ prompts/                         # ğŸ’¬ í”„ë¡¬í”„íŠ¸ ê¸°ë¡
        â”‚   â”œâ”€â”€ system_prompt.txt
        â”‚   â”œâ”€â”€ user_prompt.txt
        â”‚   â”œâ”€â”€ final_prompt.txt
        â”‚   â””â”€â”€ prompt_template.yaml
        â”‚
        â”œâ”€â”€ ui/                              # ğŸ–¥ï¸ UI ê´€ë ¨ ê¸°ë¡
        â”‚   â”œâ”€â”€ streamlit_session.json
        â”‚   â”œâ”€â”€ user_interactions.log
        â”‚   â””â”€â”€ ui_events.json
        â”‚
        â”œâ”€â”€ outputs/                         # ğŸ“„ ìƒì„±ëœ ê²°ê³¼ë¬¼
        â”‚   â”œâ”€â”€ response.txt
        â”‚   â”œâ”€â”€ summary.md
        â”‚   â””â”€â”€ saved_file.txt
        â”‚
        â”œâ”€â”€ evaluation/                      # ğŸ“Š í‰ê°€ ì§€í‘œ
        â”‚   â”œâ”€â”€ rag_metrics.json
        â”‚   â”œâ”€â”€ agent_accuracy.json
        â”‚   â”œâ”€â”€ latency_report.json
        â”‚   â”œâ”€â”€ cost_analysis.json
        â”‚   â””â”€â”€ test_results.json
        â”‚
        â””â”€â”€ debug/                           # ğŸ› ë””ë²„ê·¸ ì •ë³´ (ì„ íƒ)
            â”œâ”€â”€ agent_trace.json
            â”œâ”€â”€ llm_tokens.json
            â””â”€â”€ error_trace.log
```

#### 2.3 Session ID ìë™ ë¶€ì—¬

Session IDëŠ” **ë‹¹ì¼ ê¸°ì¤€ìœ¼ë¡œ ìë™ ë¶€ì—¬**ë©ë‹ˆë‹¤:

- **í˜•ì‹**: `session_001`, `session_002`, `session_003` ...
- **ë¶€ì—¬ ë°©ì‹**: ë‹¹ì¼ í´ë”ì˜ ê¸°ì¡´ session í™•ì¸ í›„ ë‹¤ìŒ ë²ˆí˜¸
- **ì‹œì‘ ë²ˆí˜¸**: ë§¤ì¼ `001`ë¶€í„° ì‹œì‘

**ì˜ˆì‹œ:**
```
experiments/20251031/
â”œâ”€â”€ 20251031_103015_session_001/   # ì˜¤ëŠ˜ ì²« ë²ˆì§¸
â”œâ”€â”€ 20251031_110234_session_002/   # ì˜¤ëŠ˜ ë‘ ë²ˆì§¸
â””â”€â”€ 20251031_143520_session_003/   # ì˜¤ëŠ˜ ì„¸ ë²ˆì§¸

experiments/20251101/
â””â”€â”€ 20251101_090012_session_001/   # ë‹¤ìŒ ë‚ , ë‹¤ì‹œ 001ë¶€í„°
```

#### 2.4 ExperimentManager í•µì‹¬ ë©”ì„œë“œ

**í´ë˜ìŠ¤ ì„¤ëª…:** ì‹¤í—˜ í´ë” ìƒì„± ë° ê´€ë¦¬ í´ë˜ìŠ¤

**ì´ˆê¸°í™” ë©”ì„œë“œ: `__init__()`**

ìë™ ìˆ˜í–‰ ì‘ì—…:
- ë‚ ì§œ/ì‹œê°„ ìƒì„± ë° Session ID ë¶€ì—¬
- í•„ìˆ˜ ì„œë¸Œ í´ë” 6ê°œ ìë™ ìƒì„± (tools, database, prompts, ui, outputs, evaluation)
- debug í´ë”ëŠ” í•„ìš”ì‹œ ìƒì„± (ì„ íƒ)
- metadata.json ì´ˆê¸°í™”
- Logger ì´ˆê¸°í™”

**ë„êµ¬ ë¡œê·¸ ë©”ì„œë“œ:**

| ë©”ì„œë“œ | íŒŒë¼ë¯¸í„° | ë°˜í™˜ | ì„¤ëª… |
|--------|----------|------|------|
| `get_tool_logger` | `tool_name: str` | `Logger` | ë„êµ¬ë³„ Logger ìƒì„± |

**DB ê´€ë ¨ ë©”ì„œë“œ:**

| ë©”ì„œë“œ | íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|--------|----------|------|
| `log_sql_query` | `query: str, description: str, tool: str, execution_time_ms: int` | SQL ì¿¼ë¦¬ ê¸°ë¡ |
| `log_pgvector_search` | `search_info: Dict` | pgvector ê²€ìƒ‰ ê¸°ë¡ |
| `save_search_results` | `tool_name: str, results: Dict` | DB ê²€ìƒ‰ ê²°ê³¼ ì €ì¥ |
| `save_db_performance` | `performance_data: Dict` | DB ì„±ëŠ¥ ì •ë³´ ì €ì¥ |

**í”„ë¡¬í”„íŠ¸ ê´€ë ¨ ë©”ì„œë“œ:**

| ë©”ì„œë“œ | íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|--------|----------|------|
| `save_system_prompt` | `system_prompt: str, metadata: Dict` | ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì €ì¥ |
| `save_user_prompt` | `user_prompt: str, metadata: Dict` | ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ì €ì¥ |
| `save_final_prompt` | `final_prompt: str, metadata: Dict` | ìµœì¢… í”„ë¡¬í”„íŠ¸ ì €ì¥ |
| `save_prompt_template` | `template_info: Dict` | í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì •ë³´ ì €ì¥ |

**UI ê´€ë ¨ ë©”ì„œë“œ:**

| ë©”ì„œë“œ | íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|--------|----------|------|
| `save_streamlit_session` | `session_data: Dict` | Streamlit ì„¸ì…˜ ìƒíƒœ ì €ì¥ |
| `log_ui_interaction` | `interaction: str` | UI ì¸í„°ë™ì…˜ ë¡œê·¸ |
| `log_ui_event` | `event: Dict` | UI ì´ë²¤íŠ¸ ê¸°ë¡ |

**ì¶œë ¥ ê´€ë ¨ ë©”ì„œë“œ:**

| ë©”ì„œë“œ | íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|--------|----------|------|
| `save_output` | `filename: str, content: str` | ê²°ê³¼ë¬¼ ì €ì¥ |

**í‰ê°€ ì§€í‘œ ê´€ë ¨ ë©”ì„œë“œ:**

| ë©”ì„œë“œ | íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|--------|----------|------|
| `save_rag_metrics` | `metrics: Dict` | RAG í‰ê°€ ì§€í‘œ ì €ì¥ |
| `save_agent_accuracy` | `accuracy_data: Dict` | Agent ì •í™•ë„ ì €ì¥ |
| `save_latency_report` | `latency_data: Dict` | ì‘ë‹µ ì‹œê°„ ë¶„ì„ ì €ì¥ |
| `save_cost_analysis` | `cost_data: Dict` | ë¹„ìš© ë¶„ì„ ì €ì¥ |
| `save_test_results` | `test_data: Dict` | í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì €ì¥ |

**ë©”íƒ€ë°ì´í„° ë° ê´€ë¦¬ ë©”ì„œë“œ:**

| ë©”ì„œë“œ | íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|--------|----------|------|
| `update_metadata` | `**kwargs` | ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸ (ê°€ë³€ ì¸ì) |
| `save_config` | `config: Dict` | ì „ì²´ ì„¤ì • ì €ì¥ |
| `close` | - | ì‹¤í—˜ ì¢…ë£Œ, ë¦¬ì†ŒìŠ¤ ì •ë¦¬ |
| `__enter__` | - | with ë¬¸ ì‹œì‘ ì‹œ í˜¸ì¶œ, `self` ë°˜í™˜ |
| `__exit__` | `exc_type, exc_val, exc_tb` | with ë¬¸ ì¢…ë£Œ ì‹œ ìë™ `close()` í˜¸ì¶œ |

---

### 3. ì‚¬ìš© ì˜ˆì‹œ

#### 3.1 ê¸°ë³¸ ì‚¬ìš© (with ë¬¸)

**ì‚¬ìš© íŒ¨í„´:**

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|------|------|------|
| 1 | ExperimentManager ì„í¬íŠ¸ | `from src.utils.experiment_manager import ExperimentManager` |
| 2 | with ë¬¸ìœ¼ë¡œ ì´ˆê¸°í™” | `with ExperimentManager() as exp:` |
| 3 | ìë™ í´ë” ìƒì„± | `experiments/20251031/20251031_103015_session_001/` |
| 4 | Session ID ìë™ ë¶€ì—¬ | `session_001`, `session_002`, ... (ë‹¹ì¼ ê¸°ì¤€ ì¦ê°€) |
| 5 | ê¸°ë³¸ íŒŒì¼ ìƒì„± | `chatbot.log` íŒŒì¼ ìƒì„± |
| 6 | ì„œë¸Œ í´ë” ìƒì„± | 6ê°œ í´ë”: tools, database, prompts, ui, outputs, evaluation |
| 7 | metadata.json ì´ˆê¸°í™” | ë¹ˆ ë©”íƒ€ë°ì´í„° íŒŒì¼ ìƒì„± |
| 8 | Logger ì´ˆê¸°í™” | `exp.logger` ì‚¬ìš© ê°€ëŠ¥ |
| 9 | ë¡œê·¸ ê¸°ë¡ | `exp.logger.write("ì±—ë´‡ ì‹¤í–‰ ì‹œì‘")` |
| 10 | ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸ | `exp.update_metadata(user_query="...", difficulty="...")` |
| 11 | ìë™ ì¢…ë£Œ | with ë¸”ë¡ ì¢…ë£Œ ì‹œ ìë™ìœ¼ë¡œ `close()` í˜¸ì¶œ |

#### 3.2 ë„êµ¬ë³„ Logger ì‚¬ìš©

**ì‚¬ìš© íŒ¨í„´:**

| ë‹¨ê³„ | ì‘ì—… | ì½”ë“œ |
|------|------|------|
| 1 | ExperimentManager ì‹œì‘ | `with ExperimentManager() as exp:` |
| 2 | RAG Logger ìƒì„± | `rag_logger = exp.get_tool_logger('rag_paper')` |
| 3 | RAG ë¡œê·¸ ê¸°ë¡ | `rag_logger.write("ë…¼ë¬¸ ê²€ìƒ‰ ì‹œì‘")` |
| 4 | RAG ë¡œê·¸ ê¸°ë¡ | `rag_logger.write("ê²€ìƒ‰ ì™„ë£Œ: 5ê°œ ë…¼ë¬¸ ë°œê²¬")` |
| 5 | RAG Logger ì¢…ë£Œ | `rag_logger.close()` |
| 6 | Web Logger ìƒì„± | `web_logger = exp.get_tool_logger('web_search')` |
| 7 | Web ë¡œê·¸ ê¸°ë¡ | `web_logger.write("ì›¹ ê²€ìƒ‰ ì‹œì‘")` |
| 8 | Web Logger ì¢…ë£Œ | `web_logger.close()` |

**ìƒì„±ë˜ëŠ” íŒŒì¼:**
- `tools/rag_paper.log` - RAG ë„êµ¬ ë¡œê·¸
- `tools/web_search.log` - ì›¹ ê²€ìƒ‰ ë„êµ¬ ë¡œê·¸

#### 3.3 DB ì¿¼ë¦¬ ë° í”„ë¡¬í”„íŠ¸ ì €ì¥

**SQL ì¿¼ë¦¬ ê¸°ë¡ - `log_sql_query()`:**

| íŒŒë¼ë¯¸í„° | ê°’ | ì„¤ëª… |
|----------|-----|------|
| `query` | `"SELECT * FROM papers WHERE paper_id IN (1, 2, 3)"` | SQL ì¿¼ë¦¬ ë¬¸ìì—´ |
| `description` | `"ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ì¡°íšŒ"` | ì¿¼ë¦¬ ì„¤ëª… |
| `tool` | `"rag_paper"` | ì‹¤í–‰í•œ ë„êµ¬ ì´ë¦„ |
| `execution_time_ms` | `12` | ì‹¤í–‰ ì‹œê°„ (ë°€ë¦¬ì´ˆ) |

**ì €ì¥ ìœ„ì¹˜:** `database/queries.sql`

**pgvector ê²€ìƒ‰ ê¸°ë¡ - `log_pgvector_search()`:**

| í‚¤ | ê°’ | ì„¤ëª… |
|-----|-----|------|
| `tool` | `"rag_paper"` | ë„êµ¬ ì´ë¦„ |
| `collection` | `"paper_chunks"` | ê²€ìƒ‰í•œ ì»¬ë ‰ì…˜ |
| `query_text` | `"RAGì— ëŒ€í•´ ì•Œë ¤ì¤˜"` | ê²€ìƒ‰ ì¿¼ë¦¬ í…ìŠ¤íŠ¸ |
| `top_k` | `5` | ë°˜í™˜í•  ê²°ê³¼ ìˆ˜ |
| `execution_time_ms` | `45` | ì‹¤í–‰ ì‹œê°„ (ë°€ë¦¬ì´ˆ) |

**ì €ì¥ ìœ„ì¹˜:** `database/pgvector_searches.json`

**ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì €ì¥ - `save_system_prompt()`:**

| íŒŒë¼ë¯¸í„° | ê°’ | ì„¤ëª… |
|----------|-----|------|
| `system_prompt` | `"ë‹¹ì‹ ì€ ë…¼ë¬¸ì„ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤."` | ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ í…ìŠ¤íŠ¸ |
| `metadata` | `{"ë‚œì´ë„": "easy"}` | ì¶”ê°€ ë©”íƒ€ë°ì´í„° |

**ì €ì¥ ìœ„ì¹˜:** `prompts/system_prompt.txt`

**ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ì €ì¥ - `save_user_prompt()`:**

| íŒŒë¼ë¯¸í„° | ê°’ | ì„¤ëª… |
|----------|-----|------|
| `user_prompt` | `"[ì§ˆë¬¸]\nRAGì— ëŒ€í•´ ì•Œë ¤ì¤˜"` | ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ í…ìŠ¤íŠ¸ |
| `metadata` | `{"ê²€ìƒ‰ ê²°ê³¼ ìˆ˜": 5}` | ì¶”ê°€ ë©”íƒ€ë°ì´í„° |

**ì €ì¥ ìœ„ì¹˜:** `prompts/user_prompt.txt`

#### 3.4 í‰ê°€ ì§€í‘œ ì €ì¥

**RAG í‰ê°€ ì§€í‘œ - `save_rag_metrics()`:**

| ì¹´í…Œê³ ë¦¬ | ì§€í‘œ | ê°’ | ì„¤ëª… |
|----------|------|-----|------|
| `retrieval_metrics` | `recall_at_5` | `0.8` | ìƒìœ„ 5ê°œ ê²°ê³¼ ì¬í˜„ìœ¨ |
| `retrieval_metrics` | `precision_at_5` | `0.4` | ìƒìœ„ 5ê°œ ê²°ê³¼ ì •ë°€ë„ |
| `generation_metrics` | `faithfulness` | `0.95` | ìƒì„± ë‹µë³€ ì¶©ì‹¤ë„ |

**ì €ì¥ ìœ„ì¹˜:** `evaluation/rag_metrics.json`

**Agent ì •í™•ë„ - `save_agent_accuracy()`:**

| ì¹´í…Œê³ ë¦¬ | í‚¤ | ê°’ | ì„¤ëª… |
|----------|-----|-----|------|
| `routing_decision` | `predicted_tool` | `"rag_paper"` | ì˜ˆì¸¡í•œ ë„êµ¬ |
| `routing_decision` | `correct` | `True` | ì •ë‹µ ì—¬ë¶€ |

**ì €ì¥ ìœ„ì¹˜:** `evaluation/agent_accuracy.json`

**ì‘ë‹µ ì‹œê°„ ë¶„ì„ - `save_latency_report()`:**

| ì¹´í…Œê³ ë¦¬ | í‚¤ | ê°’ | ì„¤ëª… |
|----------|-----|-----|------|
| `total_latency` | `total_time_ms` | `5000` | ì „ì²´ ì‘ë‹µ ì‹œê°„ (ë°€ë¦¬ì´ˆ) |
| `total_latency` | `status` | `"PASS"` | ì„±ëŠ¥ ê¸°ì¤€ í†µê³¼ ì—¬ë¶€ |

**ì €ì¥ ìœ„ì¹˜:** `evaluation/latency_report.json`

**ë¹„ìš© ë¶„ì„ - `save_cost_analysis()`:**

| ì¹´í…Œê³ ë¦¬ | í‚¤ | ê°’ | ì„¤ëª… |
|----------|-----|-----|------|
| `llm_usage` | `total_tokens` | `2345` | ì´ í† í° ì‚¬ìš©ëŸ‰ |
| `cost_breakdown_krw` | `total_cost` | `30.51` | ì´ ë¹„ìš© (ì›í™”) |

**ì €ì¥ ìœ„ì¹˜:** `evaluation/cost_analysis.json`

---

## ì°¸ê³  PRD ë¬¸ì„œ

ì•„ë˜ PRD ë¬¸ì„œë“¤ì„ ì°¸ê³ í•˜ì—¬ êµ¬í˜„í•˜ì„¸ìš”:

1. **[05_ë¡œê¹…_ì‹œìŠ¤í…œ.md](../PRD/05_ë¡œê¹…_ì‹œìŠ¤í…œ.md)** â­â­â­
   - Logger í´ë˜ìŠ¤ ìƒì„¸ ëª…ì„¸
   - ExperimentManager ì‚¬ìš©ë²•
   - ë¡œê¹… ì •ì±… ë° ê·œì¹™

2. **[06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md](../PRD/06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md)** â­â­â­
   - ì‹¤í—˜ í´ë” êµ¬ì¡°
   - Session ID ìë™ ë¶€ì—¬ ê·œì¹™
   - metadata.json êµ¬ì¡°

3. **[09_í‰ê°€_ê¸°ì¤€.md](../PRD/09_í‰ê°€_ê¸°ì¤€.md)** â­â­
   - RAG í‰ê°€ ì§€í‘œ
   - Agent ì •í™•ë„
   - ì‘ë‹µ ì‹œê°„ ë° ë¹„ìš© ë¶„ì„

4. **[ì‹¤í—˜_í´ë”_êµ¬ì¡°_ìµœì¢…ì•ˆ.md](../references/ì‹¤í—˜_í´ë”_êµ¬ì¡°_ìµœì¢…ì•ˆ.md)** â­â­â­
   - ì „ì²´ í´ë” êµ¬ì¡° ìƒì„¸ ê°€ì´ë“œ
   - ExperimentManager ì „ì²´ êµ¬í˜„ ì½”ë“œ
   - ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ

5. **[ë‹´ë‹¹ì—­í• _01-1_ìµœí˜„í™”_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md](./ë‹´ë‹¹ì—­í• _01-1_ìµœí˜„í™”_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md)** â­â­â­
   - ExperimentManager êµ¬í˜„ ë‹´ë‹¹ ì—­í• 
   - 7ê°€ì§€ ì‚¬ìš© ì˜ˆì‹œ
   - êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

6. **[ë‹´ë‹¹ì—­í• _06_ë¡œê¹…_ëª¨ë‹ˆí„°ë§.md](./ë‹´ë‹¹ì—­í• _06_ë¡œê¹…_ëª¨ë‹ˆí„°ë§.md)** â­â­
   - Logger ë° query_logs í…Œì´ë¸” êµ¬í˜„
   - ë ˆê±°ì‹œ ë¡œê¹… ì‹œìŠ¤í…œ ì°¸ê³ 

---

## í˜‘ì—… ë°©ë²•

### ë‹¤ë¥¸ ë‹´ë‹¹ìì™€ì˜ í˜‘ì—…

#### 1. ì „ì²´ íŒ€ì› - Logger ë° ExperimentManager ì‚¬ìš©
- **í˜‘ì—… ë‚´ìš©**: ëª¨ë“  ì±—ë´‡ ì‹¤í–‰ ì‹œ ExperimentManager ì‚¬ìš©
- **íƒ€ì´ë°**: Logger êµ¬í˜„ ì™„ë£Œ ì¦‰ì‹œ
- **ì „ë‹¬ ì‚¬í•­**: Logger ë° ExperimentManager ì‚¬ìš©ë²• ë¬¸ì„œí™”, ì˜ˆì‹œ ì½”ë“œ

#### 2. AI Agent ë‹´ë‹¹ - Agent ì‹¤í–‰ ë¡œê¹… í†µí•©
- **í˜‘ì—… ë‚´ìš©**: Agent ì‹¤í–‰ ì‹œ ExperimentManagerë¡œ ìë™ ê¸°ë¡
- **íƒ€ì´ë°**: Agent graph êµ¬í˜„ ì™„ë£Œ í›„
- **ì „ë‹¬ ì‚¬í•­**: with ExperimentManager() as exp ì‚¬ìš© íŒ¨í„´

#### 3. RAG ë‹´ë‹¹ - DB ì¿¼ë¦¬ ë° ê²€ìƒ‰ ê²°ê³¼ ê¸°ë¡
- **í˜‘ì—… ë‚´ìš©**: pgvector ê²€ìƒ‰ ë° DB ì¿¼ë¦¬ ê¸°ë¡
- **íƒ€ì´ë°**: RAG Retriever êµ¬í˜„ ì™„ë£Œ í›„
- **ì „ë‹¬ ì‚¬í•­**: log_sql_query, log_pgvector_search ë©”ì„œë“œ ì‚¬ìš©ë²•

#### 4. UI ë‹´ë‹¹ - Streamlit ì¸í„°ë™ì…˜ ê¸°ë¡
- **í˜‘ì—… ë‚´ìš©**: UI ì´ë²¤íŠ¸ ë° ì„¸ì…˜ ìƒíƒœ ì €ì¥
- **íƒ€ì´ë°**: Streamlit UI êµ¬í˜„ ì™„ë£Œ í›„
- **ì „ë‹¬ ì‚¬í•­**: log_ui_interaction, save_streamlit_session ë©”ì„œë“œ ì‚¬ìš©ë²•

---

## êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: Logger í´ë˜ìŠ¤ êµ¬í˜„ (ìš°ì„ ìˆœìœ„ 1, Day 1-2)
- [ ] `src/utils/logger.py` íŒŒì¼ ìƒì„±
- [ ] Logger í´ë˜ìŠ¤ êµ¬í˜„
  - [ ] `__init__()` - íŒŒì¼ ì—´ê¸°, í´ë” ìƒì„±
  - [ ] `write()` - íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€, íŒŒì¼/ì½˜ì†” ì¶œë ¥
  - [ ] `start_redirect()`, `stop_redirect()` - í‘œì¤€ ì¶œë ¥ ë¦¬ë””ë ‰ì…˜
  - [ ] `tqdm_redirect()` - tqdm í†µí•©
  - [ ] `flush()`, `close()` - íŒŒì¼ ê´€ë¦¬
- [ ] í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ë° ê²€ì¦
- [ ] ì‚¬ìš©ë²• ë¬¸ì„œí™” ë° íŒ€ì› ê³µìœ 

### Phase 2: ExperimentManager ê¸°ë³¸ êµ¬í˜„ (ìš°ì„ ìˆœìœ„ 2, Day 3-5)
- [ ] `src/utils/experiment_manager.py` íŒŒì¼ ìƒì„±
- [ ] ExperimentManager í´ë˜ìŠ¤ ê¸°ë³¸ êµ¬í˜„
  - [ ] `__init__()` - Session ID ìë™ ë¶€ì—¬, í´ë” ìƒì„±
  - [ ] `_get_next_session_id()` - Session ID ìë™ ì¦ê°€
  - [ ] `get_tool_logger()` - ë„êµ¬ë³„ Logger ìƒì„±
  - [ ] `update_metadata()` - ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸
  - [ ] `save_config()` - ì„¤ì • ì €ì¥
  - [ ] `close()` - ì‹¤í—˜ ì¢…ë£Œ
  - [ ] `__enter__()`, `__exit__()` - with ë¬¸ ì§€ì›
- [ ] metadata.json ìë™ ìƒì„± ë° ì—…ë°ì´íŠ¸
- [ ] í•„ìˆ˜ ì„œë¸Œ í´ë” 6ê°œ ìë™ ìƒì„± (tools, database, prompts, ui, outputs, evaluation)

### Phase 3: DB ë° í”„ë¡¬í”„íŠ¸ ì €ì¥ (ìš°ì„ ìˆœìœ„ 2, Day 5-6)
- [ ] DB ê´€ë ¨ ë©”ì„œë“œ êµ¬í˜„
  - [ ] `log_sql_query()` - SQL ì¿¼ë¦¬ ê¸°ë¡
  - [ ] `log_pgvector_search()` - pgvector ê²€ìƒ‰ ê¸°ë¡
  - [ ] `save_search_results()` - ê²€ìƒ‰ ê²°ê³¼ ì €ì¥
  - [ ] `save_db_performance()` - DB ì„±ëŠ¥ ì €ì¥
- [ ] í”„ë¡¬í”„íŠ¸ ê´€ë ¨ ë©”ì„œë“œ êµ¬í˜„
  - [ ] `save_system_prompt()` - ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì €ì¥
  - [ ] `save_user_prompt()` - ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ì €ì¥
  - [ ] `save_final_prompt()` - ìµœì¢… í”„ë¡¬í”„íŠ¸ ì €ì¥
  - [ ] `save_prompt_template()` - í…œí”Œë¦¿ ì •ë³´ ì €ì¥

### Phase 4: UI ë° í‰ê°€ ì§€í‘œ (ì¤‘ìš”, Day 6-7)
- [ ] UI ê´€ë ¨ ë©”ì„œë“œ êµ¬í˜„
  - [ ] `save_streamlit_session()` - ì„¸ì…˜ ìƒíƒœ ì €ì¥
  - [ ] `log_ui_interaction()` - ì¸í„°ë™ì…˜ ë¡œê·¸
  - [ ] `log_ui_event()` - ì´ë²¤íŠ¸ ê¸°ë¡
- [ ] í‰ê°€ ì§€í‘œ ì €ì¥ ë©”ì„œë“œ êµ¬í˜„
  - [ ] `save_rag_metrics()` - RAG í‰ê°€ ì§€í‘œ
  - [ ] `save_agent_accuracy()` - Agent ì •í™•ë„
  - [ ] `save_latency_report()` - ì‘ë‹µ ì‹œê°„ ë¶„ì„
  - [ ] `save_cost_analysis()` - ë¹„ìš© ë¶„ì„
  - [ ] `save_test_results()` - í…ŒìŠ¤íŠ¸ ê²°ê³¼
- [ ] ì¶œë ¥ ê´€ë ¨ ë©”ì„œë“œ êµ¬í˜„
  - [ ] `save_output()` - ê²°ê³¼ë¬¼ ì €ì¥

### Phase 5: ì‹¤í—˜ ê²€ìƒ‰ ë° ì§‘ê³„ (ì„ íƒ, Day 8+)
- [ ] `scripts/find_experiments.py` êµ¬í˜„
  - [ ] metadata.json ê¸°ë°˜ ê²€ìƒ‰ í•¨ìˆ˜
  - [ ] í•„í„°ë§ ì˜µì…˜ (ë‚œì´ë„, ë„êµ¬, ë‚ ì§œ, ì‘ë‹µ ì‹œê°„)
- [ ] `scripts/aggregate_metrics.py` êµ¬í˜„
  - [ ] í‰ê°€ ì§€í‘œ ìˆ˜ì§‘ ë° ì§‘ê³„
  - [ ] í‰ê· /ìµœì†Œ/ìµœëŒ€ê°’ ê³„ì‚°
  - [ ] CSV/JSON ê²°ê³¼ ì €ì¥

### Phase 6: ë¬¸ì„œí™” ë° í…ŒìŠ¤íŠ¸ (ì§€ì†)
- [ ] README.md ì—…ë°ì´íŠ¸ (ExperimentManager ì‚¬ìš©ë²•)
- [ ] ìƒ˜í”Œ ì½”ë“œ ì‘ì„±
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (`tests/utils/test_experiment_manager.py`)
- [ ] í†µí•© í…ŒìŠ¤íŠ¸

---

## ê·œì¹™ ë° ì£¼ì˜ì‚¬í•­

### 1. ë¡œê¹… ê·œì¹™
- **ëª¨ë“  ì±—ë´‡ ì‹¤í–‰ì€ ExperimentManagerë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë¡**
- `print()` ì‚¬ìš© ê¸ˆì§€ â†’ `logger.write()` ì‚¬ìš©
- ë¡œê·¸ íŒŒì¼ì€ `experiments/ë‚ ì§œ/ë‚ ì§œ_ì‹œê°„_session_XXX/` êµ¬ì¡°ë¡œ ìë™ ì €ì¥

### 2. Session ID ê·œì¹™
- **í˜•ì‹**: `session_001`, `session_002`, `session_003` ...
- **ìë™ ë¶€ì—¬**: ë‹¹ì¼ í´ë”ì˜ ê¸°ì¡´ session í™•ì¸ í›„ ë‹¤ìŒ ë²ˆí˜¸
- **ì‹œì‘ ë²ˆí˜¸**: ë§¤ì¼ `001`ë¶€í„° ì‹œì‘

### 3. ì½”ë“œ í’ˆì§ˆ
- ëª¨ë“  í´ë˜ìŠ¤ì™€ í•¨ìˆ˜ì— docstring ì‘ì„±
- íƒ€ì… íŒíŒ… ì‚¬ìš© (Python 3.10+)
- ì—ëŸ¬ ì²˜ë¦¬ ì² ì €íˆ (try-except)
- ë¦¬ì†ŒìŠ¤ ìë™ ì •ë¦¬ (`__del__`, `close()`)

### 4. í…ŒìŠ¤íŠ¸
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (`tests/utils/test_logger.py`, `tests/utils/test_experiment_manager.py`)
- ExperimentManagerëŠ” í”„ë¡œì íŠ¸ ì „ì²´ì—ì„œ ì‚¬ìš©ë˜ë¯€ë¡œ ì² ì €í•œ í…ŒìŠ¤íŠ¸ í•„ìš”
- Session ID ìë™ ë¶€ì—¬ ë¡œì§ í…ŒìŠ¤íŠ¸ í•„ìˆ˜

### 5. ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­
- ë¡œê·¸ íŒŒì¼ì€ ë²„í¼ë§ ì‚¬ìš© (`flush()` ì ì ˆíˆ í˜¸ì¶œ)
- metadata.jsonì€ UTF-8 ì¸ì½”ë”©ìœ¼ë¡œ ì €ì¥
- ëŒ€ìš©ëŸ‰ ë¡œê·¸ ì‹œ íŒŒì¼ í¬ê¸° ê´€ë¦¬ (ì„ íƒì‚¬í•­)

---

## ì˜ˆìƒ ê²°ê³¼ë¬¼

### 1. íŒŒì¼ êµ¬ì¡°

```
src/
â””â”€â”€ utils/
    â”œâ”€â”€ logger.py              # Logger í´ë˜ìŠ¤
    â””â”€â”€ experiment_manager.py  # ExperimentManager í´ë˜ìŠ¤

tests/
â””â”€â”€ utils/
    â”œâ”€â”€ test_logger.py
    â””â”€â”€ test_experiment_manager.py

scripts/
â”œâ”€â”€ find_experiments.py        # ì‹¤í—˜ ê²€ìƒ‰ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ aggregate_metrics.py       # í‰ê°€ ì§€í‘œ ì§‘ê³„ ìŠ¤í¬ë¦½íŠ¸

experiments/                   # ì‹¤í—˜ ê²°ê³¼ í´ë”
â””â”€â”€ 20251031/
    â””â”€â”€ 20251031_103015_session_001/
        â”œâ”€â”€ metadata.json
        â”œâ”€â”€ chatbot.log
        â”œâ”€â”€ config.yaml
        â”œâ”€â”€ tools/
        â”œâ”€â”€ database/
        â”œâ”€â”€ prompts/
        â”œâ”€â”€ ui/
        â”œâ”€â”€ outputs/
        â”œâ”€â”€ evaluation/
        â””â”€â”€ debug/                # ì„ íƒ ì‚¬í•­
```

### 2. ì‚¬ìš© ì˜ˆì‹œ

**ExperimentManager ê¸°ë³¸ ì‚¬ìš©:**

| ìˆœì„œ | ì‘ì—… | ì½”ë“œ |
|------|------|------|
| 1 | ExperimentManager ì„í¬íŠ¸ | `from src.utils.experiment_manager import ExperimentManager` |
| 2 | with ë¬¸ ì‹œì‘ | `with ExperimentManager() as exp:` |
| 3 | ë¡œê·¸ ê¸°ë¡ | `exp.logger.write("ì±—ë´‡ ì‹¤í–‰ ì‹œì‘")` |
| 4 | ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸ | `exp.update_metadata(user_query="...", difficulty="easy")` |
| 5 | ê²°ê³¼ ì €ì¥ | `exp.save_output('response.txt', "ë‹µë³€ ë‚´ìš©...")` |

**ë„êµ¬ë³„ Logger:**

| ìˆœì„œ | ì‘ì—… | ì½”ë“œ |
|------|------|------|
| 1 | with ë¬¸ ì‹œì‘ | `with ExperimentManager() as exp:` |
| 2 | ë„êµ¬ Logger ìƒì„± | `tool_logger = exp.get_tool_logger('rag_paper')` |
| 3 | ë¡œê·¸ ê¸°ë¡ | `tool_logger.write("ë…¼ë¬¸ ê²€ìƒ‰ ì‹œì‘")` |
| 4 | Logger ì¢…ë£Œ | `tool_logger.close()` |

**í‰ê°€ ì§€í‘œ ì €ì¥:**

| ìˆœì„œ | ì‘ì—… | ë©”ì„œë“œ |
|------|------|--------|
| 1 | with ë¬¸ ì‹œì‘ | `with ExperimentManager() as exp:` |
| 2 | RAG ì§€í‘œ ì €ì¥ | `exp.save_rag_metrics({"recall_at_5": 0.8})` |
| 3 | Agent ì •í™•ë„ ì €ì¥ | `exp.save_agent_accuracy({"predicted_tool": "rag_paper", "correct": True})` |
| 4 | ë¹„ìš© ë¶„ì„ ì €ì¥ | `exp.save_cost_analysis({"total_cost_krw": 30.51})` |
