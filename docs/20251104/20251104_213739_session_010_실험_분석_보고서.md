# ì‹¤í—˜ ì„¸ì…˜ ë¶„ì„ ë³´ê³ ì„œ

**ì„¸ì…˜ ID**: 010
**ì‹¤í—˜ ì‹œì‘**: 2025-11-04 21:37:39
**ì‹¤í—˜ í´ë”**: experiments/20251104/20251104_213739_session_010
**ë¶„ì„ ë‚ ì§œ**: 2025-11-04

---

## ëª©ì°¨
1. [ì‹¤í—˜ ê°œìš”](#1-ì‹¤í—˜-ê°œìš”)
2. [í´ë” êµ¬ì¡° ë¶„ì„](#2-í´ë”-êµ¬ì¡°-ë¶„ì„)
3. [ë°œê²¬ëœ ë¬¸ì œì  ë° ì›ì¸ ë¶„ì„](#3-ë°œê²¬ëœ-ë¬¸ì œì -ë°-ì›ì¸-ë¶„ì„)
4. [ì½”ë“œ ë¶„ì„ ê²°ê³¼](#4-ì½”ë“œ-ë¶„ì„-ê²°ê³¼)
5. [ê°œì„  ê¶Œì¥ì‚¬í•­](#5-ê°œì„ -ê¶Œì¥ì‚¬í•­)

---

## 1. ì‹¤í—˜ ê°œìš”

### 1.1 ì„¸ì…˜ ì •ë³´
- **ì„¸ì…˜ ID**: 010
- **ì‹¤í—˜ í´ë”**: experiments/20251104/20251104_213739_session_010
- **ì‹¤í—˜ ì‹œì‘ ì‹œê°„**: 2025-11-04 21:37:39
- **ìƒì„±ëœ íŒŒì¼ ìˆ˜**: 39ê°œ
- **í´ë” êµ¬ì¡°**: 8ê°œ í•˜ìœ„ ë””ë ‰í† ë¦¬

### 1.2 ì‹¤í—˜ ë‚´ìš©
- ì´ˆë³´ì(easy) ëª¨ë“œì—ì„œ 10ê°œ ì§ˆì˜ì‘ë‹µ ìˆ˜í–‰
- ì›¹ ê²€ìƒ‰, ë…¼ë¬¸ ê²€ìƒ‰, ìš©ì–´ì§‘, ìš”ì•½ ë“± ë‹¤ì–‘í•œ ë„êµ¬ ì‚¬ìš©
- ê° ë‹µë³€ì— ëŒ€í•œ ìë™ í‰ê°€ ìˆ˜í–‰
- ëŒ€í™” ê¸°ë¡ ë° í‰ê°€ ê²°ê³¼ ì €ì¥

---

## 2. í´ë” êµ¬ì¡° ë¶„ì„

### 2.1 ì „ì²´ êµ¬ì¡°
```
experiments/20251104/20251104_213739_session_010/
â”œâ”€â”€ chatbot.log
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ db_config.yaml
â”‚   â””â”€â”€ model_config.yaml
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ pgvector_searches.json
â”‚   â””â”€â”€ queries.sql
â”œâ”€â”€ evaluation/
â”‚   â”œâ”€â”€ evaluation_20251104_214008.json
â”‚   â”œâ”€â”€ evaluation_20251104_215227.json
â”‚   â”œâ”€â”€ evaluation_20251104_215438.json
â”‚   â”œâ”€â”€ evaluation_20251104_215601.json
â”‚   â”œâ”€â”€ evaluation_20251104_215728.json
â”‚   â”œâ”€â”€ evaluation_20251104_215831.json
â”‚   â”œâ”€â”€ evaluation_20251104_215935.json
â”‚   â”œâ”€â”€ evaluation_20251104_220031.json
â”‚   â”œâ”€â”€ evaluation_20251104_220156.json
â”‚   â”œâ”€â”€ evaluation_20251104_220400.json
â”‚   â””â”€â”€ evaluation_20251104_220617.json (11ê°œ)
â”œâ”€â”€ metadata.json
â”œâ”€â”€ outputs/
â”‚   â”œâ”€â”€ conversation_20251104_214008.json
â”‚   â”œâ”€â”€ conversation_20251104_215227.json
â”‚   â”œâ”€â”€ conversation_20251104_215438.json
â”‚   â”œâ”€â”€ conversation_20251104_215601.json
â”‚   â”œâ”€â”€ conversation_20251104_215728.json
â”‚   â”œâ”€â”€ conversation_20251104_215831.json
â”‚   â”œâ”€â”€ conversation_20251104_215935.json
â”‚   â”œâ”€â”€ conversation_20251104_220031.json
â”‚   â”œâ”€â”€ conversation_20251104_220156.json
â”‚   â”œâ”€â”€ conversation_20251104_220400.json (10ê°œ)
â”‚   â”œâ”€â”€ response.txt
â”‚   â”œâ”€â”€ response_20251104_220557.txt
â”‚   â””â”€â”€ summary.md
â”œâ”€â”€ prompts/
â”‚   â”œâ”€â”€ final_prompt.txt
â”‚   â”œâ”€â”€ system_prompt.txt
â”‚   â””â”€â”€ user_prompt.txt
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ evaluator.log
â”‚   â”œâ”€â”€ rag_glossary.log
â”‚   â”œâ”€â”€ rag_paper.log
â”‚   â”œâ”€â”€ summarize.log
â”‚   â””â”€â”€ web_search.log
â””â”€â”€ ui/
    â””â”€â”€ user_interactions.log
```

### 2.2 íŒŒì¼ ê°œìˆ˜ í†µê³„
- **ì´ íŒŒì¼ ìˆ˜**: 39ê°œ
- **evaluation íŒŒì¼**: 11ê°œ (ëª¨ë‘ easy ëª¨ë“œ)
- **conversation íŒŒì¼**: 10ê°œ
- **ë„êµ¬ ë¡œê·¸**: 5ê°œ
- **í”„ë¡¬í”„íŠ¸ íŒŒì¼**: 3ê°œ

---

## 3. ë°œê²¬ëœ ë¬¸ì œì  ë° ì›ì¸ ë¶„ì„

### 3.1 outputs í´ë” response.txt íŒŒì¼ ë¬¸ì œ

#### ë¬¸ì œì 
1. `response.txt` íŒŒì¼ê³¼ `response_20251104_220557.txt` íŒŒì¼ì´ ë³„ë„ë¡œ ì¡´ì¬
2. `response.txt`ëŠ” ì²« ë²ˆì§¸ ë‹µë³€ ë‚´ìš©ìœ¼ë¡œ ë®ì–´ì“°ê¸°ë¨
3. `response_20251104_220557.txt`ëŠ” "ì €ì¥í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤."ë¡œ ë¹ˆ ë‚´ìš©

#### ì›ì¸ ë¶„ì„
**íŒŒì¼ ìœ„ì¹˜**: `ui/components/chat_interface.py:322`
```python
# ë§¤ ë‹µë³€ë§ˆë‹¤ response.txtì— ë‹µë³€ ì €ì¥ (ë®ì–´ì“°ê¸°)
if exp_manager:
    exp_manager.save_output("response.txt", answer)  # ë¬¸ì œ: ë™ì¼ íŒŒì¼ëª…ìœ¼ë¡œ ë®ì–´ì“°ê¸°
```

**íŒŒì¼ ìœ„ì¹˜**: `src/tools/save_file.py:42-51`
```python
# íŒŒì¼ ì €ì¥ ë„êµ¬ ì‹¤í–‰ ì‹œ íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ íŒŒì¼ëª… ìƒì„±
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
filename = f"response_{timestamp}.txt"
if exp_manager:
    file_path = exp_manager.save_output(filename, content_to_save)
```

**ê·¼ë³¸ ì›ì¸**:
1. ë‘ ê°€ì§€ ë‹¤ë¥¸ ì €ì¥ ë©”ì»¤ë‹ˆì¦˜ì´ ì¤‘ë³µìœ¼ë¡œ ì‹¤í–‰ë¨
2. `response.txt`ëŠ” ë§¤ ë‹µë³€ë§ˆë‹¤ ë®ì–´ì“°ê¸°ë˜ì–´ ì˜ë¯¸ ì—†ìŒ
3. `response_ë‚ ì§œ_ì‹œê°„.txt`ëŠ” íŒŒì¼ ì €ì¥ ë„êµ¬ ì‹¤í–‰ ì‹œì—ë§Œ ìƒì„±ë˜ì§€ë§Œ, ì €ì¥í•  ë‚´ìš©ì´ ì—†ì„ ë•Œë„ ë¹ˆ íŒŒì¼ ìƒì„±ë¨

### 3.2 conversation JSON íŒŒì¼ ì¤‘ë³µ ìƒì„± ë° ëª¨ë“œë³„ êµ¬ë¶„ ë¬¸ì œ

#### ë¬¸ì œì 
1. ë§¤ ì§ˆì˜ì‘ë‹µë§ˆë‹¤ ìƒˆë¡œìš´ `conversation_ë‚ ì§œ_ì‹œê°„.json` íŒŒì¼ ìƒì„±ë¨ (ì´ 10ê°œ)
2. íŒŒì¼ëª…ì— ëª¨ë“œ(easy/hard) êµ¬ë¶„ì´ ì—†ìŒ
3. ì´ì–´ì“°ê¸°ê°€ ì•„ë‹Œ ì™„ì „íˆ ìƒˆë¡œìš´ íŒŒì¼ì´ ìƒì„±ë¨

#### ì›ì¸ ë¶„ì„
**íŒŒì¼ ìœ„ì¹˜**: `ui/components/chat_interface.py:456-461`
```python
# ì „ì²´ ëŒ€í™” outputs í´ë”ì— ì €ì¥
if exp_manager:
    from ui.components.chat_manager import get_current_messages
    messages = get_current_messages()
    if messages:
        exp_manager.save_conversation(messages)  # ë§¤ ë‹µë³€ë§ˆë‹¤ í˜¸ì¶œë¨
```

**íŒŒì¼ ìœ„ì¹˜**: `src/utils/experiment_manager.py:559-572`
```python
def save_conversation(self, conversation_data: list):
    """ì „ì²´ ëŒ€í™” ê¸°ë¡ ì €ì¥"""
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")  # ë§¤ë²ˆ ìƒˆ íƒ€ì„ìŠ¤íƒ¬í”„ ìƒì„±
    conv_file = self.outputs_dir / f"conversation_{timestamp}.json"  # ëª¨ë“œ ì •ë³´ ì—†ìŒ

    with open(conv_file, 'w', encoding='utf-8') as f:
        json.dump(conversation_data, f, ensure_ascii=False, indent=2)
```

**ê·¼ë³¸ ì›ì¸**:
1. `save_conversation` ë©”ì„œë“œê°€ ë§¤ ë‹µë³€ë§ˆë‹¤ í˜¸ì¶œë¨
2. ë§¤ë²ˆ ìƒˆë¡œìš´ íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ íŒŒì¼ ìƒì„± (ì´ì–´ì“°ê¸° ì•„ë‹˜)
3. íŒŒì¼ëª… í˜•ì‹ì— ëª¨ë“œ(easy/hard) ì •ë³´ ì—†ìŒ
4. ì¤‘ë³µ íŒŒì¼ë“¤ì´ ê³„ì† ìƒì„±ë˜ì–´ ë””ìŠ¤í¬ ê³µê°„ ë‚­ë¹„

#### ê¶Œì¥ í•´ê²° ë°©ì•ˆ
1. **íŒŒì¼ëª… í˜•ì‹ ê°œì„ **: `conversation_easy_ë‚ ì§œ_ì‹œê°„.json` ë˜ëŠ” `conversation_hard_ë‚ ì§œ_ì‹œê°„.json`
2. **ì €ì¥ ë¹ˆë„ ì¡°ì •**:
   - ì˜µì…˜ 1: ì„¸ì…˜ë‹¹ í•˜ë‚˜ì˜ íŒŒì¼ë§Œ ìƒì„±í•˜ê³  ì´ì–´ì“°ê¸°
   - ì˜µì…˜ 2: ì±„íŒ…ì´ ì „í™˜ë  ë•Œë§Œ ì €ì¥ (í˜„ì¬ ì±„íŒ… ê¸°ì¤€)
3. **ì¤‘ë³µ ì œê±°**: response.txt ì €ì¥ ë¡œì§ ì œê±°

### 3.3 metadata.json null ê°’ ë¬¸ì œ

#### ë¬¸ì œì 
```json
{
  "session_id": "010",
  "start_time": "2025-11-04T21:37:39.988735",
  "difficulty": null,                  // null
  "tool_used": "web_search",
  "user_query": "2025ë…„ ê¸°ì¤€ AI íŠ¸ë Œë“œ ê´€ë ¨ ìµœì‹  ì†Œì‹ ì•Œë ¤ì¤˜",
  "success": null,                     // null
  "response_time_ms": null,            // null
  "end_time": null                     // null
}
```

- `difficulty`, `success`, `response_time_ms`, `end_time` í•„ë“œê°€ ëª¨ë‘ null
- ì²« ë²ˆì§¸ ì§ˆë¬¸ì— ëŒ€í•œ ì •ë³´ë§Œ ê¸°ë¡ë¨

#### ì›ì¸ ë¶„ì„
**íŒŒì¼ ìœ„ì¹˜**: `src/utils/experiment_manager.py:68-77`
```python
# ë©”íƒ€ë°ì´í„° ì´ˆê¸°í™” (nullë¡œ ì„¤ì •)
self.metadata = {
    'session_id': f"{session_id:03d}",
    'start_time': datetime.now().isoformat(),
    'difficulty': None,                # ì´ˆê¸°í™” ì‹œ null
    'tool_used': None,
    'user_query': None,
    'success': None,                   # ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ
    'response_time_ms': None,          # ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ
    'end_time': None                   # ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ
}
```

**íŒŒì¼ ìœ„ì¹˜**: `ui/components/chat_interface.py:151, 216`
```python
# user_queryë§Œ ì—…ë°ì´íŠ¸
if exp_manager:
    exp_manager.update_metadata(user_query=prompt)

# tool_usedë§Œ ì—…ë°ì´íŠ¸
if exp_manager:
    exp_manager.update_metadata(tool_used=tool_choice)
```

**ê·¼ë³¸ ì›ì¸**:
1. metadata.json íŒŒì¼ì€ ì„¸ì…˜ ì „ì²´ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ì•„ì•¼ í•˜ëŠ”ë° ì²« ë²ˆì§¸ ì§ˆë¬¸ ì •ë³´ë§Œ ê¸°ë¡ë¨
2. `difficulty`, `success`, `response_time_ms` ì—…ë°ì´íŠ¸ ë¡œì§ ëˆ„ë½
3. `end_time`ì€ `experiment_manager.py:688`ì˜ `close()` ë©”ì„œë“œì—ì„œ ì—…ë°ì´íŠ¸ë˜ì§€ë§Œ ì„¸ì…˜ì´ ì¢…ë£Œë˜ì§€ ì•Šìœ¼ë©´ ê¸°ë¡ ì•ˆë¨

#### ë°ì´í„° ë¶ˆì¼ì¹˜
- `metadata.json`: `tool_used: "web_search"`
- `conversation_20251104_220400.json`: `tool_choice: "web_search"` (ì²« ë‹µë³€)
- ì‹¤ì œ ë¡œê·¸: web_searchë¡œ ë¼ìš°íŒ…ë˜ì—ˆì§€ë§Œ ì¼ë°˜ ë‹µë³€ì´ ìƒì„±ë¨

**ê·¼ë³¸ ë¬¸ì œ**: metadata.jsonì˜ ëª©ì ê³¼ í™œìš© ë°©ì•ˆì´ ë¶ˆëª…í™•

### 3.4 ë‹¤ì¤‘ ìš”ì²­ ì²˜ë¦¬ ë¬¸ì œ

#### ë¬¸ì œì 
ì‚¬ìš©ì ì§ˆë¬¸: "Transformer ë…¼ë¬¸ë“¤ì— ëŒ€í•´ ì •ë¦¬í•´ì„œ ì‰½ê²Œ ì„¤ëª…í•´ì¤˜"

**ë‹¤ì¤‘ ìš”ì²­ í¬í•¨**:
1. ë…¼ë¬¸ ê²€ìƒ‰ (search_paper)
2. ì •ë¦¬ ë° ìš”ì•½ (summarize)
3. ì‰¬ìš´ ì„¤ëª… (general)

**ì‹¤ì œ ì²˜ë¦¬ ê²°ê³¼**:
- ì„ íƒëœ ë„êµ¬: `general` (ì¼ë°˜ ë‹µë³€)
- ë…¼ë¬¸ ê²€ìƒ‰ì´ë‚˜ ìš”ì•½ ë„êµ¬ëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

#### ì›ì¸ ë¶„ì„
**íŒŒì¼ ìœ„ì¹˜**: `src/agent/nodes.py:30-74` (router_node í•¨ìˆ˜)
```python
def router_node(state: AgentState, exp_manager=None):
    """ë¼ìš°í„° ë…¸ë“œ: ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ë„êµ¬ ì„ íƒ"""
    question = state["question"]

    # LLM í˜¸ì¶œí•˜ì—¬ ë‹¨ì¼ ë„êµ¬ ì„ íƒ
    raw_response = llm_client.llm.invoke(routing_prompt).content.strip()
    tool_choice = raw_response.split()[0] if raw_response else "general"  # ë‹¨ì¼ ë„êµ¬ë§Œ ì„ íƒ

    state["tool_choice"] = tool_choice  # í•˜ë‚˜ì˜ ë„êµ¬ë§Œ ì €ì¥
    return state
```

**íŒŒì¼ ìœ„ì¹˜**: `src/agent/question_classifier.py:78-124` (classify ë©”ì„œë“œ)
```python
def classify(self, question: str, difficulty: str = "easy") -> str:
    """ì§ˆë¬¸ ìœ í˜• ë¶„ë¥˜ - ë‹¨ì¼ ìœ í˜•ë§Œ ë°˜í™˜"""
    # LLM í˜¸ì¶œ
    response = llm_client.llm.invoke(prompt).content.strip()
    question_type = response.split()[0].lower()  # ì²« ë²ˆì§¸ ë‹¨ì–´ë§Œ ì¶”ì¶œ
    return question_type  # ë‹¨ì¼ ìœ í˜•ë§Œ ë°˜í™˜
```

**ê·¼ë³¸ ì›ì¸**:
1. ë¼ìš°í„°ëŠ” **ë‹¨ì¼ ë„êµ¬ë§Œ ì„ íƒ**í•˜ë„ë¡ ì„¤ê³„ë¨
2. ë‹¤ì¤‘ ìš”ì²­ ê°ì§€ ë° ì²˜ë¦¬ ë¡œì§ì´ ì—†ìŒ
3. í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ë„ ë‹¨ì¼ ë„êµ¬ ì„ íƒì„ ìš”êµ¬í•¨

#### ê¶Œì¥ í•´ê²° ë°©ì•ˆ
1. **ë‹¤ì¤‘ ë„êµ¬ ì„ íƒ ì§€ì›**:
   ```python
   # ì˜ˆì‹œ
   tool_choices = ["search_paper", "summarize", "general"]
   tool_priority = [1, 2, 3]  # ìš°ì„ ìˆœìœ„
   ```

2. **ìˆœì°¨ ì‹¤í–‰ íŒŒì´í”„ë¼ì¸**:
   ```
   search_paper â†’ summarize â†’ general
   ```

3. **ì§ˆë¬¸ ë¶„í•´**:
   - "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜" â†’ search_paper
   - "ì°¾ì€ ë…¼ë¬¸ ìš”ì•½í•´ì¤˜" â†’ summarize
   - "ì‰½ê²Œ ì„¤ëª…í•´ì¤˜" â†’ general

### 3.5 ì „ë¬¸ê°€ ëª¨ë“œ ì„±ëŠ¥ í‰ê°€ ë° íŒŒì¼ ì €ì¥ ë¬¸ì œ

#### ë¬¸ì œì 
1. evaluation í´ë”ì— 11ê°œ íŒŒì¼ ëª¨ë‘ `"difficulty": "easy"`
2. hard ëª¨ë“œ evaluation íŒŒì¼ ì—†ìŒ
3. outputs í´ë”ì—ë„ hard ëª¨ë“œ conversation íŒŒì¼ ì—†ìŒ (íŒŒì¼ëª…ìœ¼ë¡œ êµ¬ë¶„ ë¶ˆê°€)

#### ì›ì¸ ë¶„ì„
**ê²€ì¦ëœ ì‚¬ì‹¤**:
- ëª¨ë“  evaluation íŒŒì¼ì— `"difficulty": "easy"` ê¸°ë¡ë¨
- ì‹¤í—˜ ì„¸ì…˜ 010ì€ ì´ˆë³´ì ëª¨ë“œì—ì„œë§Œ ì‹¤í–‰ë¨

**ì¶”ë¡ **:
1. ì‚¬ìš©ìê°€ ì „ë¬¸ê°€ ëª¨ë“œë¡œ ì±„íŒ…ì„ ìƒì„±í–ˆì§€ë§Œ
2. Streamlit UIì—ì„œ í˜ì´ì§€ ì „í™˜ ì‹œ ì„¸ì…˜ ìƒíƒœê°€ ì´ˆê¸°í™”ë¨
3. ì „ë¬¸ê°€ ëª¨ë“œ ì±„íŒ… ë‚´ìš©ì´ ì €ì¥ë˜ì§€ ì•ŠìŒ

**íŒŒì¼ ìœ„ì¹˜**: `ui/components/sidebar.py:159-166`
```python
# ìƒˆ ì±„íŒ… ë²„íŠ¼ í´ë¦­ ì‹œ
if st.button("â• ìƒˆ ì±„íŒ…", use_container_width=True, type="primary"):
    selected_difficulty = st.session_state.difficulty_selector
    create_new_chat(selected_difficulty)  # ìƒˆ ì±„íŒ… ìƒì„±

    if exp_manager:
        exp_manager.log_ui_interaction(f"ìƒˆ ì±„íŒ… ìƒì„±: ë‚œì´ë„={selected_difficulty}")

    st.rerun()  # í˜ì´ì§€ ë¦¬ë¡œë“œ
```

**ê·¼ë³¸ ë¬¸ì œ**: Streamlitì˜ ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬ ë° ì±„íŒ… ì „í™˜ ë¡œì§

### 3.6 ë©€í‹°í„´ ëŒ€í™” ê¸°ëŠ¥ ë¬¸ì œ

#### ë¬¸ì œì 
ì‚¬ìš©ì: "ì²«ë²ˆì§¸ë¡œ ë§í•œ ë…¼ë¬¸ì˜ ë‚´ìš©ì„ ìš”ì•½í•´ì„œ ì•Œë ¤ì¤˜"
â†’ LLMì´ ì´ì „ ëŒ€í™”ë¥¼ ì „í˜€ ì°¸ì¡°í•˜ì§€ ëª»í•¨

#### ì›ì¸ ë¶„ì„
**íŒŒì¼ ìœ„ì¹˜**: `ui/components/chat_interface.py:187-195`
```python
response = agent_executor.invoke(
    {
        "question": prompt,
        "difficulty": difficulty,
        "messages": []          # ë¹ˆ ë¦¬ìŠ¤íŠ¸ ì „ë‹¬
    },
    config={"callbacks": [st_callback]}
)
```

**ê·¼ë³¸ ì›ì¸**:
1. `messages` í•„ë“œì— ë¹ˆ ë¦¬ìŠ¤íŠ¸ ì „ë‹¬
2. ì´ì „ ëŒ€í™” íˆìŠ¤í† ë¦¬ë¥¼ ì „ë‹¬í•˜ì§€ ì•ŠìŒ
3. LLMì´ í˜„ì¬ ì§ˆë¬¸ë§Œ ë³´ê³  ë‹µë³€ ìƒì„±

#### ê¶Œì¥ í•´ê²° ë°©ì•ˆ
```python
# í˜„ì¬ ì±„íŒ…ì˜ ì´ì „ ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸°
from ui.components.chat_manager import get_current_messages
previous_messages = get_current_messages()

response = agent_executor.invoke(
    {
        "question": prompt,
        "difficulty": difficulty,
        "messages": previous_messages  # ì´ì „ ëŒ€í™” ì „ë‹¬
    },
    config={"callbacks": [st_callback]}
)
```

### 3.7 UI ìˆ«ì ì…ë ¥ ë™ê¸°í™” ë¬¸ì œ

#### ë¬¸ì œì 
- ìŠ¬ë¼ì´ë” ë“œë˜ê·¸ ê°’ê³¼ í…ìŠ¤íŠ¸ ë°•ìŠ¤ ì…ë ¥ ê°’ì´ ë‹¤ë¦„
- ë‘ ì…ë ¥ ë°©ì‹ì´ ì™„ì „íˆ ë™ê¸°í™”ë˜ì§€ ì•ŠìŒ

#### ì›ì¸ ë¶„ì„
**íŒŒì¼ ìœ„ì¹˜**: `ui/components/sidebar.py:182-237`
```python
# ìŠ¬ë¼ì´ë” ìœ„ì ¯
slider_range = st.slider(
    "ìŠ¬ë¼ì´ë”ë¡œ ë²”ìœ„ ì¡°ì •",
    value=(st.session_state.glossary_min_terms, st.session_state.glossary_max_terms),
    key="glossary_slider"
)

# í…ìŠ¤íŠ¸ ì…ë ¥ ìœ„ì ¯
min_input = st.number_input(
    "ìµœì†Œ ê°œìˆ˜",
    value=slider_range[0],  # ìŠ¬ë¼ì´ë” ê°’ ì°¸ì¡°
    key="glossary_min_input"
)

# ì–‘ë°©í–¥ ë™ê¸°í™” ë¡œì§
if slider_range != (st.session_state.glossary_min_terms, st.session_state.glossary_max_terms):
    st.session_state.glossary_min_terms = slider_range[0]
    st.session_state.glossary_max_terms = slider_range[1]

if min_input != st.session_state.glossary_min_terms or max_input != st.session_state.glossary_max_terms:
    if min_input <= max_input:
        st.session_state.glossary_min_terms = min_input
        st.session_state.glossary_max_terms = max_input
```

**ë¬¸ì œì **:
1. `number_input`ì˜ `value`ê°€ `slider_range`ë¥¼ ì§ì ‘ ì°¸ì¡°í•¨
2. `session_state` ì—…ë°ì´íŠ¸ í›„ì—ë„ ìœ„ì ¯ ê°’ì´ ì¦‰ì‹œ ë°˜ì˜ë˜ì§€ ì•ŠìŒ
3. Streamlitì˜ ìœ„ì ¯ ì—…ë°ì´íŠ¸ ìˆœì„œ ë¬¸ì œ

#### ê¶Œì¥ í•´ê²° ë°©ì•ˆ
```python
# session_stateë¥¼ ë‹¨ì¼ ì†ŒìŠ¤ë¡œ ì‚¬ìš©
slider_range = st.slider(
    "ìŠ¬ë¼ì´ë”ë¡œ ë²”ìœ„ ì¡°ì •",
    value=(st.session_state.glossary_min_terms, st.session_state.glossary_max_terms),
    key="glossary_slider"
)

# ìŠ¬ë¼ì´ë” ë³€ê²½ ì‹œ session_state ì—…ë°ì´íŠ¸
st.session_state.glossary_min_terms = slider_range[0]
st.session_state.glossary_max_terms = slider_range[1]

# í…ìŠ¤íŠ¸ ì…ë ¥ë„ session_state ì°¸ì¡°
min_input = st.number_input(
    "ìµœì†Œ ê°œìˆ˜",
    value=st.session_state.glossary_min_terms,  # session_state ì§ì ‘ ì°¸ì¡°
    key="glossary_min_input"
)
```

### 3.8 ë³µì‚¬ ë²„íŠ¼ ê¸°ëŠ¥ ë¬¸ì œ

#### ë¬¸ì œì 
Streamlit UIì—ì„œ "ë³µì‚¬" ë²„íŠ¼ í´ë¦­ ì‹œ ë™ì‘í•˜ì§€ ì•ŠìŒ

#### ì›ì¸ ë¶„ì„
**íŒŒì¼ ìœ„ì¹˜**: `ui/components/chat_interface.py:257-303`
```python
# HTML + JavaScript ê¸°ë°˜ ë³µì‚¬ ë²„íŠ¼
copy_button_html = f"""
<button id="copy_btn_{unique_id}" onclick="copyToClipboard_{unique_id}()">ğŸ“‹ ë³µì‚¬</button>

<script>
function copyToClipboard_{unique_id}() {{
    const text = {safe_answer};
    navigator.clipboard.writeText(text).then(function() {{
        button.textContent = 'âœ… ë³µì‚¬ë¨!';
    }}, function(err) {{
        alert('âŒ ë³µì‚¬ ì‹¤íŒ¨: ' + err);
    }});
}}
</script>
"""
st.markdown(copy_button_html, unsafe_allow_html=True)
```

**ê°€ëŠ¥í•œ ì›ì¸ë“¤**:
1. **Streamlit ë³´ì•ˆ ì •ì±…**: Streamlitì€ ê¸°ë³¸ì ìœ¼ë¡œ JavaScript ì‹¤í–‰ì„ ì œí•œí•¨
2. **navigator.clipboard API ì œí•œ**: HTTPSê°€ ì•„ë‹Œ í™˜ê²½ì—ì„œëŠ” clipboard API ì ‘ê·¼ ë¶ˆê°€
3. **iframe ìƒŒë“œë°•ìŠ¤**: Streamlit ì»´í¬ë„ŒíŠ¸ê°€ iframe ë‚´ì—ì„œ ì‹¤í–‰ë  ê²½ìš° í´ë¦½ë³´ë“œ ì ‘ê·¼ ì œí•œ
4. **JavaScript ë¡œë“œ ìˆœì„œ**: ë²„íŠ¼ì´ ë Œë”ë§ë˜ê¸° ì „ì— ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë  ìˆ˜ ìˆìŒ

#### ê¶Œì¥ í•´ê²° ë°©ì•ˆ
1. **Streamlit ê³µì‹ ë°©ì‹ ì‚¬ìš©**:
   ```python
   # pyperclip ë˜ëŠ” streamlit-copy-button ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©
   import streamlit_copy_button

   streamlit_copy_button.copy_button(
       text=answer,
       button_text="ğŸ“‹ ë³µì‚¬"
   )
   ```

2. **HTTP â†’ HTTPS ì „í™˜**: ë¡œì»¬ ê°œë°œ ì‹œ HTTPS ì‚¬ìš©

3. **ëŒ€ì•ˆ ë°©ë²•**: ì‚¬ìš©ìê°€ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ê³  Ctrl+Cë¡œ ë³µì‚¬í•˜ë„ë¡ ì•ˆë‚´

---

## 4. ì½”ë“œ ë¶„ì„ ê²°ê³¼

### 4.1 íŒŒì¼ ì €ì¥ ë¡œì§

#### ExperimentManager (src/utils/experiment_manager.py)

**ì£¼ìš” ë©”ì„œë“œ**:
1. `save_output(filename, content)`: outputs í´ë”ì— íŒŒì¼ ì €ì¥
2. `save_conversation(conversation_data)`: ëŒ€í™” ê¸°ë¡ ì €ì¥ (íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ íŒŒì¼ëª…)
3. `save_evaluation_result(evaluation_data)`: í‰ê°€ ê²°ê³¼ ì €ì¥ (íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ íŒŒì¼ëª…)
4. `update_metadata(**kwargs)`: metadata.json ì—…ë°ì´íŠ¸

**ë¬¸ì œì **:
- `save_conversation`ì´ ë§¤ë²ˆ ìƒˆ íŒŒì¼ ìƒì„± (ì´ì–´ì“°ê¸° ë¶ˆê°€)
- íŒŒì¼ëª…ì— ëª¨ë“œ ì •ë³´ ì—†ìŒ
- metadata.json ì—…ë°ì´íŠ¸ ë¡œì§ ë¶ˆì™„ì „

### 4.2 ë¼ìš°í„° ë¡œì§

#### router_node (src/agent/nodes.py:30-74)

**ë™ì‘ ë°©ì‹**:
1. ì‚¬ìš©ì ì§ˆë¬¸ì„ routing_promptì— ì‚½ì…
2. LLM í˜¸ì¶œí•˜ì—¬ ë„êµ¬ ì„ íƒ
3. ì²« ë²ˆì§¸ ë‹¨ì–´ë§Œ ì¶”ì¶œí•˜ì—¬ tool_choiceë¡œ ì €ì¥

**í•œê³„**:
- ë‹¨ì¼ ë„êµ¬ë§Œ ì„ íƒ ê°€ëŠ¥
- ë‹¤ì¤‘ ìš”ì²­ ì²˜ë¦¬ ë¶ˆê°€
- ë„êµ¬ ìš°ì„ ìˆœìœ„ ê³ ë ¤ ì•ˆí•¨

#### question_classifier (src/agent/question_classifier.py)

**ì§ˆë¬¸ ìœ í˜•**:
1. term_definition
2. paper_search
3. latest_research
4. paper_summary
5. statistics
6. file_save
7. general_question

**í•œê³„**:
- ë‹¨ì¼ ìœ í˜•ë§Œ ë¶„ë¥˜
- ë³µí•© ì§ˆë¬¸ ì²˜ë¦¬ ë¶ˆê°€

### 4.3 Fallback Chain ë©”ì»¤ë‹ˆì¦˜

#### fallback_router_node (src/agent/nodes.py:120-200)

**ë™ì‘ ë°©ì‹**:
1. ë„êµ¬ ì‹¤í–‰ ì‹¤íŒ¨ ê°ì§€
2. fallback_chainì—ì„œ ë‹¤ìŒ ë„êµ¬ ì„ íƒ
3. ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ í™•ì¸
4. ëª¨ë“  ë„êµ¬ ì‹¤íŒ¨ ì‹œ generalë¡œ ì „í™˜

**íŠ¹ì§•**:
- ë„êµ¬ ì‹¤íŒ¨ ì‹œ ìë™ ì „í™˜ ì§€ì›
- ì‹¤íŒ¨ ì´ìœ  ê¸°ë¡
- íƒ€ì„ë¼ì¸ ê¸°ë¡

**ë¬¸ì œì **:
- ë‹¤ì¤‘ ìš”ì²­ ì²˜ë¦¬ì—ëŠ” ì ìš©ë˜ì§€ ì•ŠìŒ (ë‹¨ì¼ ë„êµ¬ ì²´ì¸ë§Œ ì§€ì›)

### 4.4 UI ì±„íŒ… ê´€ë¦¬

#### chat_interface.py

**ì£¼ìš” ê¸°ëŠ¥**:
1. `display_chat_history()`: ì €ì¥ëœ ë©”ì‹œì§€ í‘œì‹œ
2. `add_user_message()`: ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
3. `handle_agent_response()`: Agent ì‹¤í–‰ ë° ì‘ë‹µ ì²˜ë¦¬
4. `render_chat_input()`: ì±„íŒ… ì…ë ¥ UI

**ì‹¤í–‰ íë¦„**:
```
ì‚¬ìš©ì ì…ë ¥
  â†’ add_user_message() [user ë©”ì‹œì§€ ì¶”ê°€]
  â†’ handle_agent_response() [Agent ì‹¤í–‰]
    â†’ agent_executor.invoke() [messages=[] ì „ë‹¬]  â† ë¬¸ì œ: ë¹ˆ ë¦¬ìŠ¤íŠ¸
    â†’ ë‹µë³€ í‘œì‹œ
    â†’ save_output("response.txt", answer)  â† ë¬¸ì œ: ë§¤ë²ˆ ë®ì–´ì“°ê¸°
    â†’ save_conversation(messages)  â† ë¬¸ì œ: ë§¤ë²ˆ ìƒˆ íŒŒì¼ ìƒì„±
```

---

## 5. ê°œì„  ê¶Œì¥ì‚¬í•­

### 5.1 ì¦‰ì‹œ ìˆ˜ì • í•„ìš” (Critical)

#### 1. response.txt ì¤‘ë³µ ì €ì¥ ì œê±°
**íŒŒì¼**: `ui/components/chat_interface.py:322`
```python
# ì‚­ì œ ë˜ëŠ” ì£¼ì„ ì²˜ë¦¬
# if exp_manager:
#     exp_manager.save_output("response.txt", answer)
```

#### 2. conversation íŒŒì¼ëª…ì— ëª¨ë“œ ì¶”ê°€
**íŒŒì¼**: `src/utils/experiment_manager.py:559-572`
```python
def save_conversation(self, conversation_data: list, difficulty: str = "easy"):
    """ì „ì²´ ëŒ€í™” ê¸°ë¡ ì €ì¥"""
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    conv_file = self.outputs_dir / f"conversation_{difficulty}_{timestamp}.json"  # ëª¨ë“œ ì¶”ê°€

    with open(conv_file, 'w', encoding='utf-8') as f:
        json.dump(conversation_data, f, ensure_ascii=False, indent=2)
```

#### 3. metadata.json ì—…ë°ì´íŠ¸ ë¡œì§ ë³´ì™„
**íŒŒì¼**: `ui/components/chat_interface.py:155-164`
```python
def handle_agent_response(agent_executor, prompt: str, difficulty: str, exp_manager=None):
    # ì‹œì‘ ì‹œê°„ ê¸°ë¡
    start_time = datetime.now()

    # difficulty ì—…ë°ì´íŠ¸
    if exp_manager:
        exp_manager.update_metadata(difficulty=difficulty)

    try:
        # Agent ì‹¤í–‰
        response = agent_executor.invoke(...)

        # ì¢…ë£Œ ì‹œê°„ ë° ì‘ë‹µ ì‹œê°„ ê³„ì‚°
        end_time = datetime.now()
        response_time_ms = int((end_time - start_time).total_seconds() * 1000)

        # ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸
        if exp_manager:
            exp_manager.update_metadata(
                success=True,
                response_time_ms=response_time_ms
            )
    except Exception as e:
        if exp_manager:
            exp_manager.update_metadata(success=False)
```

#### 4. ë©€í‹°í„´ ëŒ€í™” ì§€ì›
**íŒŒì¼**: `ui/components/chat_interface.py:187-195`
```python
# ì´ì „ ëŒ€í™” ê°€ì ¸ì˜¤ê¸°
from ui.components.chat_manager import get_current_messages
previous_messages = get_current_messages()

response = agent_executor.invoke(
    {
        "question": prompt,
        "difficulty": difficulty,
        "messages": previous_messages  # ì´ì „ ëŒ€í™” ì „ë‹¬
    },
    config={"callbacks": [st_callback]}
)
```

### 5.2 ì¤‘ìš” ê°œì„ ì‚¬í•­ (High Priority)

#### 1. conversation íŒŒì¼ ì €ì¥ ë¹ˆë„ ì¡°ì •
**ì˜µì…˜ A**: ì„¸ì…˜ë‹¹ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ì´ì–´ì“°ê¸°
```python
def save_conversation(self, conversation_data: list, difficulty: str = "easy"):
    """ì „ì²´ ëŒ€í™” ê¸°ë¡ ì €ì¥ (ì´ì–´ì“°ê¸°)"""
    # ì„¸ì…˜ ì‹œì‘ ì‹œ íŒŒì¼ëª… ê³ ì •
    if not hasattr(self, 'conversation_file'):
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        self.conversation_file = self.outputs_dir / f"conversation_{difficulty}_{timestamp}.json"

    # ê¸°ì¡´ ë‚´ìš© ì½ê¸° (ìˆë‹¤ë©´)
    if self.conversation_file.exists():
        with open(self.conversation_file, 'r', encoding='utf-8') as f:
            existing_data = json.load(f)
    else:
        existing_data = []

    # ìƒˆ ë‚´ìš© ì¶”ê°€
    existing_data.extend(conversation_data)

    # ì €ì¥
    with open(self.conversation_file, 'w', encoding='utf-8') as f:
        json.dump(existing_data, f, ensure_ascii=False, indent=2)
```

**ì˜µì…˜ B**: ì±„íŒ… ì „í™˜ ì‹œì—ë§Œ ì €ì¥
```python
# chat_manager.pyì˜ switch_chat() ë˜ëŠ” create_new_chat()ì—ì„œ í˜¸ì¶œ
def switch_chat(chat_id):
    # í˜„ì¬ ì±„íŒ… ì €ì¥
    if exp_manager:
        messages = get_current_messages()
        exp_manager.save_conversation(messages, difficulty=get_current_difficulty())

    # ì±„íŒ… ì „í™˜
    st.session_state.current_chat_id = chat_id
```

#### 2. ë‹¤ì¤‘ ìš”ì²­ ì²˜ë¦¬ ì§€ì›
**ì˜µì…˜ A**: ë‹¤ì¤‘ ë„êµ¬ ì„ íƒ ë° ìˆœì°¨ ì‹¤í–‰
```python
def router_node(state: AgentState, exp_manager=None):
    """ë¼ìš°í„° ë…¸ë“œ: ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ë„êµ¬ë“¤ ì„ íƒ"""
    question = state["question"]

    # ë‹¤ì¤‘ ë„êµ¬ ì„ íƒ í”„ë¡¬í”„íŠ¸
    routing_prompt = """ë‹¤ìŒ ì§ˆë¬¸ì— í•„ìš”í•œ ë„êµ¬ë“¤ì„ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•˜ì„¸ìš”.

    ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬:
    - search_paper: ë…¼ë¬¸ ê²€ìƒ‰
    - summarize: ë…¼ë¬¸ ìš”ì•½
    - glossary: ìš©ì–´ ì„¤ëª…
    - web_search: ì›¹ ê²€ìƒ‰
    - general: ì¼ë°˜ ë‹µë³€

    ì§ˆë¬¸: {question}

    ë‹µë³€ í˜•ì‹: tool1, tool2, tool3
    """

    # LLM í˜¸ì¶œ
    raw_response = llm_client.llm.invoke(routing_prompt).content.strip()

    # ë„êµ¬ ëª©ë¡ íŒŒì‹±
    tool_choices = [t.strip() for t in raw_response.split(',')]

    # ìƒíƒœ ì—…ë°ì´íŠ¸
    state["tool_pipeline"] = tool_choices  # ë„êµ¬ íŒŒì´í”„ë¼ì¸
    state["tool_choice"] = tool_choices[0]  # ì²« ë²ˆì§¸ ë„êµ¬ë¶€í„° ì‹¤í–‰

    return state
```

**ì˜µì…˜ B**: ì§ˆë¬¸ ë¶„í•´ ë° ìˆœì°¨ ì²˜ë¦¬
```python
def decompose_question(question: str) -> list:
    """ë³µí•© ì§ˆë¬¸ì„ ë‹¨ìˆœ ì§ˆë¬¸ë“¤ë¡œ ë¶„í•´"""
    prompt = """ë‹¤ìŒ ë³µí•© ì§ˆë¬¸ì„ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•  ë‹¨ìˆœ ì§ˆë¬¸ë“¤ë¡œ ë¶„í•´í•˜ì„¸ìš”.

    ì§ˆë¬¸: {question}

    ë‹µë³€ í˜•ì‹:
    1. ì²« ë²ˆì§¸ ë‹¨ê³„ ì§ˆë¬¸
    2. ë‘ ë²ˆì§¸ ë‹¨ê³„ ì§ˆë¬¸
    3. ì„¸ ë²ˆì§¸ ë‹¨ê³„ ì§ˆë¬¸
    """

    # LLM í˜¸ì¶œí•˜ì—¬ ì§ˆë¬¸ ë¶„í•´
    # ...

    return sub_questions
```

#### 3. summary.md íŒŒì¼ ìœ„ì¹˜ ë³€ê²½
**íŒŒì¼**: `src/tools/summarize.py` (ì°¾ì•„ì„œ ìˆ˜ì • í•„ìš”)
```python
def save_summary(title: str, content: str, exp_manager):
    """ë…¼ë¬¸ ìš”ì•½ ì €ì¥"""
    # summary í´ë” ìƒì„±
    summary_dir = exp_manager.outputs_dir / "summary"
    summary_dir.mkdir(exist_ok=True)

    # ë…¼ë¬¸ ì œëª©ì„ íŒŒì¼ëª…ìœ¼ë¡œ ì‚¬ìš© (íŠ¹ìˆ˜ë¬¸ì ì œê±°)
    safe_title = "".join(c for c in title if c.isalnum() or c in (' ', '-', '_')).strip()
    filename = f"{safe_title}.md"

    # ì €ì¥
    summary_file = summary_dir / filename
    with open(summary_file, 'w', encoding='utf-8') as f:
        f.write(content)
```

### 5.3 ì¥ê¸° ê°œì„ ì‚¬í•­ (Medium Priority)

#### 1. metadata.json ì¬ì„¤ê³„
**í˜„ì¬ ë¬¸ì œ**:
- ì²« ë²ˆì§¸ ì§ˆë¬¸ ì •ë³´ë§Œ ì €ì¥
- ì„¸ì…˜ ì „ì²´ ì •ë³´ ë¯¸í¡

**ê°œì„  ë°©ì•ˆ**:
```json
{
  "session_id": "010",
  "start_time": "2025-11-04T21:37:39",
  "end_time": "2025-11-04T22:10:00",
  "total_questions": 10,
  "mode_summary": {
    "easy": 10,
    "hard": 0
  },
  "tool_usage": {
    "general": 3,
    "search_paper": 2,
    "web_search": 1,
    "glossary": 1,
    "summarize": 1,
    "save_file": 2
  },
  "average_response_time_ms": 2500,
  "success_rate": 0.9,
  "questions": [
    {
      "question_id": 1,
      "user_query": "...",
      "tool_used": "web_search",
      "difficulty": "easy",
      "success": true,
      "response_time_ms": 3000,
      "timestamp": "2025-11-04T21:40:00"
    },
    // ...
  ]
}
```

#### 2. conversation íŒŒì¼ í†µí•©
ê° ëŒ€í™”ë§ˆë‹¤ ë³„ë„ íŒŒì¼ ëŒ€ì‹  conversation íŒŒì¼ ë‚´ì— ì§ˆë¬¸ë³„ ì •ë³´ í¬í•¨:
```json
[
  {
    "question_id": 1,
    "timestamp": "2025-11-04T21:40:00",
    "role": "user",
    "content": "2025ë…„ ê¸°ì¤€ AI íŠ¸ë Œë“œ ê´€ë ¨ ìµœì‹  ì†Œì‹ ì•Œë ¤ì¤˜"
  },
  {
    "question_id": 1,
    "timestamp": "2025-11-04T21:42:00",
    "role": "assistant",
    "content": "...",
    "tool_choice": "web_search",
    "difficulty": "easy",
    "response_time_ms": 2000,
    "sources": null
  },
  // ...
]
```

#### 3. ë³µì‚¬ ë²„íŠ¼ ê°œì„ 
```python
# streamlit-copy-to-clipboard íŒ¨í‚¤ì§€ ì‚¬ìš©
from streamlit_copy_to_clipboard import copy_to_clipboard

copy_to_clipboard(
    text=answer,
    button_text="ğŸ“‹ ë³µì‚¬",
    success_text="âœ… ë³µì‚¬ë¨!"
)
```

ë˜ëŠ” Streamlit ê³µì‹ ë°©ë²•:
```python
# ì‚¬ìš©ìê°€ ì§ì ‘ ë³µì‚¬í•  ìˆ˜ ìˆë„ë¡ ì½”ë“œ ë¸”ë¡ ì œê³µ
with st.expander("ğŸ“‹ ë‹µë³€ ë³µì‚¬í•˜ê¸°"):
    st.code(answer, language=None)
    st.caption("ìœ„ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ê³  Ctrl+C (ë˜ëŠ” Cmd+C)ë¡œ ë³µì‚¬í•˜ì„¸ìš”")
```

### 5.4 ê¸°íƒ€ ê°œì„ ì‚¬í•­ (Low Priority)

#### 1. sources í•„ë“œ í™œìš©
í˜„ì¬ ëª¨ë“  conversation íŒŒì¼ì—ì„œ `"sources": null`ì¸ë°, ì´ë¥¼ í™œìš©í•˜ì—¬ ì¶œì²˜ ì •ë³´ ì €ì¥:
```json
{
  "role": "assistant",
  "content": "...",
  "tool_choice": "search_paper",
  "sources": [
    {
      "title": "Attention is All You Need",
      "authors": "Vaswani et al.",
      "year": 2017,
      "arxiv_id": "1706.03762"
    }
  ]
}
```

#### 2. ìš©ì–´ ì¶”ì¶œ ì„¤ì • ë™ê¸°í™” ì™„ì „ ê°œì„ 
```python
# callback í•¨ìˆ˜ ì‚¬ìš©
def on_slider_change():
    st.session_state.glossary_min_terms = st.session_state.glossary_slider[0]
    st.session_state.glossary_max_terms = st.session_state.glossary_slider[1]

def on_input_change():
    min_val = st.session_state.glossary_min_input
    max_val = st.session_state.glossary_max_input
    if min_val <= max_val:
        st.session_state.glossary_slider = (min_val, max_val)

slider_range = st.slider(
    ...,
    on_change=on_slider_change,
    key="glossary_slider"
)

min_input = st.number_input(
    ...,
    on_change=on_input_change,
    key="glossary_min_input"
)
```

---

## ë¶€ë¡: íŒŒì¼ë³„ ì£¼ìš” ì½”ë“œ ìœ„ì¹˜

### A. íŒŒì¼ ì €ì¥ ê´€ë ¨
- `src/utils/experiment_manager.py:437-456` - save_output()
- `src/utils/experiment_manager.py:559-572` - save_conversation()
- `src/tools/save_file.py:16-73` - save_file_node()
- `ui/components/chat_interface.py:322` - response.txt ì €ì¥
- `ui/components/chat_interface.py:456-461` - conversation ì €ì¥

### B. ë¼ìš°í„° ë° ë„êµ¬ ì„ íƒ
- `src/agent/nodes.py:30-74` - router_node()
- `src/agent/nodes.py:120-200` - fallback_router_node()
- `src/agent/question_classifier.py:78-132` - classify()

### C. UI ê´€ë ¨
- `ui/components/chat_interface.py:32-129` - display_chat_history()
- `ui/components/chat_interface.py:155-494` - handle_agent_response()
- `ui/components/sidebar.py:74-381` - render_sidebar()
- `ui/components/sidebar.py:182-237` - ìš©ì–´ ì¶”ì¶œ ì„¤ì •

### D. ë©”íƒ€ë°ì´í„°
- `src/utils/experiment_manager.py:68-77` - ë©”íƒ€ë°ì´í„° ì´ˆê¸°í™”
- `src/utils/experiment_manager.py:618-630` - update_metadata()
- `src/utils/experiment_manager.py:688` - close() (end_time ì—…ë°ì´íŠ¸)
- `ui/components/chat_interface.py:151` - user_query ì—…ë°ì´íŠ¸
- `ui/components/chat_interface.py:216` - tool_used ì—…ë°ì´íŠ¸

### E. í‰ê°€
- `ui/components/chat_interface.py:356-421` - ë‹µë³€ í’ˆì§ˆ í‰ê°€
- `src/utils/experiment_manager.py:540-556` - save_evaluation_result()

---

**ì‘ì„±ì¼**: 2025-11-04
**ë¶„ì„ì**: Claude Code
**ë²„ì „**: 1.0
