# ë‹´ë‹¹ì—­í• : ë°•ì¬í™ - ë…¼ë¬¸ ë°ì´í„° ìˆ˜ì§‘ ë° DB êµ¬ì¶•

## ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì**: ìµœí˜„í™”[íŒ€ì¥]

## ë‹´ë‹¹ì ì •ë³´
- **ì´ë¦„**: ë°•ì¬í™
- **ì—­í• **: ë°ì´í„° ì¸í”„ë¼ êµ¬ì¶• ë‹´ë‹¹
- **ì°¸ì—¬ ê¸°ê°„**: ë‹¨ê¸° ì°¸ì—¬ (4ì¼)
- **í•µì‹¬ ì—­í• **: ë…¼ë¬¸ ë°ì´í„° ìˆ˜ì§‘, Langchain Document ì²˜ë¦¬, DB ì ì¬

---

## ë‹´ë‹¹ ëª¨ë“ˆ ë° ì‘ì—…

### 1. ë°ì´í„° ìˆ˜ì§‘ (`scripts/`)
- arXiv APIë¡œ ë…¼ë¬¸ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸
- Semantic Scholar API ì—°ë™ (ì„ íƒ)
- ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘

### 2. Langchain ë¬¸ì„œ ì²˜ë¦¬ (`src/data/`)
- Langchain Document Loader êµ¬í˜„ (PyPDFLoader)
- Langchain Text Splitter êµ¬í˜„ (RecursiveCharacterTextSplitter)
- PDF â†’ Langchain Document ë³€í™˜

### 3. ì„ë² ë”© ë° Vector DB ì ì¬ (`src/data/embeddings.py`)
- OpenAI Embeddingsë¥¼ ì‚¬ìš©í•œ ì„ë² ë”© ìƒì„±
- Langchain PGVector (PostgreSQL + pgvector) ì—°ë™ ë° ë¬¸ì„œ ì ì¬
- ìš©ì–´ì§‘ ë°ì´í„° ì„ë² ë”© ë° ì €ì¥
- ë°°ì¹˜ ì²˜ë¦¬ ìµœì í™”

### 4. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸° ì„¤ì •
- PostgreSQL ìŠ¤í‚¤ë§ˆ ìƒì„± (papers, glossary í…Œì´ë¸”)
- pgvector extension ì„¤ì¹˜ ë° ì´ˆê¸°í™”
- ë²¡í„° ì»¬ë ‰ì…˜ ìƒì„±
- í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¡œë“œ

---

## ë°ì´í„° ìˆ˜ì§‘ íŒŒì´í”„ë¼ì¸ ë‹¤ì´ì–´ê·¸ë¨

### 1. ë…¼ë¬¸ ë°ì´í„° ìˆ˜ì§‘ íŒŒì´í”„ë¼ì¸

```mermaid
graph TB
    subgraph Collection["ğŸ”¸ ìˆ˜ì§‘"]
        direction LR
        A[arXiv API] --> B[ë…¼ë¬¸ ê²€ìƒ‰<br/>í‚¤ì›Œë“œë³„]
        B --> C[ë©”íƒ€ë°ì´í„°<br/>ì¶”ì¶œ]
        C --> D[PDF<br/>ë‹¤ìš´ë¡œë“œ]
    end

    subgraph Processing["ğŸ”¹ ì²˜ë¦¬"]
        direction LR
        E[PyPDFLoader] --> F[Text<br/>Splitting]
        F --> G[Chunks<br/>ìƒì„±]
    end

    subgraph Storage["ğŸ”º ì €ì¥"]
        direction LR
        H[ì„ë² ë”©<br/>ìƒì„±] --> I1[PostgreSQL<br/>ë©”íƒ€ë°ì´í„°]
        H --> I2[pgvector<br/>ë²¡í„°]
        I1 --> J[âœ… ì™„ë£Œ]
        I2 --> J
    end

    Collection --> Processing
    Processing --> Storage

    style Collection fill:#e1f5ff,stroke:#01579b,stroke-width:2px,color:#000
    style Processing fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
    style Storage fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ìˆ˜ì§‘ - íŒŒë‘ ê³„ì—´)
    style A fill:#90caf9,stroke:#1976d2,color:#000
    style B fill:#81d4fa,stroke:#0288d1,color:#000
    style C fill:#64b5f6,stroke:#1976d2,color:#000
    style D fill:#42a5f5,stroke:#1565c0,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì²˜ë¦¬ - ë³´ë¼ ê³„ì—´)
    style E fill:#ce93d8,stroke:#7b1fa2,color:#000
    style F fill:#ba68c8,stroke:#7b1fa2,color:#fff
    style G fill:#ab47bc,stroke:#4a148c,color:#fff

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì €ì¥ - ë…¹ìƒ‰ ê³„ì—´)
    style H fill:#a5d6a7,stroke:#388e3c,color:#000
    style I1 fill:#81c784,stroke:#2e7d32,color:#000
    style I2 fill:#81c784,stroke:#2e7d32,color:#000
    style J fill:#66bb6a,stroke:#2e7d32,color:#fff
```

### 2. ë¬¸ì„œ ì²˜ë¦¬ íë¦„

```mermaid
sequenceDiagram
    autonumber
    participant Collector as Collector
    participant arXiv as arXiv API
    participant Loader as PyPDFLoader
    participant Splitter as TextSplitter
    participant Embed as Embeddings
    participant VDB as Vector DB
    participant PG as PostgreSQL

    Collector->>arXiv: í‚¤ì›Œë“œ ê²€ìƒ‰<br/>(Transformer, BERT...)
    arXiv-->>Collector: ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ë¦¬ìŠ¤íŠ¸

    loop ê° ë…¼ë¬¸
        Collector->>arXiv: PDF ë‹¤ìš´ë¡œë“œ
        arXiv-->>Collector: PDF íŒŒì¼

        Collector->>Loader: load_pdf(path)
        Loader-->>Collector: Document ë¦¬ìŠ¤íŠ¸

        Collector->>Splitter: split_documents(docs)
        Splitter-->>Collector: ì²­í¬ ë¦¬ìŠ¤íŠ¸

        Collector->>Embed: embed_documents(chunks)
        Embed-->>Collector: ì„ë² ë”© ë²¡í„°

        Collector->>PG: INSERT ë©”íƒ€ë°ì´í„°
        PG-->>Collector: paper_id

        Collector->>VDB: add_documents(chunks)
        VDB-->>Collector: âœ… ì €ì¥ ì™„ë£Œ
    end

    style Collector fill:#90caf9,stroke:#1976d2,color:#000
    style arXiv fill:#ba68c8,stroke:#7b1fa2,color:#000
    style Loader fill:#ce93d8,stroke:#7b1fa2,color:#000
    style Splitter fill:#ab47bc,stroke:#4a148c,color:#000
    style Embed fill:#ffcc80,stroke:#f57c00,color:#000
    style VDB fill:#a5d6a7,stroke:#388e3c,color:#000
    style PG fill:#81c784,stroke:#2e7d32,color:#000
```

---

## í•µì‹¬ ì‘ì—…: ë…¼ë¬¸ ë°ì´í„° ìˆ˜ì§‘

### ëª©í‘œ
**ìµœì†Œ 50-100í¸ ë…¼ë¬¸ ë°ì´í„°**ë¥¼ Langchain íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ Vector DB ì €ì¥ ì™„ë£Œ

### 1. arXiv APIë¡œ ë…¼ë¬¸ ìˆ˜ì§‘

**íŒŒì¼ ê²½ë¡œ**: `scripts/collect_arxiv_papers.py`

**êµ¬í˜„ ë°©ë²•**:
1. `ArxivPaperCollector` í´ë˜ìŠ¤ ì •ì˜
   - ì´ˆê¸°í™” ì‹œ ì €ì¥ ë””ë ‰í† ë¦¬ ì„¤ì • (ê¸°ë³¸ê°’: "data/raw/pdfs")
   - ë””ë ‰í† ë¦¬ ìë™ ìƒì„±

2. `collect_papers` ë©”ì„œë“œ êµ¬í˜„
   - arxiv.Search ê°ì²´ ìƒì„± (query, max_results, sort_by ì„¤ì •)
   - ê²€ìƒ‰ ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ë©° ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘
   - ê° ë…¼ë¬¸ì˜ title, authors, published_date, summary, pdf_url, entry_id, categories, primary_category ì¶”ì¶œ
   - PDF ë‹¤ìš´ë¡œë“œ (arxiv_id ê¸°ë°˜ íŒŒì¼ëª…)
   - ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ ë…¼ë¬¸ ê±´ë„ˆë›°ê¸°
   - ìˆ˜ì§‘í•œ ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

3. `collect_by_keywords` ë©”ì„œë“œ êµ¬í˜„
   - ì—¬ëŸ¬ í‚¤ì›Œë“œë¡œ ë°˜ë³µ ìˆ˜ì§‘
   - ê° í‚¤ì›Œë“œë‹¹ ì§€ì •ëœ ìˆ˜ë§Œí¼ ë…¼ë¬¸ ìˆ˜ì§‘
   - ì „ì²´ ë…¼ë¬¸ ë¦¬ìŠ¤íŠ¸ í†µí•©
   - ì¤‘ë³µ ì œê±° (ì œëª© ê¸°ì¤€)
   - ìµœì¢… ìˆ˜ì§‘ ê²°ê³¼ ë°˜í™˜

4. `remove_duplicates` ë©”ì„œë“œ êµ¬í˜„
   - ì œëª©ì„ ì†Œë¬¸ìë¡œ ì •ê·œí™”í•˜ì—¬ ì¤‘ë³µ í™•ì¸
   - ì¤‘ë³µë˜ì§€ ì•Šì€ ë…¼ë¬¸ë§Œ ìœ ì§€

5. ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
   - AI/ML ê´€ë ¨ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ ì •ì˜
   - í‚¤ì›Œë“œë‹¹ 15í¸ì”© ìˆ˜ì§‘ (ì´ ~100í¸)
   - ë©”íƒ€ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ì €ì¥

**íŒŒì¼:** `scripts/collect_arxiv_papers.py`

**í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬:**
- `arxiv`
- `os`
- `json`
- `src.utils.experiment_manager.ExperimentManager`

**í´ë˜ìŠ¤: ArxivPaperCollector**

**__init__ ë©”ì„œë“œ:**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|---------|------|--------|------|
| save_dir | str | "data/raw/pdfs" | PDF íŒŒì¼ ì €ì¥ ë””ë ‰í† ë¦¬ |
| exp_manager | ExperimentManager | None | ì‹¤í—˜ ê´€ë¦¬ì ì¸ìŠ¤í„´ìŠ¤ |

**ì´ˆê¸°í™” ë™ì‘:**
- save_dir ì„¤ì •
- exp_manager ì €ì¥
- os.makedirs()ë¡œ ë””ë ‰í† ë¦¬ ìƒì„±

**ë©”ì„œë“œ: collect_papers**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|---------|------|--------|------|
| query | str | (í•„ìˆ˜) | ê²€ìƒ‰ ì¿¼ë¦¬ |
| max_results | int | 50 | ìµœëŒ€ ìˆ˜ì§‘ ë…¼ë¬¸ ìˆ˜ |

**ì²˜ë¦¬ íë¦„:**

| ë‹¨ê³„ | ë™ì‘ |
|------|------|
| 1 | arxiv.Search ê°ì²´ ìƒì„± (sort_by=SubmittedDate) |
| 2 | ê²€ìƒ‰ ê²°ê³¼ ìˆœíšŒí•˜ë©° ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘ (title, authors, published_date, summary, pdf_url, entry_id, categories, primary_category) |
| 3 | entry_idì—ì„œ arxiv_id ì¶”ì¶œ |
| 4 | result.download_pdf()ë¡œ PDF ë‹¤ìš´ë¡œë“œ |
| 5 | exp_manager.loggerë¡œ ë‹¤ìš´ë¡œë“œ ë¡œê·¸ ê¸°ë¡ |
| 6 | ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ ë…¼ë¬¸ ê±´ë„ˆë›°ê¸° |
| 7 | papers_data ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ |

**ë©”ì„œë“œ: collect_by_keywords**

- ì—¬ëŸ¬ í‚¤ì›Œë“œë¡œ ë°˜ë³µ ìˆ˜ì§‘
- ê° í‚¤ì›Œë“œë‹¹ per_keywordë§Œí¼ ë…¼ë¬¸ ìˆ˜ì§‘
- remove_duplicates()ë¡œ ì¤‘ë³µ ì œê±° í›„ ë°˜í™˜

**ë©”ì„œë“œ: remove_duplicates**

- ì œëª©ì„ ì†Œë¬¸ìë¡œ ì •ê·œí™”í•˜ì—¬ ì¤‘ë³µ í™•ì¸
- ì¤‘ë³µë˜ì§€ ì•Šì€ ë…¼ë¬¸ë§Œ ë°˜í™˜

**ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸:**

1. ExperimentManager()ë¡œ with ë¬¸ ì´ˆê¸°í™”
2. ArxivPaperCollector ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
3. AI/ML ê´€ë ¨ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ ì •ì˜ (7ê°œ)
4. í‚¤ì›Œë“œë‹¹ 15í¸ì”© ìˆ˜ì§‘
5. ë©”íƒ€ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ì €ì¥

---

## Langchain Document Loader êµ¬í˜„

### 2. PDF â†’ Langchain Document ë³€í™˜

**íŒŒì¼ ê²½ë¡œ**: `src/data/document_loader.py`

**êµ¬í˜„ ë°©ë²•**:
1. `PaperDocumentLoader` í´ë˜ìŠ¤ ì •ì˜
   - RecursiveCharacterTextSplitter ì´ˆê¸°í™”
   - chunk_size: 1000 (ì²­í¬ í¬ê¸°)
   - chunk_overlap: 200 (ì²­í¬ ê°„ ì¤‘ë³µ, ë§¥ë½ ìœ ì§€)
   - separators: ["\n\n", "\n", ". ", " ", ""] (ë¶„í•  ìš°ì„ ìˆœìœ„)

2. `load_pdf` ë©”ì„œë“œ êµ¬í˜„
   - PyPDFLoaderë¡œ PDF íŒŒì¼ ë¡œë“œ
   - ì¶”ê°€ ë©”íƒ€ë°ì´í„°ê°€ ìˆìœ¼ë©´ ê° ë¬¸ì„œì— ì—…ë°ì´íŠ¸
   - Langchain Document ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

3. `load_and_split` ë©”ì„œë“œ êµ¬í˜„
   - PDF íŒŒì¼ì„ ë¡œë“œí•˜ê³  ì²­í¬ë¡œ ë¶„í• 
   - load_pdf()ë¡œ PDF ë¡œë“œ
   - text_splitter.split_documents()ë¡œ ì²­í¬ ë¶„í• 
   - ê° ì²­í¬ì— chunk_id ë©”íƒ€ë°ì´í„° ì¶”ê°€
   - ë¶„í• ëœ Document ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

4. `load_all_pdfs` ë©”ì„œë“œ êµ¬í˜„
   - JSON ë©”íƒ€ë°ì´í„° íŒŒì¼ ë¡œë“œ
   - arXiv IDë¡œ ë©”íƒ€ë°ì´í„° ë§¤í•‘ ë”•ì…”ë„ˆë¦¬ ìƒì„±
   - ë””ë ‰í† ë¦¬ì˜ ëª¨ë“  PDF íŒŒì¼ ìˆœíšŒ
   - ê° PDFì— ëŒ€í•´ ë©”íƒ€ë°ì´í„° ì¡°íšŒ ë° ë¡œë“œ
   - load_and_split()ìœ¼ë¡œ ì²­í¬ ë¶„í• 
   - ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ íŒŒì¼ ê±´ë„ˆë›°ê¸°
   - ëª¨ë“  ì²­í¬ë¥¼ í†µí•©í•˜ì—¬ ë°˜í™˜

**íŒŒì¼:** `src/data/document_loader.py`

**í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬:**
- `langchain.document_loaders.PyPDFLoader`
- `langchain.text_splitter.RecursiveCharacterTextSplitter`
- `os`
- `json`

**í´ë˜ìŠ¤: PaperDocumentLoader**

**__init__ ë©”ì„œë“œ:**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|---------|------|--------|------|
| exp_manager | ExperimentManager | None | ì‹¤í—˜ ê´€ë¦¬ì ì¸ìŠ¤í„´ìŠ¤ |

**ì´ˆê¸°í™” ë™ì‘:**
- exp_manager ì €ì¥
- RecursiveCharacterTextSplitter ì´ˆê¸°í™” (chunk_size=1000, chunk_overlap=200, separators=["\n\n", "\n", ". ", " ", ""])

**ë©”ì„œë“œ: load_pdf**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ì„¤ëª… |
|---------|------|------|
| pdf_path | str | PDF íŒŒì¼ ê²½ë¡œ |
| metadata | dict | ì¶”ê°€ ë©”íƒ€ë°ì´í„° |

**ë™ì‘:**
- PyPDFLoaderë¡œ PDF ë¡œë“œ
- metadata ìˆìœ¼ë©´ ê° ë¬¸ì„œì— ì—…ë°ì´íŠ¸
- Document ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

**ë©”ì„œë“œ: load_and_split**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ì„¤ëª… |
|---------|------|------|
| pdf_path | str | PDF íŒŒì¼ ê²½ë¡œ |
| metadata | dict | ì¶”ê°€ ë©”íƒ€ë°ì´í„° |

**ì²˜ë¦¬ íë¦„:**

| ë‹¨ê³„ | ë™ì‘ |
|------|------|
| 1 | load_pdf()ë¡œ PDF ë¡œë“œ |
| 2 | text_splitter.split_documents()ë¡œ ì²­í¬ ë¶„í•  |
| 3 | ê° ì²­í¬ì— chunk_id ë©”íƒ€ë°ì´í„° ì¶”ê°€ (enumerate) |
| 4 | ë¶„í• ëœ Document ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ |

**ë©”ì„œë“œ: load_all_pdfs**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ì„¤ëª… |
|---------|------|------|
| pdf_dir | str | PDF íŒŒì¼ ë””ë ‰í† ë¦¬ |
| metadata_json_path | str | ë©”íƒ€ë°ì´í„° JSON íŒŒì¼ ê²½ë¡œ |

**ì²˜ë¦¬ íë¦„:**

| ë‹¨ê³„ | ë™ì‘ |
|------|------|
| 1 | JSON ë©”íƒ€ë°ì´í„° íŒŒì¼ ë¡œë“œ |
| 2 | arXiv IDë¡œ ë©”íƒ€ë°ì´í„° ë§¤í•‘ ë”•ì…”ë„ˆë¦¬ ìƒì„± |
| 3 | pdf_dirì˜ ëª¨ë“  PDF íŒŒì¼ ìˆœíšŒ |
| 4 | ê° PDFì˜ arxiv_idë¡œ ë©”íƒ€ë°ì´í„° ì¡°íšŒ |
| 5 | load_and_split()ë¡œ ì²­í¬ ë¶„í•  |
| 6 | exp_manager.loggerë¡œ ì²˜ë¦¬ ë¡œê·¸ ê¸°ë¡ |
| 7 | ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ íŒŒì¼ ê±´ë„ˆë›°ê¸° |
| 8 | ëª¨ë“  ì²­í¬ë¥¼ í†µí•©í•˜ì—¬ ë°˜í™˜ |

**ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸:**

1. ExperimentManager()ë¡œ with ë¬¸ ì´ˆê¸°í™”
2. PaperDocumentLoader ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
3. load_all_pdfs()ë¡œ ëª¨ë“  PDF ë¡œë“œ ë° ë¶„í• 
4. ì´ ì²­í¬ ê°œìˆ˜ ë¡œê·¸ ê¸°ë¡

---

## ì„ë² ë”© ë° Vector DB ì ì¬

### 3. OpenAI Embeddings ìƒì„± ë° pgvector ì €ì¥

**íŒŒì¼ ê²½ë¡œ**: `src/data/embeddings.py`

**êµ¬í˜„ ë°©ë²•**:
1. `PaperEmbeddingManager` í´ë˜ìŠ¤ ì •ì˜
   - OpenAI Embeddings ì´ˆê¸°í™” (ëª¨ë¸: text-embedding-3-small)
   - API í‚¤ë¥¼ í™˜ê²½ë³€ìˆ˜ì—ì„œ ë¡œë“œ
   - PostgreSQL + pgvector VectorStore ì´ˆê¸°í™”
   - ì»¬ë ‰ì…˜ëª…: "paper_chunks"
   - PostgreSQL ì—°ê²° ë¬¸ìì—´ ì„¤ì •

2. `add_documents` ë©”ì„œë“œ êµ¬í˜„
   - Document ë¦¬ìŠ¤íŠ¸ë¥¼ ë°°ì¹˜ë¡œ ë‚˜ëˆ„ì–´ ì²˜ë¦¬
   - OpenAI API ì†ë„ ì œí•œ ëŒ€ì‘ì„ ìœ„í•œ ë°°ì¹˜ ì²˜ë¦¬
   - ê° ë°°ì¹˜ë¥¼ vectorstore.add_documents()ë¡œ ì €ì¥
   - ì§„í–‰ ìƒí™© ì¶œë ¥
   - ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ ë°°ì¹˜ ê±´ë„ˆë›°ê¸°

3. `add_documents_with_paper_id` ë©”ì„œë“œ êµ¬í˜„
   - ê° ë¬¸ì„œì˜ URLì—ì„œ arXiv ID ì¶”ì¶œ
   - paper_id_mappingì—ì„œ PostgreSQL paper_id ì¡°íšŒ
   - ë¬¸ì„œ ë©”íƒ€ë°ì´í„°ì— paper_id ì¶”ê°€
   - add_documents()ë¡œ Vector DBì— ì €ì¥

4. ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
   - PaperDocumentLoaderë¡œ PDF ë¡œë“œ ë° ë¶„í• 
   - PaperEmbeddingManagerë¡œ ì„ë² ë”© ë° Vector DB ì €ì¥
   - ë°°ì¹˜ í¬ê¸°: 50

### í´ë˜ìŠ¤ ì„¤ëª…

**í´ë˜ìŠ¤ëª…**: `PaperEmbeddingManager`

**ì—­í• **: ë…¼ë¬¸ ì„ë² ë”© ìƒì„± ë° PostgreSQL + pgvector Vector DB ì €ì¥

**í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬**:
- `langchain_openai.OpenAIEmbeddings`
- `langchain_postgres.vectorstores.PGVector`
- `os`

**`__init__` íŒŒë¼ë¯¸í„°**:

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ì„¤ëª… | ê¸°ë³¸ê°’ |
|---------|------|------|--------|
| exp_manager | ExperimentManager | ì‹¤í—˜ ê´€ë¦¬ ì¸ìŠ¤í„´ìŠ¤ (ë¡œê¹…ìš©) | None |

**ì´ˆê¸°í™” ë™ì‘**:
1. OpenAI Embeddings ì´ˆê¸°í™”
   - ëª¨ë¸: `text-embedding-3-small`
   - API í‚¤: í™˜ê²½ë³€ìˆ˜ `OPENAI_API_KEY`ì—ì„œ ë¡œë“œ
2. PostgreSQL + pgvector VectorStore ì´ˆê¸°í™”
   - ì»¬ë ‰ì…˜ëª…: `paper_chunks`
   - ì—°ê²° ë¬¸ìì—´: í™˜ê²½ë³€ìˆ˜ `DATABASE_URL` (ê¸°ë³¸ê°’: `postgresql://user:password@localhost:5432/papers`)

---

#### ë©”ì„œë“œ 1: `add_documents`

**ì—­í• **: Document ë¦¬ìŠ¤íŠ¸ë¥¼ ë°°ì¹˜ë¡œ ë‚˜ëˆ„ì–´ Vector DBì— ì €ì¥

**íŒŒë¼ë¯¸í„°**:

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ì„¤ëª… | ê¸°ë³¸ê°’ |
|---------|------|------|--------|
| documents | List[Document] | Langchain Document ë¦¬ìŠ¤íŠ¸ | - |
| batch_size | int | ë°°ì¹˜ í¬ê¸° (OpenAI API ì†ë„ ì œí•œ ëŒ€ì‘) | 50 |

**ë°˜í™˜ê°’**: `int` - ì €ì¥ëœ ë¬¸ì„œ ìˆ˜

**ì²˜ë¦¬ íë¦„**:

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|-----|------|------|
| 1 | ë¬¸ì„œ ê°œìˆ˜ ê³„ì‚° | ì „ì²´ ë¬¸ì„œ ê°œìˆ˜ í™•ì¸ |
| 2 | ë°°ì¹˜ ë¶„í•  | batch_size ë‹¨ìœ„ë¡œ ë¬¸ì„œ ë¦¬ìŠ¤íŠ¸ ë¶„í•  |
| 3 | ê° ë°°ì¹˜ ì²˜ë¦¬ | vectorstore.add_documents()ë¡œ ì €ì¥ |
| 4 | ë¡œê·¸ ê¸°ë¡ | ë°°ì¹˜ë³„ ì €ì¥ ì§„í–‰ ìƒí™© ë¡œê¹… (ExperimentManager ì‚¬ìš© ì‹œ) |
| 5 | ì˜¤ë¥˜ ì²˜ë¦¬ | ë°°ì¹˜ ì €ì¥ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ ê¸°ë¡ í›„ ë‹¤ìŒ ë°°ì¹˜ë¡œ ì§„í–‰ |
| 6 | ê²°ê³¼ ë°˜í™˜ | ì´ ì €ì¥ëœ ë¬¸ì„œ ìˆ˜ ë°˜í™˜ |

---

#### ë©”ì„œë“œ 2: `add_documents_with_paper_id`

**ì—­í• **: ê° ë¬¸ì„œì˜ URLì—ì„œ arXiv IDë¥¼ ì¶”ì¶œí•˜ì—¬ paper_id ì¶”ê°€ í›„ ì €ì¥

**íŒŒë¼ë¯¸í„°**:

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ì„¤ëª… |
|---------|------|------|
| documents | List[Document] | Langchain Document ë¦¬ìŠ¤íŠ¸ |
| paper_id_mapping | Dict[str, int] | arXiv ID â†’ paper_id ë§¤í•‘ ë”•ì…”ë„ˆë¦¬ |

**ë°˜í™˜ê°’**: `int` - ì €ì¥ëœ ë¬¸ì„œ ìˆ˜

**ì²˜ë¦¬ íë¦„**:

| ë‹¨ê³„ | ì‘ì—… | ì„¤ëª… |
|-----|------|------|
| 1 | ê° ë¬¸ì„œ ìˆœíšŒ | documents ë¦¬ìŠ¤íŠ¸ ë°˜ë³µ ì²˜ë¦¬ |
| 2 | PDF URL ì¶”ì¶œ | metadataì—ì„œ 'pdf_url' ê°€ì ¸ì˜¤ê¸° |
| 3 | arXiv ID ì¶”ì¶œ | URLì—ì„œ arXiv ID íŒŒì‹± (ì˜ˆ: "2301.12345") |
| 4 | paper_id ì¡°íšŒ | paper_id_mapping ë”•ì…”ë„ˆë¦¬ì—ì„œ paper_id ê²€ìƒ‰ |
| 5 | ë©”íƒ€ë°ì´í„° ì¶”ê°€ | ë¬¸ì„œ metadataì— 'paper_id' í•„ë“œ ì¶”ê°€ |
| 6 | Vector DB ì €ì¥ | add_documents() ë©”ì„œë“œ í˜¸ì¶œí•˜ì—¬ ì €ì¥ |

---

### ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ë‹¨ê³„

**ì‹¤í–‰ ìˆœì„œ**:

1. ExperimentManager ì´ˆê¸°í™” (with ë¬¸)
2. PaperDocumentLoaderë¡œ PDF ë¡œë“œ ë° ë¶„í• 
   - PDF ê²½ë¡œ: `data/raw/pdfs`
   - ë©”íƒ€ë°ì´í„° ê²½ë¡œ: `data/raw/arxiv_papers_metadata.json`
3. ì²­í¬ ìƒì„± ì™„ë£Œ ë¡œê·¸ ê¸°ë¡
4. paper_id_mapping JSON íŒŒì¼ ë¡œë“œ
   - ê²½ë¡œ: `data/processed/paper_id_mapping.json`
5. PaperEmbeddingManager ì´ˆê¸°í™”
6. add_documents_with_paper_id()ë¡œ ì„ë² ë”© ìƒì„± ë° Vector DB ì €ì¥
7. ì €ì¥ ì™„ë£Œ ë¡œê·¸ ê¸°ë¡

---

## PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

### 4. ìŠ¤í‚¤ë§ˆ ìƒì„± ë° ë©”íƒ€ë°ì´í„° ì €ì¥

**íŒŒì¼ ê²½ë¡œ**: `scripts/setup_database.py`

**êµ¬í˜„ ë°©ë²•**:
1. `create_tables` í•¨ìˆ˜ êµ¬í˜„
   - PostgreSQL ì—°ê²° ë° ì»¤ì„œ ìƒì„±
   - papers í…Œì´ë¸” ìƒì„± (paper_id, title, authors, publish_date, source, url, category, citation_count, abstract, created_at)
   - glossary í…Œì´ë¸” ìƒì„± (term_id, term, definition, easy_explanation, hard_explanation, category, difficulty_level, related_terms, examples, created_at)
   - ì¸ë±ìŠ¤ ìƒì„± (papersì˜ title, category, date ë° glossaryì˜ term)
   - ì»¤ë°‹ ë° ì™„ë£Œ ë©”ì‹œì§€ ì¶œë ¥

2. `insert_paper_metadata` í•¨ìˆ˜ êµ¬í˜„
   - JSON ë©”íƒ€ë°ì´í„° ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒ
   - ê° ë…¼ë¬¸ ë°ì´í„°ë¥¼ papers í…Œì´ë¸”ì— INSERT
   - ON CONFLICT (url) DO NOTHINGìœ¼ë¡œ ì¤‘ë³µ ë°©ì§€
   - RETURNING paper_idë¡œ ì‚½ì…ëœ ID ì¡°íšŒ
   - arxiv_idì™€ paper_id ë§¤í•‘ ë”•ì…”ë„ˆë¦¬ ìƒì„±
   - ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ ë…¼ë¬¸ ê±´ë„ˆë›°ê¸°
   - ë§¤í•‘ ë”•ì…”ë„ˆë¦¬ ë°˜í™˜

3. `insert_glossary_data` í•¨ìˆ˜ êµ¬í˜„
   - ìš©ì–´ì§‘ ì´ˆê¸° ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ì •ì˜ (Attention Mechanism, Fine-tuning, BLEU Score ë“±)
   - ê° ìš©ì–´ ë°ì´í„°ë¥¼ glossary í…Œì´ë¸”ì— INSERT
   - ON CONFLICT (term) DO NOTHINGìœ¼ë¡œ ì¤‘ë³µ ë°©ì§€
   - ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ ìš©ì–´ ê±´ë„ˆë›°ê¸°

4. ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
   - PostgreSQL ì—°ê²°
   - create_tables()ë¡œ í…Œì´ë¸” ë° ì¸ë±ìŠ¤ ìƒì„±
   - JSON íŒŒì¼ì—ì„œ ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ë¡œë“œ
   - insert_paper_metadata()ë¡œ ë…¼ë¬¸ ë°ì´í„° ì‚½ì…
   - insert_glossary_data()ë¡œ ìš©ì–´ì§‘ ë°ì´í„° ì‚½ì…
   - paper_id_mappingì„ JSON íŒŒì¼ë¡œ ì €ì¥

---

## ì¸ìˆ˜ì¸ê³„ ë¬¸ì„œ

### ì™„ë£Œ í•­ëª© ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] arXivì—ì„œ ìµœì†Œ 50í¸ ë…¼ë¬¸ ìˆ˜ì§‘
- [ ] PDF â†’ Langchain Document ë³€í™˜ ì™„ë£Œ
- [ ] PostgreSQL ìŠ¤í‚¤ë§ˆ ìƒì„± (papers, glossary)
- [ ] PostgreSQL + pgvector ì»¬ë ‰ì…˜ ìƒì„± (paper_chunks, glossary_embeddings)
- [ ] ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° PostgreSQL ì €ì¥
- [ ] ë…¼ë¬¸ ì„ë² ë”© pgvector ì €ì¥
- [ ] ìš©ì–´ì§‘ ì´ˆê¸° ë°ì´í„° ì‚½ì…
- [ ] paper_id_mapping.json ìƒì„±

### ì¸ìˆ˜ì¸ê³„ ë‚´ìš©

#### 1. ë°ì´í„° ìœ„ì¹˜
- **PDF íŒŒì¼**: `data/raw/pdfs/`
- **ë©”íƒ€ë°ì´í„°**: `data/raw/arxiv_papers_metadata.json`
- **paper_id ë§¤í•‘**: `data/processed/paper_id_mapping.json`
- **Vector DB**: PostgreSQL + pgvector (connection: `postgresql://user:password@localhost:5432/papers`)

#### 2. ì¶”ê°€ ë°ì´í„° ìˆ˜ì§‘ ë°©ë²•
```bash
# ì¶”ê°€ ë…¼ë¬¸ ìˆ˜ì§‘
python scripts/collect_arxiv_papers.py --query "ìƒˆë¡œìš´ í‚¤ì›Œë“œ" --max-results 50

# ì„ë² ë”© ë° DB ì €ì¥
python src/data/embeddings.py
```

#### 3. DB ì—°ê²° ì •ë³´
- PostgreSQL + pgvector: `postgresql://user:password@localhost:5432/papers`
  - ë…¼ë¬¸ ë©”íƒ€ë°ì´í„°: `papers` í…Œì´ë¸”
  - ìš©ì–´ì§‘: `glossary` í…Œì´ë¸”
  - ë²¡í„° ì„ë² ë”©: pgvector extension ì‚¬ìš©

#### 4. ì£¼ì˜ì‚¬í•­
- OpenAI API í‚¤ í™˜ê²½ë³€ìˆ˜ ì„¤ì • í•„ìˆ˜: `OPENAI_API_KEY`
- ì„ë² ë”© ìƒì„± ì‹œ ë°°ì¹˜ í¬ê¸° ì¡°ì ˆ (API ì†ë„ ì œí•œ)
- PDF ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ë¡œì§ í•„ìš”

---

## ë¡œê¹… ë° ì‹¤í—˜ ì¶”ì  ê´€ë¦¬

### ExperimentManager ì‚¬ìš©

**ì¤‘ìš”**: ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘ ì„¸ì…˜ì€ ExperimentManager í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

**íŒŒì¼ ê²½ë¡œ**: `src/utils/experiment_manager.py`

**ì‚¬ìš© ë°©ë²•**:
1. ExperimentManager ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (with ë¬¸ ì‚¬ìš©)
   - Session ID ìë™ ë¶€ì—¬ ë° í´ë” êµ¬ì¡° ìë™ ìƒì„±
   ```python
   from src.utils.experiment_manager import ExperimentManager

   # ExperimentManager ì´ˆê¸°í™” (with ë¬¸)
   with ExperimentManager() as exp:
       # ìë™ìœ¼ë¡œ ë‹¤ìŒ ì‘ì—… ìˆ˜í–‰:
       # 1. experiments/20251031/20251031_103015_session_001/ ìƒì„±
       # 2. Session ID ìë™ ë¶€ì—¬ (session_001, 002...)
       # 3. chatbot.log íŒŒì¼ ìƒì„±
       # 4. 7ê°œ ì„œë¸Œ í´ë” ìƒì„± (tools/, database/, prompts/, ui/, outputs/, evaluation/, debug/)
       # 5. metadata.json ì´ˆê¸°í™”
       # 6. Logger ì´ˆê¸°í™”

       # ë°ì´í„° ìˆ˜ì§‘ ë¡œê·¸ ì‘ì„±
       exp.logger.write("ë…¼ë¬¸ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘")

       # ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ë¡œê·¸
       exp.db_logger.write("PostgreSQL ì—°ê²° ì™„ë£Œ")

       # ì‹¤í—˜ ì¢…ë£Œ (ìë™ìœ¼ë¡œ logger.close() í˜¸ì¶œ)
   ```

2. ì„¸ì…˜ í´ë” êµ¬ì¡°
   ```
   experiments/
   â””â”€â”€ 20251031/
       â”œâ”€â”€ 20251031_103015_session_001/
       â”‚   â”œâ”€â”€ chatbot.log          # ë°ì´í„° ìˆ˜ì§‘ ë¡œê·¸
       â”‚   â”œâ”€â”€ metadata.json        # ì„¸ì…˜ ë©”íƒ€ë°ì´í„°
       â”‚   â”œâ”€â”€ tools/               # ë„êµ¬ ì‹¤í–‰ ë¡œê·¸
       â”‚   â”œâ”€â”€ database/            # DB ì¿¼ë¦¬ ë¡œê·¸
       â”‚   â”‚   â””â”€â”€ database.log
       â”‚   â”œâ”€â”€ prompts/             # í”„ë¡¬í”„íŠ¸ ì €ì¥
       â”‚   â”œâ”€â”€ ui/                  # UI ìŠ¤í¬ë¦°ìƒ·
       â”‚   â”œâ”€â”€ outputs/             # ìµœì¢… ê²°ê³¼ë¬¼ ì €ì¥
       â”‚   â”œâ”€â”€ evaluation/          # í‰ê°€ ì§€í‘œ
       â”‚   â””â”€â”€ debug/               # ë””ë²„ê·¸ ë¡œê·¸
       â””â”€â”€ 20251031_103520_session_002/
           â””â”€â”€ ...
   ```

3. Logger vs DB Logger
   - `exp.logger`: ë°ì´í„° ìˆ˜ì§‘ ì‹¤í–‰ ë¡œê·¸ (`chatbot.log`)
   - `exp.db_logger`: ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ë¡œê·¸ (`database/database.log`)

4. ì¶”ê°€ ê¸°ëŠ¥
   - ìˆ˜ì§‘ ë©”íƒ€ë°ì´í„° ì €ì¥: `exp.save_output(papers_data, "collected_papers")`
   - ì²˜ë¦¬ ê²°ê³¼ ì €ì¥: `exp.save_output(chunks_data, "document_chunks")`

### ì‹¤í—˜ í´ë” êµ¬ì¡°

ìƒì„¸ ë‚´ìš©ì€ [ì‹¤í—˜_í´ë”_êµ¬ì¡°.md](../rules/ì‹¤í—˜_í´ë”_êµ¬ì¡°.md) ì°¸ì¡°

---

## Feature ë¸Œëœì¹˜

**1ë‹¨ê³„: ë°ì´í„° ì¸í”„ë¼ êµ¬ì¶• (ë°•ì¬í™)**
- `1-1. feature/data-collection` - arXiv ë°ì´í„° ìˆ˜ì§‘
- `1-2. feature/document-processing` - Document Loader/Splitter
- `1-3. feature/database-setup` - PostgreSQL + pgvector ì„¤ì •

---

## ì°¸ê³  PRD ë¬¸ì„œ

ê°œë°œ ì‹œ ë°˜ë“œì‹œ ì°¸ê³ í•´ì•¼ í•  PRD ë¬¸ì„œ ëª©ë¡:

### í•„ìˆ˜ ì°¸ê³  ë¬¸ì„œ
1. [01_í”„ë¡œì íŠ¸_ê°œìš”.md](../PRD/01_í”„ë¡œì íŠ¸_ê°œìš”.md) - í”„ë¡œì íŠ¸ ì „ì²´ ê°œìš”
2. [02_í”„ë¡œì íŠ¸_êµ¬ì¡°.md](../PRD/02_í”„ë¡œì íŠ¸_êµ¬ì¡°.md) - í´ë” êµ¬ì¡° (data/, scripts/)
3. [05_ë¡œê¹…_ì‹œìŠ¤í…œ.md](../PRD/05_ë¡œê¹…_ì‹œìŠ¤í…œ.md) â­ - Logger ì‚¬ìš©ë²•
4. [06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md](../PRD/06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md) â­ - ExperimentManager ë° Session í´ë” êµ¬ì¡°
5. [10_ê¸°ìˆ _ìš”êµ¬ì‚¬í•­.md](../PRD/10_ê¸°ìˆ _ìš”êµ¬ì‚¬í•­.md) - arXiv API, PyPDFLoader, OpenAI Embeddings
6. [11_ë°ì´í„°ë² ì´ìŠ¤_ì„¤ê³„.md](../PRD/11_ë°ì´í„°ë² ì´ìŠ¤_ì„¤ê³„.md) - papers í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ
7. [13_RAG_ì‹œìŠ¤í…œ_ì„¤ê³„.md](../PRD/13_RAG_ì‹œìŠ¤í…œ_ì„¤ê³„.md) - Document ì²˜ë¦¬ ë° Text Splitting

### ì°¸ê³  ë¬¸ì„œ
- [03_ë¸Œëœì¹˜_ì „ëµ.md](../PRD/03_ë¸Œëœì¹˜_ì „ëµ.md) - Feature ë¸Œëœì¹˜
- [04_ì¼ì •_ê´€ë¦¬.md](../PRD/04_ì¼ì •_ê´€ë¦¬.md) - ê°œë°œ ì¼ì •
- [ë‹´ë‹¹ì—­í• _01-1_ìµœí˜„í™”_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md](ë‹´ë‹¹ì—­í• _01-1_ìµœí˜„í™”_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md) - ExperimentManager í´ë˜ìŠ¤ ìƒì„¸ êµ¬í˜„
- [ë‹´ë‹¹ì—­í• _01-2_ìµœí˜„í™”_ë¡œê¹…_ëª¨ë‹ˆí„°ë§.md](ë‹´ë‹¹ì—­í• _01-2_ìµœí˜„í™”_ë¡œê¹…_ëª¨ë‹ˆí„°ë§.md) - ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ
- [ì‹¤í—˜_í´ë”_êµ¬ì¡°.md](../rules/ì‹¤í—˜_í´ë”_êµ¬ì¡°.md) - ì‹¤í—˜ í´ë” êµ¬ì¡° ìµœì¢…ì•ˆ

---

## ì°¸ê³  ìë£Œ

- arXiv API: https://info.arxiv.org/help/api/index.html
- Langchain Document Loaders: https://python.langchain.com/docs/integrations/document_loaders/
- Langchain Text Splitters: https://python.langchain.com/docs/modules/data_connection/document_transformers/
- Langchain Embeddings: https://python.langchain.com/docs/integrations/text_embedding/
- pgvector ë¬¸ì„œ: https://github.com/pgvector/pgvector

