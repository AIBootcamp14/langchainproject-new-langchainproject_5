# 시나리오: 파일 저장 (Save File)

## 📋 도구 설명

**도구명**: `save_file`
**목적**: AI Agent의 답변을 파일로 저장하여 오프라인 활용

### 주요 기능
- 답변 내용 텍스트 파일로 저장
- 다운로드 버튼 제공
- 파일명 자동 생성 (타임스탬프 포함)
- 메타데이터 포함 옵션

---

## 🎯 사용 시나리오

### 시나리오 1: 답변 저장 요청

**사용자 상황**: 챗봇의 답변을 나중에 다시 보고 싶음

**사용자 질문**:
```
"Transformer 설명을 파일로 저장해줘"
```

**Agent 동작**:
1. Router가 "저장" 키워드 감지
2. `save_file` 도구 선택
3. 이전 답변 또는 새로운 답변 생성
4. 파일 저장 및 다운로드 버튼 제공

**UI 표시**:
```
🗣️ 사용된 도구: 💾 파일 저장

[답변 내용]

---

✅ 파일이 준비되었습니다!
💡 아래 버튼을 클릭하여 파일을 다운로드하세요.

[⬇️ 파일 다운로드]
```

**저장된 파일** (`paper_response_20241103_103045.txt`):
```
# 논문 리뷰 챗봇 답변
생성 일시: 2024-11-03 10:30:45
난이도: easy
질문: Transformer 설명을 파일로 저장해줘

---

Transformer는 2017년 Google이 발표한 혁신적인 딥러닝 아키텍처입니다.

핵심 특징:
1. 어텐션 메커니즘: 입력의 중요한 부분에 집중
2. 병렬 처리: RNN과 달리 순차 처리가 필요 없어 빠름
3. 장거리 의존성: 멀리 떨어진 단어 간의 관계도 잘 파악

...
```

---

### 시나리오 2: 논문 요약 저장

**사용자 질문**:
```
"BERT 논문 요약을 마크다운 파일로 저장해줘"
```

**Agent 동작**:
1. `summarize` 도구로 논문 요약 생성
2. `save_file` 도구로 마크다운 형식 저장
3. 다운로드 버튼 제공

**저장된 파일** (`bert_summary_20241103.md`):
```markdown
# BERT 논문 요약

**저자**: Jacob Devlin et al.
**연도**: 2018
**학회**: NAACL

## 연구 목적
Pre-training of Deep Bidirectional Transformers for Language Understanding

## 주요 기술
### 1. Masked Language Model (MLM)
- 입력 토큰의 15%를 랜덤 마스킹
- 양방향 컨텍스트 활용

### 2. Next Sentence Prediction (NSP)
- 두 문장의 연속성 예측
- QA, NLI 작업에 유용

...

## 실험 결과
- GLUE: 80.5% → 83.9%
- SQuAD v1.1: 93.2% EM
- MNLI: 86.7% accuracy
```

---

### 시나리오 3: 용어집 export

**사용자 질문**:
```
"오늘 추가된 용어들을 파일로 정리해줘"
```

**Agent 동작**:
1. glossary 테이블에서 오늘 추가된 용어 검색
2. 용어 리스트 포맷팅
3. `save_file` 도구로 저장

**저장된 파일** (`glossary_20241103.txt`):
```
# AI/ML 용어집
추출 날짜: 2024-11-03

## 1. Attention Mechanism
카테고리: Deep Learning
정의: 신경망이 입력 데이터의 중요한 부분에 집중할 수 있게 하는 기법

## 2. Fine-tuning
카테고리: Transfer Learning
정의: 사전 학습된 모델을 특정 작업에 맞게 추가로 학습시키는 기법

## 3. BLEU Score
카테고리: Metric
정의: 기계 번역의 품질을 평가하는 지표
```

---

## 📊 파일 형식 옵션

### 텍스트 파일 (.txt)
```
일반 텍스트 형식
- 호환성: 높음
- 편집: 모든 텍스트 에디터
- 용도: 간단한 저장
```

### 마크다운 파일 (.md)
```
마크다운 형식
- 호환성: GitHub, Notion, Obsidian 등
- 편집: 마크다운 에디터
- 용도: 구조화된 문서
```

### JSON 파일 (.json)
```json
{
  "question": "Transformer가 뭐야?",
  "answer": "...",
  "difficulty": "easy",
  "timestamp": "2024-11-03T10:30:45",
  "sources": [...]
}
```

---

## 🎨 다운로드 옵션 UI

Streamlit UI에서 제공하는 다운로드 옵션:

```
📁 다운로드 옵션

파일명: [paper_response]
파일 형식: ○ 텍스트 (.txt)  ○ 마크다운 (.md)
☑ 메타데이터 포함

[⬇️ 파일 다운로드]
```

### 메타데이터 포함 옵션
- **포함**: 날짜, 난이도, 질문, 출처 등
- **미포함**: 순수 답변 내용만

---

## 📊 성능 지표

- **처리 속도**: 매우 빠름 (파일 생성만)
- **파일 크기**: 답변 길이에 따라 다름 (보통 1-10KB)
- **호환성**: 모든 OS 지원

---

## 🔧 내부 구현

### 파일 저장
```python
from ui.components.file_download import create_download_button

# 파일명 생성
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
filename = f"paper_response_{timestamp}.txt"

# 다운로드 버튼
create_download_button(
    content=answer,
    filename=filename
)
```

### 로깅
- **outputs/response.txt**: 저장된 파일 내용
- **ui/user_interactions.log**: 파일 다운로드 이벤트

---

## 🔄 워크플로우 통합

### 일반적인 사용 패턴
```
1. search_paper → 답변 생성
2. [📋 답변 복사] expander 클릭
3. 필요 시 save_file 도구 사용
```

### 자동 저장 옵션
설정에서 "모든 답변 자동 저장" 활성화 시:
- 각 답변이 자동으로 experiments/ 폴더에 저장
- 파일명 자동 생성: `YYYYMMDD_HHMMSS_answer.txt`

---

## 💡 활용 팁

1. **즉시 복사**: 간단한 복사는 "📋 답변 복사" expander 사용
2. **파일 저장**: 나중에 다시 볼 내용은 파일로 저장
3. **마크다운 활용**: Notion, Obsidian에서 활용하려면 .md 형식

---

## 🎯 실전 활용 사례

### 케이스 1: 논문 스터디 준비
```
1. "Transformer 논문 요약해줘" (summarize)
2. "파일로 저장해줘" (save_file)
3. 저장된 파일을 Notion에 업로드
4. 스터디 자료로 활용
```

### 케이스 2: 용어집 구축
```
1. 여러 질문으로 답변 생성
2. 자동으로 용어집 추가됨
3. "오늘 추가된 용어 정리해줘"
4. 용어집 파일 다운로드
5. 개인 학습 노트 작성
```

### 케이스 3: 리서치 노트
```
1. 연구 주제 관련 질문
2. 모든 답변 자동 저장
3. experiments/ 폴더에서 세션별 정리
4. 연구 진행 상황 추적
```

---

## ⚠️ 주의사항

1. **저작권**: 논문 요약은 fair use 범위 내 사용
2. **파일 관리**: 다운로드 폴더 정기적으로 정리
3. **인코딩**: UTF-8 인코딩 사용 (한글 지원)

---

## 📈 향후 개선 계획

- [ ] PDF 파일 export
- [ ] 이미지 포함 (차트, 그래프)
- [ ] Notion, Obsidian 직접 연동
- [ ] 클라우드 스토리지 연동

---

## 📈 예상 질문 리스트

### 다중요청 (다른 도구와 결합)
- `search_paper` → `save_file`: 한국 연구자가 참여한 LLM 관련 논문이 있는지 찾아서 알려줘
- `text2sql` → `save_file`: AI 논문 데이터베이스에서 Transformer 관련 논문 수를 SQL로 조회하고 결과를 파일로 저장해줘

---

**작성일**: 2025-11-05
**버전**: 2.0
