# 00. í”„ë¡œì íŠ¸ êµ¬ì¡°

## ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-11-04
- **ì‘ì„±ì**: ìµœí˜„í™”[íŒ€ì¥]
- **ìµœì¢… ìˆ˜ì •ì¼**: 2025-11-04

---

## ê°œìš”

ë³¸ ë¬¸ì„œëŠ” ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡ í”„ë¡œì íŠ¸ì˜ **ì „ì²´ ë””ë ‰í† ë¦¬ êµ¬ì¡°ì™€ íŒŒì¼ ì¡°ì§**ì„ ì„¤ëª…í•©ë‹ˆë‹¤. í”„ë¡œì íŠ¸ëŠ” **ëª¨ë“ˆí™” ì›ì¹™**ì— ë”°ë¼ ê¸°ëŠ¥ë³„ë¡œ ë¶„ë¦¬ëœ ë””ë ‰í† ë¦¬ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, ê° ë””ë ‰í† ë¦¬ëŠ” ëª…í™•í•œ ì±…ì„ì„ ê°€ì§‘ë‹ˆë‹¤.

### í•µì‹¬ ì„¤ê³„ ì›ì¹™
1. **ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ (Separation of Concerns)**: ì†ŒìŠ¤ ì½”ë“œ, ìŠ¤í¬ë¦½íŠ¸, ë°ì´í„°, ë¬¸ì„œë¥¼ ëª…í™•íˆ êµ¬ë¶„
2. **ëª¨ë“ˆí™” (Modularity)**: ê¸°ëŠ¥ë³„ë¡œ ë…ë¦½ëœ ëª¨ë“ˆ êµ¬ì¡°
3. **ê³„ì¸µí™” (Layering)**: UI, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§, ë°ì´í„° ê³„ì¸µ ë¶„ë¦¬
4. **í™•ì¥ì„± (Scalability)**: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ê°€ ìš©ì´í•œ êµ¬ì¡°

---

## ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
langchain-project/
â”œâ”€â”€ configs/                    # ì„¤ì • íŒŒì¼
â”‚   â””â”€â”€ collect/               # ë°ì´í„° ìˆ˜ì§‘ ì„¤ì •
â”œâ”€â”€ data/                       # ë°ì´í„° ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ processed/             # ì „ì²˜ë¦¬ëœ ë°ì´í„°
â”‚   â”œâ”€â”€ raw/                   # ì›ë³¸ ë°ì´í„°
â”‚   â”‚   â””â”€â”€ pdfs/              # PDF ë…¼ë¬¸ íŒŒì¼
â”‚   â”œâ”€â”€ rdbms/                 # ê´€ê³„í˜• DB ë°ì´í„°
â”‚   â””â”€â”€ vectordb/              # ë²¡í„° DB ë°ì´í„°
â”‚       â””â”€â”€ papers_faiss/      # FAISS ì¸ë±ìŠ¤
â”œâ”€â”€ database/                   # DB ìŠ¤í‚¤ë§ˆ ë° ë§ˆì´ê·¸ë ˆì´ì…˜
â”œâ”€â”€ docs/                       # í”„ë¡œì íŠ¸ ë¬¸ì„œ
â”‚   â”œâ”€â”€ PPT/                   # ë°œí‘œ ìë£Œ
â”‚   â”œâ”€â”€ PRD/                   # ì œí’ˆ ìš”êµ¬ì‚¬í•­ ëª…ì„¸ì„œ
â”‚   â”œâ”€â”€ QnA/                   # ì§ˆì˜ì‘ë‹µ ë¬¸ì„œ
â”‚   â”œâ”€â”€ architecture/          # ì•„í‚¤í…ì²˜ ë¬¸ì„œ
â”‚   â”‚   â”œâ”€â”€ claude_prompts/    # Claude í”„ë¡¬í”„íŠ¸
â”‚   â”‚   â”œâ”€â”€ mermaid/           # Mermaid ë‹¤ì´ì–´ê·¸ë¨
â”‚   â”‚   â”œâ”€â”€ multiple_request/  # ë‹¤ì¤‘ ìš”ì²­ ë¬¸ì„œ
â”‚   â”‚   â””â”€â”€ single_request/    # ë‹¨ì¼ ìš”ì²­ ë¬¸ì„œ
â”‚   â”œâ”€â”€ errors/                # ì—ëŸ¬ ë¡œê·¸
â”‚   â”œâ”€â”€ images/                # ë¬¸ì„œ ì´ë¯¸ì§€
â”‚   â”œâ”€â”€ issues/                # ì´ìŠˆ íŠ¸ë˜í‚¹
â”‚   â”œâ”€â”€ minutes/               # íšŒì˜ë¡
â”‚   â”œâ”€â”€ modularization/        # ëª¨ë“ˆí™” ë¬¸ì„œ
â”‚   â”œâ”€â”€ roles/                 # ì—­í•  ì •ì˜
â”‚   â”œâ”€â”€ rules/                 # ê·œì¹™ ë° ê°€ì´ë“œ
â”‚   â”œâ”€â”€ scenarios/             # ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤
â”‚   â””â”€â”€ usage/                 # ì‚¬ìš©ë²• ë¬¸ì„œ
â”œâ”€â”€ notebooks/                  # Jupyter ë…¸íŠ¸ë¶
â”‚   â”œâ”€â”€ base/                  # ê¸°ë³¸ ì‹¤í—˜ ë…¸íŠ¸ë¶
â”‚   â””â”€â”€ team/                  # íŒ€ë³„ ë…¸íŠ¸ë¶
â”œâ”€â”€ prompts/                    # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”œâ”€â”€ scripts/                    # ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ analysis/              # ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ data/                  # ë°ì´í„° ì²˜ë¦¬
â”‚   â”œâ”€â”€ debug/                 # ë””ë²„ê¹… ë„êµ¬
â”‚   â”œâ”€â”€ system/                # ì‹œìŠ¤í…œ ê´€ë¦¬
â”‚   â””â”€â”€ tests/                 # í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â”‚       â”œâ”€â”€ integration/       # í†µí•© í…ŒìŠ¤íŠ¸
â”‚       â””â”€â”€ unit/              # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ src/                        # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ agent/                 # AI Agent (LangGraph)
â”‚   â”œâ”€â”€ data/                  # ë°ì´í„° ì²˜ë¦¬
â”‚   â”œâ”€â”€ database/              # DB ì—°ê²° ë° ì¿¼ë¦¬
â”‚   â”œâ”€â”€ evaluation/            # ì„±ëŠ¥ í‰ê°€
â”‚   â”œâ”€â”€ llm/                   # LLM í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ memory/                # ëŒ€í™” ë©”ëª¨ë¦¬
â”‚   â”œâ”€â”€ papers/                # ë…¼ë¬¸ ì²˜ë¦¬
â”‚   â”‚   â”œâ”€â”€ domain/            # ë„ë©”ì¸ ëª¨ë¸
â”‚   â”‚   â””â”€â”€ infra/             # ì¸í”„ë¼ ê³„ì¸µ
â”‚   â”œâ”€â”€ prompts/               # í”„ë¡¬í”„íŠ¸ ê´€ë¦¬
â”‚   â”œâ”€â”€ rag/                   # RAG ê²€ìƒ‰
â”‚   â”œâ”€â”€ text2sql/              # Text-to-SQL
â”‚   â”œâ”€â”€ tools/                 # Agent ë„êµ¬
â”‚   â””â”€â”€ utils/                 # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â””â”€â”€ ui/                         # Streamlit UI
    â”œâ”€â”€ assets/                # ì •ì  ìì‚°
    â”œâ”€â”€ components/            # UI ì»´í¬ë„ŒíŠ¸
    â”œâ”€â”€ pages/                 # í˜ì´ì§€
    â””â”€â”€ test/                  # UI í…ŒìŠ¤íŠ¸
```

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°ë„

```mermaid
graph TB
    subgraph MainFlow["ğŸ“‹ í”„ë¡œì íŠ¸ ì „ì²´ êµ¬ì¡°"]
        direction TB

        subgraph Root["ğŸ”¸ í”„ë¡œì íŠ¸ ë£¨íŠ¸"]
            direction LR
            Main[main.py<br/>ì§„ì…ì ] --> Config[.env<br/>í™˜ê²½ ë³€ìˆ˜]
            Config --> Req[requirements.txt<br/>ì˜ì¡´ì„±]
        end

        subgraph Configs["ğŸ”¸ ì„¤ì • (configs/)"]
            direction TB
            DBConfig[db_config.yaml<br/>DB ì„¤ì •]
            DBConfig ~~~ ModelConfig[model_config.yaml<br/>ëª¨ë¸ ì„¤ì •]
            ModelConfig ~~~ MultiRequest[multi_request_patterns.yaml<br/>ë‹¤ì¤‘ ìš”ì²­ íŒ¨í„´]
            MultiRequest ~~~ PromptConfig[prompt_config.yaml<br/>í”„ë¡¬í”„íŠ¸ ì„¤ì •]
            PromptConfig ~~~ CollectConfig[collect/config.yaml<br/>ë°ì´í„° ìˆ˜ì§‘ ì„¤ì •]
        end

        subgraph Source["ğŸ”¹ ì†ŒìŠ¤ ì½”ë“œ (src/)"]
            direction TB

            subgraph SourceCore["ğŸ”· í•µì‹¬ ë¡œì§"]
                direction LR
                Agent[agent/<br/>AI Agent<br/>Fallback Chain] --> Tools[tools/<br/>ë„êµ¬ ì‹œìŠ¤í…œ]
                Tools --> PromptsMgr[prompts/<br/>í”„ë¡¬í”„íŠ¸ ê´€ë¦¬]
            end

            subgraph SourceData["ğŸ”¶ ë°ì´í„° ì²˜ë¦¬"]
                direction LR
                RAG[rag/<br/>RAG ê²€ìƒ‰] --> Papers[papers/<br/>ë…¼ë¬¸ ì²˜ë¦¬]
                Papers --> DataLoader[data/<br/>ë¬¸ì„œ ë¡œë”]
            end

            subgraph SourceInfra["ğŸ”º ì¸í”„ë¼"]
                direction LR
                LLM[llm/<br/>LLM í´ë¼ì´ì–¸íŠ¸] --> DB[database/<br/>DB ì—°ê²°]
                DB --> Text2SQL[text2sql/<br/>SQL ë³€í™˜]
            end

            subgraph SourceSupport["ğŸ’¡ ì§€ì› ê¸°ëŠ¥"]
                direction LR
                Utils[utils/<br/>ìœ í‹¸ë¦¬í‹°] --> Eval[evaluation/<br/>ì„±ëŠ¥ í‰ê°€]
                Eval --> Mem[memory/<br/>ëŒ€í™” ë©”ëª¨ë¦¬]
            end

            SourceCore --> SourceData
            SourceData --> SourceInfra
            SourceInfra --> SourceSupport
        end

        subgraph Prompts["ğŸ”º í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§<br>(prompts/)"]
            direction TB
            RoutingPrompts[routing_prompts.json<br/>ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸]
            RoutingPrompts ~~~ ToolPrompts[tool_prompts.json<br/>ë„êµ¬ í”„ë¡¬í”„íŠ¸]
            ToolPrompts ~~~ EvalPrompts[evaluation_prompts.json<br/>í‰ê°€ í”„ë¡¬í”„íŠ¸]
            EvalPrompts --> QGenPrompts[question_generation_prompts.json<br/>ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸]
            QGenPrompts --> GoldenDataset[golden_dataset.json<br/>ê³¨ë“  ë°ì´í„°ì…‹]
        end

        subgraph UI["ğŸ”º ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (ui/)"]
            direction LR
            App[app.py<br/>ë©”ì¸ UI] --> Comp[components/<br/>UI ì»´í¬ë„ŒíŠ¸]
            Comp --> Pages[pages/<br/>ì¶”ê°€ í˜ì´ì§€]
        end

        subgraph Scripts["ğŸ”¶ ìŠ¤í¬ë¦½íŠ¸ (scripts/)"]
            direction LR
            DataScript[data/<br/>ë°ì´í„° ì²˜ë¦¬] --> System[system/<br/>ì‹œìŠ¤í…œ ê´€ë¦¬]
            System --> Tests[tests/<br/>í…ŒìŠ¤íŠ¸]
        end

        subgraph Docs["ğŸ”· ë¬¸ì„œ (docs/)"]
            direction TB

            subgraph DocsBasic["ğŸ“‘ ê¸°ë³¸ ë¬¸ì„œ"]
                direction LR
                Rules[rules/<br/>ê·œì¹™] --> PRD2[PRD/<br/>ìš”êµ¬ì‚¬í•­]
                PRD2 --> Roles[roles/<br/>ë‹´ë‹¹ì—­í• ]
                Roles --> Minutes[minutes/<br/>íšŒì˜ë¡]
            end

            subgraph DocsTracking["ğŸ“Š ì¶”ì  ë¬¸ì„œ"]
                direction LR
                Issues[issues/<br/>ì´ìŠˆ íŠ¸ë˜í‚¹] --> Errors[errors/<br/>ì—ëŸ¬]
                Errors --> Experiments[experiments/<br/>ì‹¤í—˜ ë³´ê³ ì„œ]
            end

            subgraph DocsArch["ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë¬¸ì„œ"]
                direction LR
                Mod[modularization/<br/>ëª¨ë“ˆ ë¬¸ì„œ] --> Arch[architecture/<br/>ë‹¨ì¼ìš”ì²­/ë‹¤ì¤‘ìš”ì²­/<br/>ë©€í‹°í„´ ê¸°ëŠ¥ë³„<br/>ì•„í‚¤í…ì²˜]
            end

            subgraph DocsUsage["ğŸ“– ì‚¬ìš© ê°€ì´ë“œ"]
                direction LR
                Usage[usage/<br/>ì‹¤í–‰ ëª…ë ¹ì–´] --> QnA[QnA/<br/>í”„ë¡œì íŠ¸ ê´€ë ¨<br/>ì§ˆì˜ì‘ë‹µ]
                QnA --> Scenarios[scenarios/<br/>ì§ˆë¬¸ ë¦¬ìŠ¤íŠ¸<br/>ì‹œë‚˜ë¦¬ì˜¤]
            end

            DocsBasic --> DocsTracking
            DocsTracking --> DocsArch
            DocsArch --> DocsUsage
        end

        Root --> Configs
        Root --> Prompts
        Configs --> Source
        Prompts --> Source
        Source --> UI
        UI --> Scripts
        Scripts --> Docs
    end

    %% ë©”ì¸ ì›Œí¬í”Œë¡œìš° ë°°ê²½
    style MainFlow fill:#fffde7,stroke:#f9a825,stroke-width:4px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼ (ìƒìœ„ ë ˆë²¨)
    style Root fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style Configs fill:#fff3e0,stroke:#f57c00,stroke-width:3px,color:#000
    style Source fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style Prompts fill:#e1f5fe,stroke:#01579b,stroke-width:3px,color:#000
    style UI fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style Scripts fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style Docs fill:#fce4ec,stroke:#880e4f,stroke-width:3px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼ (ì†ŒìŠ¤ ì½”ë“œ í•˜ìœ„ ë ˆë²¨)
    style SourceCore fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
    style SourceData fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
    style SourceInfra fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
    style SourceSupport fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼ (ë¬¸ì„œ í•˜ìœ„ ë ˆë²¨)
    style DocsBasic fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
    style DocsTracking fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
    style DocsArch fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
    style DocsUsage fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (í”„ë¡œì íŠ¸ ë£¨íŠ¸ - ì²­ë¡ ê³„ì—´)
    style Main fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style Config fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style Req fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì„¤ì • - ì£¼í™© ê³„ì—´)
    style DBConfig fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style ModelConfig fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style MultiRequest fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style PromptConfig fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style CollectConfig fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì†ŒìŠ¤ ì½”ë“œ - ë³´ë¼ ê³„ì—´)
    style Agent fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Tools fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style PromptsMgr fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style RAG fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Papers fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style DataLoader fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style LLM fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style DB fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Text2SQL fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Utils fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Eval fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Mem fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ - íŒŒë‘ ê³„ì—´)
    style RoutingPrompts fill:#81d4fa,stroke:#01579b,stroke-width:2px,color:#000
    style ToolPrompts fill:#81d4fa,stroke:#01579b,stroke-width:2px,color:#000
    style EvalPrompts fill:#81d4fa,stroke:#01579b,stroke-width:2px,color:#000
    style QGenPrompts fill:#81d4fa,stroke:#01579b,stroke-width:2px,color:#000
    style GoldenDataset fill:#81d4fa,stroke:#01579b,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (UI - ë…¹ìƒ‰ ê³„ì—´)
    style App fill:#a5d6a7,stroke:#2e7d32,stroke-width:2px,color:#000
    style Comp fill:#a5d6a7,stroke:#2e7d32,stroke-width:2px,color:#000
    style Pages fill:#a5d6a7,stroke:#2e7d32,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ìŠ¤í¬ë¦½íŠ¸ - ì£¼í™© ê³„ì—´)
    style DataScript fill:#ffcc80,stroke:#e65100,stroke-width:2px,color:#000
    style System fill:#ffcc80,stroke:#e65100,stroke-width:2px,color:#000
    style Tests fill:#ffcc80,stroke:#e65100,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë¬¸ì„œ - ë¶„í™ ê³„ì—´)
    style Rules fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style PRD2 fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Roles fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Minutes fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Issues fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Errors fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Experiments fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Mod fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Arch fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Usage fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style QnA fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000
    style Scenarios fill:#f48fb1,stroke:#880e4f,stroke-width:2px,color:#000

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼
    linkStyle 0,1 stroke:#006064,stroke-width:2px
    linkStyle 2,3,4,5 stroke:#none,stroke-width:0px
    linkStyle 6,7 stroke:#7b1fa2,stroke-width:2px
    linkStyle 8,9 stroke:#7b1fa2,stroke-width:2px
    linkStyle 10,11 stroke:#7b1fa2,stroke-width:2px
    linkStyle 12,13 stroke:#7b1fa2,stroke-width:2px
    linkStyle 14,15,16 stroke:#616161,stroke-width:3px
    linkStyle 17,18 stroke:#none,stroke-width:0px
    linkStyle 19,20 stroke:#01579b,stroke-width:2px
    linkStyle 21,22 stroke:#2e7d32,stroke-width:2px
    linkStyle 23,24 stroke:#e65100,stroke-width:2px
    linkStyle 25,26,27 stroke:#880e4f,stroke-width:2px
    linkStyle 28,29 stroke:#c2185b,stroke-width:2px
    linkStyle 30 stroke:#c2185b,stroke-width:2px
    linkStyle 31,32 stroke:#c2185b,stroke-width:2px
    linkStyle 33,34,35,36,37,38 stroke:#616161,stroke-width:3px
```

**êµ¬ì¡°ë„ ì„¤ëª…:**
- **í”„ë¡œì íŠ¸ ë£¨íŠ¸**: ì§„ì…ì (`main.py`)ê³¼ í™˜ê²½ ì„¤ì •(`.env`)
- **ì„¤ì • (configs/)**: DB, ëª¨ë¸, ë‹¤ì¤‘ ìš”ì²­ íŒ¨í„´, í”„ë¡¬í”„íŠ¸ ì„¤ì • íŒŒì¼
- **ì†ŒìŠ¤ ì½”ë“œ (src/)**:
  - **í•µì‹¬ ë¡œì§**: Agent, Tools, í”„ë¡¬í”„íŠ¸ ê´€ë¦¬
  - **ë°ì´í„° ì²˜ë¦¬**: RAG, ë…¼ë¬¸ ì²˜ë¦¬, ë¬¸ì„œ ë¡œë”
  - **ì¸í”„ë¼**: LLM í´ë¼ì´ì–¸íŠ¸, DB ì—°ê²°, Text2SQL
  - **ì§€ì› ê¸°ëŠ¥**: ìœ í‹¸ë¦¬í‹°, í‰ê°€, ëŒ€í™” ë©”ëª¨ë¦¬
- **í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ (prompts/)**: ë¼ìš°íŒ…, ë„êµ¬, í‰ê°€, ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸ ë° ê³¨ë“  ë°ì´í„°ì…‹
- **ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (ui/)**: Streamlit ê¸°ë°˜ ì›¹ UI
- **ìŠ¤í¬ë¦½íŠ¸ (scripts/)**: ë°ì´í„° ì²˜ë¦¬, ì‹œìŠ¤í…œ ê´€ë¦¬, í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
- **ë¬¸ì„œ (docs/)**: ì„¤ê³„ ë¬¸ì„œ, PRD, ì—­í•  ë¬¸ì„œ, ì•„í‚¤í…ì²˜, ì‚¬ìš© ê°€ì´ë“œ

---

## ì „ì²´ ì•„í‚¤í…ì²˜ (ë‹¨ìˆœ íë¦„ë„)

```mermaid
graph TB
    subgraph MainFlow["ğŸ“‹ main.py ì‹¤í–‰ ì›Œí¬í”Œë¡œìš°"]
        direction TB

        subgraph Init["ğŸ”¸ ì´ˆê¸°í™”"]
            direction LR
            Start([â–¶ï¸ python main.py]) --> LoadEnv[.env íŒŒì¼<br/>í™˜ê²½ë³€ìˆ˜ ë¡œë“œ]
            LoadEnv --> CheckPath[ui/app.py<br/>ê²½ë¡œ í™•ì¸]
        end

        subgraph Streamlit["ğŸ”¹ Streamlit ì„œë²„ ì‹œì‘"]
            direction LR
            RunStreamlit[Streamlit ì‹¤í–‰<br/>ui/app.py] --> SetConfig[ì„œë²„ ì„¤ì •<br/>port: 8501]
            SetConfig --> OpenBrowser[ë¸Œë¼ìš°ì €<br/>ìë™ ì—´ê¸°]
        end

        subgraph UIInit["ğŸ”º UI ì´ˆê¸°í™” (ui/app.py)"]
            direction LR
            PageConfig[í˜ì´ì§€ ì„¤ì •<br/>ì œëª©/ì•„ì´ì½˜] --> ValidateEnv{í™˜ê²½ë³€ìˆ˜<br/>ê²€ì¦}
            ValidateEnv -->|API í‚¤ ì—†ìŒ| ErrorStop[âŒ ì•± ì¤‘ì§€]
            ValidateEnv -->|ì •ìƒ| InitAgent[Agent ì´ˆê¸°í™”<br/>ìºì‹±]
        end

        subgraph AgentSetup["ğŸ”¶ Agent & ì‹¤í—˜ê´€ë¦¬ì ìƒì„±"]
            direction LR
            CreateExpMgr[ì‹¤í—˜ê´€ë¦¬ì<br/>ìƒì„±] --> CreateGraph[Agent ê·¸ë˜í”„<br/>êµ¬ì„±]
            CreateGraph --> AddNodes[ë…¸ë“œ ì¶”ê°€<br/>ë¼ìš°í„° + 7ê°œ ë„êµ¬]
            AddNodes --> AddEdges[ì—£ì§€ ì¶”ê°€<br/>ì¡°ê±´ë¶€ ë¼ìš°íŒ…]
            AddEdges --> Compile[ê·¸ë˜í”„<br/>ì»´íŒŒì¼]
        end

        subgraph UIRender["ğŸ’¡ UI ë Œë”ë§"]
            direction LR
            RenderSidebar[ì‚¬ì´ë“œë°” ë Œë”ë§<br/>ë‚œì´ë„ ì„ íƒ] --> InitChat[ì±„íŒ… ì„¸ì…˜<br/>ì´ˆê¸°í™”]
            InitChat --> ShowHistory[ì±„íŒ… íˆìŠ¤í† ë¦¬<br/>í‘œì‹œ]
            ShowHistory --> WaitInput[ì‚¬ìš©ì ì…ë ¥<br/>ëŒ€ê¸°]
        end

        subgraph UserInput["ğŸ”· ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬"]
            direction LR
            InputReceived[ì§ˆë¬¸ ì…ë ¥<br/>ìˆ˜ì‹ ] --> SelectDiff[ë‚œì´ë„ ì„ íƒ<br/>ì´ˆì‹¬ì/ì „ë¬¸ê°€]
            SelectDiff --> AddUserMsg[ì‚¬ìš©ì ë©”ì‹œì§€<br/>ì¶”ê°€]
            AddUserMsg --> ExtractKeyword[í‚¤ì›Œë“œ ì¶”ì¶œ<br/>íŒ¨í„´ ë§¤ì¹­]
            ExtractKeyword --> SelectToolInit[ë„êµ¬ ì„ íƒ<br/>ìš°ì„ ìˆœìœ„]
            SelectToolInit --> ValidateTool{ë„êµ¬<br/>ê²€ì¦}
            ValidateTool -->|ì í•©| InvokeAgent[Agent ê·¸ë˜í”„<br/>ì‹¤í–‰]
            ValidateTool -->|ì¬ì„ íƒ| SelectToolInit
        end

        subgraph AgentExec["âœ¨ Agent ì‹¤í–‰ (LangGraph)"]
            direction LR
            RouterNode[ë¼ìš°í„°<br/>ìµœì¢… ë„êµ¬ í™•ì •] --> SelectTool{ë„êµ¬<br/>ì„ íƒ}
            SelectTool -->|ì¼ë°˜| GeneralNode[ì¼ë°˜ ë‹µë³€]
            SelectTool -->|RAG ë…¼ë¬¸| SearchNode[RAG ë…¼ë¬¸ ê²€ìƒ‰]
            SelectTool -->|Web ë…¼ë¬¸| WebNode[Web ë…¼ë¬¸ ê²€ìƒ‰]
            SelectTool -->|RAG ìš©ì–´| GlossaryNode[RAG ìš©ì–´ì§‘ ê²€ìƒ‰]
            SelectTool -->|ìš”ì•½| SummarizeNode[ë…¼ë¬¸ ìš”ì•½]
            SelectTool -->|í†µê³„| Text2SQLNode[Text2SQL í†µê³„]
            SelectTool -->|ì €ì¥| SaveNode[íŒŒì¼ ì €ì¥]
        end

        subgraph DataQuery["ğŸ’¾ ë°ì´í„° ì¡°íšŒ"]
            direction LR
            GeneralNode --> LLMDirect[ğŸ¤– LLM<br/>ì§ì ‘ í˜¸ì¶œ]
            SearchNode --> VectorDB[(ğŸ’¾ PGVector<br/>ë…¼ë¬¸ ì„ë² ë”©)]
            GlossaryNode --> GlossaryDB[(ğŸ’¾ PostgreSQL<br/>glossary í…Œì´ë¸”)]
            Text2SQLNode --> PapersDB[(ğŸ’¾ PostgreSQL<br/>papers í…Œì´ë¸”)]
            WebNode --> TavilyAPI[ğŸ” Tavily API<br/>ì›¹ ê²€ìƒ‰]
            SummarizeNode --> SummarizeDB[(ğŸ’¾ PGVector<br/>ë…¼ë¬¸ ì²­í¬)]
        end

        subgraph FallbackChain["ğŸ”„ ë„êµ¬ ìë™ ì „í™˜ (Fallback)"]
            direction LR
            GlossaryFail[RAG ìš©ì–´ì§‘ ê²€ìƒ‰<br/>ì‹¤íŒ¨] -.-> GlossaryToGeneral[ì¼ë°˜ ë‹µë³€<br/>ì „í™˜]
            SearchFail[RAG ë…¼ë¬¸ ê²€ìƒ‰<br/>ì‹¤íŒ¨] -.-> SearchToWeb[Web ë…¼ë¬¸ ê²€ìƒ‰<br/>ì „í™˜]
            SearchToWeb -.-> WebToGeneral[ì¼ë°˜ ë‹µë³€<br/>ì „í™˜]
            Text2SQLFail[Text2SQL í†µê³„<br/>ì‹¤íŒ¨] -.-> Text2SQLToGeneral[ì¼ë°˜ ë‹µë³€<br/>ì „í™˜]
        end

        subgraph FinalAnswer["âœï¸ ìµœì¢… ë‹µë³€ ìƒì„±"]
            direction LR
            CheckDiff{ë‚œì´ë„<br/>í™•ì¸} -->|ì´ˆë³´ì| EasyPrompt[ì´ˆë³´ììš©<br/>í”„ë¡¬í”„íŠ¸]
            CheckDiff -->|ì „ë¬¸ê°€| HardPrompt[ì „ë¬¸ê°€ìš©<br/>í”„ë¡¬í”„íŠ¸]
            EasyPrompt --> GenerateLLM[LLMìœ¼ë¡œ<br/>ë‹µë³€ ìƒì„±]
            HardPrompt --> GenerateLLM
        end

        subgraph AnswerDisplay["ğŸ“± ë‹µë³€ í‘œì‹œ"]
            direction LR
            DisplayAnswer[ë‹µë³€<br/>UI ë Œë”ë§] --> ShowBadge[ë„êµ¬ ë°°ì§€<br/>í‘œì‹œ]
            ShowBadge --> ShowReason[ì„ íƒ ì´ìœ <br/>í¼ì¹¨ ë©”ë‰´]
            ShowReason --> ExtractTerms[ìš©ì–´ ì¶”ì¶œ<br/>DB ì €ì¥]
        end

        subgraph Evaluation["ğŸ“Š ë‹µë³€ í’ˆì§ˆ í‰ê°€"]
            direction LR
            LLMJudge[LLM-as-a-Judge<br/>í’ˆì§ˆ í‰ê°€] --> EvalScore[í‰ê°€ ì ìˆ˜<br/>ìƒì„±]
            EvalScore --> SaveEval[í‰ê°€ ê²°ê³¼<br/>DB ì €ì¥]
            SaveEval --> ShowEval[í‰ê°€ ê²°ê³¼<br/>UI í‘œì‹œ]
        end

        subgraph Continue["ğŸ”¹ ê³„ì† ì§ˆë¬¸"]
            direction LR
            WaitNext{ê³„ì†<br/>ì§ˆë¬¸?} -->|Yes| BackToInput[ì…ë ¥ì°½<br/>ë³µê·€]
            WaitNext -->|No| SessionEnd[ì„¸ì…˜<br/>ìœ ì§€]
        end

        %% ì‹œì‘/ì¢…ë£Œ ë…¸ë“œ
        Start([â–¶ï¸ ì‹œì‘<br/>ì‚¬ìš©ì ì‹¤í–‰]) --> Init
        SessionEnd --> End([âœ… ì¢…ë£Œ<br/>ë¸Œë¼ìš°ì € íƒ­ ë‹«ê¸°])

        %% ë‹¨ê³„ ê°„ ì—°ê²°
        Init --> Streamlit
        Streamlit --> UIInit
        UIInit --> AgentSetup
        AgentSetup --> UIRender
        UIRender --> UserInput
        UserInput --> AgentExec
        AgentExec --> DataQuery
        DataQuery --> FinalAnswer
        FinalAnswer --> AnswerDisplay
        AnswerDisplay --> Evaluation
        Evaluation --> Continue
        BackToInput --> UserInput
    end

    %% ë©”ì¸ ì›Œí¬í”Œë¡œìš° ë°°ê²½
    style MainFlow fill:#fffde7,stroke:#f9a825,stroke-width:4px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼
    style Init fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style Streamlit fill:#e3f2fd,stroke:#0d47a1,stroke-width:3px,color:#000
    style UIInit fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style AgentSetup fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style UIRender fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000
    style UserInput fill:#fce4ec,stroke:#880e4f,stroke-width:3px,color:#000
    style AgentExec fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style DataQuery fill:#ede7f6,stroke:#512da8,stroke-width:3px,color:#000
    style FinalAnswer fill:#e0f2f1,stroke:#00695c,stroke-width:3px,color:#000
    style AnswerDisplay fill:#e1f5fe,stroke:#01579b,stroke-width:3px,color:#000
    style Evaluation fill:#fff9c4,stroke:#f57f17,stroke-width:3px,color:#000
    style Continue fill:#f1f8e9,stroke:#33691e,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì‹œì‘/ì¢…ë£Œ)
    style Start fill:#4db6ac,stroke:#00695c,stroke-width:3px,color:#000
    style End fill:#66bb6a,stroke:#2e7d32,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì´ˆê¸°í™” - ì²­ë¡)
    style LoadEnv fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style CheckPath fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (Streamlit - íŒŒë‘)
    style RunStreamlit fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style SetConfig fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style OpenBrowser fill:#42a5f5,stroke:#1565c0,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (UI ì´ˆê¸°í™” - ë³´ë¼)
    style PageConfig fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style ValidateEnv fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style ErrorStop fill:#ef5350,stroke:#c62828,stroke-width:2px,color:#000
    style InitAgent fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (Agent ìƒì„± - ì£¼í™©)
    style CreateExpMgr fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style CreateGraph fill:#ffb74d,stroke:#f57c00,stroke-width:2px,color:#000
    style AddNodes fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style AddEdges fill:#ff9800,stroke:#e65100,stroke-width:2px,color:#000
    style Compile fill:#fb8c00,stroke:#e65100,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (UI ë Œë”ë§ - ë¹¨ê°•)
    style RenderSidebar fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style InitChat fill:#e57373,stroke:#c62828,stroke-width:2px,color:#000
    style ShowHistory fill:#ef5350,stroke:#b71c1c,stroke-width:2px,color:#000
    style WaitInput fill:#f44336,stroke:#b71c1c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì‚¬ìš©ì ì…ë ¥ - í•‘í¬)
    style InputReceived fill:#f48fb1,stroke:#ad1457,stroke-width:2px,color:#000
    style SelectDiff fill:#f48fb1,stroke:#ad1457,stroke-width:2px,color:#000
    style AddUserMsg fill:#f06292,stroke:#ad1457,stroke-width:2px,color:#000
    style ExtractKeyword fill:#f06292,stroke:#ad1457,stroke-width:2px,color:#000
    style SelectToolInit fill:#ec407a,stroke:#880e4f,stroke-width:2px,color:#000
    style ValidateTool fill:#e91e63,stroke:#880e4f,stroke-width:2px,color:#000
    style InvokeAgent fill:#ec407a,stroke:#880e4f,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (Agent ì‹¤í–‰ - ë…¹ìƒ‰)
    style RouterNode fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style SelectTool fill:#66bb6a,stroke:#2e7d32,stroke-width:2px,color:#000
    style GeneralNode fill:#a5d6a7,stroke:#388e3c,stroke-width:2px,color:#000
    style SearchNode fill:#a5d6a7,stroke:#388e3c,stroke-width:2px,color:#000
    style WebNode fill:#a5d6a7,stroke:#388e3c,stroke-width:2px,color:#000
    style GlossaryNode fill:#a5d6a7,stroke:#388e3c,stroke-width:2px,color:#000
    style SummarizeNode fill:#a5d6a7,stroke:#388e3c,stroke-width:2px,color:#000
    style Text2SQLNode fill:#a5d6a7,stroke:#388e3c,stroke-width:2px,color:#000
    style SaveNode fill:#a5d6a7,stroke:#388e3c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë°ì´í„° ì¡°íšŒ - ë³´ë¼)
    style LLMDirect fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style VectorDB fill:#b39ddb,stroke:#512da8,stroke-width:2px,color:#000
    style GlossaryDB fill:#b39ddb,stroke:#512da8,stroke-width:2px,color:#000
    style PapersDB fill:#b39ddb,stroke:#512da8,stroke-width:2px,color:#000
    style TavilyAPI fill:#ba68c8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style SummarizeDB fill:#b39ddb,stroke:#512da8,stroke-width:2px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼ (Fallback - ì£¼í™©)
    style FallbackChain fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (Fallback - ì£¼í™©)
    style GlossaryFail fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style GlossaryToGeneral fill:#ffb74d,stroke:#f57c00,stroke-width:2px,color:#000
    style SearchFail fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style SearchToWeb fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style WebToGeneral fill:#ffb74d,stroke:#f57c00,stroke-width:2px,color:#000
    style Text2SQLFail fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style Text2SQLToGeneral fill:#ffb74d,stroke:#f57c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ìµœì¢… ë‹µë³€ ìƒì„± - ì²­ë¡)
    style CheckDiff fill:#4dd0e1,stroke:#00838f,stroke-width:2px,color:#000
    style EasyPrompt fill:#26c6da,stroke:#00838f,stroke-width:2px,color:#000
    style HardPrompt fill:#26c6da,stroke:#00838f,stroke-width:2px,color:#000
    style GenerateLLM fill:#00bcd4,stroke:#00695c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë‹µë³€ í‘œì‹œ - í•˜ëŠ˜ìƒ‰)
    style DisplayAnswer fill:#81d4fa,stroke:#0288d1,stroke-width:2px,color:#000
    style ShowBadge fill:#4fc3f7,stroke:#0277bd,stroke-width:2px,color:#000
    style ShowReason fill:#29b6f6,stroke:#01579b,stroke-width:2px,color:#000
    style ExtractTerms fill:#03a9f4,stroke:#01579b,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë‹µë³€ í’ˆì§ˆ í‰ê°€ - ë…¸ë‘)
    style LLMJudge fill:#fff59d,stroke:#f9a825,stroke-width:2px,color:#000
    style EvalScore fill:#ffee58,stroke:#f57f17,stroke-width:2px,color:#000
    style SaveEval fill:#fdd835,stroke:#f57f17,stroke-width:2px,color:#000
    style ShowEval fill:#fbc02d,stroke:#ef6c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ê³„ì† - ì—°ë‘)
    style WaitNext fill:#9ccc65,stroke:#558b2f,stroke-width:2px,color:#000
    style BackToInput fill:#8bc34a,stroke:#33691e,stroke-width:2px,color:#000
    style SessionEnd fill:#aed581,stroke:#558b2f,stroke-width:2px,color:#000

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (Continue ë‚´ë¶€ 0~1)
    linkStyle 0 stroke:#558b2f,stroke-width:2px
    linkStyle 1 stroke:#558b2f,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì‹œì‘/ì¢…ë£Œ 2~3)
    linkStyle 2 stroke:#00695c,stroke-width:3px
    linkStyle 3 stroke:#2e7d32,stroke-width:3px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì´ˆê¸°í™” 4~5)
    linkStyle 4 stroke:#006064,stroke-width:2px
    linkStyle 5 stroke:#006064,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (Streamlit 6~7)
    linkStyle 6 stroke:#1976d2,stroke-width:2px
    linkStyle 7 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (UI ì´ˆê¸°í™” 8~10)
    linkStyle 8 stroke:#7b1fa2,stroke-width:2px
    linkStyle 9 stroke:#c62828,stroke-width:2px
    linkStyle 10 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (Agent ìƒì„± 11~14)
    linkStyle 11 stroke:#f57c00,stroke-width:2px
    linkStyle 12 stroke:#f57c00,stroke-width:2px
    linkStyle 13 stroke:#f57c00,stroke-width:2px
    linkStyle 14 stroke:#f57c00,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (UI ë Œë”ë§ 15~17)
    linkStyle 15 stroke:#c62828,stroke-width:2px
    linkStyle 16 stroke:#c62828,stroke-width:2px
    linkStyle 17 stroke:#c62828,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì‚¬ìš©ì ì…ë ¥ 18~24)
    linkStyle 18 stroke:#ad1457,stroke-width:2px
    linkStyle 19 stroke:#ad1457,stroke-width:2px
    linkStyle 20 stroke:#ad1457,stroke-width:2px
    linkStyle 21 stroke:#ad1457,stroke-width:2px
    linkStyle 22 stroke:#ad1457,stroke-width:2px
    linkStyle 23 stroke:#880e4f,stroke-width:2px
    linkStyle 24 stroke:#ad1457,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (Agent ì‹¤í–‰ 25~32)
    linkStyle 25 stroke:#2e7d32,stroke-width:2px
    linkStyle 26 stroke:#2e7d32,stroke-width:2px
    linkStyle 27 stroke:#2e7d32,stroke-width:2px
    linkStyle 28 stroke:#2e7d32,stroke-width:2px
    linkStyle 29 stroke:#2e7d32,stroke-width:2px
    linkStyle 30 stroke:#2e7d32,stroke-width:2px
    linkStyle 31 stroke:#2e7d32,stroke-width:2px
    linkStyle 32 stroke:#2e7d32,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë°ì´í„° ì¡°íšŒ 33~38)
    linkStyle 33 stroke:#7b1fa2,stroke-width:2px
    linkStyle 34 stroke:#512da8,stroke-width:2px
    linkStyle 35 stroke:#512da8,stroke-width:2px
    linkStyle 36 stroke:#512da8,stroke-width:2px
    linkStyle 37 stroke:#7b1fa2,stroke-width:2px
    linkStyle 38 stroke:#512da8,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ìµœì¢… ë‹µë³€ ìƒì„± 39~42)
    linkStyle 39 stroke:#00838f,stroke-width:2px
    linkStyle 40 stroke:#00838f,stroke-width:2px
    linkStyle 41 stroke:#00838f,stroke-width:2px
    linkStyle 42 stroke:#00838f,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë‹µë³€ í‘œì‹œ 43~45)
    linkStyle 43 stroke:#0288d1,stroke-width:2px
    linkStyle 44 stroke:#0277bd,stroke-width:2px
    linkStyle 45 stroke:#01579b,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë‹µë³€ í’ˆì§ˆ í‰ê°€ 46~48)
    linkStyle 46 stroke:#f9a825,stroke-width:2px
    linkStyle 47 stroke:#f57f17,stroke-width:2px
    linkStyle 48 stroke:#f57f17,stroke-width:2px

    %% ë‹¨ê³„ ê°„ ì—°ê²° (íšŒìƒ‰ 49~57)
    linkStyle 49 stroke:#616161,stroke-width:3px
    linkStyle 50 stroke:#616161,stroke-width:3px
    linkStyle 51 stroke:#616161,stroke-width:3px
    linkStyle 52 stroke:#616161,stroke-width:3px
    linkStyle 53 stroke:#616161,stroke-width:3px
    linkStyle 54 stroke:#616161,stroke-width:3px
    linkStyle 55 stroke:#616161,stroke-width:3px
    linkStyle 56 stroke:#616161,stroke-width:3px
    linkStyle 57 stroke:#616161,stroke-width:3px
```

---

## ì „ì²´ ì•„í‚¤í…ì²˜ (ìƒì„¸ íë¦„ë„)

```mermaid
graph TB
    subgraph MainFlow["ğŸ“‹ ì „ì²´ ì‹œìŠ¤í…œ ìƒì„¸ ì‹¤í–‰ íë¦„ (main.py â†’ UI â†’ Agent â†’ Tools â†’ DB)"]
        direction TB

        subgraph Init["ğŸ”¸ 1ë‹¨ê³„: í”„ë¡œê·¸ë¨ ì‹œì‘"]
            direction LR
            A([â–¶ï¸ python main.py]) --> B[main í•¨ìˆ˜<br/>ì‹¤í–‰]
            B --> C[load_dotenv í•¨ìˆ˜<br/>.env ë¡œë“œ]
            C --> D[ê²½ë¡œ í™•ì¸<br/>ui/app.py]
        end

        subgraph StreamlitStart["ğŸ”¹ 2ë‹¨ê³„: Streamlit ì„œë²„ ì‹œì‘"]
            direction LR
            E[subprocess.run<br/>streamlit run ui/app.py] --> F[ì„œë²„ ì„¤ì •<br/>port: 8501]
            F --> G[ë¸Œë¼ìš°ì € ì—´ê¸°<br/>localhost:8501]
        end

        subgraph UISetup["ğŸ”º 3ë‹¨ê³„: UI ì´ˆê¸°í™” (ui/app.py)"]
            direction LR
            H[st.set_page_config<br/>í˜ì´ì§€ ì„¤ì •] --> I{í™˜ê²½ë³€ìˆ˜ ê²€ì¦<br/>OPENAI_API_KEY}
            I -->|ì—†ìŒ| J[st.stop<br/>ì•± ì¤‘ì§€]
            I -->|ìˆìŒ| K[initialize_agent<br/>ìºì‹œëœ ì´ˆê¸°í™”]
        end

        subgraph ExpMgrSetup["ğŸ”¶ 4ë‹¨ê³„: ExperimentManager ìƒì„±"]
            direction LR
            L[ExperimentManager<br/>ìƒì„±ì í˜¸ì¶œ] --> M[ì‹¤í—˜ í´ë” ìƒì„±<br/>experiments/YYYYMMDD/ID]
            M --> N[Logger ì´ˆê¸°í™”<br/>ë¡œê·¸ íŒŒì¼ ìƒì„±]
            N --> O[ë©”íƒ€ë°ì´í„° ì €ì¥<br/>config.json]
        end

        subgraph GraphSetup["âœ¨ 5ë‹¨ê³„: Agent ê·¸ë˜í”„ ìƒì„± (src/agent/graph.py)"]
            direction LR
            P[create_agent_graph<br/>ê·¸ë˜í”„ êµ¬ì„±] --> Q[StateGraph<br/>AgentState ê¸°ë°˜]
            Q --> R[ë…¸ë“œ ì¶”ê°€<br/>router + 7ê°œ ë„êµ¬]
            R --> S[ì—£ì§€ ì¶”ê°€<br/>ì¡°ê±´ë¶€ ë¼ìš°íŒ…]
            S --> T[workflow.compile<br/>ê·¸ë˜í”„ ì»´íŒŒì¼]
        end

        subgraph UIRender["ğŸ’¡ 6ë‹¨ê³„: UI ë Œë”ë§"]
            direction LR
            U[initialize_storage<br/>Storage ì´ˆê¸°í™”] --> V[initialize_chat_sessions<br/>ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”]
            V --> W[create_new_chat<br/>ì²« ì±„íŒ… ìë™ ìƒì„±]
            W --> X[render_sidebar<br/>ì‚¬ì´ë“œë°” ë Œë”ë§]
            X --> Y[display_chat_history<br/>íˆìŠ¤í† ë¦¬ í‘œì‹œ]
        end

        subgraph UserInput["ğŸ”· 7ë‹¨ê³„: ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ (ui/components/chat_interface.py)"]
            direction LR
            Z[st.chat_input<br/>ì…ë ¥ ëŒ€ê¸°] --> AA[ì…ë ¥ ìˆ˜ì‹ <br/>prompt]
            AA --> AB[í˜„ì¬ ì±„íŒ… ID<br/>ê°€ì ¸ì˜¤ê¸°]
            AB --> AC[ì´ì „ ë©”ì‹œì§€<br/>ë¡œë“œ]
            AC --> AD[ì‚¬ìš©ì ë©”ì‹œì§€<br/>ì¶”ê°€]
        end

        subgraph AgentInvoke["ğŸ”¸ 8ë‹¨ê³„: Agent ì‹¤í–‰ (agent_executor.invoke)"]
            direction LR
            AE[agent_executor.invoke<br/>ê·¸ë˜í”„ ì‹¤í–‰] --> AF[ì…ë ¥ ë°ì´í„°<br/>question, difficulty]
            AF --> AG[ë©”ì‹œì§€ íˆìŠ¤í† ë¦¬<br/>messages ì „ë‹¬]
            AG --> AH[Streamlit Callback<br/>ì‹¤ì‹œê°„ ë¡œê¹…]
        end

        subgraph RouterNode["ğŸ”¹ 9ë‹¨ê³„: ë¼ìš°í„° ë…¸ë“œ (src/agent/nodes.py:router_node)"]
            direction LR
            AI[router_node<br/>ë„êµ¬ ì„ íƒ] --> AJ[í‚¤ì›Œë“œ ì¶”ì¶œ<br/>íŒ¨í„´ ë§¤ì¹­]
            AJ --> AK[multi_request_patterns.yaml<br/>ë‹¤ì¤‘ ìš”ì²­ íŒ¨í„´ í™•ì¸]
            AK --> AL{ë‹¤ì¤‘ ìš”ì²­?}
            AL -->|Yes| AM[tool_pipeline ì„¤ì •<br/>5ë‹¨ê³„ íŒŒì´í”„ë¼ì¸]
            AL -->|No| AN[LLM ë¼ìš°íŒ…<br/>ë‹¨ì¼ ë„êµ¬ ì„ íƒ]
            AM --> AO[tool_choice ì„¤ì •<br/>ì²« ë²ˆì§¸ ë„êµ¬]
            AN --> AO
        end

        subgraph ToolWrapper["ğŸ”º 10ë‹¨ê³„: ë„êµ¬ ë˜í¼ (src/agent/tool_wrapper.py:wrap_tool_node)"]
            direction LR
            AP[wrap_tool_node<br/>ë„êµ¬ ì‹¤í–‰ ë˜í¼] --> AQ[ë„êµ¬ í•¨ìˆ˜ í˜¸ì¶œ<br/>ì˜ˆ: glossary_node]
            AQ --> AR[ê²°ê³¼ ê²€ì¦<br/>ì„±ê³µ/ì‹¤íŒ¨ íŒë‹¨]
            AR --> AS[tool_status ì„¤ì •<br/>success/failed]
            AS --> AT[tool_result ì €ì¥<br/>AgentStateì— ì €ì¥]
        end

        subgraph ToolExecution["ğŸ”¶ 11ë‹¨ê³„: ë„êµ¬ ì‹¤í–‰ ì˜ˆì‹œ (RAG ìš©ì–´ì§‘ ê²€ìƒ‰)"]
            direction LR
            AU[glossary_node<br/>src/tools/glossary.py] --> AV[extract_term_from_question<br/>ìš©ì–´ ì¶”ì¶œ]
            AV --> AW[SQL ê²€ìƒ‰<br/>glossary í…Œì´ë¸” ILIKE]
            AW --> AX[ë²¡í„° ê²€ìƒ‰<br/>glossary_embeddings<br/>pgvector]
            AX --> AY[í•˜ì´ë¸Œë¦¬ë“œ ë³‘í•©<br/>50% SQL + 50% Vector]
            AY --> AZ{ê²°ê³¼ ìˆìŒ?}
            AZ -->|Yes| BA[tool_result ë°˜í™˜<br/>ìš©ì–´ ì •ì˜]
            AZ -->|No| BB[tool_status: failed<br/>ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤]
        end

        subgraph DBQuery["ğŸ’¾ 12ë‹¨ê³„: DB ì¡°íšŒ (PostgreSQL + pgvector)"]
            direction LR
            BC[(PostgreSQL<br/>glossary í…Œì´ë¸”)] --> BD[SQL ì¿¼ë¦¬<br/>ILIKE íŒ¨í„´ ê²€ìƒ‰]
            BE[(PGVector<br/>glossary_embeddings)] --> BF[ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰<br/>cosine_similarity]
            BD --> BG[SQL ê²°ê³¼<br/>ì •í™•í•œ ë§¤ì¹­]
            BF --> BH[ë²¡í„° ê²°ê³¼<br/>ìœ ì‚¬ ìš©ì–´]
        end

        subgraph FallbackCheck["ğŸ”· 13ë‹¨ê³„: Fallback ì²´í¬ (src/agent/graph.py:check_pipeline_or_fallback)"]
            direction LR
            BI[check_pipeline_or_fallback<br/>ìƒíƒœ í™•ì¸] --> BJ{tool_status?}
            BJ -->|success| BK[pipeline_router<br/>ë‹¤ìŒ ë„êµ¬ë¡œ]
            BJ -->|failed| BL[fallback_router_node<br/>Fallback ì‹¤í–‰]
        end

        subgraph FallbackRouter["âœ¨ 14ë‹¨ê³„: Fallback Router (src/agent/nodes.py:fallback_router_node)"]
            direction LR
            BM[fallback_router_node<br/>ë„êµ¬ êµì²´] --> BN[TOOL_FALLBACKS ì¡°íšŒ<br/>glossary â†’ general]
            BN --> BO[tool_pipeline ìˆ˜ì •<br/>ì‹¤íŒ¨ ë„êµ¬ êµì²´]
            BO --> BP[tool_choice ì—…ë°ì´íŠ¸<br/>Fallback ë„êµ¬ ì„¤ì •]
            BP --> BQ[retry_count ì¦ê°€<br/>ì¬ì‹œë„ íšŸìˆ˜ ê´€ë¦¬]
        end

        subgraph PipelineRouter["ğŸ’¡ 15ë‹¨ê³„: Pipeline Router (src/agent/graph.py:pipeline_router)"]
            direction LR
            BR[pipeline_router<br/>ë‹¤ìŒ ë„êµ¬ ê²°ì •] --> BS{ê²€ìƒ‰ ë„êµ¬<br/>ì„±ê³µ?}
            BS -->|search_paper ì„±ê³µ| BT[ìŠ¤í‚µ ë¡œì§<br/>web_search, general ê±´ë„ˆë›°ê¸°]
            BS -->|web_search ì„±ê³µ| BU[ìŠ¤í‚µ ë¡œì§<br/>general ê±´ë„ˆë›°ê¸°]
            BS -->|ì¼ë°˜| BV[ìˆœì°¨ ì§„í–‰<br/>pipeline_index ì¦ê°€]
            BT --> BW[pipeline_index ì¡°ì •<br/>summarizeë¡œ ì§í–‰]
            BU --> BW
            BV --> BW
        end

        subgraph ToolExecution2["ğŸ”¸ 16ë‹¨ê³„: ë‹¤ìŒ ë„êµ¬ ì‹¤í–‰ (search_paper_node)"]
            direction LR
            BX[search_paper_node<br/>src/tools/search_paper.py] --> BY[RAGRetriever<br/>ì´ˆê¸°í™”]
            BY --> BZ[ë²¡í„° ê²€ìƒ‰<br/>papers_embeddings]
            BZ --> CA[í‚¤ì›Œë“œ ê²€ìƒ‰<br/>papers í…Œì´ë¸” FTS]
            CA --> CB[í•˜ì´ë¸Œë¦¬ë“œ ë³‘í•©<br/>70% Vector + 30% FTS]
            CB --> CC{ìœ ì‚¬ë„<br/>0.5 ë¯¸ë§Œ?}
            CC -->|Yes| CD[tool_result ë°˜í™˜<br/>ë…¼ë¬¸ ë³¸ë¬¸]
            CC -->|No| CE[tool_status: failed<br/>ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤]
        end

        subgraph DBQuery2["ğŸ’¾ 17ë‹¨ê³„: DB ì¡°íšŒ (papers í…Œì´ë¸”)"]
            direction LR
            CF[(PGVector<br/>papers_embeddings)] --> CG[ë²¡í„° ê²€ìƒ‰<br/>ì„ë² ë”© ìœ ì‚¬ë„]
            CH[(PostgreSQL<br/>papers í…Œì´ë¸”)] --> CI[FTS ê²€ìƒ‰<br/>Full-Text Search]
            CG --> CJ[ë²¡í„° ê²°ê³¼ 70%<br/>ì˜ë¯¸ì  ìœ ì‚¬ë„]
            CI --> CK[FTS ê²°ê³¼ 30%<br/>í‚¤ì›Œë“œ ë§¤ì¹­]
        end

        subgraph ToolExecution3["ğŸ”¹ 18ë‹¨ê³„: ìš”ì•½ ë„êµ¬ ì‹¤í–‰ (summarize_node)"]
            direction LR
            CL[summarize_node<br/>src/tools/summarize.py] --> CM{íŒŒì´í”„ë¼ì¸<br/>ëª¨ë“œ?}
            CM -->|Yes| CN[ì´ì „ tool_result ì‚¬ìš©<br/>ê²€ìƒ‰ ê²°ê³¼ í™œìš©]
            CM -->|No| CO[ì œëª© ì¶”ì¶œ í›„<br/>DB ê²€ìƒ‰]
            CN --> CP[ë‚œì´ë„ ë§¤í•‘<br/>easy â†’ elementary/beginner]
            CO --> CP
            CP --> CQ[í”„ë¡¬í”„íŠ¸ ë¡œë“œ<br/>get_summarize_template]
            CQ --> CR[LLM í˜¸ì¶œ<br/>LLMClient.generate]
        end

        subgraph LLMCall["ğŸ”º 19ë‹¨ê³„: LLM í˜¸ì¶œ (src/llm/client.py)"]
            direction LR
            CS[LLMClient.generate<br/>LLM í´ë¼ì´ì–¸íŠ¸] --> CT[ëª¨ë¸ ì„ íƒ<br/>Solar-pro2 ë˜ëŠ” GPT-5]
            CT --> CU[í”„ë¡¬í”„íŠ¸ ì¡°í•©<br/>ì‹œìŠ¤í…œ + ì‚¬ìš©ì]
            CU --> CV[OpenAI API í˜¸ì¶œ<br/>chat.completions.create]
            CV --> CW[ì‘ë‹µ ìˆ˜ì‹ <br/>generated_text]
            CW --> CX[í† í° ì‚¬ìš©ëŸ‰ ê³„ì‚°<br/>prompt + completion]
        end

        subgraph StateUpdate["ğŸ”¶ 20ë‹¨ê³„: AgentState ì—…ë°ì´íŠ¸"]
            direction LR
            CY[tool_result ì €ì¥<br/>ë„êµ¬ ì¶œë ¥] --> CZ[final_answers ì €ì¥<br/>ë‚œì´ë„ë³„ ë‹µë³€]
            CZ --> DA[tool_status ì €ì¥<br/>success/failed]
            DA --> DB[messages ì—…ë°ì´íŠ¸<br/>ëŒ€í™” íˆìŠ¤í† ë¦¬]
            DB --> DC[metadata ì €ì¥<br/>ë„êµ¬ëª…, ì´ìœ , ì‹œê°„]
        end

        subgraph EndCheck["âœ¨ 21ë‹¨ê³„: ì¢…ë£Œ ì¡°ê±´ í™•ì¸ (src/agent/graph.py:should_end)"]
            direction LR
            DD[should_end<br/>ì¢…ë£Œ íŒë‹¨] --> DE{ì¡°ê±´ í™•ì¸}
            DE -->|pipeline_index ì™„ë£Œ| DF[íŒŒì´í”„ë¼ì¸ ì™„ë£Œ<br/>END]
            DE -->|final_answers ì¡´ì¬| DF
            DE -->|retry_count ì´ˆê³¼| DF
            DE -->|ê³„ì†| DG[ë‹¤ìŒ ë„êµ¬<br/>CONTINUE]
        end

        subgraph UIDisplay["ğŸ’¡ 22ë‹¨ê³„: UI ë‹µë³€ í‘œì‹œ (ui/components/chat_interface.py)"]
            direction LR
            DH[response ìˆ˜ì‹ <br/>agent_executor ê²°ê³¼] --> DI[final_answers ì¶”ì¶œ<br/>ë‚œì´ë„ë³„ ë‹µë³€]
            DI --> DJ[ë„êµ¬ ë°°ì§€ í‘œì‹œ<br/>tool_choice]
            DJ --> DK[ì„ íƒ ì´ìœ  í‘œì‹œ<br/>routing_reason]
            DK --> DL[ë‹µë³€ í…ìŠ¤íŠ¸<br/>st.markdown]
            DL --> DM[ìš©ì–´ ì¶”ì¶œ<br/>extract_and_save_terms]
        end

        subgraph TermExtraction["ğŸ”· 23ë‹¨ê³„: ìš©ì–´ ì¶”ì¶œ ë° ì €ì¥"]
            direction LR
            DN[extract_and_save_terms<br/>ìš©ì–´ ì¶”ì¶œ] --> DO[ì •ê·œì‹ ë§¤ì¹­<br/>ê¸°ìˆ  ìš©ì–´ íŒ¨í„´]
            DO --> DP[LLM ìš©ì–´ ì¶”ì¶œ<br/>GPTë¡œ ìš©ì–´ ê°ì§€]
            DP --> DQ[DB ì €ì¥<br/>extracted_terms í…Œì´ë¸”]
            DQ --> DR[UI í‘œì‹œ<br/>ì¶”ì¶œëœ ìš©ì–´ ëª©ë¡]
        end

        subgraph Evaluation["ğŸ”¸ 24ë‹¨ê³„: ë‹µë³€ í‰ê°€ (LLM-as-a-Judge)"]
            direction LR
            DS[í‰ê°€ ì‹œì‘<br/>ì‚¬ìš©ì í´ë¦­] --> DT[LLMClient.generate<br/>í‰ê°€ í”„ë¡¬í”„íŠ¸]
            DT --> DU[í‰ê°€ ê¸°ì¤€<br/>ì •í™•ì„±/ì™„ì „ì„±/ëª…í™•ì„±]
            DU --> DV[ì ìˆ˜ ê³„ì‚°<br/>0~100ì ]
            DV --> DW[DB ì €ì¥<br/>evaluations í…Œì´ë¸”]
            DW --> DX[UI í‘œì‹œ<br/>í‰ê°€ ê²°ê³¼]
        end

        subgraph Continue["ğŸ”¹ 25ë‹¨ê³„: ê³„ì† ëŒ€í™”"]
            direction LR
            DY[ì…ë ¥ì°½ ëŒ€ê¸°<br/>st.chat_input] --> DZ{ìƒˆ ì§ˆë¬¸?}
            DZ -->|Yes| EA[7ë‹¨ê³„ë¡œ ë³µê·€<br/>ìƒˆ ì§ˆë¬¸ ì²˜ë¦¬]
            DZ -->|No| EB[ì„¸ì…˜ ìœ ì§€<br/>ëŒ€í™” íˆìŠ¤í† ë¦¬ ë³´ì¡´]
        end

        subgraph End["ğŸ’¾ 26ë‹¨ê³„: ì„¸ì…˜ ì¢…ë£Œ"]
            direction LR
            EC[ë¸Œë¼ìš°ì € íƒ­ ë‹«ê¸°] --> ED[cleanup_on_exit<br/>ì •ë¦¬ í•¨ìˆ˜ í˜¸ì¶œ]
            ED --> EE[ë¹ˆ í´ë” ì‚­ì œ<br/>experiments ì •ë¦¬]
            EE --> EF([âœ… ì¢…ë£Œ])
        end

        %% ë‹¨ê³„ ê°„ ì—°ê²°
        Init --> StreamlitStart
        StreamlitStart --> UISetup
        UISetup --> ExpMgrSetup
        ExpMgrSetup --> GraphSetup
        GraphSetup --> UIRender
        UIRender --> UserInput
        UserInput --> AgentInvoke
        AgentInvoke --> RouterNode
        RouterNode --> ToolWrapper
        ToolWrapper --> ToolExecution
        ToolExecution --> DBQuery
        DBQuery --> FallbackCheck
        FallbackCheck --> FallbackRouter
        FallbackCheck --> PipelineRouter
        FallbackRouter --> PipelineRouter
        PipelineRouter --> ToolExecution2
        ToolExecution2 --> DBQuery2
        DBQuery2 --> ToolExecution3
        ToolExecution3 --> LLMCall
        LLMCall --> StateUpdate
        StateUpdate --> EndCheck
        EndCheck --> UIDisplay
        UIDisplay --> TermExtraction
        TermExtraction --> Evaluation
        Evaluation --> Continue
        Continue --> End
        EA --> UserInput
    end

    %% ë©”ì¸ ì›Œí¬í”Œë¡œìš° ë°°ê²½
    style MainFlow fill:#fffde7,stroke:#f9a825,stroke-width:4px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼
    style Init fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style StreamlitStart fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style UISetup fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style ExpMgrSetup fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style GraphSetup fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000
    style UIRender fill:#fce4ec,stroke:#880e4f,stroke-width:3px,color:#000
    style UserInput fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style AgentInvoke fill:#e0f2f1,stroke:#00695c,stroke-width:3px,color:#000
    style RouterNode fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style ToolWrapper fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style ToolExecution fill:#e3f2fd,stroke:#0d47a1,stroke-width:3px,color:#000
    style DBQuery fill:#ede7f6,stroke:#512da8,stroke-width:3px,color:#000
    style FallbackCheck fill:#fce4ec,stroke:#880e4f,stroke-width:3px,color:#000
    style FallbackRouter fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000
    style PipelineRouter fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style ToolExecution2 fill:#e3f2fd,stroke:#0d47a1,stroke-width:3px,color:#000
    style DBQuery2 fill:#ede7f6,stroke:#512da8,stroke-width:3px,color:#000
    style ToolExecution3 fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style LLMCall fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style StateUpdate fill:#fff9c4,stroke:#f57f17,stroke-width:3px,color:#000
    style EndCheck fill:#f1f8e9,stroke:#33691e,stroke-width:3px,color:#000
    style UIDisplay fill:#e1f5fe,stroke:#0277bd,stroke-width:3px,color:#000
    style TermExtraction fill:#e0f2f1,stroke:#00695c,stroke-width:3px,color:#000
    style Evaluation fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style Continue fill:#f1f8e9,stroke:#558b2f,stroke-width:3px,color:#000
    style End fill:#e8f5e9,stroke:#2e7d32,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (1ë‹¨ê³„ - ì²­ë¡)
    style A fill:#4db6ac,stroke:#00695c,stroke-width:3px,color:#000
    style B fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style C fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style D fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (2ë‹¨ê³„ - íŒŒë‘)
    style E fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style F fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style G fill:#42a5f5,stroke:#1565c0,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (3ë‹¨ê³„ - ë³´ë¼)
    style H fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style I fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style J fill:#ef5350,stroke:#c62828,stroke-width:2px,color:#000
    style K fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (4ë‹¨ê³„ - ì£¼í™©)
    style L fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style M fill:#ffb74d,stroke:#f57c00,stroke-width:2px,color:#000
    style N fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style O fill:#ff9800,stroke:#e65100,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (5ë‹¨ê³„ - ë¹¨ê°•)
    style P fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style Q fill:#e57373,stroke:#c62828,stroke-width:2px,color:#000
    style R fill:#ef5350,stroke:#b71c1c,stroke-width:2px,color:#000
    style S fill:#f44336,stroke:#b71c1c,stroke-width:2px,color:#000
    style T fill:#e53935,stroke:#b71c1c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (6ë‹¨ê³„ - í•‘í¬)
    style U fill:#f48fb1,stroke:#ad1457,stroke-width:2px,color:#000
    style V fill:#f06292,stroke:#ad1457,stroke-width:2px,color:#000
    style W fill:#ec407a,stroke:#880e4f,stroke-width:2px,color:#000
    style X fill:#e91e63,stroke:#880e4f,stroke-width:2px,color:#000
    style Y fill:#d81b60,stroke:#880e4f,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (7ë‹¨ê³„ - ë…¹ìƒ‰)
    style Z fill:#a5d6a7,stroke:#388e3c,stroke-width:2px,color:#000
    style AA fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style AB fill:#66bb6a,stroke:#2e7d32,stroke-width:2px,color:#000
    style AC fill:#4caf50,stroke:#1b5e20,stroke-width:2px,color:#000
    style AD fill:#43a047,stroke:#1b5e20,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (8ë‹¨ê³„ - ì²­ë¡)
    style AE fill:#4dd0e1,stroke:#00838f,stroke-width:2px,color:#000
    style AF fill:#26c6da,stroke:#00838f,stroke-width:2px,color:#000
    style AG fill:#00bcd4,stroke:#00695c,stroke-width:2px,color:#000
    style AH fill:#00acc1,stroke:#00695c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (9ë‹¨ê³„ - íŒŒë‘)
    style AI fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AJ fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style AK fill:#42a5f5,stroke:#1565c0,stroke-width:2px,color:#000
    style AL fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AM fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style AN fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AO fill:#2196f3,stroke:#1565c0,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (10ë‹¨ê³„ - ë³´ë¼)
    style AP fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AQ fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style AR fill:#ba68c8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style AS fill:#ab47bc,stroke:#4a148c,stroke-width:2px,color:#000
    style AT fill:#9c27b0,stroke:#4a148c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (11ë‹¨ê³„ - íŒŒë‘)
    style AU fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AV fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style AW fill:#42a5f5,stroke:#1565c0,stroke-width:2px,color:#000
    style AX fill:#2196f3,stroke:#1565c0,stroke-width:2px,color:#000
    style AY fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AZ fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style BA fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style BB fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (12ë‹¨ê³„ - ë³´ë¼)
    style BC fill:#b39ddb,stroke:#512da8,stroke-width:2px,color:#000
    style BD fill:#9575cd,stroke:#512da8,stroke-width:2px,color:#000
    style BE fill:#b39ddb,stroke:#512da8,stroke-width:2px,color:#000
    style BF fill:#9575cd,stroke:#512da8,stroke-width:2px,color:#000
    style BG fill:#7e57c2,stroke:#4a148c,stroke-width:2px,color:#000
    style BH fill:#7e57c2,stroke:#4a148c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (13ë‹¨ê³„ - í•‘í¬)
    style BI fill:#f48fb1,stroke:#ad1457,stroke-width:2px,color:#000
    style BJ fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style BK fill:#f06292,stroke:#ad1457,stroke-width:2px,color:#000
    style BL fill:#ec407a,stroke:#880e4f,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (14ë‹¨ê³„ - ë¹¨ê°•)
    style BM fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style BN fill:#e57373,stroke:#c62828,stroke-width:2px,color:#000
    style BO fill:#ef5350,stroke:#b71c1c,stroke-width:2px,color:#000
    style BP fill:#f44336,stroke:#b71c1c,stroke-width:2px,color:#000
    style BQ fill:#e53935,stroke:#b71c1c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (15ë‹¨ê³„ - ì£¼í™©)
    style BR fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style BS fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style BT fill:#ffb74d,stroke:#f57c00,stroke-width:2px,color:#000
    style BU fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style BV fill:#ff9800,stroke:#e65100,stroke-width:2px,color:#000
    style BW fill:#fb8c00,stroke:#e65100,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (16ë‹¨ê³„ - íŒŒë‘)
    style BX fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style BY fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style BZ fill:#42a5f5,stroke:#1565c0,stroke-width:2px,color:#000
    style CA fill:#2196f3,stroke:#1565c0,stroke-width:2px,color:#000
    style CB fill:#1e88e5,stroke:#0d47a1,stroke-width:2px,color:#000
    style CC fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style CD fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style CE fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (17ë‹¨ê³„ - ë³´ë¼)
    style CF fill:#b39ddb,stroke:#512da8,stroke-width:2px,color:#000
    style CG fill:#9575cd,stroke:#512da8,stroke-width:2px,color:#000
    style CH fill:#b39ddb,stroke:#512da8,stroke-width:2px,color:#000
    style CI fill:#9575cd,stroke:#512da8,stroke-width:2px,color:#000
    style CJ fill:#7e57c2,stroke:#4a148c,stroke-width:2px,color:#000
    style CK fill:#7e57c2,stroke:#4a148c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (18ë‹¨ê³„ - ë…¹ìƒ‰)
    style CL fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style CM fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style CN fill:#66bb6a,stroke:#2e7d32,stroke-width:2px,color:#000
    style CO fill:#4caf50,stroke:#1b5e20,stroke-width:2px,color:#000
    style CP fill:#43a047,stroke:#1b5e20,stroke-width:2px,color:#000
    style CQ fill:#388e3c,stroke:#1b5e20,stroke-width:2px,color:#000
    style CR fill:#2e7d32,stroke:#1b5e20,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (19ë‹¨ê³„ - ì²­ë¡)
    style CS fill:#4dd0e1,stroke:#00838f,stroke-width:2px,color:#000
    style CT fill:#26c6da,stroke:#00838f,stroke-width:2px,color:#000
    style CU fill:#00bcd4,stroke:#00695c,stroke-width:2px,color:#000
    style CV fill:#00acc1,stroke:#00695c,stroke-width:2px,color:#000
    style CW fill:#0097a7,stroke:#006064,stroke-width:2px,color:#000
    style CX fill:#00838f,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (20ë‹¨ê³„ - ë…¸ë‘)
    style CY fill:#fff59d,stroke:#f9a825,stroke-width:2px,color:#000
    style CZ fill:#ffee58,stroke:#f57f17,stroke-width:2px,color:#000
    style DA fill:#fdd835,stroke:#f57f17,stroke-width:2px,color:#000
    style DB fill:#fbc02d,stroke:#ef6c00,stroke-width:2px,color:#000
    style DC fill:#f9a825,stroke:#ef6c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (21ë‹¨ê³„ - ì—°ë‘)
    style DD fill:#aed581,stroke:#558b2f,stroke-width:2px,color:#000
    style DE fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style DF fill:#9ccc65,stroke:#558b2f,stroke-width:2px,color:#000
    style DG fill:#8bc34a,stroke:#33691e,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (22ë‹¨ê³„ - í•˜ëŠ˜ìƒ‰)
    style DH fill:#81d4fa,stroke:#0288d1,stroke-width:2px,color:#000
    style DI fill:#4fc3f7,stroke:#0277bd,stroke-width:2px,color:#000
    style DJ fill:#29b6f6,stroke:#01579b,stroke-width:2px,color:#000
    style DK fill:#03a9f4,stroke:#01579b,stroke-width:2px,color:#000
    style DL fill:#039be5,stroke:#0277bd,stroke-width:2px,color:#000
    style DM fill:#0288d1,stroke:#01579b,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (23ë‹¨ê³„ - ì²­ë¡)
    style DN fill:#4dd0e1,stroke:#00838f,stroke-width:2px,color:#000
    style DO fill:#26c6da,stroke:#00838f,stroke-width:2px,color:#000
    style DP fill:#00bcd4,stroke:#00695c,stroke-width:2px,color:#000
    style DQ fill:#00acc1,stroke:#00695c,stroke-width:2px,color:#000
    style DR fill:#0097a7,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (24ë‹¨ê³„ - ì£¼í™©)
    style DS fill:#ffcc80,stroke:#f57c00,stroke-width:2px,color:#000
    style DT fill:#ffb74d,stroke:#f57c00,stroke-width:2px,color:#000
    style DU fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style DV fill:#ff9800,stroke:#e65100,stroke-width:2px,color:#000
    style DW fill:#fb8c00,stroke:#e65100,stroke-width:2px,color:#000
    style DX fill:#f57c00,stroke:#ef6c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (25ë‹¨ê³„ - ì—°ë‘)
    style DY fill:#aed581,stroke:#558b2f,stroke-width:2px,color:#000
    style DZ fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style EA fill:#9ccc65,stroke:#558b2f,stroke-width:2px,color:#000
    style EB fill:#8bc34a,stroke:#33691e,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (26ë‹¨ê³„ - ë…¹ìƒ‰)
    style EC fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style ED fill:#66bb6a,stroke:#2e7d32,stroke-width:2px,color:#000
    style EE fill:#4caf50,stroke:#1b5e20,stroke-width:2px,color:#000
    style EF fill:#43a047,stroke:#1b5e20,stroke-width:3px,color:#000

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (1ë‹¨ê³„ 0~2)
    linkStyle 0 stroke:#006064,stroke-width:2px
    linkStyle 1 stroke:#006064,stroke-width:2px
    linkStyle 2 stroke:#006064,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (2ë‹¨ê³„ 3~4)
    linkStyle 3 stroke:#1976d2,stroke-width:2px
    linkStyle 4 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (3ë‹¨ê³„ 5~7)
    linkStyle 5 stroke:#7b1fa2,stroke-width:2px
    linkStyle 6 stroke:#c62828,stroke-width:2px
    linkStyle 7 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (4ë‹¨ê³„ 8~10)
    linkStyle 8 stroke:#f57c00,stroke-width:2px
    linkStyle 9 stroke:#f57c00,stroke-width:2px
    linkStyle 10 stroke:#f57c00,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (5ë‹¨ê³„ 11~14)
    linkStyle 11 stroke:#c62828,stroke-width:2px
    linkStyle 12 stroke:#c62828,stroke-width:2px
    linkStyle 13 stroke:#c62828,stroke-width:2px
    linkStyle 14 stroke:#c62828,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (6ë‹¨ê³„ 15~18)
    linkStyle 15 stroke:#ad1457,stroke-width:2px
    linkStyle 16 stroke:#ad1457,stroke-width:2px
    linkStyle 17 stroke:#ad1457,stroke-width:2px
    linkStyle 18 stroke:#ad1457,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (7ë‹¨ê³„ 19~22)
    linkStyle 19 stroke:#2e7d32,stroke-width:2px
    linkStyle 20 stroke:#2e7d32,stroke-width:2px
    linkStyle 21 stroke:#2e7d32,stroke-width:2px
    linkStyle 22 stroke:#2e7d32,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (8ë‹¨ê³„ 23~25)
    linkStyle 23 stroke:#00838f,stroke-width:2px
    linkStyle 24 stroke:#00838f,stroke-width:2px
    linkStyle 25 stroke:#00838f,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (9ë‹¨ê³„ 26~32)
    linkStyle 26 stroke:#1976d2,stroke-width:2px
    linkStyle 27 stroke:#1976d2,stroke-width:2px
    linkStyle 28 stroke:#1976d2,stroke-width:2px
    linkStyle 29 stroke:#1976d2,stroke-width:2px
    linkStyle 30 stroke:#1976d2,stroke-width:2px
    linkStyle 31 stroke:#1976d2,stroke-width:2px
    linkStyle 32 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (10ë‹¨ê³„ 33~36)
    linkStyle 33 stroke:#7b1fa2,stroke-width:2px
    linkStyle 34 stroke:#7b1fa2,stroke-width:2px
    linkStyle 35 stroke:#7b1fa2,stroke-width:2px
    linkStyle 36 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (11ë‹¨ê³„ 37~43)
    linkStyle 37 stroke:#1976d2,stroke-width:2px
    linkStyle 38 stroke:#1976d2,stroke-width:2px
    linkStyle 39 stroke:#1976d2,stroke-width:2px
    linkStyle 40 stroke:#1976d2,stroke-width:2px
    linkStyle 41 stroke:#1976d2,stroke-width:2px
    linkStyle 42 stroke:#1976d2,stroke-width:2px
    linkStyle 43 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (12ë‹¨ê³„ 44~49)
    linkStyle 44 stroke:#512da8,stroke-width:2px
    linkStyle 45 stroke:#512da8,stroke-width:2px
    linkStyle 46 stroke:#512da8,stroke-width:2px
    linkStyle 47 stroke:#512da8,stroke-width:2px
    linkStyle 48 stroke:#512da8,stroke-width:2px
    linkStyle 49 stroke:#512da8,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (13ë‹¨ê³„ 50~52)
    linkStyle 50 stroke:#ad1457,stroke-width:2px
    linkStyle 51 stroke:#ad1457,stroke-width:2px
    linkStyle 52 stroke:#880e4f,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (14ë‹¨ê³„ 53~56)
    linkStyle 53 stroke:#c62828,stroke-width:2px
    linkStyle 54 stroke:#c62828,stroke-width:2px
    linkStyle 55 stroke:#c62828,stroke-width:2px
    linkStyle 56 stroke:#c62828,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (15ë‹¨ê³„ 57~62)
    linkStyle 57 stroke:#f57c00,stroke-width:2px
    linkStyle 58 stroke:#f57c00,stroke-width:2px
    linkStyle 59 stroke:#f57c00,stroke-width:2px
    linkStyle 60 stroke:#f57c00,stroke-width:2px
    linkStyle 61 stroke:#f57c00,stroke-width:2px
    linkStyle 62 stroke:#f57c00,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (16ë‹¨ê³„ 63~69)
    linkStyle 63 stroke:#1976d2,stroke-width:2px
    linkStyle 64 stroke:#1976d2,stroke-width:2px
    linkStyle 65 stroke:#1976d2,stroke-width:2px
    linkStyle 66 stroke:#1976d2,stroke-width:2px
    linkStyle 67 stroke:#1976d2,stroke-width:2px
    linkStyle 68 stroke:#1976d2,stroke-width:2px
    linkStyle 69 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (17ë‹¨ê³„ 70~75)
    linkStyle 70 stroke:#512da8,stroke-width:2px
    linkStyle 71 stroke:#512da8,stroke-width:2px
    linkStyle 72 stroke:#512da8,stroke-width:2px
    linkStyle 73 stroke:#512da8,stroke-width:2px
    linkStyle 74 stroke:#512da8,stroke-width:2px
    linkStyle 75 stroke:#512da8,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (18ë‹¨ê³„ 76~82)
    linkStyle 76 stroke:#2e7d32,stroke-width:2px
    linkStyle 77 stroke:#2e7d32,stroke-width:2px
    linkStyle 78 stroke:#2e7d32,stroke-width:2px
    linkStyle 79 stroke:#2e7d32,stroke-width:2px
    linkStyle 80 stroke:#2e7d32,stroke-width:2px
    linkStyle 81 stroke:#2e7d32,stroke-width:2px
    linkStyle 82 stroke:#2e7d32,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (19ë‹¨ê³„ 83~86)
    linkStyle 83 stroke:#00838f,stroke-width:2px
    linkStyle 84 stroke:#00838f,stroke-width:2px
    linkStyle 85 stroke:#00838f,stroke-width:2px
    linkStyle 86 stroke:#00838f,stroke-width:2px
```

---

## ì „ì²´ íë¦„ ìš”ì•½ í‘œ

ì•„ë˜ í‘œëŠ” main.pyë¶€í„° ì‹œì‘ë˜ëŠ” ì „ì²´ ì‹œìŠ¤í…œ ì‹¤í–‰ íë¦„ì„ ë‹¨ê³„ë³„ë¡œ ì •ë¦¬í•œ ê²ƒì…ë‹ˆë‹¤.

| ë‹¨ê³„ | ë„êµ¬/ì»´í¬ë„ŒíŠ¸ëª… | íŒŒì¼ëª… | ë©”ì„œë“œëª… | ë™ì‘ ì„¤ëª… | ì…ë ¥ | ì¶œë ¥ | Fallback | ì„¸ì…˜ ì €ì¥ |
|------|-----------------|--------|----------|-----------|------|------|----------|----------|
| **1** | **í”„ë¡œê·¸ë¨ ì‹œì‘** | `main.py` | `main()`, `load_dotenv()` | .env íŒŒì¼ ë¡œë“œ í›„ Streamlit ì„œë²„ ì‹œì‘ | ì—†ìŒ | í™˜ê²½ë³€ìˆ˜ ë¡œë“œ ì™„ë£Œ | ì—†ìŒ | ì—†ìŒ |
| **2** | **Streamlit ì„œë²„** | `main.py` | `subprocess.run()` | Streamlit ì•± ì‹¤í–‰ (port 8501) | `ui/app.py` ê²½ë¡œ | ë¸Œë¼ìš°ì € localhost:8501 ì—´ë¦¼ | ì—†ìŒ | ì—†ìŒ |
| **3** | **UI ì´ˆê¸°í™”** | `ui/app.py` | `st.set_page_config()`, `initialize_agent()` | í˜ì´ì§€ ì„¤ì • ë° í™˜ê²½ë³€ìˆ˜ ê²€ì¦ | OPENAI_API_KEY í™•ì¸ | Agent ë° ExpManager ìƒì„± | ì—†ìŒ | `st.session_state` |
| **4** | **ExperimentManager** | `src/utils/experiment_manager.py` | `__init__()`, `Logger.write()` | ì‹¤í—˜ í´ë” ìƒì„± (experiments/YYYYMMDD/ID) | ì—†ìŒ | ë¡œê·¸ íŒŒì¼ ìƒì„±, config.json ì €ì¥ | ì—†ìŒ | ë¡œì»¬ íŒŒì¼ |
| **5** | **Agent ê·¸ë˜í”„ ìƒì„±** | `src/agent/graph.py` | `create_agent_graph()`, `StateGraph()`, `workflow.compile()` | LangGraph ê·¸ë˜í”„ êµ¬ì„± (router + 7ê°œ ë„êµ¬ ë…¸ë“œ) | `exp_manager` | ì»´íŒŒì¼ëœ Agent ê·¸ë˜í”„ | ì—†ìŒ | ë©”ëª¨ë¦¬ |
| **6** | **UI ë Œë”ë§** | `ui/app.py` | `initialize_storage()`, `initialize_chat_sessions()`, `create_new_chat()`, `render_sidebar()` | Storage ë° ì±„íŒ… ì„¸ì…˜ ì´ˆê¸°í™” | ì—†ìŒ | ì²« ì±„íŒ… ìë™ ìƒì„± ì™„ë£Œ | ì—†ìŒ | `st.session_state` |
| **7** | **ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬** | `ui/components/chat_interface.py` | `st.chat_input()`, `render_chat_input()` | ì‚¬ìš©ì ì§ˆë¬¸ ìˆ˜ì‹  ë° ë©”ì‹œì§€ ì¶”ê°€ | ì‚¬ìš©ì prompt | ì±„íŒ… íˆìŠ¤í† ë¦¬ì— ë©”ì‹œì§€ ì¶”ê°€ | ì—†ìŒ | `st.session_state.chats` |
| **8** | **Agent ì‹¤í–‰** | `ui/components/chat_interface.py` | `agent_executor.invoke()` | LangGraph ê·¸ë˜í”„ ì‹¤í–‰ ì‹œì‘ | `question`, `difficulty`, `messages` | AgentState ë°˜í™˜ | ì—†ìŒ | ì—†ìŒ |
| **9** | **ë¼ìš°í„° ë…¸ë“œ** | `src/agent/nodes.py` | `router_node()`, `extract_keywords()` | ë‹¤ì¤‘ ìš”ì²­ íŒ¨í„´ í™•ì¸ ë° ë„êµ¬ ì„ íƒ | `question`, `multi_request_patterns.yaml` | `tool_choice`, `tool_pipeline`, `routing_reason` | ì—†ìŒ | `AgentState` |
| **10** | **ë„êµ¬ ë˜í¼** | `src/agent/tool_wrapper.py` | `wrap_tool_node()` | ë„êµ¬ ì‹¤í–‰ ì „ ë˜í¼ ì ìš© | ë„êµ¬ í•¨ìˆ˜ | `tool_status`, `tool_result` ì„¤ì • | ì—†ìŒ | `AgentState` |
| **11-A** | **RAG ìš©ì–´ì§‘ ê²€ìƒ‰** | `src/tools/glossary.py` | `glossary_node()`, `extract_term_from_question()`, `hybrid_search()` | SQL(ILIKE) + Vector í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (50%+50%) | `question` | ìš©ì–´ ì •ì˜ ë˜ëŠ” ì‹¤íŒ¨ | **ì¼ë°˜ ë‹µë³€** | `AgentState.tool_result` |
| **11-A-F** | **ì¼ë°˜ ë‹µë³€ (Fallback)** | `src/tools/general.py` | `general_node()`, `get_general_template()`, `LLMClient.generate()` | LLMìœ¼ë¡œ ì§ì ‘ ë‹µë³€ ìƒì„± | `question`, `difficulty` | ì¼ë°˜ ë‹µë³€ í…ìŠ¤íŠ¸ | ì—†ìŒ | `AgentState.final_answers` |
| **12** | **DB ì¡°íšŒ (glossary)** | `src/db/rag_retriever.py` | `hybrid_search()`, `sql_search()`, `vector_search()` | PostgreSQL glossary í…Œì´ë¸” + pgvector ê²€ìƒ‰ | ì¶”ì¶œëœ ìš©ì–´ | SQL ê²°ê³¼ + ë²¡í„° ê²°ê³¼ ë³‘í•© | ì—†ìŒ | ì—†ìŒ |
| **13** | **Fallback ì²´í¬** | `src/agent/graph.py` | `check_pipeline_or_fallback()` | `tool_status` í™•ì¸í•˜ì—¬ Fallback ë˜ëŠ” Pipeline ì§„í–‰ | `tool_status` | `pipeline_router` ë˜ëŠ” `fallback_router_node` | ì—†ìŒ | ì—†ìŒ |
| **14** | **Fallback Router** | `src/agent/nodes.py` | `fallback_router_node()`, `TOOL_FALLBACKS.get()` | ì‹¤íŒ¨í•œ ë„êµ¬ë¥¼ Fallback ë„êµ¬ë¡œ êµì²´ (glossaryâ†’general) | `tool_choice`, `TOOL_FALLBACKS` | `tool_pipeline` ìˆ˜ì •, `retry_count` ì¦ê°€ | ì—†ìŒ | `AgentState` |
| **15** | **Pipeline Router** | `src/agent/graph.py` | `pipeline_router()` | ê²€ìƒ‰ ì„±ê³µ ì‹œ ìŠ¤í‚µ ë¡œì§ ì ìš© (search_paperâ†’summarize ì§í–‰) | `tool_status`, `pipeline_index` | ë‹¤ìŒ ë„êµ¬ ì„ íƒ ë˜ëŠ” ìŠ¤í‚µ | ì—†ìŒ | `AgentState` |
| **16-A** | **RAG ë…¼ë¬¸ ê²€ìƒ‰** | `src/tools/search_paper.py` | `search_paper_node()`, `RAGRetriever()`, `hybrid_search()` | Vector(70%) + FTS(30%) í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ | `question` | ë…¼ë¬¸ ë³¸ë¬¸ ë˜ëŠ” ì‹¤íŒ¨ | **Web ë…¼ë¬¸ ê²€ìƒ‰** | `AgentState.tool_result` |
| **16-A-F1** | **Web ë…¼ë¬¸ ê²€ìƒ‰ (Fallback 1)** | `src/tools/web_search.py` | `web_search_node()`, `TavilySearchResults()` | Tavily APIë¡œ ì›¹ ê²€ìƒ‰ | `question` | ì›¹ ê²€ìƒ‰ ê²°ê³¼ ë˜ëŠ” ì‹¤íŒ¨ | **ì¼ë°˜ ë‹µë³€** | `AgentState.tool_result` |
| **16-A-F2** | **ì¼ë°˜ ë‹µë³€ (Fallback 2)** | `src/tools/general.py` | `general_node()`, `get_general_template()`, `LLMClient.generate()` | LLMìœ¼ë¡œ ì§ì ‘ ë‹µë³€ ìƒì„± | `question`, `difficulty` | ì¼ë°˜ ë‹µë³€ í…ìŠ¤íŠ¸ | ì—†ìŒ | `AgentState.final_answers` |
| **17** | **DB ì¡°íšŒ (papers)** | `src/db/rag_retriever.py` | `hybrid_search()`, `vector_search()`, `fts_search()` | PostgreSQL papers í…Œì´ë¸” + pgvector ê²€ìƒ‰ | ì§ˆë¬¸ ì„ë² ë”© | Vector 70% + FTS 30% ë³‘í•© ê²°ê³¼ | ì—†ìŒ | ì—†ìŒ |
| **18** | **ë…¼ë¬¸ ìš”ì•½** | `src/tools/summarize.py` | `summarize_node()`, `get_summarize_template()`, `LLMClient.generate()` | íŒŒì´í”„ë¼ì¸ ëª¨ë“œ: ì´ì „ tool_result í™œìš©í•˜ì—¬ ìš”ì•½ | ê²€ìƒ‰ëœ ë…¼ë¬¸ ë³¸ë¬¸, `difficulty` | ë‚œì´ë„ë³„ ë…¼ë¬¸ ìš”ì•½ | **ì¼ë°˜ ë‹µë³€** | `AgentState.final_answers` |
| **18-F** | **ì¼ë°˜ ë‹µë³€ (Fallback)** | `src/tools/general.py` | `general_node()`, `get_general_template()`, `LLMClient.generate()` | ìš”ì•½ ì‹¤íŒ¨ ì‹œ ì¼ë°˜ ë‹µë³€ ìƒì„± | `question`, `difficulty` | ì¼ë°˜ ë‹µë³€ í…ìŠ¤íŠ¸ | ì—†ìŒ | `AgentState.final_answers` |
| **19** | **LLM í˜¸ì¶œ** | `src/llm/client.py` | `LLMClient.generate()`, `chat.completions.create()` | OpenAI API í˜¸ì¶œ (Solar-pro2 ë˜ëŠ” GPT-5) | ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ + ì‚¬ìš©ì ì§ˆë¬¸ | `generated_text`, í† í° ì‚¬ìš©ëŸ‰ | ì—†ìŒ | ì—†ìŒ |
| **20** | **AgentState ì—…ë°ì´íŠ¸** | `src/agent/graph.py` | (LangGraph ìë™) | `tool_result`, `final_answers`, `tool_status`, `messages`, `metadata` ì—…ë°ì´íŠ¸ | ë„êµ¬ ì¶œë ¥ | AgentState ê°±ì‹  | ì—†ìŒ | ë©”ëª¨ë¦¬ |
| **21** | **ì¢…ë£Œ ì¡°ê±´ í™•ì¸** | `src/agent/graph.py` | `should_end()` | `pipeline_index` ì™„ë£Œ, `final_answers` ì¡´ì¬, `retry_count` ì´ˆê³¼ í™•ì¸ | `AgentState` | `END` ë˜ëŠ” `CONTINUE` | ì—†ìŒ | ì—†ìŒ |
| **22** | **UI ë‹µë³€ í‘œì‹œ** | `ui/components/chat_interface.py` | `render_chat_input()`, `st.markdown()` | ë‚œì´ë„ë³„ ë‹µë³€, ë„êµ¬ ë°°ì§€, ì„ íƒ ì´ìœ  í‘œì‹œ | `response.final_answers` | ì±„íŒ… UIì— ë‹µë³€ ë Œë”ë§ | ì—†ìŒ | `st.session_state.chats` |
| **23** | **ìš©ì–´ ì¶”ì¶œ ë° ì €ì¥** | `ui/components/chat_interface.py` | `extract_and_save_terms()`, ì •ê·œì‹ ë§¤ì¹­, LLM ì¶”ì¶œ | ë‹µë³€ì—ì„œ ê¸°ìˆ  ìš©ì–´ ì¶”ì¶œ í›„ DB ì €ì¥ | ë‹µë³€ í…ìŠ¤íŠ¸ | `extracted_terms` í…Œì´ë¸”ì— INSERT | ì—†ìŒ | PostgreSQL DB |
| **24** | **ë‹µë³€ í‰ê°€** | `ui/components/chat_interface.py` | `LLMClient.generate()` (í‰ê°€ í”„ë¡¬í”„íŠ¸) | LLM-as-a-Judgeë¡œ ì •í™•ì„±/ì™„ì „ì„±/ëª…í™•ì„± í‰ê°€ | ì§ˆë¬¸ + ë‹µë³€ | í‰ê°€ ì ìˆ˜(0~100), `evaluations` í…Œì´ë¸” ì €ì¥ | ì—†ìŒ | PostgreSQL DB |
| **25** | **ê³„ì† ëŒ€í™”** | `ui/components/chat_interface.py` | `st.chat_input()` | ìƒˆ ì§ˆë¬¸ ëŒ€ê¸°, ìˆìœ¼ë©´ 7ë‹¨ê³„ë¡œ ë³µê·€ | ìƒˆ ì§ˆë¬¸ ë˜ëŠ” ì—†ìŒ | 7ë‹¨ê³„ë¡œ ë³µê·€ ë˜ëŠ” ì„¸ì…˜ ìœ ì§€ | ì—†ìŒ | `st.session_state` |
| **26** | **ì„¸ì…˜ ì¢…ë£Œ** | `ui/app.py` | `cleanup_on_exit()`, `atexit.register()` | ë¸Œë¼ìš°ì € íƒ­ ë‹«ê¸° ì‹œ ë¹ˆ í´ë” ì •ë¦¬ | `experiments/` í´ë” | ë¹ˆ í´ë” ì‚­ì œ ì™„ë£Œ | ì—†ìŒ | ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œ |

### í‘œ ì„¤ëª…

- **ë‹¨ê³„**: ì‹¤í–‰ ìˆœì„œ (1~26ë‹¨ê³„)
- **Fallback í‘œê¸°**:
  - `11-A`: ìš©ì–´ì§‘ ê²€ìƒ‰ (ë©”ì¸)
  - `11-A-F`: ìš©ì–´ì§‘ ì‹¤íŒ¨ ì‹œ Fallback (ì¼ë°˜ ë‹µë³€)
  - `16-A`: ë…¼ë¬¸ ê²€ìƒ‰ (ë©”ì¸)
  - `16-A-F1`: ë…¼ë¬¸ ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ Fallback 1ë‹¨ê³„ (Web ê²€ìƒ‰)
  - `16-A-F2`: Web ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ Fallback 2ë‹¨ê³„ (ì¼ë°˜ ë‹µë³€)
- **ì„¸ì…˜ ì €ì¥**: ê° ë‹¨ê³„ì˜ ê²°ê³¼ê°€ ì €ì¥ë˜ëŠ” ìœ„ì¹˜ (ë©”ëª¨ë¦¬, DB, íŒŒì¼ ë“±)

---

## ë‹¨ê³„ë³„ ì›Œí¬í”Œë¡œìš° ìƒì„¸ ì„¤ëª… (ì´ˆë³´ ê°œë°œììš©)

ì•„ë˜ëŠ” ê° ë‹¨ê³„ê°€ **ì–¸ì œ, ì™œ, ì–´ë–»ê²Œ** ì‹¤í–‰ë˜ëŠ”ì§€ë¥¼ ì´ˆë³´ ê°œë°œìë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ìƒì„¸íˆ ì„¤ëª…í•œ ê²ƒì…ë‹ˆë‹¤.

### ğŸš€ Phase 1: í”„ë¡œê·¸ë¨ ì‹œì‘ ë° ì´ˆê¸°í™” (1~6ë‹¨ê³„)

<details>
<summary><strong>1ë‹¨ê³„: í”„ë¡œê·¸ë¨ ì‹œì‘</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- í„°ë¯¸ë„ì—ì„œ `python main.py` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ ê°€ì¥ ë¨¼ì € ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `.env` íŒŒì¼ì— ì €ì¥ëœ í™˜ê²½ë³€ìˆ˜(API í‚¤, DB ì ‘ì† ì •ë³´ ë“±)ë¥¼ ë©”ëª¨ë¦¬ì— ë¡œë“œí•©ë‹ˆë‹¤.
- `load_dotenv()` í•¨ìˆ˜ê°€ `.env` íŒŒì¼ì„ ì½ì–´ì„œ `os.getenv()`ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- OpenAI API í‚¤ë‚˜ PostgreSQL ë¹„ë°€ë²ˆí˜¸ ê°™ì€ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì½”ë“œì— ì§ì ‘ ì“°ì§€ ì•Šê³  ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# main.py
from dotenv import load_dotenv
load_dotenv()  # .env íŒŒì¼ ë¡œë“œ
```

</details>

<details>
<summary><strong>2ë‹¨ê³„: Streamlit ì„œë²„ ì‹œì‘</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 1ë‹¨ê³„ì—ì„œ í™˜ê²½ë³€ìˆ˜ ë¡œë“œê°€ ì™„ë£Œëœ ì§í›„ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `subprocess.run()` í•¨ìˆ˜ë¡œ ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ Streamlit ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.
- ì„œë²„ëŠ” `localhost:8501` í¬íŠ¸ì—ì„œ ì‹¤í–‰ë˜ë©°, ìë™ìœ¼ë¡œ ë¸Œë¼ìš°ì €ê°€ ì—´ë¦½ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ì‚¬ìš©ìê°€ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì±—ë´‡ê³¼ ëŒ€í™”í•  ìˆ˜ ìˆëŠ” UIë¥¼ ì œê³µí•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# main.py
subprocess.run(["streamlit", "run", "ui/app.py"])
```

</details>

<details>
<summary><strong>3ë‹¨ê³„: UI ì´ˆê¸°í™”</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- Streamlit ì„œë²„ê°€ ì‹œì‘ë˜ê³  ë¸Œë¼ìš°ì €ì—ì„œ í˜ì´ì§€ë¥¼ ë¡œë“œí•  ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `st.set_page_config()`ë¡œ í˜ì´ì§€ ì œëª©, ì•„ì´ì½˜, ë ˆì´ì•„ì›ƒì„ ì„¤ì •í•©ë‹ˆë‹¤.
- í™˜ê²½ë³€ìˆ˜ ê²€ì¦: `OPENAI_API_KEY`ê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ê³  ì•±ì„ ì¤‘ì§€í•©ë‹ˆë‹¤.
- `initialize_agent()` í•¨ìˆ˜ë¡œ Agentì™€ ExperimentManagerë¥¼ ìƒì„±í•©ë‹ˆë‹¤ (ìºì‹±ë¨).

**ì™œ í•„ìš”í•œê°€ìš”?**
- API í‚¤ê°€ ì—†ìœ¼ë©´ LLMì„ í˜¸ì¶œí•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ì•± ì‹œì‘ ì „ì— ê²€ì¦í•´ì•¼ í•©ë‹ˆë‹¤.
- Agentë¥¼ ë§¤ë²ˆ ìƒˆë¡œ ìƒì„±í•˜ë©´ ëŠë¦¬ë¯€ë¡œ, ìºì‹±í•˜ì—¬ ì¬ì‚¬ìš©í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# ui/app.py
st.set_page_config(page_title="ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡", page_icon="ğŸ“š")
if not os.getenv("OPENAI_API_KEY"):
    st.error("âŒ API í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤")
    st.stop()
```

</details>

<details>
<summary><strong>4ë‹¨ê³„: ExperimentManager ìƒì„±</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 3ë‹¨ê³„ì˜ `initialize_agent()` í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- ì‹¤í—˜ í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤: `experiments/20250108/exp_001/` (ë‚ ì§œì™€ IDë¡œ êµ¬ë¶„)
- ë¡œê·¸ íŒŒì¼(`log.txt`)ê³¼ ì„¤ì • íŒŒì¼(`config.json`)ì„ ìƒì„±í•©ë‹ˆë‹¤.
- ëª¨ë“  ì‹¤í—˜ ë°ì´í„°ë¥¼ ì´ í´ë”ì— ì €ì¥í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ì—¬ëŸ¬ ì‹¤í—˜ì„ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³ , ë‚˜ì¤‘ì— ê²°ê³¼ë¥¼ ë¹„êµ/ë¶„ì„í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.
- ë¡œê·¸ë¥¼ í†µí•´ ë¬¸ì œê°€ ë°œìƒí–ˆì„ ë•Œ ë””ë²„ê¹…ì´ ì‰¬ì›Œì§‘ë‹ˆë‹¤.

**ì‹¤ì œ í´ë” êµ¬ì¡°:**
```
experiments/
â””â”€â”€ 20250108/
    â”œâ”€â”€ exp_001/
    â”‚   â”œâ”€â”€ log.txt
    â”‚   â””â”€â”€ config.json
    â””â”€â”€ exp_002/
        â”œâ”€â”€ log.txt
        â””â”€â”€ config.json
```

</details>

<details>
<summary><strong>5ë‹¨ê³„: Agent ê·¸ë˜í”„ ìƒì„±</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 4ë‹¨ê³„ì—ì„œ ExperimentManager ìƒì„± ì§í›„ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- LangGraphì˜ `StateGraph`ë¥¼ ì‚¬ìš©í•˜ì—¬ Agentì˜ ì‹¤í–‰ íë¦„ì„ ì •ì˜í•©ë‹ˆë‹¤.
- ë…¸ë“œ ì¶”ê°€: `router_node`, `glossary_node`, `search_paper_node` ë“± 8ê°œ ë…¸ë“œ
- ì—£ì§€ ì¶”ê°€: ë…¸ë“œ ê°„ ì—°ê²° (ì¡°ê±´ë¶€ ë¼ìš°íŒ… í¬í•¨)
- `workflow.compile()`ë¡œ ê·¸ë˜í”„ë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ì»´íŒŒì¼í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- Agentê°€ ì§ˆë¬¸ì„ ë°›ì•˜ì„ ë•Œ ì–´ë–¤ ìˆœì„œë¡œ ë„êµ¬ë¥¼ ì‹¤í–‰í• ì§€ ë¯¸ë¦¬ ì •ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
- ê·¸ë˜í”„ êµ¬ì¡°ë¡œ í‘œí˜„í•˜ë©´ ë³µì¡í•œ ë¡œì§ë„ ì‹œê°ì ìœ¼ë¡œ ì´í•´í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# src/agent/graph.py
workflow = StateGraph(AgentState)
workflow.add_node("router", router_node)
workflow.add_node("glossary", glossary_node)
workflow.add_edge("router", "glossary")
agent = workflow.compile()
```

</details>

<details>
<summary><strong>6ë‹¨ê³„: UI ë Œë”ë§</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 5ë‹¨ê³„ì—ì„œ Agent ê·¸ë˜í”„ ìƒì„± ì™„ë£Œ í›„, í˜ì´ì§€ë¥¼ ì²˜ìŒ ë¡œë“œí•  ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `initialize_storage()`: Storage ì´ˆê¸°í™” (ì±„íŒ… ë°ì´í„° ì €ì¥ìš©)
- `initialize_chat_sessions()`: ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™” (`st.session_state.chats = {}`)
- `create_new_chat()`: ì²« ë²ˆì§¸ ì±„íŒ…ì„ ìë™ìœ¼ë¡œ ìƒì„± (ë‚œì´ë„: easy)
- `render_sidebar()`: ì‚¬ì´ë“œë°”ì— ë‚œì´ë„ ì„ íƒ, ì±„íŒ… ëª©ë¡ í‘œì‹œ

**ì™œ í•„ìš”í•œê°€ìš”?**
- ì‚¬ìš©ìê°€ í˜ì´ì§€ë¥¼ ì—´ìë§ˆì ë°”ë¡œ ëŒ€í™”ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆë„ë¡ ì¤€ë¹„í•©ë‹ˆë‹¤.
- ì—¬ëŸ¬ ì±„íŒ… ì„¸ì…˜ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì´ˆê¸° êµ¬ì¡°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

**ì‹¤ì œ í™”ë©´:**
```
ì‚¬ì´ë“œë°”: [ìƒˆ ì±„íŒ…] [ë‚œì´ë„: Easy] [ì±„íŒ… 1, ì±„íŒ… 2, ...]
ë©”ì¸ í™”ë©´: ì±„íŒ… ì…ë ¥ì°½ (ë¹„ì–´ìˆìŒ)
```

</details>

---

### ğŸ’¬ Phase 2: ì‚¬ìš©ì ì…ë ¥ ë° Agent ì‹¤í–‰ (7~10ë‹¨ê³„)

<details>
<summary><strong>7ë‹¨ê³„: ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ì‚¬ìš©ìê°€ ì±„íŒ… ì…ë ¥ì°½ì— ì§ˆë¬¸ì„ ì…ë ¥í•˜ê³  Enterë¥¼ ëˆ„ë¥¼ ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `st.chat_input()`ìœ¼ë¡œ ì‚¬ìš©ì ì…ë ¥ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤.
- í˜„ì¬ ì±„íŒ… IDë¥¼ ê°€ì ¸ì™€ì„œ í•´ë‹¹ ì±„íŒ…ì˜ ë©”ì‹œì§€ íˆìŠ¤í† ë¦¬ì— ì‚¬ìš©ì ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
- ì´ì „ ëŒ€í™” ë‚´ì—­ë„ í•¨ê»˜ ë¡œë“œí•˜ì—¬ Agentì— ì „ë‹¬í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- Agentê°€ ì´ì „ ëŒ€í™” ë§¥ë½ì„ ì´í•´í•˜ê³  ì—°ì†ì ì¸ ëŒ€í™”ë¥¼ í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
- ì—¬ëŸ¬ ì±„íŒ… ì„¸ì…˜ì„ êµ¬ë¶„í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# ui/components/chat_interface.py
user_input = st.chat_input("ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”")
if user_input:
    st.session_state.chats[chat_id]["messages"].append({
        "role": "user",
        "content": user_input
    })
```

</details>

<details>
<summary><strong>8ë‹¨ê³„: Agent ì‹¤í–‰</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 7ë‹¨ê³„ì—ì„œ ì‚¬ìš©ì ë©”ì‹œì§€ê°€ ì¶”ê°€ëœ ì§í›„ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `agent_executor.invoke()`ë¡œ LangGraph ê·¸ë˜í”„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
- ì…ë ¥ ë°ì´í„°: `question` (ì‚¬ìš©ì ì§ˆë¬¸), `difficulty` (ë‚œì´ë„), `messages` (ëŒ€í™” íˆìŠ¤í† ë¦¬)
- Streamlit Callbackì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¡œê·¸ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- Agentì˜ ì‹¤í–‰ì„ ì‹œì‘í•˜ëŠ” ì§„ì…ì ì…ë‹ˆë‹¤.
- ì…ë ¥ ë°ì´í„°ë¥¼ AgentStateì— ì „ë‹¬í•˜ì—¬ ëª¨ë“  ë…¸ë“œì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# ui/components/chat_interface.py
response = agent_executor.invoke({
    "question": user_input,
    "difficulty": difficulty,
    "messages": previous_messages
})
```

</details>

<details>
<summary><strong>9ë‹¨ê³„: ë¼ìš°í„° ë…¸ë“œ</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- Agent ì‹¤í–‰ ì‹œ ê°€ì¥ ë¨¼ì € ì‹¤í–‰ë˜ëŠ” ë…¸ë“œì…ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì–´ë–¤ ë„êµ¬ë¥¼ ì‚¬ìš©í• ì§€ ê²°ì •í•©ë‹ˆë‹¤.
- **ë‹¤ì¤‘ ìš”ì²­ íŒ¨í„´ í™•ì¸**: `multi_request_patterns.yaml` íŒŒì¼ì—ì„œ íŒ¨í„´ì„ ì°¾ìŠµë‹ˆë‹¤.
  - ì˜ˆ: "ë…¼ë¬¸ ê²€ìƒ‰ í›„ ìš”ì•½í•´ì¤˜" â†’ `[search_paper, summarize]` íŒŒì´í”„ë¼ì¸
- **ë‹¨ì¼ ìš”ì²­**: LLMì„ ì‚¬ìš©í•˜ì—¬ ê°€ì¥ ì í•©í•œ ë„êµ¬ 1ê°œë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
- ê²°ê³¼: `tool_choice`, `tool_pipeline`, `routing_reason`ì„ AgentStateì— ì €ì¥

**ì™œ í•„ìš”í•œê°€ìš”?**
- ì§ˆë¬¸ì— ë”°ë¼ ë‹¤ë¥¸ ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ë¯€ë¡œ, ë¼ìš°íŒ… ë¡œì§ì´ í•„ìš”í•©ë‹ˆë‹¤.
- ë‹¤ì¤‘ ìš”ì²­ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ì—¬ ì—¬ëŸ¬ ë„êµ¬ë¥¼ ìˆœì°¨ ì‹¤í–‰í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì˜ˆì‹œ:**
```
ì§ˆë¬¸: "Transformerê°€ ë­ì•¼?"
â†’ ë¼ìš°í„° íŒë‹¨: glossary (ìš©ì–´ì§‘ ê²€ìƒ‰)

ì§ˆë¬¸: "Attention ë…¼ë¬¸ ì°¾ì•„ì„œ ìš”ì•½í•´ì¤˜"
â†’ ë¼ìš°í„° íŒë‹¨: [search_paper, summarize] íŒŒì´í”„ë¼ì¸
```

</details>

<details>
<summary><strong>10ë‹¨ê³„: ë„êµ¬ ë˜í¼</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ë¼ìš°í„°ê°€ ë„êµ¬ë¥¼ ì„ íƒí•œ ì§í›„, ì‹¤ì œ ë„êµ¬ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— ë˜í¼ê°€ ê°ì‹¸ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- ì„ íƒëœ ë„êµ¬ í•¨ìˆ˜(ì˜ˆ: `glossary_node`)ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
- ë„êµ¬ ì‹¤í–‰ ê²°ê³¼ë¥¼ ê²€ì¦í•©ë‹ˆë‹¤ (ì„±ê³µ/ì‹¤íŒ¨ íŒë‹¨).
- `tool_status`ë¥¼ ìë™ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤ (`success` ë˜ëŠ” `failed`).
- `tool_result`ë¥¼ AgentStateì— ì €ì¥í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ëª¨ë“  ë„êµ¬ì— ê³µí†µì ìœ¼ë¡œ ì ìš©ë˜ëŠ” ë¡œì§(ìƒíƒœ ì„¤ì •, ê²°ê³¼ ì €ì¥)ì„ ì¤‘ë³µ ì—†ì´ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- ë„êµ¬ê°€ ì‹¤íŒ¨í–ˆì„ ë•Œ ìë™ìœ¼ë¡œ Fallbackì„ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# src/agent/tool_wrapper.py
def wrap_tool_node(tool_func):
    def wrapper(state: AgentState):
        result = tool_func(state)  # ë„êµ¬ ì‹¤í–‰
        if result:
            state["tool_status"] = "success"
        else:
            state["tool_status"] = "failed"
        state["tool_result"] = result
        return state
    return wrapper
```

</details>

---

### ğŸ” Phase 3: ë„êµ¬ ì‹¤í–‰ ë° Fallback (11~18ë‹¨ê³„)

<details>
<summary><strong>11-Aë‹¨ê³„: RAG ìš©ì–´ì§‘ ê²€ìƒ‰</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ë¼ìš°í„°ê°€ `glossary` ë„êµ¬ë¥¼ ì„ íƒí–ˆì„ ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
1. **ìš©ì–´ ì¶”ì¶œ**: `extract_term_from_question()`ìœ¼ë¡œ ì§ˆë¬¸ì—ì„œ ê¸°ìˆ  ìš©ì–´ë¥¼ ì¶”ì¶œ
   - ì˜ˆ: "Transformerê°€ ë­ì•¼?" â†’ "Transformer"
2. **SQL ê²€ìƒ‰**: PostgreSQL `glossary` í…Œì´ë¸”ì—ì„œ `ILIKE '%Transformer%'` ê²€ìƒ‰
3. **ë²¡í„° ê²€ìƒ‰**: `glossary_embeddings` í…Œì´ë¸”ì—ì„œ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê²€ìƒ‰
4. **í•˜ì´ë¸Œë¦¬ë“œ ë³‘í•©**: SQL ê²°ê³¼ 50% + ë²¡í„° ê²°ê³¼ 50%ë¥¼ í•©ì‚°í•˜ì—¬ ìµœì¢… ê²°ê³¼ ì„ íƒ

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë‹¨ìˆœ í‚¤ì›Œë“œ ê²€ìƒ‰(SQL)ë§Œìœ¼ë¡œëŠ” ë™ì˜ì–´ë‚˜ ìœ ì‚¬ ìš©ì–´ë¥¼ ì°¾ê¸° ì–´ë µìŠµë‹ˆë‹¤.
- ë²¡í„° ê²€ìƒ‰ì„ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ì˜ë¯¸ì ìœ¼ë¡œ ìœ ì‚¬í•œ ìš©ì–´ë„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê²°ê³¼:**
- **ì„±ê³µ**: ìš©ì–´ ì •ì˜ë¥¼ `tool_result`ì— ì €ì¥ â†’ ë°”ë¡œ 22ë‹¨ê³„(UI í‘œì‹œ)ë¡œ ì´ë™
- **ì‹¤íŒ¨**: `tool_status = "failed"` â†’ 11-A-Fë‹¨ê³„(Fallback)ë¡œ ì´ë™

</details>

<details>
<summary><strong>11-A-Fë‹¨ê³„: ì¼ë°˜ ë‹µë³€ (Fallback)</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 11-Aë‹¨ê³„ì—ì„œ ìš©ì–´ë¥¼ ì°¾ì§€ ëª»í–ˆì„ ë•Œ(ì‹¤íŒ¨) ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `general_node()`ë¥¼ ì‹¤í–‰í•˜ì—¬ LLMì—ê²Œ ì§ì ‘ ì§ˆë¬¸ì„ ì „ë‹¬í•©ë‹ˆë‹¤.
- ë‚œì´ë„ì— ë§ëŠ” í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ì„ ë¡œë“œí•©ë‹ˆë‹¤ (`get_general_template()`).
- LLMì´ ìì²´ ì§€ì‹ìœ¼ë¡œ ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- DBì— ì—†ëŠ” ìš©ì–´ë¼ë„ ì‚¬ìš©ìì—ê²Œ "ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"ë¼ê³ ë§Œ ë‹µí•˜ëŠ” ê²ƒë³´ë‹¤, LLMì˜ ì¼ë°˜ ì§€ì‹ìœ¼ë¡œ ë‹µë³€í•˜ëŠ” ê²ƒì´ ë” ìœ ìš©í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì˜ˆì‹œ:**
```
ì§ˆë¬¸: "Quantum Attentionì´ ë­ì•¼?"
â†’ glossary ê²€ìƒ‰ ì‹¤íŒ¨ (DBì— ì—†ìŒ)
â†’ Fallback: general_nodeê°€ LLMìœ¼ë¡œ ë‹µë³€ ìƒì„±
â†’ "Quantum Attentionì€ ì–‘ì ì»´í“¨íŒ… ê°œë…ì„ Attention ë©”ì»¤ë‹ˆì¦˜ì— ì ìš©í•œ ê²ƒì…ë‹ˆë‹¤..."
```

</details>

<details>
<summary><strong>12ë‹¨ê³„: DB ì¡°íšŒ (glossary)</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 11-Aë‹¨ê³„ì˜ `glossary_node` ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `RAGRetriever.hybrid_search()` ë©”ì„œë“œ í˜¸ì¶œ
- **SQL ê²€ìƒ‰**: `SELECT * FROM glossary WHERE term ILIKE '%ê²€ìƒ‰ì–´%'`
- **ë²¡í„° ê²€ìƒ‰**: pgvector í™•ì¥ì„ ì‚¬ìš©í•˜ì—¬ ì„ë² ë”© ìœ ì‚¬ë„ ê²€ìƒ‰
- ë‘ ê²°ê³¼ë¥¼ ì ìˆ˜ ê¸°ë°˜ìœ¼ë¡œ ë³‘í•©í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ì‹¤ì œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë ˆì´ì–´ì…ë‹ˆë‹¤.
- SQLê³¼ ë²¡í„° ê²€ìƒ‰ì„ ë¶„ë¦¬í•˜ì—¬ ê°ê°ì˜ ì¥ì ì„ í™œìš©í•©ë‹ˆë‹¤.

**ì‹¤ì œ SQL ì˜ˆì‹œ:**
```sql
-- SQL ê²€ìƒ‰
SELECT term, definition FROM glossary WHERE term ILIKE '%Transformer%';

-- ë²¡í„° ê²€ìƒ‰ (pgvector)
SELECT term, definition
FROM glossary_embeddings
ORDER BY embedding <=> '[0.1, 0.2, ...]'
LIMIT 5;
```

</details>

<details>
<summary><strong>13ë‹¨ê³„: Fallback ì²´í¬</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ë„êµ¬(11-Aë‹¨ê³„) ì‹¤í–‰ ì™„ë£Œ í›„ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `tool_status`ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
- **ì„±ê³µ**: `pipeline_router`ë¡œ ì´ë™ (ë‹¤ìŒ ë„êµ¬ ì‹¤í–‰ ë˜ëŠ” ì¢…ë£Œ)
- **ì‹¤íŒ¨**: `fallback_router_node`ë¡œ ì´ë™ (Fallback ë„êµ¬ ì‹¤í–‰)

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë„êµ¬ ì‹¤íŒ¨ ì‹œ ìë™ìœ¼ë¡œ ëŒ€ì²´ ë„êµ¬ë¥¼ ì‹¤í–‰í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ í•­ìƒ ë‹µë³€ì„ ì œê³µí•©ë‹ˆë‹¤.

**ì‹¤ì œ íë¦„:**
```
glossary ì„±ê³µ â†’ pipeline_router â†’ END
glossary ì‹¤íŒ¨ â†’ fallback_router_node â†’ general ì‹¤í–‰
```

</details>

<details>
<summary><strong>14ë‹¨ê³„: Fallback Router</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 13ë‹¨ê³„ì—ì„œ `tool_status = "failed"`ì¼ ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `TOOL_FALLBACKS` ë”•ì…”ë„ˆë¦¬ì—ì„œ ì‹¤íŒ¨í•œ ë„êµ¬ì˜ Fallbackì„ ì¡°íšŒí•©ë‹ˆë‹¤.
  - ì˜ˆ: `TOOL_FALLBACKS = {"glossary": "general", "search_paper": "web_search"}`
- `tool_pipeline`ì„ ìˆ˜ì •í•˜ì—¬ ì‹¤íŒ¨í•œ ë„êµ¬ë¥¼ Fallback ë„êµ¬ë¡œ êµì²´í•©ë‹ˆë‹¤.
- `retry_count`ë¥¼ ì¦ê°€ì‹œì¼œ ë¬´í•œ ë£¨í”„ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë„êµ¬ë§ˆë‹¤ ë‹¤ë¥¸ Fallback ì „ëµì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìë™ìœ¼ë¡œ Fallback ì²´ì¸ì„ ë”°ë¼ ì¬ì‹œë„í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì˜ˆì‹œ:**
```python
TOOL_FALLBACKS = {
    "glossary": "general",
    "search_paper": "web_search",
    "web_search": "general",
    "summarize": "general"
}

# glossary ì‹¤íŒ¨ ì‹œ
tool_pipeline = ["glossary"]  # ì›ë˜
â†’ tool_pipeline = ["general"]  # Fallback ì ìš©
```

</details>

<details>
<summary><strong>15ë‹¨ê³„: Pipeline Router</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 13ë‹¨ê³„ì—ì„œ `tool_status = "success"`ì¼ ë•Œ, ë˜ëŠ” 14ë‹¨ê³„(Fallback Router) ì‹¤í–‰ í›„ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- **ê²€ìƒ‰ ìŠ¤í‚µ ë¡œì§**: ê²€ìƒ‰ ë„êµ¬ê°€ ì„±ê³µí•˜ë©´ ë‚˜ë¨¸ì§€ ê²€ìƒ‰ ë„êµ¬ë¥¼ ê±´ë„ˆëœë‹ˆë‹¤.
  - `search_paper` ì„±ê³µ â†’ `web_search`, `general` ê±´ë„ˆë›°ê¸° â†’ `summarize`ë¡œ ì§í–‰
  - `web_search` ì„±ê³µ â†’ `general` ê±´ë„ˆë›°ê¸° â†’ `summarize`ë¡œ ì§í–‰
- **ìˆœì°¨ ì§„í–‰**: íŒŒì´í”„ë¼ì¸ì˜ ë‹¤ìŒ ë„êµ¬ë¡œ `pipeline_index`ë¥¼ ì¦ê°€ì‹œí‚µë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë¶ˆí•„ìš”í•œ ê²€ìƒ‰ì„ ë°©ì§€í•˜ì—¬ ì‹¤í–‰ ì‹œê°„ê³¼ ë¹„ìš©ì„ ì ˆì•½í•©ë‹ˆë‹¤.
- ë‹¤ì¤‘ ìš”ì²­ íŒŒì´í”„ë¼ì¸ì—ì„œ íš¨ìœ¨ì ìœ¼ë¡œ ë„êµ¬ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì˜ˆì‹œ:**
```
íŒŒì´í”„ë¼ì¸: [search_paper, web_search, general, summarize]

Case 1: search_paper ì„±ê³µ
â†’ web_search, general ìŠ¤í‚µ
â†’ summarize ì‹¤í–‰

Case 2: search_paper ì‹¤íŒ¨ â†’ web_search ì„±ê³µ
â†’ general ìŠ¤í‚µ
â†’ summarize ì‹¤í–‰

Case 3: search_paper, web_search ëª¨ë‘ ì‹¤íŒ¨
â†’ general ì‹¤í–‰ (Fallback)
â†’ summarize ì‹¤í–‰
```

</details>

<details>
<summary><strong>16-Aë‹¨ê³„: RAG ë…¼ë¬¸ ê²€ìƒ‰</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ë¼ìš°í„°ê°€ `search_paper` ë„êµ¬ë¥¼ ì„ íƒí–ˆì„ ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
1. **RAGRetriever ì´ˆê¸°í™”**: PostgreSQL + pgvector ì—°ê²°
2. **ë²¡í„° ê²€ìƒ‰**: `papers_embeddings` í…Œì´ë¸”ì—ì„œ ì„ë² ë”© ìœ ì‚¬ë„ ê²€ìƒ‰ (70% ê°€ì¤‘ì¹˜)
3. **FTS ê²€ìƒ‰**: `papers` í…Œì´ë¸”ì—ì„œ Full-Text Search (30% ê°€ì¤‘ì¹˜)
4. **í•˜ì´ë¸Œë¦¬ë“œ ë³‘í•©**: ë²¡í„° 70% + FTS 30%ë¥¼ í•©ì‚°í•˜ì—¬ ìµœìƒìœ„ ë…¼ë¬¸ ì„ íƒ
5. **ìœ ì‚¬ë„ í™•ì¸**: ìœ ì‚¬ë„ê°€ 0.5 ë¯¸ë§Œì´ë©´ ì„±ê³µ, 0.5 ì´ìƒì´ë©´ ì‹¤íŒ¨

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë¡œì»¬ DBì— ì €ì¥ëœ ë…¼ë¬¸ì„ ë¨¼ì € ê²€ìƒ‰í•˜ëŠ” ê²ƒì´ ì›¹ ê²€ìƒ‰ë³´ë‹¤ ë¹ ë¥´ê³  ì •í™•í•©ë‹ˆë‹¤.
- ë²¡í„° ê²€ìƒ‰ì€ ì˜ë¯¸ì  ìœ ì‚¬ë„ë¥¼, FTSëŠ” í‚¤ì›Œë“œ ë§¤ì¹­ì„ ì˜ ìˆ˜í–‰í•©ë‹ˆë‹¤.

**ê²°ê³¼:**
- **ì„±ê³µ**: ë…¼ë¬¸ ë³¸ë¬¸ì„ `tool_result`ì— ì €ì¥ â†’ 18ë‹¨ê³„(ìš”ì•½)ë¡œ ì´ë™
- **ì‹¤íŒ¨**: `tool_status = "failed"` â†’ 16-A-F1ë‹¨ê³„(Web ê²€ìƒ‰)ë¡œ Fallback

</details>

<details>
<summary><strong>16-A-F1ë‹¨ê³„: Web ë…¼ë¬¸ ê²€ìƒ‰ (Fallback 1)</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 16-Aë‹¨ê³„ì—ì„œ ë…¼ë¬¸ì„ ì°¾ì§€ ëª»í–ˆì„ ë•Œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- Tavily APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ì—ì„œ ë…¼ë¬¸ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤.
- `TavilySearchResults()` ë„êµ¬ê°€ Google Scholar, arXiv ë“±ì—ì„œ ê²€ìƒ‰í•©ë‹ˆë‹¤.
- ê²€ìƒ‰ ê²°ê³¼(ì œëª©, ë§í¬, ìš”ì•½)ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë¡œì»¬ DBì— ì—†ëŠ” ìµœì‹  ë…¼ë¬¸ì´ë‚˜ íŠ¹ì • ë…¼ë¬¸ì€ ì›¹ ê²€ìƒ‰ìœ¼ë¡œ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.

**ê²°ê³¼:**
- **ì„±ê³µ**: ì›¹ ê²€ìƒ‰ ê²°ê³¼ë¥¼ `tool_result`ì— ì €ì¥ â†’ 18ë‹¨ê³„(ìš”ì•½)ë¡œ ì´ë™
- **ì‹¤íŒ¨**: `tool_status = "failed"` â†’ 16-A-F2ë‹¨ê³„(ì¼ë°˜ ë‹µë³€)ë¡œ Fallback

</details>

<details>
<summary><strong>16-A-F2ë‹¨ê³„: ì¼ë°˜ ë‹µë³€ (Fallback 2)</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 16-A-F1ë‹¨ê³„(Web ê²€ìƒ‰)ë„ ì‹¤íŒ¨í–ˆì„ ë•Œ ìµœì¢…ì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- LLMì—ê²Œ ì§ˆë¬¸ì„ ì§ì ‘ ì „ë‹¬í•˜ì—¬ ì¼ë°˜ ì§€ì‹ìœ¼ë¡œ ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ëª¨ë“  ê²€ìƒ‰ì´ ì‹¤íŒ¨í•´ë„ ì‚¬ìš©ìì—ê²Œ "ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"ë³´ë‹¤ëŠ” LLMì˜ ì¼ë°˜ ì§€ì‹ìœ¼ë¡œ ë‹µë³€í•˜ëŠ” ê²ƒì´ ë” ìœ ìš©í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì˜ˆì‹œ:**
```
ì§ˆë¬¸: "2025ë…„ 1ì›”ì— ë°œí‘œëœ ìµœì‹  LLM ë…¼ë¬¸ ì°¾ì•„ì¤˜"
â†’ search_paper ì‹¤íŒ¨ (ë¡œì»¬ DBì— ì—†ìŒ)
â†’ web_search ì‹¤íŒ¨ (ë„ˆë¬´ ìµœì‹ ì´ë¼ ì¸ë±ì‹± ì•ˆ ë¨)
â†’ Fallback: general_nodeê°€ ë‹µë³€
â†’ "2025ë…„ 1ì›” ìµœì‹  ë…¼ë¬¸ì€ ì•„ì§ ì œ ë°ì´í„°ë² ì´ìŠ¤ì— ì—†ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ LLM ì—°êµ¬ëŠ”..."
```

</details>

<details>
<summary><strong>17ë‹¨ê³„: DB ì¡°íšŒ (papers)</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 16-Aë‹¨ê³„ì˜ `search_paper_node` ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- **ë²¡í„° ê²€ìƒ‰**: `papers_embeddings` í…Œì´ë¸”ì—ì„œ ì„ë² ë”© ìœ ì‚¬ë„ ê²€ìƒ‰
- **FTS ê²€ìƒ‰**: `papers` í…Œì´ë¸”ì—ì„œ PostgreSQL Full-Text Search
- ë‘ ê²°ê³¼ë¥¼ ê°€ì¤‘ì¹˜ ê¸°ë°˜ìœ¼ë¡œ ë³‘í•© (ë²¡í„° 70%, FTS 30%)

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë…¼ë¬¸ ê²€ìƒ‰ì€ ìš©ì–´ì§‘ë³´ë‹¤ ë³µì¡í•˜ë¯€ë¡œ ë²¡í„° ê²€ìƒ‰ ë¹„ì¤‘ì„ ë” ë†’ì…ë‹ˆë‹¤.
- FTSëŠ” ì €ìëª…, ë…¼ë¬¸ ì œëª© ë“± ì •í™•í•œ í‚¤ì›Œë“œ ë§¤ì¹­ì— ìœ ë¦¬í•©ë‹ˆë‹¤.

**ì‹¤ì œ SQL ì˜ˆì‹œ:**
```sql
-- FTS ê²€ìƒ‰
SELECT title, abstract, content
FROM papers
WHERE to_tsvector('english', content) @@ to_tsquery('Transformer & Attention');

-- ë²¡í„° ê²€ìƒ‰
SELECT title, abstract, content
FROM papers_embeddings
ORDER BY embedding <=> '[...]'
LIMIT 10;
```

</details>

<details>
<summary><strong>18ë‹¨ê³„: ë…¼ë¬¸ ìš”ì•½</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 16-A, 16-A-F1, ë˜ëŠ” 16-A-F2 ì¤‘ í•˜ë‚˜ê°€ ì„±ê³µí•œ í›„, íŒŒì´í”„ë¼ì¸ì— `summarize`ê°€ ìˆì„ ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
1. **íŒŒì´í”„ë¼ì¸ ëª¨ë“œ í™•ì¸**: ì´ì „ ë‹¨ê³„ì˜ `tool_result` ì‚¬ìš© (ê²€ìƒ‰ ê²°ê³¼ í™œìš©)
2. **ë‚œì´ë„ ë§¤í•‘**: `easy` â†’ `elementary/beginner` ìˆ˜ì¤€ìœ¼ë¡œ ë³€í™˜
3. **í”„ë¡¬í”„íŠ¸ ë¡œë“œ**: `get_summarize_template(difficulty)`ë¡œ ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ ê°€ì ¸ì˜¤ê¸°
4. **LLM í˜¸ì¶œ**: `LLMClient.generate()`ë¡œ ìš”ì•½ ìƒì„±

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë…¼ë¬¸ ì „ë¬¸ì€ ê¸¸ê³  ì–´ë ¤ìš°ë¯€ë¡œ, ì‚¬ìš©ì ë‚œì´ë„ì— ë§ê²Œ ìš”ì•½í•´ì•¼ í•©ë‹ˆë‹¤.
- ì´ˆë³´ìëŠ” ì‰¬ìš´ ìš©ì–´ë¡œ, ì „ë¬¸ê°€ëŠ” ìƒì„¸í•œ ê¸°ìˆ  ë‚´ìš©ìœ¼ë¡œ ìš”ì•½í•©ë‹ˆë‹¤.

**ê²°ê³¼:**
- **ì„±ê³µ**: ë‚œì´ë„ë³„ ìš”ì•½ì„ `final_answers`ì— ì €ì¥ â†’ 22ë‹¨ê³„(UI í‘œì‹œ)ë¡œ ì´ë™
- **ì‹¤íŒ¨**: Fallback (`18-F`)ìœ¼ë¡œ ì¼ë°˜ ë‹µë³€ ìƒì„±

</details>

<details>
<summary><strong>18-Fë‹¨ê³„: ì¼ë°˜ ë‹µë³€ (Fallback)</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 18ë‹¨ê³„ì—ì„œ ìš”ì•½ ìƒì„±ì´ ì‹¤íŒ¨í–ˆì„ ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- LLMì—ê²Œ ì›ë˜ ì§ˆë¬¸ì„ ì „ë‹¬í•˜ì—¬ ì¼ë°˜ ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€ìš”?**
- ìš”ì•½ ì‹¤íŒ¨ ì‹œì—ë„ ì‚¬ìš©ìì—ê²Œ ë‹µë³€ì„ ì œê³µí•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

</details>

---

### ğŸ¤– Phase 4: LLM í˜¸ì¶œ ë° ìƒíƒœ ê´€ë¦¬ (19~21ë‹¨ê³„)

<details>
<summary><strong>19ë‹¨ê³„: LLM í˜¸ì¶œ</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ì¼ë°˜ ë‹µë³€(`general_node`), ìš”ì•½(`summarize_node`), í‰ê°€ ë“±ì—ì„œ LLMì´ í•„ìš”í•  ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
1. **ëª¨ë¸ ì„ íƒ**: í™˜ê²½ë³€ìˆ˜ ë˜ëŠ” ì„¤ì •ì— ë”°ë¼ Solar-pro2 ë˜ëŠ” GPT-5 ì„ íƒ
2. **í”„ë¡¬í”„íŠ¸ ì¡°í•©**: ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ + ì‚¬ìš©ì ì§ˆë¬¸ ê²°í•©
3. **OpenAI API í˜¸ì¶œ**: `chat.completions.create()` ë©”ì„œë“œ ì‚¬ìš©
4. **ì‘ë‹µ ìˆ˜ì‹ **: `generated_text` ì¶”ì¶œ
5. **í† í° ì‚¬ìš©ëŸ‰ ê³„ì‚°**: `prompt_tokens + completion_tokens` ê³„ì‚°í•˜ì—¬ ë¡œê¹…

**ì™œ í•„ìš”í•œê°€ìš”?**
- LLMì€ ëª¨ë“  ë„êµ¬ì˜ í•µì‹¬ì…ë‹ˆë‹¤ (ë‹µë³€ ìƒì„±, ë¼ìš°íŒ…, í‰ê°€ ë“±).
- í† í° ì‚¬ìš©ëŸ‰ì„ ì¶”ì í•˜ì—¬ ë¹„ìš©ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# src/llm/client.py
response = openai.chat.completions.create(
    model="gpt-4o",
    messages=[
        {"role": "system", "content": system_prompt},
        {"role": "user", "content": user_question}
    ],
    temperature=0.7
)
generated_text = response.choices[0].message.content
```

</details>

<details>
<summary><strong>20ë‹¨ê³„: AgentState ì—…ë°ì´íŠ¸</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ê° ë„êµ¬ ì‹¤í–‰ í›„ ìë™ìœ¼ë¡œ LangGraphê°€ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `tool_result`: ë„êµ¬ ì‹¤í–‰ ê²°ê³¼ ì €ì¥
- `final_answers`: ë‚œì´ë„ë³„ ìµœì¢… ë‹µë³€ ì €ì¥
- `tool_status`: `success` ë˜ëŠ” `failed` ì €ì¥
- `messages`: ëŒ€í™” íˆìŠ¤í† ë¦¬ì— AI ë©”ì‹œì§€ ì¶”ê°€
- `metadata`: ë„êµ¬ëª…, ì„ íƒ ì´ìœ , ì‹¤í–‰ ì‹œê°„ ë“± ì €ì¥

**ì™œ í•„ìš”í•œê°€ìš”?**
- ëª¨ë“  ë…¸ë“œê°€ ê³µìœ  ìƒíƒœë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ìŠµë‹ˆë‹¤.
- ëŒ€í™” íˆìŠ¤í† ë¦¬ë¥¼ ìœ ì§€í•˜ì—¬ ì—°ì†ì ì¸ ëŒ€í™”ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

**AgentState êµ¬ì¡°:**
```python
class AgentState(TypedDict):
    question: str
    difficulty: str
    tool_choice: str
    tool_result: str
    tool_status: str  # "success" or "failed"
    final_answers: dict  # {"easy": "...", "medium": "...", "hard": "..."}
    messages: list
    metadata: dict
    pipeline_index: int
    retry_count: int
```

</details>

<details>
<summary><strong>21ë‹¨ê³„: ì¢…ë£Œ ì¡°ê±´ í™•ì¸</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ê° ë„êµ¬ ì‹¤í–‰ í›„ ë§¤ë²ˆ í™•ì¸í•©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `should_end()` í•¨ìˆ˜ê°€ ë‹¤ìŒ ì¡°ê±´ì„ í™•ì¸í•©ë‹ˆë‹¤:
  1. **íŒŒì´í”„ë¼ì¸ ì™„ë£Œ**: `pipeline_index >= len(tool_pipeline)`
  2. **ìµœì¢… ë‹µë³€ ì¡´ì¬**: `final_answers`ì— ë‚œì´ë„ë³„ ë‹µë³€ì´ ëª¨ë‘ ìˆìŒ
  3. **ì¬ì‹œë„ íšŸìˆ˜ ì´ˆê³¼**: `retry_count > 3`
- ì¡°ê±´ ì¶©ì¡± ì‹œ `END`, ì•„ë‹ˆë©´ `CONTINUE`

**ì™œ í•„ìš”í•œê°€ìš”?**
- ë¬´í•œ ë£¨í”„ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.
- ë‹µë³€ì´ ì™„ì„±ë˜ë©´ ì¦‰ì‹œ ì¢…ë£Œí•˜ì—¬ ë¶ˆí•„ìš”í•œ ì‹¤í–‰ì„ ë§‰ìŠµë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# src/agent/graph.py
def should_end(state: AgentState):
    if state.get("final_answers"):
        return "END"
    if state.get("retry_count", 0) > 3:
        return "END"
    if state.get("pipeline_index", 0) >= len(state.get("tool_pipeline", [])):
        return "END"
    return "CONTINUE"
```

</details>

---

### ğŸ–¥ï¸ Phase 5: UI í‘œì‹œ ë° ë¶€ê°€ ê¸°ëŠ¥ (22~26ë‹¨ê³„)

<details>
<summary><strong>22ë‹¨ê³„: UI ë‹µë³€ í‘œì‹œ</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- Agent ì‹¤í–‰ì´ ì™„ë£Œë˜ê³  `response` ê°ì²´ë¥¼ ë°›ì€ í›„ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
1. **`final_answers` ì¶”ì¶œ**: ë‚œì´ë„ë³„ ë‹µë³€ ê°€ì ¸ì˜¤ê¸°
2. **ë„êµ¬ ë°°ì§€ í‘œì‹œ**: ì–´ë–¤ ë„êµ¬ë¥¼ ì‚¬ìš©í–ˆëŠ”ì§€ í‘œì‹œ (ì˜ˆ: `[ìš©ì–´ì§‘]`, `[ë…¼ë¬¸ ê²€ìƒ‰]`)
3. **ì„ íƒ ì´ìœ  í‘œì‹œ**: `routing_reason` ì¶œë ¥
4. **ë‹µë³€ í…ìŠ¤íŠ¸**: `st.markdown()`ìœ¼ë¡œ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ ë Œë”ë§

**ì™œ í•„ìš”í•œê°€ìš”?**
- ì‚¬ìš©ìì—ê²Œ ë‹µë³€ì„ ì‹œê°ì ìœ¼ë¡œ ë³´ê¸° ì¢‹ê²Œ í‘œì‹œí•©ë‹ˆë‹¤.
- ì–´ë–¤ ë„êµ¬ë¥¼ ì‚¬ìš©í–ˆëŠ”ì§€ íˆ¬ëª…í•˜ê²Œ ë³´ì—¬ì¤ë‹ˆë‹¤.

**ì‹¤ì œ í™”ë©´ ì˜ˆì‹œ:**
```
ğŸ¤– AI ë‹µë³€ [ìš©ì–´ì§‘]

ì„ íƒ ì´ìœ : ì§ˆë¬¸ì—ì„œ ê¸°ìˆ  ìš©ì–´ "Transformer"ë¥¼ ê°ì§€í•˜ì—¬ ìš©ì–´ì§‘ ê²€ìƒ‰ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.

TransformerëŠ” 2017ë…„ Googleì´ ë°œí‘œí•œ...
```

</details>

<details>
<summary><strong>23ë‹¨ê³„: ìš©ì–´ ì¶”ì¶œ ë° ì €ì¥</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 22ë‹¨ê³„ì—ì„œ ë‹µë³€ì´ UIì— í‘œì‹œëœ ì§í›„ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
1. **ì •ê·œì‹ ë§¤ì¹­**: ë‹µë³€ í…ìŠ¤íŠ¸ì—ì„œ ëŒ€ë¬¸ìë¡œ ì‹œì‘í•˜ëŠ” ê¸°ìˆ  ìš©ì–´ íŒ¨í„´ ì°¾ê¸°
2. **LLM ìš©ì–´ ì¶”ì¶œ**: GPTë¡œ ê¸°ìˆ  ìš©ì–´ë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œ
3. **DB ì €ì¥**: `extracted_terms` í…Œì´ë¸”ì— INSERT
4. **UI í‘œì‹œ**: ì¶”ì¶œëœ ìš©ì–´ ëª©ë¡ì„ ì‚¬ì´ë“œë°”ë‚˜ í•˜ë‹¨ì— í‘œì‹œ

**ì™œ í•„ìš”í•œê°€ìš”?**
- ëŒ€í™” ì¤‘ ë“±ì¥í•œ ê¸°ìˆ  ìš©ì–´ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•˜ì—¬ ë‚˜ì¤‘ì— ë³µìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì‚¬ìš©ìê°€ ì–´ë–¤ ìš©ì–´ì— ê´€ì‹¬ ìˆëŠ”ì§€ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì‹¤ì œ ì˜ˆì‹œ:**
```
ë‹µë³€: "TransformerëŠ” Self-Attention ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤..."

ì¶”ì¶œëœ ìš©ì–´:
- Transformer
- Self-Attention
- Multi-Head Attention
```

</details>

<details>
<summary><strong>24ë‹¨ê³„: ë‹µë³€ í‰ê°€</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ì‚¬ìš©ìê°€ "í‰ê°€í•˜ê¸°" ë²„íŠ¼ì„ í´ë¦­í–ˆì„ ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤ (ì„ íƒì  ê¸°ëŠ¥).

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
1. **í‰ê°€ í”„ë¡¬í”„íŠ¸ ìƒì„±**: ì§ˆë¬¸ + ë‹µë³€ì„ LLMì—ê²Œ ì „ë‹¬
2. **í‰ê°€ ê¸°ì¤€ ì ìš©**:
   - ì •í™•ì„± (Accuracy): ë‹µë³€ì´ ì‚¬ì‹¤ì ìœ¼ë¡œ ì •í™•í•œê°€?
   - ì™„ì „ì„± (Completeness): ì§ˆë¬¸ì— ì¶©ë¶„íˆ ë‹µë³€í–ˆëŠ”ê°€?
   - ëª…í™•ì„± (Clarity): ì´í•´í•˜ê¸° ì‰¬ìš´ê°€?
3. **ì ìˆ˜ ê³„ì‚°**: 0~100ì  ì‚°ì¶œ
4. **DB ì €ì¥**: `evaluations` í…Œì´ë¸”ì— ì €ì¥
5. **UI í‘œì‹œ**: í‰ê°€ ê²°ê³¼ë¥¼ ì‚¬ìš©ìì—ê²Œ í‘œì‹œ

**ì™œ í•„ìš”í•œê°€ìš”?**
- Agentì˜ ë‹µë³€ í’ˆì§ˆì„ ìë™ìœ¼ë¡œ í‰ê°€í•˜ì—¬ ê°œì„ ì ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- LLM-as-a-Judge ë°©ì‹ìœ¼ë¡œ ì¸ê°„ í‰ê°€ ì—†ì´ ë¹ ë¥´ê²Œ í‰ê°€í•©ë‹ˆë‹¤.

**ì‹¤ì œ í‰ê°€ ê²°ê³¼ ì˜ˆì‹œ:**
```
ğŸ“Š ë‹µë³€ í‰ê°€ ê²°ê³¼

âœ… ì •í™•ì„±: 90/100
âœ… ì™„ì „ì„±: 85/100
âœ… ëª…í™•ì„±: 95/100

ì´ì : 90/100
```

</details>

<details>
<summary><strong>25ë‹¨ê³„: ê³„ì† ëŒ€í™”</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- 22~24ë‹¨ê³„ê°€ ì™„ë£Œëœ í›„, í™”ë©´ í•˜ë‹¨ì— ì…ë ¥ì°½ì´ ë‹¤ì‹œ í™œì„±í™”ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
- `st.chat_input()`ì´ ìƒˆë¡œìš´ ì§ˆë¬¸ì„ ëŒ€ê¸°í•©ë‹ˆë‹¤.
- **ìƒˆ ì§ˆë¬¸ ì…ë ¥ ì‹œ**: 7ë‹¨ê³„ë¡œ ë³µê·€í•˜ì—¬ ìƒˆ ì§ˆë¬¸ ì²˜ë¦¬
- **ì…ë ¥ ì—†ìŒ**: ì„¸ì…˜ ìœ ì§€, ëŒ€í™” íˆìŠ¤í† ë¦¬ ë³´ì¡´

**ì™œ í•„ìš”í•œê°€ìš”?**
- ì—°ì†ì ì¸ ëŒ€í™”ë¥¼ ì§€ì›í•˜ì—¬ ë©€í‹°í„´ ëŒ€í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
- ì´ì „ ëŒ€í™” ë§¥ë½ì„ ìœ ì§€í•©ë‹ˆë‹¤.

**ì‹¤ì œ íë¦„:**
```
ì‚¬ìš©ì: "Transformerê°€ ë­ì•¼?"
â†’ (7~24ë‹¨ê³„ ì‹¤í–‰)
â†’ AI: "TransformerëŠ”..."

ì‚¬ìš©ì: "ê·¸ëŸ¼ BERTëŠ”?"
â†’ (7~24ë‹¨ê³„ ë‹¤ì‹œ ì‹¤í–‰, ì´ì „ ëŒ€í™” ë§¥ë½ í¬í•¨)
â†’ AI: "BERTëŠ” Transformer ê¸°ë°˜ì˜..."
```

</details>

<details>
<summary><strong>26ë‹¨ê³„: ì„¸ì…˜ ì¢…ë£Œ</strong></summary>

**ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?**
- ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì € íƒ­ì„ ë‹«ê±°ë‚˜ Streamlit ì„œë²„ë¥¼ ì¢…ë£Œí•  ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

**ë¬´ì—‡ì„ í•˜ë‚˜ìš”?**
1. **`cleanup_on_exit()` í•¨ìˆ˜ í˜¸ì¶œ**: `atexit.register()`ë¡œ ë“±ë¡ëœ ì •ë¦¬ í•¨ìˆ˜
2. **ë¹ˆ í´ë” íƒìƒ‰**: `experiments/YYYYMMDD/` í´ë”ì—ì„œ ë¹ˆ í´ë” ì°¾ê¸°
3. **ë¹ˆ í´ë” ì‚­ì œ**: `folder.rmdir()`ë¡œ ë¹ˆ í´ë” ì •ë¦¬
4. **ë¡œê·¸ ì¶œë ¥**: ì‚­ì œëœ í´ë” ê°œìˆ˜ ì¶œë ¥

**ì™œ í•„ìš”í•œê°€ìš”?**
- ì‹¤í—˜ í´ë”ëŠ” ìë™ìœ¼ë¡œ ìƒì„±ë˜ì§€ë§Œ, ì•„ë¬´ íŒŒì¼ë„ ì—†ìœ¼ë©´ ë¶ˆí•„ìš”í•œ í´ë”ê°€ ìŒ“ì…ë‹ˆë‹¤.
- ì •ë¦¬ í•¨ìˆ˜ë¡œ ìë™ìœ¼ë¡œ ë””ìŠ¤í¬ ê³µê°„ì„ ì ˆì•½í•©ë‹ˆë‹¤.

**ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ:**
```python
# ui/app.py
def cleanup_on_exit():
    date_dir = Path(f"experiments/{today}")
    for folder in sorted(date_dir.rglob("*"), key=lambda p: -len(p.parts)):
        if folder.is_dir() and not any(folder.iterdir()):
            folder.rmdir()

atexit.register(cleanup_on_exit)
```

</details>

---

### ğŸ“Š í•µì‹¬ ê°œë… ì •ë¦¬

#### Fallback ì²´ì¸ (ë„êµ¬ ìë™ ì „í™˜)

```
ìš©ì–´ì§‘ ê²€ìƒ‰:
glossary (DB ê²€ìƒ‰) â†’ ì‹¤íŒ¨ â†’ general (LLM ë‹µë³€)

ë…¼ë¬¸ ê²€ìƒ‰:
search_paper (ë¡œì»¬ DB) â†’ ì‹¤íŒ¨ â†’ web_search (Tavily) â†’ ì‹¤íŒ¨ â†’ general (LLM)

ìš”ì•½:
summarize (íŒŒì´í”„ë¼ì¸ ëª¨ë“œ) â†’ ì‹¤íŒ¨ â†’ general (LLM)
```

#### í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰

**ìš©ì–´ì§‘ (50% + 50%)**
- SQL ê²€ìƒ‰ 50%: ì •í™•í•œ í‚¤ì›Œë“œ ë§¤ì¹­
- ë²¡í„° ê²€ìƒ‰ 50%: ì˜ë¯¸ì  ìœ ì‚¬ë„

**ë…¼ë¬¸ (70% + 30%)**
- ë²¡í„° ê²€ìƒ‰ 70%: ë…¼ë¬¸ì€ ì˜ë¯¸ì  ìœ ì‚¬ë„ê°€ ë” ì¤‘ìš”
- FTS ê²€ìƒ‰ 30%: ì €ìëª…, ì œëª© ë“± ì •í™•í•œ ë§¤ì¹­

#### ë‹¤ì¤‘ ìš”ì²­ íŒŒì´í”„ë¼ì¸

```
ì§ˆë¬¸: "Attention ë…¼ë¬¸ ì°¾ì•„ì„œ ì´ˆë³´ììš©ìœ¼ë¡œ ìš”ì•½í•´ì¤˜"

íŒŒì´í”„ë¼ì¸: [search_paper, web_search, general, summarize]

ì‹¤í–‰ íë¦„:
1. search_paper ì‹¤í–‰ â†’ ì„±ê³µ
2. web_search, general ìŠ¤í‚µ (ê²€ìƒ‰ ì„±ê³µí–ˆìœ¼ë¯€ë¡œ)
3. summarize ì‹¤í–‰ (ì´ì „ ê²€ìƒ‰ ê²°ê³¼ í™œìš©)
4. ìµœì¢… ë‹µë³€ ë°˜í™˜
```

---

## Agent ë‚´ë¶€ ì‹¤í–‰ íë¦„

AgentëŠ” LangGraph ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë©°, ë¼ìš°íŒ… â†’ ê²€ì¦ â†’ ë„êµ¬ ì‹¤í–‰ â†’ Fallback ì²˜ë¦¬ì˜ ë‹¨ê³„ë¥¼ ê±°ì¹©ë‹ˆë‹¤.

```mermaid
graph TB
    subgraph AgentDetail["ğŸ¤– Agent ì‹¤í–‰ ë‚´ë¶€ êµ¬ì¡° (LangGraph)"]
        direction TB

        subgraph RouterPhase["ğŸ”¸ ë¼ìš°íŒ… ë‹¨ê³„"]
            direction LR
            RouterStart[ë¼ìš°í„°<br/>ì‹œì‘] --> MultiCheck{ë‹¤ì¤‘ìš”ì²­<br/>íŒ¨í„´?}
            MultiCheck -->|ì˜ˆ| MultiRoute[íŒ¨í„´ ë§¤ì¹­<br/>YAML íŒŒì¼]
            MultiCheck -->|ì•„ë‹ˆì˜¤| SingleRoute[ë‹¨ì¼ìš”ì²­<br/>ì²˜ë¦¬]
            MultiRoute --> SetPipeline[ë„êµ¬ íŒŒì´í”„ë¼ì¸<br/>ì„¤ì •]
            SingleRoute --> ClassifyQ[ì§ˆë¬¸ ìœ í˜•<br/>ë¶„ë¥˜]
            ClassifyQ --> SetChain[Fallback ì²´ì¸<br/>ì„¤ì •]
        end

        subgraph ValidationPhase["ğŸ”¹ ê²€ì¦ ë‹¨ê³„"]
            direction LR
            Validate{ë„êµ¬ ê²€ì¦<br/>í™œì„±í™”?} -->|ì˜ˆ| ValidateNode[ë„êµ¬ ì„ íƒ<br/>íƒ€ë‹¹ì„± ê²€ì¦]
            Validate -->|ì•„ë‹ˆì˜¤| SkipValidate[ê²€ì¦ ìƒëµ]
            ValidateNode -->|ì‹¤íŒ¨| RetryRouter[ë¼ìš°í„° ì¬ì‹¤í–‰<br/>ìµœëŒ€ 2íšŒ]
            ValidateNode -->|í†µê³¼| ProceedTool[ë„êµ¬ ì‹¤í–‰<br/>ì§„í–‰]
            SkipValidate --> ProceedTool
        end

        subgraph ToolExecPhase["ğŸ”º ë„êµ¬ ì‹¤í–‰ ë‹¨ê³„"]
            direction LR
            ToolNode[ì„ íƒëœ ë„êµ¬<br/>ì‹¤í–‰] --> WrapCheck{ë„êµ¬ ë˜í¼<br/>ì ìš©?}
            WrapCheck -->|ì˜ˆ| AutoStatus[ë„êµ¬ ìƒíƒœ<br/>ìë™ ì„¤ì •]
            WrapCheck -->|ì•„ë‹ˆì˜¤| ManualStatus[ê¸°ì¡´ ë°©ì‹<br/>ìœ ì§€]
            AutoStatus --> ToolResult[ë„êµ¬ ê²°ê³¼<br/>ë°˜í™˜]
            ManualStatus --> ToolResult
        end

        subgraph FailurePhase["ğŸ”¶ ì‹¤íŒ¨ ê°ì§€ ë‹¨ê³„"]
            direction LR
            CheckStatus{ë„êµ¬ ìƒíƒœ<br/>í™•ì¸} -->|ì„±ê³µ| NextCheck{ë‹¤ìŒ<br/>ë„êµ¬?}
            CheckStatus -->|ì‹¤íŒ¨| FailDetect[ì‹¤íŒ¨ ì›ì¸<br/>ë¶„ì„]
            FailDetect --> CountRetry{ì¬ì‹œë„<br/>íšŸìˆ˜?}
            CountRetry -->|ì¬ì‹œë„ ê°€ëŠ¥| FallbackRoute[Fallback ë¼ìš°í„°<br/>ë‹¤ìŒ ë„êµ¬ ì„ íƒ]
            CountRetry -->|ìµœëŒ€ ì´ˆê³¼| FinalFallback[ìµœì¢… Fallback<br/>ì¼ë°˜ ë‹µë³€ ê°•ì œ]
            NextCheck -->|ì˜ˆ| PipelineRouter[íŒŒì´í”„ë¼ì¸ ë¼ìš°í„°<br/>ë‹¤ìŒ ë„êµ¬]
            NextCheck -->|ì•„ë‹ˆì˜¤| Success([âœ… ì„±ê³µ<br/>ìµœì¢… ë‹µë³€])
        end

        subgraph FallbackPhase["ğŸ’¡ Fallback ì²´ì¸ ë‹¨ê³„"]
            direction LR
            FallbackStart[Fallback ì²´ì¸<br/>ì¡°íšŒ] --> GetNext{ë‹¤ìŒ ë„êµ¬<br/>ì¡´ì¬?}
            GetNext -->|ì˜ˆ| NextTool[ë‹¤ìŒ ìš°ì„ ìˆœìœ„<br/>ë„êµ¬ ì„ íƒ]
            GetNext -->|ì•„ë‹ˆì˜¤| ForceGeneral[ì¼ë°˜ ë‹µë³€<br/>ê°•ì œ ì‹¤í–‰]
            NextTool --> UpdateChain[ì‹¤íŒ¨ ë„êµ¬<br/>ê¸°ë¡ ì—…ë°ì´íŠ¸]
            ForceGeneral --> UpdateChain
            UpdateChain --> RetryTool[ì„ íƒëœ ë„êµ¬<br/>ì¬ì‹¤í–‰]
        end

        subgraph MultiTurnPhase["ğŸ”· ë©€í‹°í„´ ëŒ€í™”"]
            direction LR
            History[ëŒ€í™” íˆìŠ¤í† ë¦¬<br/>ì €ì¥ì†Œ] --> Context[ì´ì „ ëŒ€í™”<br/>ë¬¸ë§¥ ì¶”ì¶œ]
            Context --> ContextRouter[ë¼ìš°í„°ì—<br/>ë¬¸ë§¥ ì „ë‹¬]
            ContextRouter --> ContextTool[ë„êµ¬ì—<br/>ë¬¸ë§¥ ì „ë‹¬]
        end

        %% ë‹¨ê³„ ê°„ ì—°ê²°
        RouterPhase --> ValidationPhase
        ValidationPhase --> ToolExecPhase
        ToolExecPhase --> FailurePhase
        FailurePhase -.Fallback.-> FallbackPhase
        FallbackPhase -.Retry.-> ToolExecPhase
        MultiTurnPhase -.Context.-> RouterPhase
    end

    %% ë©”ì¸ ë°°ê²½
    style AgentDetail fill:#fffde7,stroke:#f9a825,stroke-width:4px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼
    style RouterPhase fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style ValidationPhase fill:#e3f2fd,stroke:#0d47a1,stroke-width:3px,color:#000
    style ToolExecPhase fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style FailurePhase fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style FallbackPhase fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000
    style MultiTurnPhase fill:#fce4ec,stroke:#880e4f,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë¼ìš°íŒ… - ì²­ë¡)
    style RouterStart fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style MultiCheck fill:#26c6da,stroke:#006064,stroke-width:2px,color:#000
    style MultiRoute fill:#00bcd4,stroke:#006064,stroke-width:2px,color:#000
    style SingleRoute fill:#00bcd4,stroke:#006064,stroke-width:2px,color:#000
    style SetPipeline fill:#00acc1,stroke:#00695c,stroke-width:2px,color:#000
    style ClassifyQ fill:#00acc1,stroke:#00695c,stroke-width:2px,color:#000
    style SetChain fill:#0097a7,stroke:#00695c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ê²€ì¦ - íŒŒë‘)
    style Validate fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style ValidateNode fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style SkipValidate fill:#64b5f6,stroke:#1976d2,stroke-width:2px,color:#000
    style RetryRouter fill:#42a5f5,stroke:#1565c0,stroke-width:2px,color:#000
    style ProceedTool fill:#1e88e5,stroke:#0d47a1,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë„êµ¬ ì‹¤í–‰ - ë³´ë¼)
    style ToolNode fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style WrapCheck fill:#ba68c8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AutoStatus fill:#ab47bc,stroke:#6a1b9a,stroke-width:2px,color:#000
    style ManualStatus fill:#ab47bc,stroke:#6a1b9a,stroke-width:2px,color:#000
    style ToolResult fill:#9c27b0,stroke:#4a148c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì‹¤íŒ¨ ê°ì§€ - ì£¼í™©)
    style CheckStatus fill:#ffb74d,stroke:#f57c00,stroke-width:2px,color:#000
    style NextCheck fill:#ffa726,stroke:#f57c00,stroke-width:2px,color:#000
    style FailDetect fill:#ff9800,stroke:#ef6c00,stroke-width:2px,color:#000
    style CountRetry fill:#fb8c00,stroke:#e65100,stroke-width:2px,color:#000
    style FallbackRoute fill:#f57c00,stroke:#e65100,stroke-width:2px,color:#000
    style FinalFallback fill:#ef6c00,stroke:#bf360c,stroke-width:2px,color:#000
    style PipelineRouter fill:#ff9800,stroke:#e65100,stroke-width:2px,color:#000
    style Success fill:#66bb6a,stroke:#2e7d32,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (Fallback - ë¹¨ê°•)
    style FallbackStart fill:#ef5350,stroke:#c62828,stroke-width:2px,color:#000
    style GetNext fill:#e53935,stroke:#c62828,stroke-width:2px,color:#000
    style NextTool fill:#d32f2f,stroke:#b71c1c,stroke-width:2px,color:#000
    style ForceGeneral fill:#c62828,stroke:#b71c1c,stroke-width:2px,color:#000
    style UpdateChain fill:#d32f2f,stroke:#b71c1c,stroke-width:2px,color:#000
    style RetryTool fill:#c62828,stroke:#b71c1c,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë©€í‹°í„´ - ë¶„í™)
    style History fill:#f48fb1,stroke:#ad1457,stroke-width:2px,color:#000
    style Context fill:#ec407a,stroke:#ad1457,stroke-width:2px,color:#000
    style ContextRouter fill:#e91e63,stroke:#880e4f,stroke-width:2px,color:#000
    style ContextTool fill:#d81b60,stroke:#880e4f,stroke-width:2px,color:#000
```

### Agent ì‹¤í–‰ íë¦„ ì„¤ëª…

#### 1. ë¼ìš°íŒ… ë‹¨ê³„ (ğŸ”¸)
**ì—­í• **: ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ë„êµ¬ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

- **ë‹¤ì¤‘ ìš”ì²­ í™•ì¸**: `multi_request_patterns.yaml` íŒŒì¼ì—ì„œ íŒ¨í„´ ë§¤ì¹­
  - ì˜ˆ: "ë…¼ë¬¸ ê²€ìƒ‰ í›„ ìš”ì•½í•´ì¤˜" â†’ `[search_paper, summarize]` íŒŒì´í”„ë¼ì¸ ì„¤ì •
- **ë‹¨ì¼ ìš”ì²­ ì²˜ë¦¬**: LLMì„ ì‚¬ìš©í•˜ì—¬ ì§ˆë¬¸ ìœ í˜• ë¶„ë¥˜ í›„ ë„êµ¬ ì„ íƒ
- **Fallback ì²´ì¸ ì„¤ì •**: ê° ë„êµ¬ë§ˆë‹¤ ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ë„êµ¬ ë¯¸ë¦¬ ì„¤ì •

**ì£¼ìš” í•¨ìˆ˜**: `router_node()` (src/agent/nodes.py)

#### 2. ê²€ì¦ ë‹¨ê³„ (ğŸ”¹)
**ì—­í• **: ì„ íƒëœ ë„êµ¬ê°€ ì§ˆë¬¸ì— ì í•©í•œì§€ ê²€ì¦í•©ë‹ˆë‹¤.

- **ë„êµ¬ ê²€ì¦ í™œì„±í™” ì‹œ**: LLMì´ ì„ íƒëœ ë„êµ¬ì˜ íƒ€ë‹¹ì„±ì„ í‰ê°€
- **ì‹¤íŒ¨ ì‹œ**: ë¼ìš°í„°ë¥¼ ìµœëŒ€ 2íšŒê¹Œì§€ ì¬ì‹¤í–‰í•˜ì—¬ ë‹¤ë¥¸ ë„êµ¬ ì„ íƒ
- **í†µê³¼ ì‹œ**: ë„êµ¬ ì‹¤í–‰ìœ¼ë¡œ ì§„í–‰

**ì£¼ìš” í•¨ìˆ˜**: `validate_tool_selection()` (src/agent/nodes.py)

#### 3. ë„êµ¬ ì‹¤í–‰ ë‹¨ê³„ (ğŸ”º)
**ì—­í• **: ì„ íƒëœ ë„êµ¬ë¥¼ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

- **ë„êµ¬ ë˜í¼ ì ìš©**: ëª¨ë“  ë„êµ¬ëŠ” ë˜í¼ë¡œ ê°ì‹¸ì ¸ì„œ ì‹¤í–‰
  - ìë™ìœ¼ë¡œ `tool_status` (`success`/`failed`) ì„¤ì •
  - `tool_result`ë¥¼ AgentStateì— ì €ì¥
- **ê¸°ì¡´ ë°©ì‹ ìœ ì§€**: ë˜í¼ ì—†ì´ ì§ì ‘ ì‹¤í–‰ (ë ˆê±°ì‹œ ì§€ì›)

**ì£¼ìš” í•¨ìˆ˜**: `wrap_tool_node()` (src/agent/tool_wrapper.py)

#### 4. ì‹¤íŒ¨ ê°ì§€ ë‹¨ê³„ (ğŸ”¶)
**ì—­í• **: ë„êµ¬ ì‹¤í–‰ ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³  ë‹¤ìŒ ë™ì‘ì„ ê²°ì •í•©ë‹ˆë‹¤.

- **ì„±ê³µ ì‹œ**:
  - ë‹¤ìŒ ë„êµ¬ê°€ ìˆìœ¼ë©´ íŒŒì´í”„ë¼ì¸ ë¼ìš°í„°ë¡œ ì´ë™
  - ì—†ìœ¼ë©´ ìµœì¢… ë‹µë³€ ë°˜í™˜
- **ì‹¤íŒ¨ ì‹œ**:
  - ì¬ì‹œë„ íšŸìˆ˜ í™•ì¸ (ìµœëŒ€ 3íšŒ)
  - Fallback ë¼ìš°í„°ë¡œ ì´ë™í•˜ì—¬ ëŒ€ì²´ ë„êµ¬ ì„ íƒ

**ì£¼ìš” í•¨ìˆ˜**: `check_pipeline_or_fallback()` (src/agent/graph.py)

#### 5. Fallback ì²´ì¸ ë‹¨ê³„ (ğŸ’¡)
**ì—­í• **: ë„êµ¬ ì‹¤íŒ¨ ì‹œ ìë™ìœ¼ë¡œ ëŒ€ì²´ ë„êµ¬ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

- **Fallback ìš°ì„ ìˆœìœ„**:
  ```
  glossary â†’ general
  search_paper â†’ web_search â†’ general
  summarize â†’ general
  ```
- **ì‹¤íŒ¨ ë„êµ¬ ê¸°ë¡**: ë¬´í•œ ë£¨í”„ ë°©ì§€ë¥¼ ìœ„í•´ ì´ë¯¸ ì‹¤íŒ¨í•œ ë„êµ¬ëŠ” ì¬ì‹œë„ ì•ˆ í•¨
- **ìµœì¢… Fallback**: ëª¨ë“  ë„êµ¬ ì‹¤íŒ¨ ì‹œ `general` (ì¼ë°˜ ë‹µë³€) ê°•ì œ ì‹¤í–‰

**ì£¼ìš” í•¨ìˆ˜**: `fallback_router_node()` (src/agent/nodes.py)

#### 6. ë©€í‹°í„´ ëŒ€í™” (ğŸ”·)
**ì—­í• **: ì´ì „ ëŒ€í™” ë§¥ë½ì„ ìœ ì§€í•˜ì—¬ ì—°ì†ì ì¸ ëŒ€í™”ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

- **ëŒ€í™” íˆìŠ¤í† ë¦¬ ì €ì¥**: ëª¨ë“  ì‚¬ìš©ì/AI ë©”ì‹œì§€ë¥¼ `st.session_state`ì— ì €ì¥
- **ë¬¸ë§¥ ì¶”ì¶œ**: ì´ì „ ëŒ€í™”ì—ì„œ ê´€ë ¨ ì •ë³´ ì¶”ì¶œ
- **ë¼ìš°í„°/ë„êµ¬ì— ì „ë‹¬**: ë¬¸ë§¥ì„ í¬í•¨í•˜ì—¬ ë„êµ¬ ì„ íƒ ë° ì‹¤í–‰

**ì£¼ìš” ë°ì´í„° êµ¬ì¡°**: `AgentState.messages` (List[BaseMessage])

---

## ì°¸ê³  ìë£Œ

### ê´€ë ¨ ë¬¸ì„œ
- [docs/architecture/](../architecture/) - ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ìƒì„¸ ë¬¸ì„œ
- [docs/rules/annotate_style.md](../rules/annotate_style.md) - í•œê¸€ ì£¼ì„ ìŠ¤íƒ€ì¼ ê°€ì´ë“œ
- [docs/rules/mermaid_style.md](../rules/mermaid_style.md) - Mermaid ë‹¤ì´ì–´ê·¸ë¨ ìŠ¤íƒ€ì¼ ê°€ì´ë“œ

---

## ì‘ì„±ì

- **ìµœí˜„í™”[íŒ€ì¥]** (í”„ë¡œì íŠ¸ êµ¬ì¡° ë¬¸ì„œí™”)

