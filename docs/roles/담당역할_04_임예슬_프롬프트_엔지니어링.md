# ë‹´ë‹¹ì—­í• : ì„ì˜ˆìŠ¬ - í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§

## ë‹´ë‹¹ì ì •ë³´
- **ì´ë¦„**: ì„ì˜ˆìŠ¬
- **ì—­í• **: í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ì „ë‹´
- **ì°¸ì—¬ ê¸°ê°„**: ì „ì²´ ê¸°ê°„
- **í•µì‹¬ ì—­í• **: AI Agent ë„êµ¬ ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸, ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸, í‰ê°€ í”„ë¡¬í”„íŠ¸, ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸

---

## ğŸ“Œ ë¬¸ì„œ ëª©ì 

ì´ ë¬¸ì„œëŠ” **í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ì—ë§Œ ì§‘ì¤‘**í•©ë‹ˆë‹¤.

### êµ¬í˜„ ì™„ë£Œëœ ê¸°ëŠ¥ (ë‹¤ë¥¸ ë‹´ë‹¹ì)
- âœ… **Streamlit UI** - ìµœí˜„í™” ([ë‹´ë‹¹ì—­í• _01-3_ìµœí˜„í™”_Streamlit_UI_êµ¬í˜„.md](ë‹´ë‹¹ì—­í• _01-3_ìµœí˜„í™”_Streamlit_UI_êµ¬í˜„.md))
- âœ… **ì›¹ ê²€ìƒ‰ ë„êµ¬** - ìµœí˜„í™”
- âœ… **íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥** - ìµœí˜„í™”
- âœ… **LangGraph ë…¸ë“œ** - ìµœí˜„í™” & ì„ì˜ˆìŠ¬ ([ë‹´ë‹¹ì—­í• _06_í†µí•©_LangGraph_ìŠ¤íŠ¸ë¦¬ë°.md](ë‹´ë‹¹ì—­í• _06_í†µí•©_LangGraph_ìŠ¤íŠ¸ë¦¬ë°.md))

### ì„ì˜ˆìŠ¬ ë‹´ë‹¹ - í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§
- â­ **AI Agent ë„êµ¬ ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸** (ìµœìš°ì„ ìˆœìœ„)
- ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸ (ì¼ë°˜ ë‹µë³€, ì›¹ ê²€ìƒ‰, ë…¼ë¬¸ ê²€ìƒ‰, ìš©ì–´ì§‘, ìš”ì•½, íŒŒì¼ ì €ì¥)
- í‰ê°€ í”„ë¡¬í”„íŠ¸ (LLM-as-a-Judge)
- ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸
- JSON í”„ë¡¬í”„íŠ¸ íŒŒì¼ ì‘ì„± (prompts/ í´ë”)

### ìµœí˜„í™” ë‹´ë‹¹ - í”„ë¡¬í”„íŠ¸ ë¡œë” ì ìš©
- âœ… **Prompt Loader ì´ˆê¸° êµ¬í˜„ ì™„ë£Œ** (`src/prompts/loader.py`)
- â­ **ê¸°ì¡´ ì½”ë“œì— Prompt JSON íŒŒì¼ ì ìš©** (ìš°ì„ ìˆœìœ„ ë†’ìŒ)
  - router_nodeì— JSON í”„ë¡¬í”„íŠ¸ ì ìš©
  - 6ê°œ ë„êµ¬ ë…¸ë“œì— JSON í”„ë¡¬í”„íŠ¸ ì ìš©
  - í•˜ë“œì½”ë”©ëœ í”„ë¡¬í”„íŠ¸ ì œê±°

---

## 1. í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ê°œìš”

### 1.1 í”„ë¡œì íŠ¸ì—ì„œ í”„ë¡¬í”„íŠ¸ì˜ ì—­í• 

**í”„ë¡¬í”„íŠ¸ê°€ ì‚¬ìš©ë˜ëŠ” ìœ„ì¹˜:**
1. **ë„êµ¬ ë¼ìš°íŒ…** (`src/agent/nodes.py:router_node`) - ê°€ì¥ ì¤‘ìš”!
2. **ë„êµ¬ë³„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸** (ê° ë„êµ¬ ë…¸ë“œ)
3. **í‰ê°€ í”„ë¡¬í”„íŠ¸** (`src/evaluation/evaluator.py`)
4. **ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸** (ìë™ ì§ˆë¬¸ ìƒì„±)

### 1.2 ë©˜í† ë‹˜ ì¸ì‚¬ì´íŠ¸ ë°˜ì˜

**ë©˜í† ë§(2025-10-30)ì—ì„œ ê°•ì¡°ëœ í”„ë¡¬í”„íŠ¸ ì „ëµ:**

1. **ë„êµ¬ ì„¤ëª… ìƒì„¸í™”**
   - ê° ë„êµ¬ì˜ ì—­í• ê³¼ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ëª…í™•í•˜ê²Œ ê¸°ì¬
   - í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ ì œê³µ

2. **Few-shot ì˜ˆì‹œ**
   - ê° ë„êµ¬ë³„ 2-3ê°œì˜ ëŒ€í‘œ ì˜ˆì‹œ ì œê³µ
   - LLMì´ íŒ¨í„´ì„ í•™ìŠµí•˜ë„ë¡ ì§€ì›

3. **ì‹œë‚˜ë¦¬ì˜¤ í…œí”Œë¦¿**
   - ì˜ˆìƒë˜ëŠ” ì§ˆë¬¸ íŒ¨í„´ì„ ë¯¸ë¦¬ ì •ì˜
   - ì¡°ê±´ë¬¸ ëª…í™•í™” ("ë§Œì•½ ~ì´ë©´ A ë„êµ¬ ì‚¬ìš©")

4. **êµ¬ì¡°í™”ëœ ì¶œë ¥**
   - JSON í˜•ì‹ìœ¼ë¡œ ì¼ê´€ëœ ì‘ë‹µ ìš”ì²­
   - íŒŒì‹± ì˜¤ë¥˜ ìµœì†Œí™”

5. **ì¬ë¼ìš°íŒ… ë° Fallback**
   - ì˜ëª»ëœ ë„êµ¬ ì„ íƒ ì‹œ ë‹¤ì‹œ ë¼ìš°íŒ…
   - í•˜ì§€ë§Œ **í”„ë¡¬í”„íŒ…ì„ ì˜í•´ì„œ ì²˜ìŒë¶€í„° ì •í™•í•œ ë„êµ¬ ì„ íƒì´ ë” ì¤‘ìš”**

---

## 2. AI Agent ë„êµ¬ ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ â­â­â­

### 2.1 ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ì˜ ì¤‘ìš”ì„±

**AI Agentì˜ í•µì‹¬ì€ ë„êµ¬ ë¼ìš°íŒ…ì…ë‹ˆë‹¤!**

- ì‚¬ìš©ì ì§ˆë¬¸ì„ ì •í™•í•˜ê²Œ ë¶„ì„í•˜ì—¬ 6ê°œ ë„êµ¬ ì¤‘ ê°€ì¥ ì ì ˆí•œ ë„êµ¬ ì„ íƒ
- **ë¼ìš°íŒ… ì •í™•ë„ = Agent ì„±ëŠ¥**
- ì˜ëª»ëœ ë„êµ¬ ì„ íƒ ì‹œ ë‹µë³€ í’ˆì§ˆ ì €í•˜

### 2.2 6ê°œ ë„êµ¬ ëª©ë¡

1. **general** - ì¼ë°˜ ë‹µë³€ (ë¹„êµ, ì„¤ëª…, ê°œë… ì§ˆë¬¸)
2. **search_paper** - ë…¼ë¬¸ ë°ì´í„°ë² ì´ìŠ¤ ê²€ìƒ‰ (íŠ¹ì • ë…¼ë¬¸)
3. **web_search** - ì›¹ ê²€ìƒ‰ (ìµœì‹  ì •ë³´, íŠ¸ë Œë“œ)
4. **glossary** - ìš©ì–´ì§‘ (ë‹¨ì¼ ìš©ì–´ ì •ì˜ë§Œ)
5. **summarize** - ë…¼ë¬¸ ìš”ì•½
6. **save_file** - íŒŒì¼ ì €ì¥

### 2.3 ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ (ìƒì„¸ ë²„ì „)

**íŒŒì¼ ê²½ë¡œ**: `src/prompts/routing_prompts.json`

**í˜„ì¬ ìœ„ì¹˜**: `src/agent/nodes.py:router_node` (í•˜ë“œì½”ë”©ë¨)

**ê°œì„ ëœ ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸:**

```
ë‹¹ì‹ ì€ ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ê°€ì¥ ì ì ˆí•œ ë„êµ¬ë¥¼ ì„ íƒí•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

[ë„êµ¬ ëª©ë¡ ë° ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤]

1. **search_paper** (ë…¼ë¬¸ ë°ì´í„°ë² ì´ìŠ¤ ê²€ìƒ‰)
   - ì‚¬ìš© ì‹œê¸°: íŠ¹ì • ë…¼ë¬¸ ë‚´ìš©, ì—°êµ¬ ë°©ë²•, ì•Œê³ ë¦¬ì¦˜ ê²€ìƒ‰
   - í‚¤ì›Œë“œ: "ë…¼ë¬¸", "ì—°êµ¬", "ë°©ë²•", "ì•Œê³ ë¦¬ì¦˜", "ì°¾ì•„ì¤˜", "ê²€ìƒ‰", "ë°ì´í„°ë² ì´ìŠ¤"
   - ì˜ˆì‹œ:
     * "RAGì— ëŒ€í•œ ë…¼ë¬¸ ì°¾ì•„ì¤˜"
     * "Transformer ì—°êµ¬ ë°©ë²• ì•Œë ¤ì¤˜"
     * "BERT ë…¼ë¬¸ ê²€ìƒ‰"
   - âŒ ìµœì‹  ì •ë³´ëŠ” web_search ì‚¬ìš©

2. **web_search** (ì›¹ ê²€ìƒ‰)
   - ì‚¬ìš© ì‹œê¸°: ìµœì‹  ì •ë³´, ë‰´ìŠ¤, íŠ¸ë Œë“œ, ì‹¤ì‹œê°„ ê²€ìƒ‰
   - í‚¤ì›Œë“œ: "ìµœì‹ ", "2024ë…„", "2025ë…„", "ë‰´ìŠ¤", "íŠ¸ë Œë“œ", "ìµœê·¼"
   - ì˜ˆì‹œ:
     * "ìµœì‹  AI ë‰´ìŠ¤"
     * "2024ë…„ ë…¼ë¬¸ íŠ¸ë Œë“œ"
     * "ìµœê·¼ Transformer ë°œì „"
   - âŒ íŠ¹ì • ë…¼ë¬¸ì€ search_paper ì‚¬ìš©

3. **glossary** (ìš©ì–´ì§‘ - ë‹¨ì¼ ìš©ì–´ ì •ì˜ë§Œ)
   - ì‚¬ìš© ì‹œê¸°: í•˜ë‚˜ì˜ ì „ë¬¸ ìš©ì–´ ì •ì˜ì™€ ì„¤ëª…
   - í‚¤ì›Œë“œ: "ë­ì•¼", "ë¬´ì—‡", "ì •ì˜", "ì„¤ëª…í•´ì¤˜", "ì˜ë¯¸"
   - ì˜ˆì‹œ:
     * "BERTê°€ ë­ì•¼?"
     * "Attention ì„¤ëª…í•´ì¤˜"
     * "RAGì˜ ì •ì˜ëŠ”?"
   - âŒ ë¹„êµ ì§ˆë¬¸ì€ general ì‚¬ìš© ("Aì™€ Bì˜ ì°¨ì´")
   - âŒ ë‘ ê°œ ì´ìƒ ìš©ì–´ëŠ” general ì‚¬ìš©

4. **summarize** (ë…¼ë¬¸ ìš”ì•½)
   - ì‚¬ìš© ì‹œê¸°: ë…¼ë¬¸ ì „ì²´ ë˜ëŠ” íŠ¹ì • ì„¹ì…˜ ìš”ì•½
   - í‚¤ì›Œë“œ: "ìš”ì•½", "í•µì‹¬", "ê°„ë‹¨íˆ", "ì •ë¦¬", "ìš”ì•½í•´ì¤˜"
   - ì˜ˆì‹œ:
     * "ì´ ë…¼ë¬¸ ìš”ì•½í•´ì¤˜"
     * "Attention Is All You Need í•µì‹¬ ë‚´ìš©"
     * "ë…¼ë¬¸ ê°„ë‹¨íˆ ì •ë¦¬í•´ì¤˜"

5. **save_file** (íŒŒì¼ ì €ì¥)
   - ì‚¬ìš© ì‹œê¸°: ëŒ€í™” ë‚´ìš©ì´ë‚˜ ê²°ê³¼ë¥¼ íŒŒì¼ë¡œ ì €ì¥
   - í‚¤ì›Œë“œ: "ì €ì¥", "ë‹¤ìš´ë¡œë“œ", "íŒŒì¼", "ë‚´ë³´ë‚´ê¸°"
   - ì˜ˆì‹œ:
     * "íŒŒì¼ë¡œ ì €ì¥í•´ì¤˜"
     * "ëŒ€í™” ë‚´ìš© ë‹¤ìš´ë¡œë“œ"
     * "ê²°ê³¼ ì €ì¥"

6. **general** (ì¼ë°˜ ë‹µë³€ - ê¸°ë³¸ ë„êµ¬)
   - ì‚¬ìš© ì‹œê¸°:
     * ë¹„êµ ì§ˆë¬¸ ("Aì™€ Bì˜ ì°¨ì´")
     * ê°œë… ì„¤ëª… ("ì–´ë–»ê²Œ ì‘ë™í•´?")
     * ì¸ì‚¬, ê°ì‚¬ ("ì•ˆë…•", "ê³ ë§ˆì›Œ")
     * ìœ„ì˜ íŠ¹ìˆ˜ ë„êµ¬ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ê²½ìš°
   - í‚¤ì›Œë“œ: "ì°¨ì´", "ë¹„êµ", "vs", "êµ¬ë³„", "ì„¤ëª…", "ì–´ë–»ê²Œ"
   - ì˜ˆì‹œ:
     * "BERTì™€ GPTì˜ ì°¨ì´ëŠ”?"
     * "Transformerê°€ RNNë³´ë‹¤ ë‚˜ì€ ì´ìœ ëŠ”?"
     * "ì•ˆë…•í•˜ì„¸ìš”"

[ì¤‘ìš”í•œ ê·œì¹™]
- **ë¹„êµ ì§ˆë¬¸** ("ì°¨ì´", "vs", "ë¹„êµ", "êµ¬ë³„") â†’ general
- **ë‘ ê°œ ì´ìƒì˜ ìš©ì–´** â†’ general (glossaryëŠ” ë‹¨ì¼ ìš©ì–´ë§Œ!)
- **ìµœì‹  ì •ë³´** ("ìµœì‹ ", "2024ë…„", "ìµœê·¼") â†’ web_search
- **íŠ¹ì • ë…¼ë¬¸** ("ë…¼ë¬¸ ì°¾ì•„ì¤˜", "ë…¼ë¬¸ ê²€ìƒ‰") â†’ search_paper
- **ë‹¨ì¼ ìš©ì–´ ì •ì˜** ("~ê°€ ë­ì•¼", "~ì˜ ì •ì˜") â†’ glossary
- **ìš”ì•½** ("ìš”ì•½í•´ì¤˜", "í•µì‹¬ ë‚´ìš©") â†’ summarize
- **íŒŒì¼ ì €ì¥** ("ì €ì¥", "ë‹¤ìš´ë¡œë“œ") â†’ save_file

[ì„ íƒ ê·œì¹™]
- ìœ„ 6ê°œ ë„êµ¬ ì¤‘ **í•˜ë‚˜ë§Œ** ì„ íƒ
- ë„êµ¬ ì´ë¦„ë§Œ ë°˜í™˜ (ì˜ˆ: search_paper)
- í‚¤ì›Œë“œì™€ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ íŒë‹¨
- ì• ë§¤í•œ ê²½ìš° general ì„ íƒ

[ì‚¬ìš©ì ì§ˆë¬¸]
{question}

[ì„ íƒí•œ ë„êµ¬]
í•˜ë‚˜ì˜ ë„êµ¬ ì´ë¦„ë§Œ ë°˜í™˜í•˜ì„¸ìš”:
```

### 2.4 Few-shot ì˜ˆì‹œ ì¶”ê°€

**Few-shot ì˜ˆì‹œëŠ” ë¼ìš°íŒ… ì •í™•ë„ë¥¼ í¬ê²Œ í–¥ìƒì‹œí‚µë‹ˆë‹¤!**

**JSON í˜•ì‹ (src/prompts/routing_prompts.jsonì— ì €ì¥):**

```json
{
  "routing_prompt": "ìœ„ì˜ ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ ì „ë¬¸",
  "few_shot_examples": [
    {
      "question": "BERTê°€ ë­ì•¼?",
      "tool": "glossary",
      "reason": "ë‹¨ì¼ ìš©ì–´(BERT) ì •ì˜ ì§ˆë¬¸"
    },
    {
      "question": "RAG ë…¼ë¬¸ ì°¾ì•„ì¤˜",
      "tool": "search_paper",
      "reason": "íŠ¹ì • ë…¼ë¬¸ ê²€ìƒ‰"
    },
    {
      "question": "ìµœì‹  AI ë‰´ìŠ¤",
      "tool": "web_search",
      "reason": "ìµœì‹  ì •ë³´ ê²€ìƒ‰"
    },
    {
      "question": "ì´ ë…¼ë¬¸ ìš”ì•½í•´ì¤˜",
      "tool": "summarize",
      "reason": "ë…¼ë¬¸ ìš”ì•½ ìš”ì²­"
    },
    {
      "question": "ëŒ€í™” ë‚´ìš© ì €ì¥í•´ì¤˜",
      "tool": "save_file",
      "reason": "íŒŒì¼ ì €ì¥ ìš”ì²­"
    },
    {
      "question": "BERTì™€ GPTì˜ ì°¨ì´ëŠ”?",
      "tool": "general",
      "reason": "ë¹„êµ ì§ˆë¬¸ (ë‘ ê°œ ìš©ì–´)"
    },
    {
      "question": "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜",
      "tool": "search_paper",
      "reason": "íŠ¹ì • ë…¼ë¬¸ ê²€ìƒ‰"
    },
    {
      "question": "Attentionì´ ë­ì•¼?",
      "tool": "glossary",
      "reason": "ë‹¨ì¼ ìš©ì–´(Attention) ì •ì˜ ì§ˆë¬¸"
    },
    {
      "question": "2024ë…„ ìµœì‹  ì—°êµ¬ ë™í–¥",
      "tool": "web_search",
      "reason": "ìµœì‹  ì •ë³´ + ì—°ë„ í‚¤ì›Œë“œ"
    },
    {
      "question": "Transformerê°€ RNNë³´ë‹¤ ë‚˜ì€ ì´ìœ ëŠ”?",
      "tool": "general",
      "reason": "ë¹„êµ ë° ì„¤ëª… ì§ˆë¬¸"
    }
  ]
}
```

**Few-shot í”„ë¡¬í”„íŠ¸ ì ìš© ë°©ë²•:**

```python
# src/agent/nodes.py

from langchain.prompts import FewShotPromptTemplate, PromptTemplate
import json

# Few-shot ì˜ˆì‹œ ë¡œë“œ
with open("src/prompts/routing_prompts.json", "r", encoding="utf-8") as f:
    routing_data = json.load(f)

few_shot_examples = routing_data["few_shot_examples"]

# ì˜ˆì‹œ í…œí”Œë¦¿
example_template = """
ì§ˆë¬¸: {question}
ë„êµ¬: {tool}
ì´ìœ : {reason}
"""

example_prompt = PromptTemplate(
    template=example_template,
    input_variables=["question", "tool", "reason"]
)

# Few-shot í”„ë¡¬í”„íŠ¸ ìƒì„±
few_shot_prompt = FewShotPromptTemplate(
    examples=few_shot_examples[:5],  # ìƒìœ„ 5ê°œ ì˜ˆì‹œ ì‚¬ìš©
    example_prompt=example_prompt,
    prefix=routing_data["routing_prompt"],
    suffix="ì§ˆë¬¸: {question}\në„êµ¬:",
    input_variables=["question"]
)
```

### 2.5 ì¬ë¼ìš°íŒ… ë° Fallback ì²˜ë¦¬

**ì˜ëª»ëœ ë„êµ¬ ì„ íƒ ì‹œ ì¬ì‹œë„ ë¡œì§:**

```python
# src/agent/nodes.py

def route_with_fallback(state: AgentState, exp_manager=None):
    """ì¬ë¼ìš°íŒ… ì§€ì› ë¼ìš°íŒ… í•¨ìˆ˜"""

    question = state["question"]
    retry_count = state.get("retry_count", 0)

    # ìœ íš¨í•œ ë„êµ¬ ëª©ë¡
    valid_tools = ["search_paper", "web_search", "glossary", "summarize", "save_file", "general"]

    try:
        # LLM í˜¸ì¶œ
        llm_client = LLMClient.from_difficulty(
            difficulty=state.get("difficulty", "easy"),
            logger=exp_manager.logger if exp_manager else None
        )

        tool_choice = llm_client.llm.invoke(routing_prompt.format(question=question)).content.strip()

        # ì‘ë‹µ íŒŒì‹± (ì²« ë²ˆì§¸ ë‹¨ì–´ë§Œ)
        tool_choice = tool_choice.split()[0] if tool_choice else "general"

        # ìœ íš¨ì„± ê²€ì¦
        if tool_choice not in valid_tools:
            if exp_manager:
                exp_manager.logger.write(f"ì˜ëª»ëœ ë„êµ¬ ì„ íƒ: {tool_choice}")

            if retry_count < 2:
                # ì¬ì‹œë„
                state["retry_count"] = retry_count + 1
                return route_with_fallback(state, exp_manager)
            else:
                # Fallback: general ë„êµ¬ ì‚¬ìš©
                if exp_manager:
                    exp_manager.logger.write("Fallback: general ë„êµ¬ ì‚¬ìš©")
                return "general"

        return tool_choice

    except Exception as e:
        if exp_manager:
            exp_manager.logger.write(f"ë¼ìš°íŒ… ì‹¤íŒ¨: {e}", print_error=True)
        return "general"  # Fallback
```

---

## 3. ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸

### 3.1 ì¼ë°˜ ë‹µë³€ í”„ë¡¬í”„íŠ¸

**íŒŒì¼ ê²½ë¡œ**: `src/tools/general_answer.py` (lines 37-50)

**í˜„ì¬ êµ¬í˜„**: ë‚œì´ë„ë³„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ í•˜ë“œì½”ë”©

**ê°œì„ ëœ í”„ë¡¬í”„íŠ¸ (JSON í˜•ì‹):**

```json
{
  "general_answer_prompts": {
    "easy": {
      "system_prompt": "ë‹¹ì‹ ì€ ì¹œì ˆí•œ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.\nì´ˆì‹¬ìë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì‰½ê³  ëª…í™•í•˜ê²Œ ë‹µë³€í•´ì£¼ì„¸ìš”.\n\në‹µë³€ ê·œì¹™:\n- ì „ë¬¸ ìš©ì–´ëŠ” ìµœì†Œí™”í•˜ê³  ì¼ìƒì ì¸ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”\n- ë³µì¡í•œ ê°œë…ì€ ê°„ë‹¨í•œ ë¹„ìœ ë¡œ ì„¤ëª…í•˜ì„¸ìš” (ì˜ˆ: 'ë§ˆì¹˜ ~ì²˜ëŸ¼')\n- ì¹œê·¼í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ í†¤ì„ ìœ ì§€í•˜ì„¸ìš”\n- í•µì‹¬ ì•„ì´ë””ì–´ 3ê°€ì§€ ì´ë‚´ë¡œ ìš”ì•½í•˜ì„¸ìš”",
      "examples": [
        {
          "question": "Attentionì´ ë­ì•¼?",
          "answer": "Attentionì€ ë§ˆì¹˜ ì—¬ëŸ¬ ë‹¨ì–´ ì¤‘ì—ì„œ ì¤‘ìš”í•œ ë‹¨ì–´ì— ì§‘ì¤‘í•˜ëŠ” ê²ƒê³¼ ê°™ì•„ìš”. ì˜ˆë¥¼ ë“¤ì–´ 'ë‚˜ëŠ” ì‚¬ê³¼ë¥¼ ë¨¹ì—ˆë‹¤'ë¼ëŠ” ë¬¸ì¥ì—ì„œ 'ì‚¬ê³¼'ì™€ 'ë¨¹ì—ˆë‹¤'ê°€ ì¤‘ìš”í•˜ì£ . AIë„ ì´ëŸ° ì‹ìœ¼ë¡œ ì¤‘ìš”í•œ ì •ë³´ì— ì§‘ì¤‘í•´ìš”!"
        }
      ]
    },
    "hard": {
      "system_prompt": "ë‹¹ì‹ ì€ ì „ë¬¸ì ì¸ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.\nê¸°ìˆ ì ì¸ ì„¸ë¶€ì‚¬í•­ì„ í¬í•¨í•˜ì—¬ ì •í™•í•˜ê³  ì „ë¬¸ì ìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.\n\në‹µë³€ ê·œì¹™:\n- ê¸°ìˆ  ìš©ì–´ì™€ ì „ë¬¸ ê°œë…ì„ ììœ ë¡­ê²Œ ì‚¬ìš©í•˜ì„¸ìš”\n- ê¹Šì´ ìˆëŠ” ì„¤ëª…ê³¼ ìƒì„¸í•œ ì •ë³´ë¥¼ ì œê³µí•˜ì„¸ìš”\n- ì•Œê³ ë¦¬ì¦˜ì˜ ì‹œê°„/ê³µê°„ ë³µì¡ë„ë¥¼ ë¶„ì„í•˜ì„¸ìš”\n- ê´€ë ¨ ë…¼ë¬¸ê³¼ì˜ ë¹„êµë¥¼ í¬í•¨í•˜ì„¸ìš”\n- ì „ë¬¸ê°€ ìˆ˜ì¤€ì˜ ì •í™•ì„±ì„ ìœ ì§€í•˜ì„¸ìš”",
      "examples": [
        {
          "question": "Attention ë©”ì»¤ë‹ˆì¦˜ì˜ ì‹œê°„ ë³µì¡ë„ëŠ”?",
          "answer": "Self-Attentionì˜ ì‹œê°„ ë³µì¡ë„ëŠ” O(nÂ²d)ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ nì€ ì‹œí€€ìŠ¤ ê¸¸ì´, dëŠ” ì„ë² ë”© ì°¨ì›ì…ë‹ˆë‹¤. Query, Key, Value í–‰ë ¬ ê³„ì‚°ì´ O(ndÂ²), Attention Score ê³„ì‚°ì´ O(nÂ²d)ì´ë¯€ë¡œ ì „ì²´ ë³µì¡ë„ëŠ” ì‹œí€€ìŠ¤ ê¸¸ì´ì— ì œê³±ìœ¼ë¡œ ì¦ê°€í•©ë‹ˆë‹¤. ì´ëŠ” ê¸´ ì‹œí€€ìŠ¤ ì²˜ë¦¬ ì‹œ ë³‘ëª©ì´ ë˜ë©°, Linformer, Performer ë“±ì˜ íš¨ìœ¨ì ì¸ ë³€í˜•ì´ ì œì•ˆë˜ì—ˆìŠµë‹ˆë‹¤."
        }
      ]
    }
  }
}
```

### 3.2 ì›¹ ê²€ìƒ‰ í”„ë¡¬í”„íŠ¸

**íŒŒì¼ ê²½ë¡œ**: `src/tools/web_search.py` (lines 119-147)

**ê°œì„ ëœ í”„ë¡¬í”„íŠ¸:**

```json
{
  "web_search_prompts": {
    "easy": {
      "system_prompt": "ë‹¹ì‹ ì€ ìµœì‹  ë…¼ë¬¸ ì •ë³´ë¥¼ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\nì´ˆì‹¬ìë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì •ë¦¬í•´ì£¼ì„¸ìš”.\n\në‹µë³€ ê·œì¹™:\n- í•µì‹¬ ë‚´ìš©ì„ ê°„ë‹¨íˆ ìš”ì•½í•˜ì„¸ìš”\n- ì‰¬ìš´ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”\n- ì¤‘ìš”í•œ ì •ë³´ë§Œ ì„ ë³„í•˜ì„¸ìš”\n- ì¹œê·¼í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ í†¤ì„ ìœ ì§€í•˜ì„¸ìš”\n- ê° ì¶œì²˜ì˜ URLì„ ë°˜ë“œì‹œ í¬í•¨í•˜ì„¸ìš”",
      "user_prompt_template": "[ì›¹ ê²€ìƒ‰ ê²°ê³¼]\n{formatted_results}\n\n[ì§ˆë¬¸]\n{question}\n\nìœ„ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”.\n**ì¤‘ìš”**: ê° ë…¼ë¬¸ì´ë‚˜ ì •ë³´ ì¶œì²˜ì˜ URLì„ ë°˜ë“œì‹œ í¬í•¨í•˜ì„¸ìš”.\nì˜ˆì‹œ í˜•ì‹:\n- ë…¼ë¬¸ ì œëª© ([ë§í¬](URL))\në˜ëŠ”\nğŸ”— ì¶œì²˜: [ì œëª©](URL)"
    },
    "hard": {
      "system_prompt": "ë‹¹ì‹ ì€ ë…¼ë¬¸ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\nê²€ìƒ‰ ê²°ê³¼ë¥¼ ì „ë¬¸ì ìœ¼ë¡œ ì •ë¦¬í•´ì£¼ì„¸ìš”.\n\në‹µë³€ ê·œì¹™:\n- ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ì„ í¬í•¨í•˜ì„¸ìš”\n- ìµœì‹  ì—°êµ¬ ë™í–¥ì„ ë¶„ì„í•˜ì„¸ìš”\n- ê´€ë ¨ ë…¼ë¬¸ë“¤ì„ ë¹„êµí•˜ì„¸ìš”\n- ì „ë¬¸ê°€ ìˆ˜ì¤€ì˜ ì •í™•ì„±ì„ ìœ ì§€í•˜ì„¸ìš”\n- ê° ì¶œì²˜ì˜ URLì„ ë°˜ë“œì‹œ í¬í•¨í•˜ì„¸ìš”",
      "user_prompt_template": "[ì›¹ ê²€ìƒ‰ ê²°ê³¼]\n{formatted_results}\n\n[ì§ˆë¬¸]\n{question}\n\nìœ„ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”.\n**ì¤‘ìš”**: ê° ë…¼ë¬¸ì´ë‚˜ ì •ë³´ ì¶œì²˜ì˜ URLì„ ë°˜ë“œì‹œ í¬í•¨í•˜ì„¸ìš”.\nì˜ˆì‹œ í˜•ì‹:\n- ë…¼ë¬¸ ì œëª© ([ë§í¬](URL))\në˜ëŠ”\nğŸ”— ì¶œì²˜: [ì œëª©](URL)"
    }
  }
}
```

### 3.3 ë…¼ë¬¸ ìš”ì•½ í”„ë¡¬í”„íŠ¸

**íŒŒì¼ ê²½ë¡œ**: `src/tools/summarize.py` (lines 58-63, 157-168)

**ê°œì„ ëœ í”„ë¡¬í”„íŠ¸:**

```json
{
  "summarize_prompts": {
    "title_extraction": {
      "template": "ë‹¤ìŒ ì§ˆë¬¸ì—ì„œ ìš”ì•½í•˜ë ¤ëŠ” ë…¼ë¬¸ì˜ ì œëª©ì„ ì¶”ì¶œí•˜ì„¸ìš”.\në…¼ë¬¸ ì œëª©ë§Œ ì •í™•íˆ ë°˜í™˜í•˜ì„¸ìš”. ë‹¤ë¥¸ ì„¤ëª…ì€ ë¶ˆí•„ìš”í•©ë‹ˆë‹¤.\n\nì§ˆë¬¸: {question}\n\në…¼ë¬¸ ì œëª©:"
    },
    "easy": {
      "system_prompt": "ë‹¹ì‹ ì€ ë…¼ë¬¸ì„ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.\nì´ˆì‹¬ìë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ë‹¤ìŒ ë…¼ë¬¸ì„ ìš”ì•½í•´ì£¼ì„¸ìš”:\n\në‹µë³€ ê·œì¹™:\n- í•µì‹¬ ë‚´ìš©ì„ ê°„ë‹¨í•˜ê³  ëª…í™•í•˜ê²Œ ì„¤ëª…\n- ì „ë¬¸ ìš©ì–´ëŠ” ì‰¬ìš´ ë§ë¡œ í’€ì–´ì„œ ì„¤ëª…\n- 3-5ê°œì˜ ì£¼ìš” í¬ì¸íŠ¸ë¡œ ì •ë¦¬\n- ì‹¤ìƒí™œ ë¹„ìœ  ì‚¬ìš©",
      "summary_template": "{system_prompt}\n\në…¼ë¬¸ ì •ë³´:\n- ì œëª©: {title}\n- ì €ì: {authors}\n- ë°œí–‰ì¼: {publish_date}\n- ì´ˆë¡: {abstract}\n\në…¼ë¬¸ ë‚´ìš©:\n{combined_text}\n\nìœ„ ë…¼ë¬¸ì˜ ë°©ë²•ë¡  ë¶€ë¶„ì„ ì¤‘ì‹¬ìœ¼ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”.\nìš”ì•½:"
    },
    "hard": {
      "system_prompt": "ë‹¹ì‹ ì€ ì „ë¬¸ì ì¸ ë…¼ë¬¸ ë¶„ì„ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.\në‹¤ìŒ ë…¼ë¬¸ì„ ì „ë¬¸ì ìœ¼ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”:\n\në‹µë³€ ê·œì¹™:\n- ì—°êµ¬ ëª©ì , ë°©ë²•ë¡ , ì£¼ìš” ê²°ê³¼, ê²°ë¡ ì„ í¬í•¨\n- ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ê³¼ í•µì‹¬ ê¸°ì—¬ë„ ê°•ì¡°\n- í•™ìˆ ì  ê´€ì ì—ì„œ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„\n- ì•Œê³ ë¦¬ì¦˜ì˜ ì‹œê°„/ê³µê°„ ë³µì¡ë„ ì–¸ê¸‰",
      "summary_template": "{system_prompt}\n\në…¼ë¬¸ ì •ë³´:\n- ì œëª©: {title}\n- ì €ì: {authors}\n- ë°œí–‰ì¼: {publish_date}\n- ì´ˆë¡: {abstract}\n\në…¼ë¬¸ ë‚´ìš©:\n{combined_text}\n\nìœ„ ë…¼ë¬¸ì˜ ë°©ë²•ë¡  ë¶€ë¶„ì„ ì¤‘ì‹¬ìœ¼ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”.\nìš”ì•½:"
    }
  }
}
```

### 3.4 ìš©ì–´ì§‘ í”„ë¡¬í”„íŠ¸

**íŒŒì¼ ê²½ë¡œ**: `src/tools/glossary.py`

**ìš©ì–´ì§‘ í”„ë¡¬í”„íŠ¸ (ë‚œì´ë„ë³„):**

```json
{
  "glossary_prompts": {
    "easy": {
      "system_prompt": "ë‹¹ì‹ ì€ AI ìš©ì–´ë¥¼ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” ì¹œì ˆí•œ ì„ ìƒë‹˜ì…ë‹ˆë‹¤.\nì´ˆì‹¬ìë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ìš©ì–´ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”.\n\në‹µë³€ ê·œì¹™:\n- ì „ë¬¸ ìš©ì–´ëŠ” ì‰¬ìš´ ë§ë¡œ í’€ì–´ì„œ ì„¤ëª…í•˜ì„¸ìš”\n- ì‹¤ìƒí™œ ë¹„ìœ ë¥¼ ì‚¬ìš©í•˜ì„¸ìš” (ì˜ˆ: 'ë§ˆì¹˜ ~ì²˜ëŸ¼')\n- í•µì‹¬ë§Œ ê°„ë‹¨íˆ ì„¤ëª…í•˜ì„¸ìš”\n- ì¹œê·¼í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ í†¤ì„ ìœ ì§€í•˜ì„¸ìš”"
    },
    "hard": {
      "system_prompt": "ë‹¹ì‹ ì€ AI ìš©ì–´ë¥¼ ì „ë¬¸ì ìœ¼ë¡œ ì„¤ëª…í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\nê¸°ìˆ ì ì¸ ì„¸ë¶€ì‚¬í•­ì„ í¬í•¨í•˜ì—¬ ì •í™•í•˜ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”.\n\në‹µë³€ ê·œì¹™:\n- ê¸°ìˆ  ìš©ì–´ì™€ ì „ë¬¸ ê°œë…ì„ ììœ ë¡­ê²Œ ì‚¬ìš©í•˜ì„¸ìš”\n- ìˆ˜ì‹ì´ë‚˜ ì•Œê³ ë¦¬ì¦˜ì„ í¬í•¨í•˜ì„¸ìš”\n- ê´€ë ¨ ë…¼ë¬¸ì´ë‚˜ ì—°êµ¬ë¥¼ ì–¸ê¸‰í•˜ì„¸ìš”\n- ì „ë¬¸ê°€ ìˆ˜ì¤€ì˜ ì •í™•ì„±ì„ ìœ ì§€í•˜ì„¸ìš”"
    }
  }
}
```

### 3.5 ë…¼ë¬¸ ê²€ìƒ‰ í”„ë¡¬í”„íŠ¸

**íŒŒì¼ ê²½ë¡œ**: `src/tools/search_paper.py`

**ë…¼ë¬¸ ê²€ìƒ‰ í”„ë¡¬í”„íŠ¸ (ë‚œì´ë„ë³„):**

```json
{
  "search_paper_prompts": {
    "easy": {
      "system_prompt": "ë‹¹ì‹ ì€ ë…¼ë¬¸ì„ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\nê²€ìƒ‰ëœ ë…¼ë¬¸ì„ ì´ˆì‹¬ìë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì •ë¦¬í•´ì£¼ì„¸ìš”.\n\në‹µë³€ ê·œì¹™:\n- í•µì‹¬ ë‚´ìš©ì„ ê°„ë‹¨íˆ ìš”ì•½\n- ì „ë¬¸ ìš©ì–´ëŠ” ì‰¬ìš´ ë§ë¡œ ì„¤ëª…\n- ë…¼ë¬¸ ì œëª©, ì €ì, ë°œí–‰ì¼ ëª…ì‹œ\n- ì¹œê·¼í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ í†¤ ìœ ì§€"
    },
    "hard": {
      "system_prompt": "ë‹¹ì‹ ì€ ë…¼ë¬¸ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\nê²€ìƒ‰ëœ ë…¼ë¬¸ì„ ì „ë¬¸ì ìœ¼ë¡œ ì •ë¦¬í•´ì£¼ì„¸ìš”.\n\në‹µë³€ ê·œì¹™:\n- ì—°êµ¬ ëª©ì ê³¼ ë°©ë²•ë¡  ë¶„ì„\n- ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ í¬í•¨\n- í•µì‹¬ ê¸°ì—¬ë„ì™€ í•œê³„ì  ëª…ì‹œ\n- ê´€ë ¨ ì—°êµ¬ì™€ ë¹„êµ\n- ë…¼ë¬¸ ì œëª©, ì €ì, ë°œí–‰ì¼ ëª…ì‹œ"
    }
  }
}
```

---

## 4. í‰ê°€ í”„ë¡¬í”„íŠ¸ (LLM-as-a-Judge)

### 4.1 ë‹µë³€ í’ˆì§ˆ í‰ê°€ í”„ë¡¬í”„íŠ¸

**íŒŒì¼ ê²½ë¡œ**: `src/evaluation/evaluator.py`

**ëª©ì **: ì±—ë´‡ì˜ ë‹µë³€ í’ˆì§ˆì„ ìë™ìœ¼ë¡œ í‰ê°€

**í‰ê°€ í•­ëª©:**
1. **ì •í™•ë„** (0-10ì ): ë…¼ë¬¸ ë‚´ìš©ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€
2. **ê´€ë ¨ì„±** (0-10ì ): ì§ˆë¬¸ê³¼ ë‹µë³€ì´ ê´€ë ¨ìˆëŠ”ì§€
3. **ë‚œì´ë„ ì í•©ì„±** (0-10ì ): Easy/Hard ëª¨ë“œì— ë§ëŠ”ì§€
4. **ì¶œì²˜ ëª…ì‹œ** (0-10ì ): ë…¼ë¬¸ ì œëª©, ì €ì ëª…ì‹œ ì—¬ë¶€

**í‰ê°€ í”„ë¡¬í”„íŠ¸:**

```json
{
  "evaluation_prompt": {
    "template": "ë‹¤ìŒ AI ì±—ë´‡ì˜ ë‹µë³€ì„ í‰ê°€í•´ì£¼ì„¸ìš”.\n\n[ì‚¬ìš©ì ì§ˆë¬¸]\n{question}\n\n[AI ë‹µë³€]\n{answer}\n\n[ì°¸ê³  ë¬¸ì„œ]\n{reference_docs}\n\n[ë‚œì´ë„ ëª¨ë“œ]\n{difficulty}\n\n[í‰ê°€ ê¸°ì¤€]\n1. ì •í™•ë„ (0-10ì ): ì°¸ê³  ë¬¸ì„œì˜ ë‚´ìš©ê³¼ ì¼ì¹˜í•˜ëŠ”ê°€?\n2. ê´€ë ¨ì„± (0-10ì ): ì§ˆë¬¸ê³¼ ë‹µë³€ì´ ê´€ë ¨ìˆëŠ”ê°€?\n3. ë‚œì´ë„ ì í•©ì„± (0-10ì ): ë‚œì´ë„ ëª¨ë“œì— ë§ëŠ” ë‹µë³€ì¸ê°€?\n   - Easy: ì‰¬ìš´ ìš©ì–´, ë¹„ìœ  ì‚¬ìš©, ê°„ë‹¨ ìš”ì•½\n   - Hard: ê¸°ìˆ  ìš©ì–´, ìˆ˜ì‹, ë³µì¡ë„, ë…¼ë¬¸ ë¹„êµ\n4. ì¶œì²˜ ëª…ì‹œ (0-10ì ): ë…¼ë¬¸ ì œëª©, ì €ìë¥¼ ëª…ì‹œí–ˆëŠ”ê°€?\n\nJSON í˜•ì‹ìœ¼ë¡œë§Œ ë°˜í™˜í•˜ì„¸ìš”:\n{\n    \"accuracy_score\": <ì ìˆ˜>,\n    \"relevance_score\": <ì ìˆ˜>,\n    \"difficulty_score\": <ì ìˆ˜>,\n    \"citation_score\": <ì ìˆ˜>,\n    \"total_score\": <ì´ì >,\n    \"comment\": \"<í‰ê°€ ì½”ë©˜íŠ¸>\"\n}",
    "input_variables": ["question", "answer", "reference_docs", "difficulty"]
  }
}
```

**êµ¬í˜„ ì˜ˆì‹œ:**

```python
# src/evaluation/evaluator.py

from langchain_openai import ChatOpenAI
from langchain.prompts import PromptTemplate
import json

class AnswerEvaluator:
    """ë‹µë³€ í’ˆì§ˆ í‰ê°€ í´ë˜ìŠ¤"""

    def __init__(self):
        """LLM ì´ˆê¸°í™”"""
        self.llm = ChatOpenAI(model="gpt-4", temperature=0)

        # í‰ê°€ í”„ë¡¬í”„íŠ¸ ë¡œë“œ
        with open("src/prompts/evaluation_prompts.json", "r", encoding="utf-8") as f:
            eval_data = json.load(f)

        self.prompt_template = PromptTemplate(
            template=eval_data["evaluation_prompt"]["template"],
            input_variables=eval_data["evaluation_prompt"]["input_variables"]
        )

    def evaluate(self, question: str, answer: str, reference_docs: str, difficulty: str):
        """
        ë‹µë³€ í‰ê°€

        Args:
            question: ì‚¬ìš©ì ì§ˆë¬¸
            answer: AI ë‹µë³€
            reference_docs: ì°¸ê³  ë¬¸ì„œ
            difficulty: ë‚œì´ë„

        Returns:
            í‰ê°€ ê²°ê³¼ ë”•ì…”ë„ˆë¦¬
        """
        # í”„ë¡¬í”„íŠ¸ í¬ë§·íŒ…
        prompt = self.prompt_template.format(
            question=question,
            answer=answer,
            reference_docs=reference_docs,
            difficulty=difficulty
        )

        # LLM í˜¸ì¶œ
        response = self.llm.invoke(prompt)

        # JSON íŒŒì‹±
        try:
            result = json.loads(response.content)
            return result
        except json.JSONDecodeError:
            return {
                "accuracy_score": 0,
                "relevance_score": 0,
                "difficulty_score": 0,
                "citation_score": 0,
                "total_score": 0,
                "comment": "í‰ê°€ ì‹¤íŒ¨ (JSON íŒŒì‹± ì˜¤ë¥˜)"
            }
```

---

## 5. ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸

### 5.1 ìë™ ì§ˆë¬¸ ìƒì„± (Golden Dataset)

**ëª©ì **: í…ŒìŠ¤íŠ¸ìš© ì§ˆë¬¸ ìë™ ìƒì„±

**íŒŒì¼ ê²½ë¡œ**: `src/prompts/question_generation_prompts.json`

**ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸:**

```json
{
  "question_generation_prompt": {
    "template": "ë‹¤ìŒ ë…¼ë¬¸ì„ ê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ìš© ì§ˆë¬¸ì„ ìƒì„±í•´ì£¼ì„¸ìš”.\n\n[ë…¼ë¬¸ ì •ë³´]\nì œëª©: {title}\nì €ì: {authors}\nì´ˆë¡: {abstract}\n\n[ìƒì„± ê·œì¹™]\n- ê° ë‚œì´ë„(Easy/Hard)ë³„ë¡œ 5ê°œì”© ì´ 10ê°œ ì§ˆë¬¸ ìƒì„±\n- ê° ë„êµ¬(search_paper, web_search, glossary, summarize, general)ë¥¼ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©í•˜ëŠ” ì§ˆë¬¸ í¬í•¨\n- Easy ì§ˆë¬¸: ì´ˆì‹¬ììš© (\"~ê°€ ë­ì•¼?\", \"ê°„ë‹¨íˆ ì„¤ëª…í•´ì¤˜\")\n- Hard ì§ˆë¬¸: ì „ë¬¸ê°€ìš© (\"ì‹œê°„ ë³µì¡ë„ëŠ”?\", \"ì•Œê³ ë¦¬ì¦˜ ë¹„êµ\")\n\nJSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜:\n{\n  \"questions\": [\n    {\n      \"question\": \"ì§ˆë¬¸ ë‚´ìš©\",\n      \"difficulty\": \"easy\",\n      \"expected_tool\": \"search_paper\",\n      \"expected_answer_keywords\": [\"í‚¤ì›Œë“œ1\", \"í‚¤ì›Œë“œ2\"]\n    }\n  ]\n}",
    "input_variables": ["title", "authors", "abstract"]
  }
}
```

### 5.2 Golden Dataset ì˜ˆì‹œ

**íŒŒì¼ ê²½ë¡œ**: `src/prompts/golden_dataset.json`

```json
{
  "golden_dataset": [
    {
      "question": "BERTê°€ ë­ì•¼?",
      "difficulty": "easy",
      "expected_tool": "glossary",
      "expected_answer_keywords": ["ì–¸ì–´ ëª¨ë¸", "ì–‘ë°©í–¥", "ì‚¬ì „ í•™ìŠµ"]
    },
    {
      "question": "RAG ë…¼ë¬¸ ì°¾ì•„ì¤˜",
      "difficulty": "easy",
      "expected_tool": "search_paper",
      "expected_answer_keywords": ["Retrieval", "Generation", "ë…¼ë¬¸"]
    },
    {
      "question": "2024ë…„ ìµœì‹  Transformer ì—°êµ¬",
      "difficulty": "hard",
      "expected_tool": "web_search",
      "expected_answer_keywords": ["2024", "Transformer", "ìµœì‹ "]
    },
    {
      "question": "Attention Is All You Need ìš”ì•½í•´ì¤˜",
      "difficulty": "easy",
      "expected_tool": "summarize",
      "expected_answer_keywords": ["Transformer", "Attention", "ìš”ì•½"]
    },
    {
      "question": "BERTì™€ GPTì˜ ì°¨ì´ëŠ”?",
      "difficulty": "hard",
      "expected_tool": "general",
      "expected_answer_keywords": ["BERT", "GPT", "ì°¨ì´", "ë¹„êµ"]
    },
    {
      "question": "Self-Attentionì˜ ì‹œê°„ ë³µì¡ë„ëŠ”?",
      "difficulty": "hard",
      "expected_tool": "general",
      "expected_answer_keywords": ["O(nÂ²)", "ë³µì¡ë„", "ì‹œí€€ìŠ¤"]
    },
    {
      "question": "Transformerê°€ RNNë³´ë‹¤ ë‚˜ì€ ì´ìœ ëŠ”?",
      "difficulty": "hard",
      "expected_tool": "general",
      "expected_answer_keywords": ["ë³‘ë ¬í™”", "long-range", "ì˜ì¡´ì„±"]
    },
    {
      "question": "ëŒ€í™” ë‚´ìš© ì €ì¥í•´ì¤˜",
      "difficulty": "easy",
      "expected_tool": "save_file",
      "expected_answer_keywords": ["ì €ì¥", "íŒŒì¼"]
    },
    {
      "question": "BLEU Scoreê°€ ë­ì•¼?",
      "difficulty": "easy",
      "expected_tool": "glossary",
      "expected_answer_keywords": ["í‰ê°€ ì§€í‘œ", "ë²ˆì—­", "ìœ ì‚¬ë„"]
    },
    {
      "question": "GPT-4 ë…¼ë¬¸ ê²€ìƒ‰",
      "difficulty": "hard",
      "expected_tool": "search_paper",
      "expected_answer_keywords": ["GPT-4", "ë…¼ë¬¸"]
    }
  ]
}
```

---

## 6. í”„ë¡¬í”„íŠ¸ íŒŒì¼ ë§¤í•‘

### 6.1 í˜„ì¬ í”„ë¡¬í”„íŠ¸ í•˜ë“œì½”ë”© ìœ„ì¹˜

| íŒŒì¼ ê²½ë¡œ | ì¤„ ë²ˆí˜¸ | í”„ë¡¬í”„íŠ¸ ì¢…ë¥˜ | JSON íŒŒì¼ ìœ„ì¹˜ |
|----------|--------|--------------|--------------|
| `src/agent/nodes.py` | 44-81 | ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ | `prompts/routing_prompts.json` |
| `src/tools/general_answer.py` | 37-50 | Easy/Hard ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ | `prompts/tool_prompts.json` (general_answer) |
| `src/tools/web_search.py` | 119-147 | Easy/Hard ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ | `prompts/tool_prompts.json` (web_search) |
| `src/tools/summarize.py` | 58-63 | ë…¼ë¬¸ ì œëª© ì¶”ì¶œ í”„ë¡¬í”„íŠ¸ | `prompts/tool_prompts.json` (summarize.title_extraction) |
| `src/tools/summarize.py` | 157-168 | Easy/Hard ìš”ì•½ í”„ë¡¬í”„íŠ¸ | `prompts/tool_prompts.json` (summarize) |

### 6.2 JSON í”„ë¡¬í”„íŠ¸ íŒŒì¼ êµ¬ì¡°

```
prompts/                           # í”„ë¡¬í”„íŠ¸ ë°ì´í„° (í”„ë¡œì íŠ¸ ìµœìƒìœ„)
â”œâ”€â”€ routing_prompts.json          # ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ + Few-shot ì˜ˆì‹œ
â”œâ”€â”€ tool_prompts.json              # 6ê°œ ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸
â”œâ”€â”€ evaluation_prompts.json        # í‰ê°€ í”„ë¡¬í”„íŠ¸
â”œâ”€â”€ question_generation_prompts.json  # ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸
â””â”€â”€ golden_dataset.json            # Golden Dataset (í…ŒìŠ¤íŠ¸ìš© ì§ˆë¬¸)

src/prompts/                       # í”„ë¡¬í”„íŠ¸ ë¡œë” ì½”ë“œ
â”œâ”€â”€ __init__.py                    # ëª¨ë“ˆ ì´ˆê¸°í™” ë° Export
â”œâ”€â”€ loader.py                      # JSON íŒŒì¼ ë¡œë” ìœ í‹¸ë¦¬í‹°
â””â”€â”€ README.md                      # ì‚¬ìš© ê°€ì´ë“œ
```

**ì„¤ê³„ ì›ì¹™**: ë°ì´í„°(`prompts/`)ì™€ ì½”ë“œ(`src/prompts/`) ë¶„ë¦¬
- `prompts/`: JSON í”„ë¡¬í”„íŠ¸ íŒŒì¼ (ë°ì´í„°)
- `src/prompts/`: Python ë¡œë” ìœ í‹¸ë¦¬í‹° (ì½”ë“œ)

**ì‚¬ìš© ì˜ˆì‹œ**:
```python
from src.prompts import get_routing_prompt, get_tool_prompt

# ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ ë¡œë“œ
routing_prompt = get_routing_prompt()

# ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸ ë¡œë“œ
system_prompt = get_tool_prompt("general_answer", "easy")
```

---

## 7. êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1: ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ ê°œì„  (ìµœìš°ì„ )
1. `src/prompts/routing_prompts.json` íŒŒì¼ ìƒì„±
2. ìƒì„¸ ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ ì‘ì„± (6ê°œ ë„êµ¬ ì‹œë‚˜ë¦¬ì˜¤)
3. Few-shot ì˜ˆì‹œ 10ê°œ ì‘ì„±
4. `src/agent/nodes.py:router_node` ìˆ˜ì • (JSON í”„ë¡¬í”„íŠ¸ ë¡œë“œ)

### Phase 2: ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸ JSONí™”
1. `src/prompts/tool_prompts.json` íŒŒì¼ ìƒì„±
2. 6ê°œ ë„êµ¬ë³„ ë‚œì´ë„ í”„ë¡¬í”„íŠ¸ ì‘ì„±
3. ê° ë„êµ¬ íŒŒì¼ ìˆ˜ì • (JSON í”„ë¡¬í”„íŠ¸ ë¡œë“œ)

### Phase 3: í‰ê°€ í”„ë¡¬í”„íŠ¸ êµ¬í˜„
1. `src/prompts/evaluation_prompts.json` íŒŒì¼ ìƒì„±
2. `src/evaluation/evaluator.py` êµ¬í˜„
3. í‰ê°€ ê²°ê³¼ DB ì €ì¥ ë¡œì§ ì¶”ê°€

### Phase 4: ì§ˆë¬¸ ìƒì„± ë° Golden Dataset
1. `src/prompts/question_generation_prompts.json` íŒŒì¼ ìƒì„±
2. `src/prompts/golden_dataset.json` íŒŒì¼ ìƒì„± (10ê°œ ì§ˆë¬¸)
3. í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

---

## 8. ExperimentManager í”„ë¡¬í”„íŠ¸ ë¡œê¹…

### í”„ë¡¬í”„íŠ¸ ì €ì¥ ë°©ë²•

```python
# ë„êµ¬ ë…¸ë“œì—ì„œ í”„ë¡¬í”„íŠ¸ ì €ì¥

def tool_node(state: AgentState, exp_manager=None):
    # ...

    # ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì €ì¥
    if exp_manager:
        exp_manager.save_system_prompt(
            system_content,
            metadata={"tool": "tool_name", "difficulty": difficulty}
        )

    # ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ì €ì¥
    if exp_manager:
        exp_manager.save_user_prompt(
            user_prompt,
            metadata={"question": question}
        )

    # ...
```

### í”„ë¡¬í”„íŠ¸ ë¡œê·¸ ìœ„ì¹˜

```
experiments/
â””â”€â”€ 20251103/
    â””â”€â”€ 20251103_103015_session_001/
        â”œâ”€â”€ prompts/
        â”‚   â”œâ”€â”€ system_prompt.txt     # ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
        â”‚   â”œâ”€â”€ user_prompt.txt       # ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸
        â”‚   â””â”€â”€ prompts.json          # ì „ì²´ í”„ë¡¬í”„íŠ¸ ë©”íƒ€ë°ì´í„°
```

---

## 9. ê°œë°œ ì¼ì •

### Phase 1: ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ (1ì¼) â­ ìµœìš°ì„ 
- ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ JSON íŒŒì¼ ìƒì„±
- Few-shot ì˜ˆì‹œ 10ê°œ ì‘ì„±
- router_node ìˆ˜ì •

### Phase 2: ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸ (1ì¼)
- ë„êµ¬ í”„ë¡¬í”„íŠ¸ JSON íŒŒì¼ ìƒì„±
- 6ê°œ ë„êµ¬ íŒŒì¼ ìˆ˜ì •

### Phase 3: í‰ê°€ í”„ë¡¬í”„íŠ¸ (1ì¼)
- í‰ê°€ í”„ë¡¬í”„íŠ¸ JSON íŒŒì¼ ìƒì„±
- evaluator.py êµ¬í˜„

### Phase 4: Golden Dataset (1ì¼)
- ì§ˆë¬¸ ìƒì„± í”„ë¡¬í”„íŠ¸ ì‘ì„±
- Golden Dataset 10ê°œ ì§ˆë¬¸ ì‘ì„±
- í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

---

## 10. Feature ë¸Œëœì¹˜

**í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ êµ¬í˜„ (ì„ì˜ˆìŠ¬)**

### ê¶Œì¥ ë¸Œëœì¹˜ ì „ëµ

íŒ€ì›ì´ `feature/prompt` ë¸Œëœì¹˜ë¥¼ ìƒì„±í–ˆë‹¤ë©´, **í•´ë‹¹ ë¸Œëœì¹˜ì—ì„œ ëª¨ë“  í”„ë¡¬í”„íŠ¸ ì‘ì—…ì„ ì§„í–‰í•´ë„ ë¬´ë°©í•©ë‹ˆë‹¤.**

```bash
# feature/prompt ë¸Œëœì¹˜ë¡œ ì „í™˜
git checkout feature/prompt

# ì‘ì—… ì§„í–‰ (í”„ë¡¬í”„íŠ¸ JSON ìˆ˜ì •, ë¡œë” ì½”ë“œ ìˆ˜ì • ë“±)
# ...

# ì»¤ë°‹ ë° í‘¸ì‹œ
git add .
git commit -m "feat: ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ ê°œì„ "
git push origin feature/prompt
```

**ë¸Œëœì¹˜ ì „í™˜ì´ ì–´ë ¤ìš´ ê²½ìš°**:
- `feature/prompt` ë¸Œëœì¹˜ í•˜ë‚˜ì—ì„œ ëª¨ë“  ì‘ì—… ì§„í–‰
- ì»¤ë°‹ ë©”ì‹œì§€ë¡œ ì‘ì—… êµ¬ë¶„ (ì˜ˆ: "feat: ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ ê°œì„ ", "feat: í‰ê°€ í”„ë¡¬í”„íŠ¸ ì¶”ê°€")

### ì„¸ë¶€ ë¸Œëœì¹˜ (ì„ íƒ ì‚¬í•­)

ë¸Œëœì¹˜ ê´€ë¦¬ê°€ ìµìˆ™í•´ì§€ë©´ ì•„ë˜ì²˜ëŸ¼ ì„¸ë¶€ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
- `feature/routing-prompts` - ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸
- `feature/tool-prompts` - ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸
- `feature/evaluation-prompts` - í‰ê°€ í”„ë¡¬í”„íŠ¸
- `feature/golden-dataset` - Golden Dataset

**ì¤‘ìš”**: Git ì´ˆë³´ì¸ ê²½ìš° `feature/prompt` í•˜ë‚˜ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤!

---

## 11. ì°¸ê³  PRD ë¬¸ì„œ

### í•„ìˆ˜ ì°¸ê³  ë¬¸ì„œ
1. [15_í”„ë¡¬í”„íŠ¸_ì—”ì§€ë‹ˆì–´ë§.md](../PRD/15_í”„ë¡¬í”„íŠ¸_ì—”ì§€ë‹ˆì–´ë§.md) - í”„ë¡¬í”„íŠ¸ ì „ëµ
2. [12_AI_Agent_ì„¤ê³„.md](../PRD/12_AI_Agent_ì„¤ê³„.md) - AI Agent ì„¤ê³„
3. [05_ë¡œê¹…_ì‹œìŠ¤í…œ.md](../PRD/05_ë¡œê¹…_ì‹œìŠ¤í…œ.md) - Logger ì‚¬ìš©ë²•
4. [06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md](../PRD/06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md) - ExperimentManager

### ì°¸ê³  ë¬¸ì„œ
- [ë‹´ë‹¹ì—­í• _06_í†µí•©_LangGraph_ìŠ¤íŠ¸ë¦¬ë°.md](ë‹´ë‹¹ì—­í• _06_í†µí•©_LangGraph_ìŠ¤íŠ¸ë¦¬ë°.md) - LangGraph ë…¸ë“œ êµ¬í˜„
- [docs/minutes/20251030/20251030_ë©˜í† ë§.md](../../minutes/20251030/20251030_ë©˜í† ë§.md) - ë©˜í†  ì¸ì‚¬ì´íŠ¸ (lines 417-553)

---

## 12. ì°¸ê³  ìë£Œ

- Langchain Prompts: https://python.langchain.com/docs/modules/model_io/prompts/
- Few-Shot Prompting: https://python.langchain.com/docs/modules/model_io/prompts/few_shot_examples
- Prompt Engineering Guide: https://www.promptingguide.ai/
- LLM-as-a-Judge: https://python.langchain.com/docs/guides/evaluation/

---

## 13. ì¤‘ìš” ì‚¬í•­

1. **ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ê°€ ìµœìš°ì„ **
   - AI Agentì˜ ì„±ëŠ¥ì€ ë¼ìš°íŒ… ì •í™•ë„ì— ë‹¬ë ¤ìˆìŒ
   - Few-shot ì˜ˆì‹œ í•„ìˆ˜

2. **JSON í˜•ì‹ ì‚¬ìš©**
   - í”„ë¡¬í”„íŠ¸ ê´€ë¦¬ ë° ë²„ì „ ê´€ë¦¬ ìš©ì´
   - íŒŒì‹± ì˜¤ë¥˜ ìµœì†Œí™”

3. **ExperimentManager ì‚¬ìš©**
   - ëª¨ë“  í”„ë¡¬í”„íŠ¸ ì €ì¥ ë° ë¡œê¹…
   - ì‹¤í—˜ ì¶”ì  ê´€ë¦¬

4. **Golden Dataset êµ¬ì¶•**
   - í…ŒìŠ¤íŠ¸ìš© ì§ˆë¬¸ 10ê°œ ì´ìƒ
   - ë¼ìš°íŒ… ì •í™•ë„ ê²€ì¦

---
