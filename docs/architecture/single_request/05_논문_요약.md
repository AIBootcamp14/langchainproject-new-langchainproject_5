# ë…¼ë¬¸ ìš”ì•½ ë„êµ¬ ì•„í‚¤í…ì²˜

## ğŸ“‹ ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-11-07
- **ì‘ì„±ì**: ìµœí˜„í™”[íŒ€ì¥]
- **í”„ë¡œì íŠ¸ëª…**: ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡ (AI Agent + RAG)
- **íŒ€ëª…**: ì—°ê²°ì˜ ë¯¼ì¡±
- **ë¬¸ì„œ ë²„ì „**: 1.0

---

## ğŸ“‘ ëª©ì°¨
1. [ë„êµ¬ ê°œìš”](#ë„êµ¬-ê°œìš”)
2. [ë„êµ¬ ì‹¤í–‰ ì¡°ê±´](#ë„êµ¬-ì‹¤í–‰-ì¡°ê±´)
3. [ë„êµ¬ ìë™ ì „í™˜ ë° Fallback](#ë„êµ¬-ìë™-ì „í™˜-ë°-fallback)
4. [ë‹¨ìˆœ íë¦„ ì•„í‚¤í…ì²˜](#ë‹¨ìˆœ-íë¦„-ì•„í‚¤í…ì²˜)
5. [ìƒì„¸ ê¸°ëŠ¥ ë™ì‘ íë¦„ë„](#ìƒì„¸-ê¸°ëŠ¥-ë™ì‘-íë¦„ë„)
6. [ë™ì‘ ì„¤ëª…](#ë™ì‘-ì„¤ëª…)
7. [ì‚¬ìš© ì˜ˆì‹œ](#ì‚¬ìš©-ì˜ˆì‹œ)
8. [í•µì‹¬ í¬ì¸íŠ¸](#í•µì‹¬-í¬ì¸íŠ¸)
9. [ì°¸ê³  ì •ë³´](#ì°¸ê³ -ì •ë³´)

---

## ğŸ“Œ ë„êµ¬ ê°œìš”

### ëª©ì ê³¼ ì—­í• 

ë…¼ë¬¸ ìš”ì•½ ë„êµ¬ëŠ” PostgreSQL + pgvectorì—ì„œ ë…¼ë¬¸ ì²­í¬ë¥¼ ì¡°íšŒí•˜ì—¬ LangChainì˜ ìš”ì•½ ì²´ì¸ìœ¼ë¡œ ë…¼ë¬¸ ì „ë¬¸ì„ ìš”ì•½í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

**í•µì‹¬ ì—­í• :**
- ì‚¬ìš©ì ì§ˆë¬¸ì—ì„œ ë…¼ë¬¸ ì œëª© ìë™ ì¶”ì¶œ (LLM ì‚¬ìš©)
- PostgreSQL papers í…Œì´ë¸”ì—ì„œ ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ê²€ìƒ‰
- pgvectorì—ì„œ í•´ë‹¹ ë…¼ë¬¸ì˜ ëª¨ë“  ì²­í¬ ì¡°íšŒ (ìµœëŒ€ 50ê°œ)
- ë‚œì´ë„ë³„ ìš”ì•½ ìƒì„± (elementary/beginner/intermediate/advanced)
- ë‘ ìˆ˜ì¤€ì˜ ìš”ì•½ ì œê³µ (easy â†’ elementary+beginner, hard â†’ intermediate+advanced)

**ì‚¬ìš© ë°ì´í„°:**
- **PostgreSQL í…Œì´ë¸”**: `papers` (ë…¼ë¬¸ ë©”íƒ€ë°ì´í„°: ì œëª©, ì €ì, ë°œí–‰ì¼, ì´ˆë¡ ë“±)
- **pgvector ì»¬ë ‰ì…˜**: `paper_chunks` (ë…¼ë¬¸ ë³¸ë¬¸ ì²­í¬ì˜ 1536ì°¨ì› ì„ë² ë”©)
- **ì„ë² ë”© ëª¨ë¸**: OpenAI `text-embedding-3-small`

**ìš”ì•½ ë©”ì»¤ë‹ˆì¦˜:**
- ë…¼ë¬¸ ì œëª© ì¶”ì¶œ (LLM)
- PostgreSQL ILIKE ê²€ìƒ‰ìœ¼ë¡œ ë…¼ë¬¸ ì¡°íšŒ
- pgvector similarity_searchë¡œ ë…¼ë¬¸ ì²­í¬ ì¡°íšŒ (k=50)
- ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ ì ìš© (`prompts/tool_prompts.json`)
- LLM ìš”ì•½ ìƒì„± (LLMClient.from_difficulty)

---

## ğŸ“‹ ë„êµ¬ ì‹¤í–‰ ì¡°ê±´

### ì–¸ì œ ì‹¤í–‰ë˜ëŠ”ê°€?

**1. ì‚¬ìš©ìê°€ ë…¼ë¬¸ ìš”ì•½ì„ ëª…ì‹œì ìœ¼ë¡œ ìš”ì²­í•  ë•Œ**
- "Attention Is All You Need ë…¼ë¬¸ ìš”ì•½í•´ì¤˜"
- "Transformer ë…¼ë¬¸ ì •ë¦¬í•´ì¤˜"
- "BERT ë…¼ë¬¸ ì„¤ëª…í•´ì¤˜"

**2. ë‹¤ì¤‘ ìš”ì²­ì˜ ì¼ë¶€ë¡œ ì‹¤í–‰ë  ë•Œ**
- "GPT ë…¼ë¬¸ ì°¾ì•„ì„œ ìš”ì•½í•´ì¤˜" â†’ search_paper â†’ summarize
- "ìµœì‹  AI ë…¼ë¬¸ ê²€ìƒ‰í•´ì„œ ì •ë¦¬í•´ì¤˜" â†’ web_search â†’ summarize

**3. íŒ¨í„´ ë§¤ì¹­ ìš°ì„ ìˆœìœ„**

`configs/multi_request_patterns.yaml`ì—ì„œ ì •ì˜ëœ íŒ¨í„´:

```yaml
- keywords:
  - ë…¼ë¬¸
  - ìš”ì•½
  exclude_keywords:
  - ì €ì¥
  tools:
  - search_paper
  - web_search
  - general
  - summarize
  priority: 120
  description: ë…¼ë¬¸ ê²€ìƒ‰ í›„ ìš”ì•½ (4ë‹¨ê³„ íŒŒì´í”„ë¼ì¸)
```

**ì‹¤í–‰ ì¡°ê±´ ê²€ì¦:**
1. `keywords`ì— ëª¨ë“  í‚¤ì›Œë“œ í¬í•¨ (`ë…¼ë¬¸`, `ìš”ì•½`) â†’ AND ì¡°ê±´
2. `exclude_keywords`ì— í•´ë‹¹ í‚¤ì›Œë“œ ì—†ìŒ (`ì €ì¥` ì œì™¸)
3. ìš°ì„ ìˆœìœ„ 120ìœ¼ë¡œ ë§¤ì¹­
4. íŒŒì´í”„ë¼ì¸: search_paper â†’ web_search â†’ general â†’ **summarize**

### íŒŒì´í”„ë¼ì¸ ëª¨ë“œ vs ë‹¨ì¼ ëª¨ë“œ

**íŒŒì´í”„ë¼ì¸ ëª¨ë“œ** (tool_pipelineì´ ìˆê³  pipeline_index > 1):
- ì´ì „ ë„êµ¬(search_paper ë˜ëŠ” web_search)ì˜ ê²°ê³¼(`tool_result`)ë¥¼ ë°›ì•„ì„œ ë°”ë¡œ ìš”ì•½
- ê°„ë‹¨í•œ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì‚¬ìš©
- ë…¼ë¬¸ ì œëª© ì¶”ì¶œ ë° DB ê²€ìƒ‰ ë‹¨ê³„ ìƒëµ

**ë‹¨ì¼ ëª¨ë“œ** (ì§ì ‘ ë…¼ë¬¸ ì œëª© ì „ë‹¬):
- ì‚¬ìš©ì ì§ˆë¬¸ì—ì„œ ë…¼ë¬¸ ì œëª© LLM ì¶”ì¶œ
- PostgreSQL papers í…Œì´ë¸”ì—ì„œ ë…¼ë¬¸ ê²€ìƒ‰
- pgvectorì—ì„œ ë…¼ë¬¸ ì²­í¬ ì¡°íšŒ
- ë‘ ìˆ˜ì¤€ì˜ ìš”ì•½ ìƒì„± (ì˜ˆ: beginner + intermediate)

---

## ğŸ”„ ë„êµ¬ ìë™ ì „í™˜ ë° Fallback

### Fallback Chain íë¦„

```
ì‚¬ìš©ì ë…¼ë¬¸ ìš”ì•½ ìš”ì²­
  â†“
[1] RAG ë…¼ë¬¸ ê²€ìƒ‰ ë„êµ¬ ì‹¤í–‰ (search_paper)
  â”œâ”€ ì„±ê³µ â†’ ë…¼ë¬¸ ë‚´ìš© ì „ë‹¬ â†’ [2]
  â””â”€ ì‹¤íŒ¨ (ë…¼ë¬¸ ì—†ìŒ)
      â†“
      Web ë…¼ë¬¸ ê²€ìƒ‰ ë„êµ¬ ì‹¤í–‰ (web_search)
      â”œâ”€ ì„±ê³µ â†’ ê²€ìƒ‰ ê²°ê³¼ ì „ë‹¬ â†’ [2]
      â””â”€ ì‹¤íŒ¨ (ì›¹ ê²€ìƒ‰ ì‹¤íŒ¨)
          â†“
          ì¼ë°˜ ë‹µë³€ ë„êµ¬ ì‹¤í–‰ (general)
          â””â”€ LLM ì§ì ‘ ë‹µë³€ ìƒì„± â†’ [2]

[2] ë…¼ë¬¸ ìš”ì•½ ë„êµ¬ ì‹¤í–‰ (summarize)
  â”œâ”€ ì„±ê³µ â†’ ìš”ì•½ ê²°ê³¼ ë°˜í™˜ â†’ END
  â””â”€ ì‹¤íŒ¨ (ìš”ì•½ ìƒì„± ì˜¤ë¥˜)
      â†“
      ì¼ë°˜ ë‹µë³€ ë„êµ¬ë¡œ ìµœì¢… ì „í™˜
      â””â”€ LLMì´ ì§ì ‘ ë…¼ë¬¸ ìš”ì•½ â†’ END
```

### Fallback íŠ¸ë¦¬ê±° ì¡°ê±´

| ì¡°ê±´ | ì„¤ëª… | ì²˜ë¦¬ ë°©ì‹ |
|------|------|-----------|
| ë…¼ë¬¸ ì œëª© ì¶”ì¶œ ì‹¤íŒ¨ | LLMì´ ì œëª©ì„ ì¶”ì¶œí•˜ì§€ ëª»í•¨ | ì—ëŸ¬ ë©”ì‹œì§€ ë°˜í™˜ (Fallback X) |
| PostgreSQL ê²€ìƒ‰ ì‹¤íŒ¨ | papers í…Œì´ë¸”ì— ë…¼ë¬¸ ì—†ìŒ | "ë…¼ë¬¸ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤" (Fallback X) |
| pgvector ì²­í¬ ì—†ìŒ | ë…¼ë¬¸ IDëŠ” ìˆì§€ë§Œ ì²­í¬ ì—†ìŒ | "ë…¼ë¬¸ ë‚´ìš©ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤" (Fallback X) |
| LLM ìš”ì•½ ì˜¤ë¥˜ | ìš”ì•½ ìƒì„± ì¤‘ ì˜ˆì™¸ ë°œìƒ | Exception ì²˜ë¦¬ + Fallback |
| íŒŒì´í”„ë¼ì¸ ëª¨ë“œ ì˜¤ë¥˜ | tool_resultê°€ ë¹„ì–´ìˆìŒ | ë‹¨ì¼ ëª¨ë“œë¡œ ì¬ì‹œë„ |

### ë„êµ¬ ì „í™˜ ê²°ì • ë¡œì§ êµ¬í˜„ ìœ„ì¹˜

**íŒŒì¼**: `src/agent/graph.py`
**í•¨ìˆ˜**: `should_continue_pipeline(state: AgentState)`

```python
def should_continue_pipeline(state: AgentState) -> str:
    """
    tool_pipelineì— ë‚¨ì€ ë„êµ¬ê°€ ìˆëŠ”ì§€ í™•ì¸
    """
    tool_pipeline = state.get("tool_pipeline", [])
    pipeline_index = state.get("pipeline_index", 0)

    if not tool_pipeline:
        return "end"

    if pipeline_index < len(tool_pipeline):
        return "continue"

    return "end"
```

**ë™ì‘:**
- `tool_pipeline = ["search_paper", "web_search", "general", "summarize"]`
- `pipeline_index = 3` (summarize ì‹¤í–‰ ì¤‘)
- summarize ì„±ê³µ ì‹œ â†’ `pipeline_index = 4` â†’ "end"
- summarize ì‹¤íŒ¨ ì‹œ â†’ Fallback ì²´ì¸ìœ¼ë¡œ ì „í™˜ (fallback_router_node)

---

## ğŸ¨ ë‹¨ìˆœ íë¦„ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    subgraph MainFlow["ğŸ“‹ ë…¼ë¬¸ ìš”ì•½ ë„êµ¬ ì‹¤í–‰ íë¦„"]
        direction TB

        subgraph UserInput["ğŸ”¸ ì‚¬ìš©ì ì…ë ¥"]
            direction LR
            A[ì‚¬ìš©ì ì§ˆë¬¸<br/>ë…¼ë¬¸ ìš”ì•½ ìš”ì²­] --> B{íŒ¨í„´ ë§¤ì¹­<br/>ë˜ëŠ”<br/>LLM ë¼ìš°íŒ…}
            B -->|summarize ì„ íƒ| C[ë„êµ¬ ì‹¤í–‰<br/>ì‹œì‘]
        end

        subgraph TitleExtraction["ğŸ”¹ ë…¼ë¬¸ ì œëª© ì¶”ì¶œ"]
            direction LR
            D[ì‚¬ìš©ì ì§ˆë¬¸<br/>ë¶„ì„] --> E[LLM<br/>ì œëª© ì¶”ì¶œ]
            E --> F[ë…¼ë¬¸ ì œëª©<br/>íšë“]
        end

        subgraph PaperSearch["ğŸ”º ë…¼ë¬¸ ê²€ìƒ‰"]
            direction LR
            G[PostgreSQL<br/>papers í…Œì´ë¸”] --> H[ILIKE ê²€ìƒ‰<br/>ì œëª© ë§¤ì¹­]
            H --> I{ë…¼ë¬¸ ë°œê²¬?}
            I -->|ì—†ìŒ| J[ì˜¤ë¥˜ ë©”ì‹œì§€<br/>ë°˜í™˜]
            I -->|ë°œê²¬| K[ë…¼ë¬¸ ë©”íƒ€ë°ì´í„°<br/>ì¶”ì¶œ]
        end

        subgraph ChunkRetrieval["ğŸ”¶ ì²­í¬ ì¡°íšŒ"]
            direction LR
            L[pgvector<br/>paper_chunks] --> M[similarity_search<br/>k=50]
            M --> N{ì²­í¬ ìˆìŒ?}
            N -->|ì—†ìŒ| O[ì˜¤ë¥˜ ë©”ì‹œì§€<br/>ë°˜í™˜]
            N -->|ìˆìŒ| P[ì²­í¬ ë³‘í•©<br/>combined_text]
        end

        subgraph Summarization["ğŸ’¾ ìš”ì•½ ìƒì„±"]
            direction LR
            Q[ë‚œì´ë„ë³„<br/>í”„ë¡¬í”„íŠ¸ ë¡œë“œ] --> R[LLMClient<br/>ì´ˆê¸°í™”]
            R --> S[ë‘ ìˆ˜ì¤€<br/>ìš”ì•½ ìƒì„±]
            S --> T[final_answers<br/>ì €ì¥]
        end

        subgraph FallbackChain["âš ï¸ Fallback ê²½ë¡œ"]
            direction LR
            U[general] --> V[ìµœì¢… ë‹µë³€]
        end

        %% ë‹¨ê³„ ê°„ ì—°ê²°
        UserInput --> TitleExtraction
        TitleExtraction --> PaperSearch
        PaperSearch --> ChunkRetrieval
        ChunkRetrieval --> Summarization
        J --> FallbackChain
        O --> FallbackChain
        Summarization --> V
    end

    %% ë©”ì¸ ì›Œí¬í”Œë¡œìš° ë°°ê²½
    style MainFlow fill:#fffde7,stroke:#f9a825,stroke-width:4px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼
    style UserInput fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style TitleExtraction fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style PaperSearch fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style ChunkRetrieval fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style Summarization fill:#e3f2fd,stroke:#1565c0,stroke-width:3px,color:#000
    style FallbackChain fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì‚¬ìš©ì ì…ë ¥ - ì²­ë¡ ê³„ì—´)
    style A fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style B fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style C fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì œëª© ì¶”ì¶œ - ë³´ë¼ ê³„ì—´)
    style D fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style E fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style F fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë…¼ë¬¸ ê²€ìƒ‰ - ë…¹ìƒ‰ ê³„ì—´)
    style G fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style H fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style I fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style J fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style K fill:#66bb6a,stroke:#1b5e20,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì²­í¬ ì¡°íšŒ - ì£¼í™© ê³„ì—´)
    style L fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style M fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style N fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style O fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style P fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ìš”ì•½ ìƒì„± - íŒŒë‘ ê³„ì—´)
    style Q fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style R fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style S fill:#64b5f6,stroke:#1565c0,stroke-width:2px,color:#000
    style T fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (Fallback - ë¹¨ê°• ê³„ì—´)
    style U fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style V fill:#66bb6a,stroke:#2e7d32,stroke-width:2px,color:#000

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì‚¬ìš©ì ì…ë ¥ - ì²­ë¡ 0~1)
    linkStyle 0 stroke:#006064,stroke-width:2px
    linkStyle 1 stroke:#006064,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì œëª© ì¶”ì¶œ - ë³´ë¼ 2~3)
    linkStyle 2 stroke:#7b1fa2,stroke-width:2px
    linkStyle 3 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë…¼ë¬¸ ê²€ìƒ‰ - ë…¹ìƒ‰ 4~7)
    linkStyle 4 stroke:#2e7d32,stroke-width:2px
    linkStyle 5 stroke:#2e7d32,stroke-width:2px
    linkStyle 6 stroke:#2e7d32,stroke-width:2px
    linkStyle 7 stroke:#2e7d32,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì²­í¬ ì¡°íšŒ - ì£¼í™© 8~11)
    linkStyle 8 stroke:#e65100,stroke-width:2px
    linkStyle 9 stroke:#e65100,stroke-width:2px
    linkStyle 10 stroke:#e65100,stroke-width:2px
    linkStyle 11 stroke:#e65100,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ìš”ì•½ ìƒì„± - íŒŒë‘ 12~14)
    linkStyle 12 stroke:#1976d2,stroke-width:2px
    linkStyle 13 stroke:#1976d2,stroke-width:2px
    linkStyle 14 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (Fallback - ë¹¨ê°• 15)
    linkStyle 15 stroke:#c62828,stroke-width:2px

    %% ë‹¨ê³„ ê°„ ì—°ê²° (íšŒìƒ‰ 16~20)
    linkStyle 16 stroke:#616161,stroke-width:3px
    linkStyle 17 stroke:#616161,stroke-width:3px
    linkStyle 18 stroke:#616161,stroke-width:3px
    linkStyle 19 stroke:#616161,stroke-width:3px
    linkStyle 20 stroke:#616161,stroke-width:3px
    linkStyle 21 stroke:#616161,stroke-width:3px
```

---

## ğŸ” ìƒì„¸ ê¸°ëŠ¥ ë™ì‘ íë¦„ë„

```mermaid
graph TB
    subgraph MainFlow["ğŸ“‹ ë…¼ë¬¸ ìš”ì•½ ë„êµ¬ ìƒì„¸ ì‹¤í–‰ íë¦„"]
        direction TB

        subgraph Init["ğŸ”¸ ì´ˆê¸°í™” & ë¼ìš°íŒ…"]
            direction LR
            A[main.py] --> B[ui/app.py<br/>initialize_agent]
            B --> C[src/agent/graph.py<br/>create_agent_graph]
            C --> D[src/agent/nodes.py<br/>router_node]
            D --> E{íŒ¨í„´ ë§¤ì¹­}
            E -->|ë§¤ì¹­ ì„±ê³µ| F[multi_request_patterns.yaml<br/>priority: 120]
            E -->|ë§¤ì¹­ ì‹¤íŒ¨| G[LLM ë¼ìš°íŒ…<br/>routing_prompts.json]
            F --> H[tool_choice =<br/>'summarize']
            G --> H
        end

        subgraph NodeExec["ğŸ”¹ ë…¸ë“œ ì‹¤í–‰"]
            direction LR
            I[src/tools/summarize.py<br/>summarize_node] --> J{íŒŒì´í”„ë¼ì¸<br/>ëª¨ë“œ?}
            J -->|Yes| K[tool_result<br/>ì‚¬ìš©]
            J -->|No| L[ë‹¨ì¼ ëª¨ë“œ<br/>ì‹¤í–‰]
        end

        subgraph PipelineMode["ğŸ”º íŒŒì´í”„ë¼ì¸ ëª¨ë“œ"]
            direction LR
            M[tool_result<br/>ì´ì „ ë„êµ¬ ê²°ê³¼] --> N[LLMClient<br/>from_difficulty]
            N --> O[ë‚œì´ë„ë³„<br/>ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸]
            O --> P[LLM invoke<br/>ê°„ë‹¨í•œ ìš”ì•½]
            P --> Q[summary ì €ì¥<br/>final_answer]
        end

        subgraph SingleMode["ğŸ”¶ ë‹¨ì¼ ëª¨ë“œ"]
            direction LR
            R[question ì¶”ì¶œ<br/>ì‚¬ìš©ì ì§ˆë¬¸] --> S[get_summarize_title<br/>_extraction_prompt]
            S --> T[LLM invoke<br/>ì œëª© ì¶”ì¶œ]
            T --> U[paper_title<br/>íšë“]
        end

        subgraph DBSearch["ğŸ’¾ PostgreSQL ê²€ìƒ‰"]
            direction LR
            V[psycopg2.connect<br/>DATABASE_URL] --> W[papers í…Œì´ë¸”<br/>ILIKE ê²€ìƒ‰]
            W --> X{ë…¼ë¬¸ ë°œê²¬?}
            X -->|No| Y[ì˜¤ë¥˜ ë©”ì‹œì§€<br/>final_answer]
            X -->|Yes| Z[paper_id, title,<br/>authors, abstract]
        end

        subgraph VectorSearch["âœ¨ pgvector ê²€ìƒ‰"]
            direction LR
            AA[OpenAIEmbeddings<br/>text-embedding-3-small] --> AB[PGVector<br/>paper_chunks]
            AB --> AC[similarity_search<br/>query=title, k=50]
            AC --> AD{ì²­í¬ ìˆìŒ?}
            AD -->|No| AE[ì˜¤ë¥˜ ë©”ì‹œì§€<br/>final_answer]
            AD -->|Yes| AF[docs íšë“<br/>50ê°œ ì²­í¬]
        end

        subgraph SummaryGeneration["ğŸ”· ìš”ì•½ ìƒì„±"]
            direction LR
            AG[level_mapping<br/>easy/hard â†’ 2 levels] --> AH[combined_text<br/>ì²­í¬ ë³‘í•©]
            AH --> AI[get_summarize_template<br/>levelë³„ í”„ë¡¬í”„íŠ¸]
            AI --> AJ[LLMClient<br/>from_difficulty]
            AJ --> AK[LLM invoke<br/>ê° level ìš”ì•½]
            AK --> AL[final_answers<br/>dict ì €ì¥]
        end

        subgraph FileOutput["ğŸ’¡ íŒŒì¼ ì €ì¥"]
            direction LR
            AM[summary_md<br/>Markdown ìƒì„±] --> AN[summary í´ë”<br/>ìƒì„±]
            AN --> AO[safe_title<br/>íŒŒì¼ëª… ìƒì„±]
            AO --> AP[summary.md<br/>ì €ì¥]
        end

        subgraph ErrorHandling["âš ï¸ ì˜¤ë¥˜ ì²˜ë¦¬"]
            direction LR
            AQ[Exception<br/>catch] --> AR[error_msg<br/>ìƒì„±]
            AR --> AS[final_answer<br/>ì €ì¥]
            AS --> AT[Fallback<br/>íŠ¸ë¦¬ê±°]
        end

        %% ë‹¨ê³„ ê°„ ì—°ê²°
        Init --> NodeExec
        NodeExec --> PipelineMode
        NodeExec --> SingleMode
        SingleMode --> DBSearch
        DBSearch --> VectorSearch
        VectorSearch --> SummaryGeneration
        SummaryGeneration --> FileOutput
        Y --> ErrorHandling
        AE --> ErrorHandling
    end

    %% ë©”ì¸ ì›Œí¬í”Œë¡œìš° ë°°ê²½
    style MainFlow fill:#fffde7,stroke:#f9a825,stroke-width:4px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼
    style Init fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style NodeExec fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style PipelineMode fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style SingleMode fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style DBSearch fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style VectorSearch fill:#e3f2fd,stroke:#1565c0,stroke-width:3px,color:#000
    style SummaryGeneration fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style FileOutput fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style ErrorHandling fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì´ˆê¸°í™” - ì²­ë¡ ê³„ì—´)
    style A fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style B fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style C fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style D fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style E fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style F fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style G fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style H fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë…¸ë“œ ì‹¤í–‰ - íŒŒë‘ ê³„ì—´)
    style I fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style J fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style K fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style L fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (íŒŒì´í”„ë¼ì¸ ëª¨ë“œ - ë³´ë¼ ê³„ì—´)
    style M fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style N fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style O fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style P fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style Q fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë‹¨ì¼ ëª¨ë“œ - ì£¼í™© ê³„ì—´)
    style R fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style S fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style T fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style U fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (DB ê²€ìƒ‰ - ë…¹ìƒ‰ ê³„ì—´)
    style V fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style W fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style X fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Y fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style Z fill:#66bb6a,stroke:#1b5e20,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë²¡í„° ê²€ìƒ‰ - íŒŒë‘ ê³„ì—´)
    style AA fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AB fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AC fill:#64b5f6,stroke:#1565c0,stroke-width:2px,color:#000
    style AD fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AE fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style AF fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ìš”ì•½ ìƒì„± - ë³´ë¼ ê³„ì—´)
    style AG fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AH fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AI fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style AJ fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style AK fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style AL fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (íŒŒì¼ ì €ì¥ - ì£¼í™© ê³„ì—´)
    style AM fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style AN fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style AO fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style AP fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì˜¤ë¥˜ ì²˜ë¦¬ - ë¹¨ê°• ê³„ì—´)
    style AQ fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style AR fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style AS fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style AT fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì´ˆê¸°í™” - ì²­ë¡ 0~7)
    linkStyle 0 stroke:#006064,stroke-width:2px
    linkStyle 1 stroke:#006064,stroke-width:2px
    linkStyle 2 stroke:#006064,stroke-width:2px
    linkStyle 3 stroke:#006064,stroke-width:2px
    linkStyle 4 stroke:#006064,stroke-width:2px
    linkStyle 5 stroke:#006064,stroke-width:2px
    linkStyle 6 stroke:#006064,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë…¸ë“œ ì‹¤í–‰ - íŒŒë‘ 8~10)
    linkStyle 7 stroke:#1976d2,stroke-width:2px
    linkStyle 8 stroke:#1976d2,stroke-width:2px
    linkStyle 9 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (íŒŒì´í”„ë¼ì¸ ëª¨ë“œ - ë³´ë¼ 11~14)
    linkStyle 10 stroke:#7b1fa2,stroke-width:2px
    linkStyle 11 stroke:#7b1fa2,stroke-width:2px
    linkStyle 12 stroke:#7b1fa2,stroke-width:2px
    linkStyle 13 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë‹¨ì¼ ëª¨ë“œ - ì£¼í™© 15~17)
    linkStyle 14 stroke:#e65100,stroke-width:2px
    linkStyle 15 stroke:#e65100,stroke-width:2px
    linkStyle 16 stroke:#e65100,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (DB ê²€ìƒ‰ - ë…¹ìƒ‰ 18~21)
    linkStyle 17 stroke:#2e7d32,stroke-width:2px
    linkStyle 18 stroke:#2e7d32,stroke-width:2px
    linkStyle 19 stroke:#2e7d32,stroke-width:2px
    linkStyle 20 stroke:#2e7d32,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë²¡í„° ê²€ìƒ‰ - íŒŒë‘ 22~26)
    linkStyle 21 stroke:#1976d2,stroke-width:2px
    linkStyle 22 stroke:#1976d2,stroke-width:2px
    linkStyle 23 stroke:#1976d2,stroke-width:2px
    linkStyle 24 stroke:#1976d2,stroke-width:2px
    linkStyle 25 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ìš”ì•½ ìƒì„± - ë³´ë¼ 27~31)
    linkStyle 26 stroke:#7b1fa2,stroke-width:2px
    linkStyle 27 stroke:#7b1fa2,stroke-width:2px
    linkStyle 28 stroke:#7b1fa2,stroke-width:2px
    linkStyle 29 stroke:#7b1fa2,stroke-width:2px
    linkStyle 30 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (íŒŒì¼ ì €ì¥ - ì£¼í™© 32~34)
    linkStyle 31 stroke:#e65100,stroke-width:2px
    linkStyle 32 stroke:#e65100,stroke-width:2px
    linkStyle 33 stroke:#e65100,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì˜¤ë¥˜ ì²˜ë¦¬ - ë¹¨ê°• 35~37)
    linkStyle 34 stroke:#c62828,stroke-width:2px
    linkStyle 35 stroke:#c62828,stroke-width:2px
    linkStyle 36 stroke:#c62828,stroke-width:2px

    %% ë‹¨ê³„ ê°„ ì—°ê²° (íšŒìƒ‰ 38~44)
    linkStyle 37 stroke:#616161,stroke-width:3px
    linkStyle 38 stroke:#616161,stroke-width:3px
    linkStyle 39 stroke:#616161,stroke-width:3px
    linkStyle 40 stroke:#616161,stroke-width:3px
    linkStyle 41 stroke:#616161,stroke-width:3px
    linkStyle 42 stroke:#616161,stroke-width:3px
    linkStyle 43 stroke:#616161,stroke-width:3px
    linkStyle 44 stroke:#616161,stroke-width:3px
```

---

### ì „ì²´ íë¦„ ìš”ì•½ í‘œ

| ë‹¨ê³„ | íŒŒì¼ëª… | ë©”ì„œë“œëª… | ë™ì‘ ì„¤ëª… | ì…ë ¥ | ì¶œë ¥ | DB ì‚¬ìš© |
|------|--------|----------|-----------|------|------|---------|
| 1 | `main.py` | - | Streamlit ì„œë²„ ì‹œì‘ | - | - | ì—†ìŒ |
| 2 | `ui/app.py` | `initialize_agent()` | Agent ê·¸ë˜í”„ ì´ˆê¸°í™” | - | agent_executor | ì—†ìŒ |
| 3 | `src/agent/graph.py` | `create_agent_graph()` | LangGraph ìƒíƒœ ë¨¸ì‹  ìƒì„± | exp_manager | CompiledGraph | ì—†ìŒ |
| 4 | `src/agent/nodes.py` | `router_node()` | ì§ˆë¬¸ ë¶„ì„ ë° ë„êµ¬ ì„ íƒ | state (question) | state (tool_choice) | ì—†ìŒ |
| 5 | `configs/multi_request_patterns.yaml` | - | íŒ¨í„´ ë§¤ì¹­ (ìš°ì„ ìˆœìœ„ 120) | question | tool_pipeline | ì—†ìŒ |
| 6 | `src/tools/summarize.py` | `summarize_node()` | ë…¼ë¬¸ ìš”ì•½ ë…¸ë“œ ì‹¤í–‰ | state (question, difficulty) | state (final_answer) | papers, paper_chunks |
| 7 | `src/tools/summarize.py` | - | íŒŒì´í”„ë¼ì¸ ëª¨ë“œ ì²´í¬ | tool_pipeline, pipeline_index | mode (pipeline/single) | ì—†ìŒ |
| 8 | `src/llm/client.py` | `LLMClient.from_difficulty()` | LLM í´ë¼ì´ì–¸íŠ¸ ìƒì„± | difficulty | LLMClient ê°ì²´ | ì—†ìŒ |
| 9 | `src/prompts/loader.py` | `get_summarize_title_extraction_prompt()` | ì œëª© ì¶”ì¶œ í”„ë¡¬í”„íŠ¸ ë¡œë“œ | - | prompt_template | ì—†ìŒ |
| 10 | `src/llm/client.py` | `LLMClient.invoke()` | LLMìœ¼ë¡œ ë…¼ë¬¸ ì œëª© ì¶”ì¶œ | question | paper_title | ì—†ìŒ |
| 11 | `psycopg2` | `connect()` | PostgreSQL ì—°ê²° | DATABASE_URL | connection | papers |
| 12 | `psycopg2` | `cursor.execute()` | papers í…Œì´ë¸” ILIKE ê²€ìƒ‰ | paper_title | paper_id, title, authors, abstract | papers (SELECT) |
| 13 | `langchain_openai` | `OpenAIEmbeddings()` | ì„ë² ë”© ëª¨ë¸ ì´ˆê¸°í™” | model="text-embedding-3-small" | embeddings | ì—†ìŒ |
| 14 | `langchain_postgres` | `PGVector()` | pgvector ì»¬ë ‰ì…˜ ì—°ê²° | collection_name, embeddings | vectorstore | paper_chunks |
| 15 | `langchain_postgres` | `similarity_search()` | ë…¼ë¬¸ ì²­í¬ ì¡°íšŒ | query=title, k=50 | docs (List[Document]) | paper_chunks (SELECT) |
| 16 | `src/tools/summarize.py` | - | ì²­í¬ ë³‘í•© | docs | combined_text | ì—†ìŒ |
| 17 | `src/tools/summarize.py` | - | ë‚œì´ë„ë³„ level ë§¤í•‘ | difficulty | levels (List[str]) | ì—†ìŒ |
| 18 | `src/prompts/loader.py` | `get_summarize_template()` | ë‚œì´ë„ë³„ ìš”ì•½ í”„ë¡¬í”„íŠ¸ ë¡œë“œ | level | summary_template | ì—†ìŒ |
| 19 | `src/llm/client.py` | `LLMClient.invoke()` | LLMìœ¼ë¡œ ìš”ì•½ ìƒì„± (ê° level) | combined_text, title, authors, abstract | summary | ì—†ìŒ |
| 20 | `src/tools/summarize.py` | - | final_answers ì €ì¥ | summaries | final_answers (dict) | ì—†ìŒ |
| 21 | `src/tools/summarize.py` | - | summary.md íŒŒì¼ ìƒì„± | final_answers, title, authors | summary_md | ì—†ìŒ |
| 22 | `src/tools/summarize.py` | - | summary í´ë”ì— ì €ì¥ | summary_md | summary_file | ì—†ìŒ |

---

## ğŸ“ ë™ì‘ ì„¤ëª…

### ë…¼ë¬¸ ìš”ì•½ í”„ë¡œì„¸ìŠ¤ ìƒì„¸ ì„¤ëª…

#### 1ë‹¨ê³„: ë…¼ë¬¸ ì œëª© ì¶”ì¶œ (LLM ì‚¬ìš©)

**ëª©ì **: ì‚¬ìš©ì ì§ˆë¬¸ì—ì„œ ìš”ì•½í•˜ë ¤ëŠ” ë…¼ë¬¸ì˜ ì œëª©ì„ ìë™ìœ¼ë¡œ ì¶”ì¶œ

**íŒŒì¼**: `src/tools/summarize.py:119-137`

**í”„ë¡¬í”„íŠ¸**: `prompts/tool_prompts.json` > `summarize_prompts.title_extraction.template`

```
ë‹¤ìŒ ì§ˆë¬¸ì—ì„œ ìš”ì•½í•˜ë ¤ëŠ” ë…¼ë¬¸ì˜ ì œëª©ì„ ì¶”ì¶œí•˜ì„¸ìš”.
ë…¼ë¬¸ ì œëª©ë§Œ ì •í™•íˆ ë°˜í™˜í•˜ì„¸ìš”. ë‹¤ë¥¸ ì„¤ëª…ì€ ë¶ˆí•„ìš”í•©ë‹ˆë‹¤.

ì§ˆë¬¸: {question}

ë…¼ë¬¸ ì œëª©:
```

**ë™ì‘ ê³¼ì •**:
1. `get_summarize_title_extraction_prompt()` í˜¸ì¶œ
2. ì‚¬ìš©ì ì§ˆë¬¸ì„ `{question}`ì— í¬ë§·íŒ…
3. LLMì— í”„ë¡¬í”„íŠ¸ ì „ë‹¬
4. LLMì´ ë…¼ë¬¸ ì œëª©ë§Œ ë°˜í™˜ (ì˜ˆ: "Attention Is All You Need")

**ì˜ˆì‹œ**:
- ì…ë ¥: "Attention Is All You Need ë…¼ë¬¸ ìš”ì•½í•´ì¤˜"
- ì¶œë ¥: "Attention Is All You Need"

#### 2ë‹¨ê³„: PostgreSQL papers í…Œì´ë¸”ì—ì„œ ë…¼ë¬¸ ê²€ìƒ‰

**ëª©ì **: ì¶”ì¶œëœ ë…¼ë¬¸ ì œëª©ë¡œ DBì—ì„œ ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ì¡°íšŒ

**íŒŒì¼**: `src/tools/summarize.py:140-182`

**SQL ì¿¼ë¦¬**:
```sql
SELECT paper_id, title, authors, abstract, publish_date
FROM papers
WHERE title ILIKE %s
LIMIT 1
```

**ILIKE ì‚¬ìš© ì´ìœ **:
- ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ê²€ìƒ‰
- ë¶€ë¶„ ì¼ì¹˜ í—ˆìš© (`%{paper_title}%`)
- ì œëª©ì´ ì •í™•í•˜ì§€ ì•Šì•„ë„ ê²€ìƒ‰ ê°€ëŠ¥

**ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ**:
```python
state["final_answer"] = f"'{paper_title}' ë…¼ë¬¸ì„ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë…¼ë¬¸ ì œëª©ì„ ì •í™•íˆ í™•ì¸í•´ì£¼ì„¸ìš”."
return state
```

#### 3ë‹¨ê³„: pgvectorì—ì„œ ë…¼ë¬¸ì˜ ëª¨ë“  ì²­í¬ ì¡°íšŒ

**ëª©ì **: ë…¼ë¬¸ ì „ë¬¸ì„ ìš”ì•½í•˜ê¸° ìœ„í•´ ëª¨ë“  ì²­í¬ë¥¼ ì¡°íšŒ

**íŒŒì¼**: `src/tools/summarize.py:184-218`

**pgvector ì„¤ì •**:
- **ì»¬ë ‰ì…˜**: `paper_chunks`
- **ì„ë² ë”© ëª¨ë¸**: OpenAI `text-embedding-3-small` (1536ì°¨ì›)
- **ê²€ìƒ‰ ë°©ì‹**: `similarity_search(query=title, k=50)`

**ì™œ titleì„ queryë¡œ ì‚¬ìš©?**
- ë…¼ë¬¸ IDë¡œ í•„í„°ë§í•˜ëŠ” ê²ƒë³´ë‹¤ ì‹œë§¨í‹± ê²€ìƒ‰ì´ ë” ì •í™•
- ê°™ì€ ë…¼ë¬¸ì˜ ì²­í¬ë“¤ì€ ì œëª©ê³¼ ë†’ì€ ìœ ì‚¬ë„ë¥¼ ê°€ì§
- `k=50`ìœ¼ë¡œ ì¶©ë¶„í•œ ì²­í¬ ìˆ˜ í™•ë³´

**ì²­í¬ ë³‘í•©**:
```python
combined_text = "\n\n".join([doc.page_content for doc in docs])
```

#### 4ë‹¨ê³„: ë‚œì´ë„ë³„ ìš”ì•½ ìƒì„± (ë‘ ìˆ˜ì¤€)

**ëª©ì **: easy/hard ë‚œì´ë„ì— ë”°ë¼ 2ê°œì˜ ìš”ì•½ì„ ìƒì„±

**íŒŒì¼**: `src/tools/summarize.py:220-300`

**ë‚œì´ë„ ë§¤í•‘**:
```python
level_mapping = {
    "easy": ["elementary", "beginner"],
    "hard": ["intermediate", "advanced"]
}
```

**ìˆ˜ì¤€ë³„ ìš”ì•½ ì°¨ì´**:

| ìˆ˜ì¤€ | ëŒ€ìƒ ì—°ë ¹ | íŠ¹ì§• | í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ |
|------|-----------|------|---------------|
| **elementary** | 8-13ì„¸ | ì´ëª¨ì§€ ì‚¬ìš©, ì¼ìƒ ë¹„ìœ , ë™í™” í˜•ì‹ | "ë…¼ë¬¸ì„ ì´ì•¼ê¸°ì²˜ëŸ¼ ì¬ë¯¸ìˆê²Œ..." |
| **beginner** | 14-22ì„¸ | ì‰¬ìš´ ì„¤ëª…, ì‹¤ìƒí™œ ì˜ˆì‹œ, 3-5ê°œ í¬ì¸íŠ¸ | "í•µì‹¬ ì•„ì´ë””ì–´ë¥¼ 3-5ê°œ í¬ì¸íŠ¸ë¡œ..." |
| **intermediate** | 23-30ì„¸ | ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­, ì•Œê³ ë¦¬ì¦˜, ì‹¤í—˜ ê²°ê³¼ | "ë°©ë²•ë¡  ìƒì„¸ ë¶„ì„, ì‹¤í—˜ ì„¤ê³„..." |
| **advanced** | 30ì„¸ ì´ìƒ | ìˆ˜ì‹/ì¦ëª…, ë¹„íŒì  ë¶„ì„, ì„ í–‰ ì—°êµ¬ ë¹„êµ | "ì´ë¡ ì  ë°°ê²½, í†µê³„ì  ìœ ì˜ì„±..." |

**í”„ë¡¬í”„íŠ¸ êµ¬ì¡°** (`prompts/tool_prompts.json`):
```json
{
  "summarize_prompts": {
    "easy": {
      "beginner": {
        "system_prompt": "ë‹¹ì‹ ì€ ë…¼ë¬¸ì„ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” ì¹œì ˆí•œ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤...",
        "summary_template": "{system_prompt}\n\në…¼ë¬¸ ì •ë³´:\n- ì œëª©: {title}\n- ì €ì: {authors}\n..."
      }
    }
  }
}
```

**LLM í˜¸ì¶œ**:
```python
for level in levels:
    summary_template_str = get_summarize_template(level)
    system_content = summary_template_str.format(
        title=title,
        authors=authors,
        combined_text=combined_text
    )
    summary = llm_client.llm.invoke(summary_prompt).content
    final_answers[level] = summary
```

#### 5ë‹¨ê³„: summary.md íŒŒì¼ ì €ì¥

**ëª©ì **: ìš”ì•½ ê²°ê³¼ë¥¼ Markdown íŒŒì¼ë¡œ ì €ì¥

**íŒŒì¼**: `src/tools/summarize.py:312-351`

**ì €ì¥ ê²½ë¡œ**: `outputs/<timestamp>/summary/<safe_title>.md`

**Markdown êµ¬ì¡°**:
```markdown
# ë…¼ë¬¸ ìš”ì•½

## ê¸°ë³¸ ì •ë³´

- **ì œëª©**: Attention Is All You Need
- **ì €ì**: Vaswani, A. et al.
- **ë°œí–‰ì¼**: 2017-06-12

## ìš”ì•½: ì´ˆê¸‰ììš© (14-22ì„¸)

[beginner ìˆ˜ì¤€ ìš”ì•½]

---

## ìš”ì•½: ì¤‘ê¸‰ììš© (23-30ì„¸)

[intermediate ìˆ˜ì¤€ ìš”ì•½]

---

*ìƒì„± ì‹œê°„: 2025-11-07T15:30:00*
```

**íŒŒì¼ëª… ìƒì„±**:
```python
safe_title = "".join(c for c in title if c.isalnum() or c in (' ', '-', '_')).strip()
safe_title = safe_title.replace(' ', '_')[:100]  # ìµœëŒ€ 100ì
```

### ì‚¬ìš©í•˜ëŠ” AI ëª¨ë¸ ì •ë³´

**LLM ëª¨ë¸**:
- **ëª¨ë¸ ì„ íƒ**: `LLMClient.from_difficulty(difficulty)`ì—ì„œ ìë™ ì„ íƒ
- **easy ëª¨ë“œ**: `solar-mini` (ë¹ ë¥´ê³  ê°„ë‹¨í•œ ìš”ì•½)
- **hard ëª¨ë“œ**: `solar-pro2` (ì‹¬ì¸µì ì´ê³  ê¸°ìˆ ì ì¸ ìš”ì•½)

**ì„ë² ë”© ëª¨ë¸**:
- **ëª¨ë¸**: OpenAI `text-embedding-3-small`
- **ì°¨ì›**: 1536
- **ìš©ë„**: ë…¼ë¬¸ ì²­í¬ ë²¡í„° ê²€ìƒ‰

**ëª¨ë¸ ì„¤ì • íŒŒì¼**: `configs/model_config.yaml`

```yaml
summarize:
  provider: solar
  model_easy: solar-mini
  model_hard: solar-pro2
  temperature: 0.3
```

### ìš”ì•½ í’ˆì§ˆ ê´€ë¦¬ ë°©ë²•

**1. í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§**:
- ë‚œì´ë„ë³„ ëª…í™•í•œ ì§€ì¹¨ ì œê³µ
- êµ¬ì¡°í™”ëœ ìš”ì•½ í˜•ì‹ ê°•ì œ (1. ë°°ê²½ 2. ë°©ë²•ë¡  3. ê²°ê³¼...)
- ì „ë¬¸ ìš©ì–´ ì„¤ëª… ìš”êµ¬

**2. ì²­í¬ ë³‘í•© ì „ëµ**:
- ìµœëŒ€ 50ê°œ ì²­í¬ ì¡°íšŒ (ì¶©ë¶„í•œ ë§¥ë½)
- ë…¼ë¬¸ ì œëª©ìœ¼ë¡œ ì‹œë§¨í‹± ê²€ìƒ‰ (ê´€ë ¨ì„± ë†’ì€ ì²­í¬)
- ì²­í¬ ìˆœì„œ ìœ ì§€ (ì›ë³¸ ë…¼ë¬¸ íë¦„)

**3. ë‘ ìˆ˜ì¤€ ìš”ì•½ ì œê³µ**:
- easy ëª¨ë“œ: elementary + beginner (ì´ˆë³´ì ì¹œí™”)
- hard ëª¨ë“œ: intermediate + advanced (ì „ë¬¸ê°€ ì¹œí™”)
- ì‚¬ìš©ìê°€ ìì‹ ì—ê²Œ ë§ëŠ” ìˆ˜ì¤€ ì„ íƒ ê°€ëŠ¥

**4. ì˜ˆì™¸ ì²˜ë¦¬**:
- ë…¼ë¬¸ ì œëª© ì¶”ì¶œ ì‹¤íŒ¨ â†’ ëª…í™•í•œ ì˜¤ë¥˜ ë©”ì‹œì§€
- ë…¼ë¬¸ ê²€ìƒ‰ ì‹¤íŒ¨ â†’ "ë…¼ë¬¸ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤" ì•ˆë‚´
- ì²­í¬ ì—†ìŒ â†’ "ë…¼ë¬¸ ë‚´ìš©ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤" ì•ˆë‚´
- LLM ì˜¤ë¥˜ â†’ Exception catch + Fallback íŠ¸ë¦¬ê±°

**5. ë¡œê¹… ë° ì¶”ì **:
- ExperimentManagerë¡œ ëª¨ë“  ë‹¨ê³„ ê¸°ë¡
- SQL ì¿¼ë¦¬, pgvector ê²€ìƒ‰, LLM í˜¸ì¶œ ë¡œê·¸
- ìš”ì•½ ê²°ê³¼ summary.mdë¡œ ì €ì¥ (ì¬ì‚¬ìš© ê°€ëŠ¥)

---

## ğŸ’¡ ì‚¬ìš© ì˜ˆì‹œ

### ì˜ˆì‹œ 1: ë‹¨ì¼ ìš”ì²­ - ë…¼ë¬¸ ìš”ì•½

**ì‚¬ìš©ì ì§ˆë¬¸:**
```
Attention Is All You Need ë…¼ë¬¸ ìš”ì•½í•´ì¤˜
```

**ì‹¤í–‰ íë¦„:**

1. **íŒ¨í„´ ë§¤ì¹­**: `keywords: [ë…¼ë¬¸, ìš”ì•½]` â†’ summarize ì„ íƒ
2. **ë…¼ë¬¸ ì œëª© ì¶”ì¶œ**:
   - LLM í”„ë¡¬í”„íŠ¸: "ë‹¤ìŒ ì§ˆë¬¸ì—ì„œ ìš”ì•½í•˜ë ¤ëŠ” ë…¼ë¬¸ì˜ ì œëª©ì„ ì¶”ì¶œí•˜ì„¸ìš”..."
   - ì¶”ì¶œ ê²°ê³¼: "Attention Is All You Need"
3. **PostgreSQL ê²€ìƒ‰**:
   ```sql
   SELECT paper_id, title, authors, abstract, publish_date
   FROM papers
   WHERE title ILIKE '%Attention Is All You Need%'
   LIMIT 1
   ```
   - ê²°ê³¼: `paper_id=42, title="Attention Is All You Need", authors="Vaswani, A. et al.", ...`
4. **pgvector ì²­í¬ ì¡°íšŒ**:
   ```python
   docs = vectorstore.similarity_search(
       query="Attention Is All You Need",
       k=50
   )
   ```
   - ì¡°íšŒëœ ì²­í¬ ìˆ˜: 48ê°œ
5. **ìš”ì•½ ìƒì„±** (easy ëª¨ë“œ: beginner + elementary):
   - **beginner ìš”ì•½**:
     ```
     ## ë…¼ë¬¸ ìš”ì•½: ì´ˆê¸‰ììš© (14-22ì„¸)

     ### ì´ ë…¼ë¬¸ì´ í•´ê²°í•˜ë ¤ëŠ” ë¬¸ì œ
     ê¸°ì¡´ ë²ˆì—­ ëª¨ë¸ì€ ìˆœì„œëŒ€ë¡œ ë‹¨ì–´ë¥¼ ì²˜ë¦¬í•´ì„œ ëŠë ¸ìŠµë‹ˆë‹¤.
     ë¬¸ì¥ì´ ê¸¸ë©´ ì•ë¶€ë¶„ì„ ìŠì–´ë²„ë¦¬ëŠ” ë¬¸ì œë„ ìˆì—ˆìŠµë‹ˆë‹¤.

     ### ì œì•ˆí•˜ëŠ” í•´ê²° ë°©ë²•
     Transformerë¼ëŠ” ìƒˆë¡œìš´ ëª¨ë¸ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
     - ëª¨ë“  ë‹¨ì–´ë¥¼ ë™ì‹œì— ì²˜ë¦¬ (Self-Attention ë©”ì»¤ë‹ˆì¦˜)
     - ë‹¨ì–´ ê°„ ê´€ê³„ë¥¼ ê³„ì‚°í•´ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ ì°¾ê¸°
     - ìˆœì„œ ì •ë³´ëŠ” Positional Encodingìœ¼ë¡œ ë³´ì¡´

     ### ì™œ ì´ ë°©ë²•ì´ ì¢‹ì€ì§€
     - í•™ìŠµ ì†ë„ê°€ í›¨ì”¬ ë¹ ë¦„ (ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥)
     - ê¸´ ë¬¸ì¥ë„ ì˜ ì´í•´í•¨
     - ë²ˆì—­ í’ˆì§ˆì´ ê¸°ì¡´ ëª¨ë¸ë³´ë‹¤ 2.0 BLEU ë†’ìŒ

     ### í•œ ì¤„ ìš”ì•½
     TransformerëŠ” ëª¨ë“  ë‹¨ì–´ë¥¼ ë™ì‹œì— ë³´ë©´ì„œ ì¤‘ìš”í•œ ì—°ê²°ì„ ì°¾ì•„ë‚´ëŠ”
     ìƒˆë¡œìš´ ë²ˆì—­ ëª¨ë¸ì…ë‹ˆë‹¤! ğŸš€
     ```
   - **elementary ìš”ì•½**:
     ```
     ## ë…¼ë¬¸ ìš”ì•½: ì´ˆë“±í•™ìƒìš© (8-13ì„¸)

     ğŸ“š ì˜›ë‚  ì˜›ë‚ ì—, ì»´í“¨í„°ê°€ ë‹¤ë¥¸ ë‚˜ë¼ ë§ì„ ë²ˆì—­í•˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆì–´ìš”.

     ğŸ¢ ë¬¸ì œì :
     - ë‹¨ì–´ë¥¼ í•˜ë‚˜ì”© ì°¨ë¡€ëŒ€ë¡œ ì½ì–´ì„œ ë„ˆë¬´ ëŠë ¸ì–´ìš”
     - ê¸´ ë¬¸ì¥ì€ ì•ë¶€ë¶„ì„ ìŠì–´ë²„ë ¸ì–´ìš”

     ğŸ’¡ ê³¼í•™ìë“¤ì˜ í•´ê²°ì±…:
     Transformerë¼ëŠ” ë§ˆë²• ê°™ì€ ë„êµ¬ë¥¼ ë§Œë“¤ì—ˆì–´ìš”!

     âœ¨ Transformerì˜ íŠ¹ë³„í•œ ì :
     - ëª¨ë“  ë‹¨ì–´ë¥¼ ë™ì‹œì— ë´ìš” (ë§ˆì¹˜ ì¹œêµ¬ë“¤ì„ í•œëˆˆì— ë³´ëŠ” ê²ƒì²˜ëŸ¼!)
     - ì–´ë–¤ ë‹¨ì–´ê°€ ì¤‘ìš”í•œì§€ ìŠ¤ìŠ¤ë¡œ ì°¾ì•„ìš”
     - ì—„ì²­ë‚˜ê²Œ ë¹¨ë¼ìš”!

     ğŸ¯ ê²°ê³¼:
     ë²ˆì—­ì´ í›¨ì”¬ ì •í™•í•´ì§€ê³  ë¹¨ë¼ì¡Œì–´ìš”.
     ë§ˆì¹˜ ë ˆê³  ë¸”ë¡ì„ í•œ ë²ˆì— ì¡°ë¦½í•˜ëŠ” ê²ƒì²˜ëŸ¼ìš”! ğŸ§±
     ```
6. **ìµœì¢… ë‹µë³€ ë°˜í™˜**: `final_answers["beginner"]`
7. **summary.md ì €ì¥**: `outputs/.../summary/Attention_Is_All_You_Need.md`

### ì˜ˆì‹œ 2: íŒŒì´í”„ë¼ì¸ ìš”ì²­ - ë…¼ë¬¸ ê²€ìƒ‰ í›„ ìš”ì•½

**ì‚¬ìš©ì ì§ˆë¬¸:**
```
Transformer ë…¼ë¬¸ ì°¾ì•„ì„œ ìš”ì•½í•´ì¤˜
```

**ì‹¤í–‰ íë¦„:**

1. **íŒ¨í„´ ë§¤ì¹­**: `keywords: [ë…¼ë¬¸, ì°¾, ìš”ì•½]` â†’ tool_pipeline
   ```python
   tool_pipeline = ["search_paper", "web_search", "general", "summarize"]
   ```
2. **search_paper ì‹¤í–‰**:
   - pgvector ê²€ìƒ‰: "Transformer" ê´€ë ¨ ë…¼ë¬¸ 5í¸ ì¡°íšŒ
   - ê²€ìƒ‰ ê²°ê³¼ë¥¼ `tool_result`ì— ì €ì¥
   ```
   1. Attention Is All You Need (Vaswani, A. et al., 2017)
      - Transformer ì•„í‚¤í…ì²˜ ì œì•ˆ
      - Self-Attention ë©”ì»¤ë‹ˆì¦˜ ë„ì…
      - ê¸°ê³„ ë²ˆì—­ì—ì„œ SOTA ë‹¬ì„±
      ...
   ```
3. **summarize ì‹¤í–‰** (íŒŒì´í”„ë¼ì¸ ëª¨ë“œ):
   - `tool_result` ì‚¬ìš© (search_paper ê²°ê³¼)
   - ê°„ë‹¨í•œ ìš”ì•½ í”„ë¡¬í”„íŠ¸ ì ìš©
   ```python
   system_content = """ë‹¹ì‹ ì€ ë…¼ë¬¸ì„ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” ì¹œì ˆí•œ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

   ë‹µë³€ ê·œì¹™:
   - í•µì‹¬ ì•„ì´ë””ì–´ë¥¼ 3-5ê°œ í¬ì¸íŠ¸ë¡œ ì •ë¦¬í•˜ì„¸ìš”
   - ì „ë¬¸ ìš©ì–´ëŠ” ì‰¬ìš´ ë§ë¡œ í’€ì–´ì„œ ì„¤ëª…í•˜ì„¸ìš”
   ..."""

   user_content = f"""ë‹¤ìŒ ë‚´ìš©ì„ ìš”ì•½í•´ì£¼ì„¸ìš”:

   {tool_result}

   ìš”ì•½:"""
   ```
4. **LLM ìš”ì•½ ìƒì„±**:
   ```
   ## Transformer ë…¼ë¬¸ ìš”ì•½

   ### ì£¼ìš” ë‚´ìš©
   1. **Self-Attention ë©”ì»¤ë‹ˆì¦˜**: ëª¨ë“  ë‹¨ì–´ë¥¼ ë™ì‹œì— ë³´ë©´ì„œ ì¤‘ìš”í•œ ì—°ê²° ì°¾ê¸°
   2. **ë³‘ë ¬ ì²˜ë¦¬**: ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ì§€ ì•Šì•„ì„œ í•™ìŠµ ì†ë„ ë¹ ë¦„
   3. **Positional Encoding**: ë‹¨ì–´ ìˆœì„œ ì •ë³´ë¥¼ ë²¡í„°ë¡œ ì¸ì½”ë”©

   ### í•µì‹¬ í¬ì¸íŠ¸
   - ê¸°ì¡´ RNN/LSTMì˜ ëŠë¦° ì†ë„ ë¬¸ì œ í•´ê²°
   - ê¸´ ë¬¸ì¥ì—ì„œë„ ì¥ê±°ë¦¬ ì˜ì¡´ì„±(long-range dependency) ì˜ í¬ì°©
   - ê¸°ê³„ ë²ˆì—­, í…ìŠ¤íŠ¸ ìƒì„± ë“± ë‹¤ì–‘í•œ NLP ì‘ì—…ì— ì ìš© ê°€ëŠ¥

   ### í•œ ì¤„ ìš”ì•½
   TransformerëŠ” Attention ë©”ì»¤ë‹ˆì¦˜ë§Œìœ¼ë¡œ êµ¬ì„±ëœ ìƒˆë¡œìš´ ì‹ ê²½ë§ êµ¬ì¡°ë¡œ,
   NLP ë¶„ì•¼ì˜ íŒ¨ëŸ¬ë‹¤ì„ì„ ë°”ê¾¼ í˜ì‹ ì ì¸ ëª¨ë¸ì…ë‹ˆë‹¤.
   ```
5. **ìµœì¢… ë‹µë³€ ë°˜í™˜**: summary

### ì˜ˆì‹œ 3: ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤ - ë…¼ë¬¸ ì—†ìŒ â†’ Fallback

**ì‚¬ìš©ì ì§ˆë¬¸:**
```
XYZ ë…¼ë¬¸ ìš”ì•½í•´ì¤˜
```

**ì‹¤í–‰ íë¦„:**

1. **íŒ¨í„´ ë§¤ì¹­**: `keywords: [ë…¼ë¬¸, ìš”ì•½]` â†’ summarize ì„ íƒ
2. **ë…¼ë¬¸ ì œëª© ì¶”ì¶œ**: "XYZ"
3. **PostgreSQL ê²€ìƒ‰**:
   ```sql
   SELECT paper_id, title, authors, abstract, publish_date
   FROM papers
   WHERE title ILIKE '%XYZ%'
   LIMIT 1
   ```
   - ê²°ê³¼: None (ë…¼ë¬¸ ì—†ìŒ)
4. **ì˜¤ë¥˜ ë©”ì‹œì§€ ë°˜í™˜**:
   ```python
   state["final_answer"] = "'XYZ' ë…¼ë¬¸ì„ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë…¼ë¬¸ ì œëª©ì„ ì •í™•íˆ í™•ì¸í•´ì£¼ì„¸ìš”."
   ```
5. **Fallback íŠ¸ë¦¬ê±°**: general ë„êµ¬ë¡œ ìë™ ì „í™˜
6. **ì¼ë°˜ ë‹µë³€ ë„êµ¬ ì‹¤í–‰**:
   ```
   XYZ ë…¼ë¬¸ì— ëŒ€í•œ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.

   ë„ì›€ì´ ë  ë§Œí•œ ì œì•ˆ:
   1. ë…¼ë¬¸ ì œëª©ì˜ ì² ìë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”
   2. ë…¼ë¬¸ì˜ ì •ì‹ ì œëª©(ì˜ë¬¸)ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”
   3. ì €ìëª…ìœ¼ë¡œ ê²€ìƒ‰í•˜ê±°ë‚˜ ë‹¤ë¥¸ í‚¤ì›Œë“œë¥¼ ì‹œë„í•´ë³´ì„¸ìš”

   ë…¼ë¬¸ ì œëª©ì„ ì •í™•íˆ ì•Œê³  ê³„ì‹œë‹¤ë©´,
   "ë…¼ë¬¸ ì°¾ì•„ì¤˜"ë¡œ ë¨¼ì € ê²€ìƒ‰ í›„ ìš”ì•½ì„ ìš”ì²­í•˜ì‹œë©´ ë” ì •í™•í•©ë‹ˆë‹¤.
   ```

---

## ğŸ” í•µì‹¬ í¬ì¸íŠ¸

### 1. íŒŒì´í”„ë¼ì¸ ëª¨ë“œ vs ë‹¨ì¼ ëª¨ë“œ

**íŒŒì´í”„ë¼ì¸ ëª¨ë“œì˜ ì¥ì **:
- ì´ì „ ë„êµ¬ ê²°ê³¼ë¥¼ ì¬ì‚¬ìš© (DB ê²€ìƒ‰ ìƒëµ)
- ë¹ ë¥¸ ìš”ì•½ ìƒì„± (ê°„ë‹¨í•œ í”„ë¡¬í”„íŠ¸)
- ë‹¤ì¤‘ ìš”ì²­ì— ìµœì í™”

**ë‹¨ì¼ ëª¨ë“œì˜ ì¥ì **:
- ë…¼ë¬¸ ì œëª©ë§Œìœ¼ë¡œ ì •í™•í•œ ìš”ì•½
- ë‘ ìˆ˜ì¤€ì˜ ìš”ì•½ ì œê³µ (ë” ìƒì„¸í•¨)
- summary.md íŒŒì¼ ì €ì¥

### 2. ë‚œì´ë„ë³„ ìš”ì•½ì˜ ê°€ì¹˜

**4ë‹¨ê³„ ë‚œì´ë„ ì‹œìŠ¤í…œ**:
- **elementary** (8-13ì„¸): ì´ëª¨ì§€, ë™í™” í˜•ì‹, ì¼ìƒ ë¹„ìœ 
- **beginner** (14-22ì„¸): ì‰¬ìš´ ì„¤ëª…, ì‹¤ìƒí™œ ì˜ˆì‹œ, í•µì‹¬ í¬ì¸íŠ¸
- **intermediate** (23-30ì„¸): ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­, ì•Œê³ ë¦¬ì¦˜, ì‹¤í—˜ ê²°ê³¼
- **advanced** (30ì„¸+): ìˆ˜ì‹/ì¦ëª…, ë¹„íŒì  ë¶„ì„, ì„ í–‰ ì—°êµ¬

**ì™œ ì¤‘ìš”í•œê°€?**
- ì‚¬ìš©ìì˜ ë°°ê²½ ì§€ì‹ì— ë§ëŠ” ì„¤ëª…
- í•™ìŠµ íš¨ìœ¨ì„± ê·¹ëŒ€í™”
- ë…¼ë¬¸ ì´í•´ë„ í–¥ìƒ

### 3. pgvector + PostgreSQL í•˜ì´ë¸Œë¦¬ë“œ

**pgvectorì˜ ì—­í• **:
- ì‹œë§¨í‹± ê²€ìƒ‰ìœ¼ë¡œ ê´€ë ¨ ì²­í¬ ì¡°íšŒ
- ë…¼ë¬¸ ì œëª© ìœ ì‚¬ë„ ê¸°ë°˜ í•„í„°ë§
- k=50ìœ¼ë¡œ ì¶©ë¶„í•œ ë§¥ë½ í™•ë³´

**PostgreSQLì˜ ì—­í• **:
- ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ê´€ë¦¬ (title, authors, abstract)
- ILIKEë¡œ ë¶€ë¶„ ì¼ì¹˜ ê²€ìƒ‰
- ë¹ ë¥¸ ì¡°íšŒ ì„±ëŠ¥

### 4. LangChain ìš”ì•½ ì²´ì¸ ë¯¸ì‚¬ìš©

**ì™œ LangChainì˜ load_summarize_chainì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ê°€?**
- í˜„ì¬ ì½”ë“œëŠ” ì§ì ‘ LLM invoke ì‚¬ìš©
- ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ë” ìœ ì—°
- ë‘ ìˆ˜ì¤€ì˜ ìš”ì•½ì„ ë™ì‹œì— ìƒì„± ê°€ëŠ¥

**í–¥í›„ ê°œì„  ë°©í–¥**:
- Map-Reduce ìš”ì•½ ì „ëµ ë„ì… (ì²­í¬ê°€ ë§ì„ ë•Œ)
- Refine ì „ëµìœ¼ë¡œ ì ì§„ì  ìš”ì•½ ê°œì„ 
- load_summarize_chain í†µí•© ê³ ë ¤

---

## ğŸ“š ì°¸ê³  ì •ë³´

### ì£¼ìš” íŒŒì¼ ë° ìœ„ì¹˜

- **ë„êµ¬ êµ¬í˜„**: `src/tools/summarize.py`
- **í”„ë¡¬í”„íŠ¸ JSON**: `prompts/tool_prompts.json` > `summarize_prompts`
- **í”„ë¡¬í”„íŠ¸ ë¡œë”**: `src/prompts/loader.py` > `get_summarize_template()`
- **íŒ¨í„´ ì„¤ì •**: `configs/multi_request_patterns.yaml` (priority: 120)
- **ëª¨ë¸ ì„¤ì •**: `configs/model_config.yaml` > `summarize`

### ê´€ë ¨ ê¸°ìˆ  ìŠ¤íƒ

- **LangChain**: ìš”ì•½ ì²´ì¸, í”„ë¡¬í”„íŠ¸ ê´€ë¦¬
- **OpenAI API**: ì„ë² ë”© ìƒì„± (text-embedding-3-small)
- **PostgreSQL**: ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ì €ì¥
- **pgvector**: ë…¼ë¬¸ ì²­í¬ ë²¡í„° ê²€ìƒ‰
- **psycopg2**: PostgreSQL ì—°ê²° ë° ì¿¼ë¦¬
- **LangGraph**: ìƒíƒœ ë¨¸ì‹  ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°

### ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

| í•­ëª© | ê°’ | ì„¤ëª… |
|------|------|------|
| **ì²­í¬ ì¡°íšŒ ìˆ˜** | k=50 | ì¶©ë¶„í•œ ë§¥ë½, í•˜ì§€ë§Œ LLM í† í° í•œë„ ê³ ë ¤ |
| **ìš”ì•½ ìˆ˜ì¤€** | 2ê°œ | easy/hard ê° 2ê°œì”©, ì´ 4ê°œ í”„ë¡¬í”„íŠ¸ |
| **LLM í˜¸ì¶œ** | 3-4íšŒ | ì œëª© ì¶”ì¶œ(1) + ìš”ì•½ ìƒì„±(2) or íŒŒì´í”„ë¼ì¸(1) |
| **PostgreSQL ì¿¼ë¦¬** | 1íšŒ | papers í…Œì´ë¸” ILIKE ê²€ìƒ‰ |
| **pgvector ê²€ìƒ‰** | 1íšŒ | paper_chunks similarity_search |

### ì œì•½ ì‚¬í•­

1. **ë…¼ë¬¸ì´ DBì— ìˆì–´ì•¼ í•¨**: papers í…Œì´ë¸”ì— ë…¼ë¬¸ì´ ì €ì¥ë˜ì–´ ìˆì–´ì•¼ ìš”ì•½ ê°€ëŠ¥
2. **ì²­í¬ ì¡´ì¬ í•„ìš”**: paper_chunksì— ë…¼ë¬¸ ë³¸ë¬¸ ì²­í¬ê°€ ìˆì–´ì•¼ í•¨
3. **LLM í† í° í•œë„**: ì²­í¬ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ í† í° í•œë„ ì´ˆê³¼ ê°€ëŠ¥ (í˜„ì¬ k=50ìœ¼ë¡œ ì œí•œ)
4. **ì œëª© ì¶”ì¶œ ì˜ì¡´**: LLMì´ ì œëª©ì„ ì •í™•íˆ ì¶”ì¶œí•˜ì§€ ëª»í•˜ë©´ ì‹¤íŒ¨

### ê°œì„  ë°©í–¥

1. **Map-Reduce ìš”ì•½ ë„ì…**: ì²­í¬ê°€ ë§ì„ ë•Œ ë¶„í•  ìš”ì•½ í›„ ë³‘í•©
2. **ë…¼ë¬¸ ìºì‹±**: ìì£¼ ìš”ì•½ë˜ëŠ” ë…¼ë¬¸ì€ ê²°ê³¼ ìºì‹±
3. **ë‹¤ì¤‘ ë…¼ë¬¸ ìš”ì•½**: í•œ ë²ˆì— ì—¬ëŸ¬ ë…¼ë¬¸ ë¹„êµ ìš”ì•½
4. **ìš”ì•½ í’ˆì§ˆ í‰ê°€**: ìš”ì•½ ê²°ê³¼ ìë™ í‰ê°€ ë° ê°œì„ 

---

**ì‘ì„±ì¼**: 2025-11-07
**ë²„ì „**: 1.0
