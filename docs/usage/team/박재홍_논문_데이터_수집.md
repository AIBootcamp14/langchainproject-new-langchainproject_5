# ë°•ì¬í™ - ë…¼ë¬¸ ë°ì´í„° ìˆ˜ì§‘ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ê°€ì´ë“œ

**ë‹´ë‹¹ì**: ë°•ì¬í™
**ì‘ì—… ë²”ìœ„**: arXiv ë…¼ë¬¸ ìˆ˜ì§‘, Document ì²˜ë¦¬, ì„ë² ë”© ìƒì„± ë° PostgreSQL + pgvector ì ì¬
**ë¬¸ì„œ ì‘ì„±ì¼**: 2025-11-03

---

## ì‹¤í–‰ í™˜ê²½ ì¤€ë¹„

### 1. ê°€ìƒí™˜ê²½ í™œì„±í™”

```bash
# pyenv ê°€ìƒí™˜ê²½ í™œì„±í™”
pyenv activate langchain_py3_11_9
```

### 2. í™˜ê²½ ë³€ìˆ˜ í™•ì¸

`.env` íŒŒì¼ì— ë‹¤ìŒ í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸:

```bash
# PostgreSQL ì„¤ì •
POSTGRES_USER=langchain
POSTGRES_PASSWORD=dusrufdmlalswhr
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=papers

# OpenAI API í‚¤
OPENAI_API_KEY=sk-...
```

### 3. PostgreSQL ì„œë²„ ì‹¤í–‰ í™•ì¸

```bash
# PostgreSQL ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status postgresql

# ì‹¤í–‰ ì¤‘ì´ ì•„ë‹ˆë©´ ì‹œì‘
sudo systemctl start postgresql
```

---

## ì‹¤í–‰ ìš°ì„ ìˆœìœ„ ë° ëª…ë ¹ì–´

### ìš°ì„ ìˆœìœ„ 1: arXiv ë…¼ë¬¸ ìˆ˜ì§‘

#### ì‹¤í–‰ ëª…ë ¹ì–´
```bash
python scripts/data/collect_arxiv_papers.py
```

#### ì„¤ëª…
- arXiv APIë¥¼ ì‚¬ìš©í•˜ì—¬ AI/ML ê´€ë ¨ ë…¼ë¬¸ ìˆ˜ì§‘
- PDF íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
- 7ê°œ í‚¤ì›Œë“œë¡œ ê° 15í¸ì”© ìˆ˜ì§‘ (í‚¤ì›Œë“œë‹¹ ì¤‘ë³µ ì œê±°)

#### ìˆ˜ì§‘ í‚¤ì›Œë“œ
1. transformer attention
2. BERT GPT
3. large language model
4. retrieval augmented generation
5. neural machine translation
6. question answering
7. AI agent

#### í•„ìš” ì¡°ê±´
- ì¸í„°ë„· ì—°ê²°
- `.env` íŒŒì¼ ì„¤ì •

#### ìƒì„± ê²°ê³¼ë¬¼
- `data/raw/pdfs/`: PDF íŒŒì¼ë“¤ (arXiv ID í˜•ì‹: `2412.09925v2.pdf`)
- `data/raw/arxiv_papers_metadata.json`: ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° JSON
- `experiments/[ë‚ ì§œ]/[ì‹œê°„]_session_[ë²ˆí˜¸]/chatbot.log`: ìˆ˜ì§‘ ë¡œê·¸

#### ì˜ˆìƒ ì†Œìš” ì‹œê°„
- ì•½ 20-30ë¶„ (ë…¼ë¬¸ ìˆ˜ì— ë”°ë¼ ë‹¤ë¦„)
- ì´ë¯¸ ë‹¤ìš´ë¡œë“œëœ PDFëŠ” ê±´ë„ˆëœ€

#### ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ
```
======================================================================
arXiv ë…¼ë¬¸ ìˆ˜ì§‘ ì‹œì‘
======================================================================
2025-11-03 00:54:25 | ì„¸ì…˜ ì‹œì‘: session_004
2025-11-03 00:54:25 | í‚¤ì›Œë“œ ìˆ˜ì§‘ ì‹œì‘: transformer attention
2025-11-03 00:54:25 | ê²€ìƒ‰ ì‹œì‘: query=transformer attention, max_results=15
2025-11-03 00:54:26 | ë‹¤ìš´ë¡œë“œ ì™„ë£Œ: Simulating Hard Attention Using Soft Attention (2412.09925v2)
...
2025-11-03 00:54:27 | ì´ 105í¸ì˜ ë…¼ë¬¸ ìˆ˜ì§‘ ì™„ë£Œ
âœ… arXiv ë…¼ë¬¸ ìˆ˜ì§‘ ì™„ë£Œ
```

---

### ìš°ì„ ìˆœìœ„ 2: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

#### ì‹¤í–‰ ëª…ë ¹ì–´
```bash
python scripts/data/setup_database.py
```

#### ì„¤ëª…
- PostgreSQLì— `papers`, `glossary` í…Œì´ë¸” ìƒì„±
- pgvector í™•ì¥ í™œì„±í™”
- ë…¼ë¬¸ ë©”íƒ€ë°ì´í„°ë¥¼ `papers` í…Œì´ë¸”ì— INSERT
- arXiv ID â†’ paper_id ë§¤í•‘ íŒŒì¼ ìƒì„±

#### í•„ìš” ì¡°ê±´
- **ìš°ì„ ìˆœìœ„ 1 ì™„ë£Œ í•„ìˆ˜** (ë…¼ë¬¸ ìˆ˜ì§‘ ì™„ë£Œ)
- PostgreSQL ì„œë²„ ì‹¤í–‰ ì¤‘
- `.env` íŒŒì¼ì— DB ì ‘ì† ì •ë³´ ì„¤ì •

#### ìƒì„± ê²°ê³¼ë¬¼
- PostgreSQL `papers` í…Œì´ë¸”: ë…¼ë¬¸ ë©”íƒ€ë°ì´í„°
- PostgreSQL `glossary` í…Œì´ë¸”: ìš©ì–´ì§‘ (ì´ˆê¸° ë°ì´í„° í¬í•¨)
- `data/processed/paper_id_mapping.json`: arXiv ID â†’ paper_id ë§¤í•‘

#### ì˜ˆìƒ ì†Œìš” ì‹œê°„
- ì•½ 1-2ë¶„

#### ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ
```
Schema created and committed.
Glossary seed data inserted (3 terms).
Inserted 105 papers into database.
Data insertion completed.
Saved arxiv_idâ†’paper_id mapping: /home/ieyeppo/AI_Lab/langchain-project/data/processed/paper_id_mapping.json (105ê°œ)
Database setup completed (tables, indexes, glossary seed, id mapping).
```

#### ìƒì„± í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ

**papers í…Œì´ë¸”:**
- `paper_id`: SERIAL PRIMARY KEY
- `arxiv_id`: VARCHAR(64)
- `title`: TEXT NOT NULL
- `authors`: TEXT
- `publish_date`: DATE
- `source`: VARCHAR(32)
- `url`: TEXT UNIQUE
- `category`: TEXT
- `citation_count`: INT
- `abstract`: TEXT
- `created_at`: TIMESTAMP
- `updated_at`: TIMESTAMP

**glossary í…Œì´ë¸”:**
- `term_id`: SERIAL PRIMARY KEY
- `term`: TEXT UNIQUE
- `definition`: TEXT
- `easy_explanation`: TEXT
- `hard_explanation`: TEXT
- `category`: TEXT
- `difficulty_level`: INT
- `related_terms`: TEXT
- `examples`: TEXT
- `created_at`: TIMESTAMP
- `updated_at`: TIMESTAMP

---

### ìš°ì„ ìˆœìœ„ 3: PDF ë¬¸ì„œ ë¡œë“œ ë° ì²­í¬ ë¶„í• 

#### ì‹¤í–‰ ëª…ë ¹ì–´
```bash
python scripts/data/process_documents.py
```

#### ì„¤ëª…
- PDF íŒŒì¼ì„ ì½ê³  í…ìŠ¤íŠ¸ ì¶”ì¶œ
- RecursiveCharacterTextSplitterë¡œ ì²­í¬ ë¶„í• 
- ê° ì²­í¬ì— ë©”íƒ€ë°ì´í„° ì¶”ê°€ (arxiv_id, chunk_id, ì œëª© ë“±)

#### í•„ìš” ì¡°ê±´
- **ìš°ì„ ìˆœìœ„ 1 ì™„ë£Œ í•„ìˆ˜** (PDF íŒŒì¼ ì¡´ì¬)
- **ìš°ì„ ìˆœìœ„ 2 ì™„ë£Œ ê¶Œì¥** (ë©”íƒ€ë°ì´í„° ë§¤í•‘)

#### ì²­í¬ ë¶„í•  ì„¤ì •
- `chunk_size`: 1000ì
- `chunk_overlap`: 200ì
- êµ¬ë¶„ì: `\n\n`, `\n`, `. `, ` `, ``

#### ìƒì„± ê²°ê³¼ë¬¼
- Document ê°ì²´ ë¦¬ìŠ¤íŠ¸ (ë©”ëª¨ë¦¬ì— ì €ì¥, ë‹¤ìŒ ë‹¨ê³„ë¡œ ì „ë‹¬)
- ì½˜ì†” ì¶œë ¥: ìƒì„±ëœ ì²­í¬ ê°œìˆ˜

#### ì˜ˆìƒ ì†Œìš” ì‹œê°„
- ì•½ 10-20ë¶„ (ë…¼ë¬¸ ìˆ˜ì™€ PDF í¬ê¸°ì— ë”°ë¼ ë‹¤ë¦„)

#### ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ
```
============================================================
PDF ë¬¸ì„œ ë¡œë“œ ë° ì²­í¬ ë¶„í• 
============================================================
PDF ë””ë ‰í† ë¦¬: /home/ieyeppo/AI_Lab/langchain-project/data/raw/pdfs
ë©”íƒ€ë°ì´í„°: /home/ieyeppo/AI_Lab/langchain-project/data/raw/arxiv_papers_metadata.json

PDF íŒŒì¼ ë¡œë“œ ì¤‘...
âœ… ì´ 8901ê°œ ì²­í¬ ìƒì„± ì™„ë£Œ

ì²« ë²ˆì§¸ ì²­í¬ ì˜ˆì‹œ:
------------------------------------------------------------
Simulating Hard Attention Using Soft Attention...
ë©”íƒ€ë°ì´í„°: {'source': 'data/raw/pdfs/2412.09925v2.pdf', 'chunk_id': 0, 'title': '...'}
```

---

### ìš°ì„ ìˆœìœ„ 4: ì„ë² ë”© ìƒì„± ë° Vector DB ì €ì¥

#### ì‹¤í–‰ ëª…ë ¹ì–´
```bash
python scripts/data/load_embeddings.py
```

#### ì„¤ëª…
- OpenAI Embeddings APIë¡œ ë¬¸ì„œ ì„ë² ë”© ìƒì„±
- PostgreSQL pgvectorì— ì„ë² ë”© ë²¡í„° ì €ì¥
- ë°°ì¹˜ ì²˜ë¦¬ (50ê°œì”©) + Rate Limit ëŒ€ì‘

#### í•„ìš” ì¡°ê±´
- **ìš°ì„ ìˆœìœ„ 1, 2 ì™„ë£Œ í•„ìˆ˜**
- `.env` íŒŒì¼ì— `OPENAI_API_KEY` ì„¤ì •
- OpenAI API ì‚¬ìš© ê°€ëŠ¥ (ìœ ë£Œ ê³„ì • ê¶Œì¥)

#### ì„ë² ë”© ëª¨ë¸
- `text-embedding-3-small` (1536 ì°¨ì›)
- ì„¤ì • ìœ„ì¹˜: `configs/model_config.yaml`

#### ë°°ì¹˜ ì²˜ë¦¬ ì„¤ì •
- ë°°ì¹˜ í¬ê¸°: 50ê°œ
- ë°°ì¹˜ ê°„ ëŒ€ê¸°: 100ms
- Rate Limit ì˜¤ë¥˜ ì‹œ: 5ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„

#### ìƒì„± ê²°ê³¼ë¬¼

**PostgreSQL + pgvectorì— ì €ì¥ë˜ëŠ” ë°ì´í„°:**

1. **langchain_pg_collection í…Œì´ë¸”**: ì»¬ë ‰ì…˜ ë©”íƒ€ë°ì´í„°
   - `uuid`: ì»¬ë ‰ì…˜ ê³ ìœ  ID
   - `name`: ì»¬ë ‰ì…˜ ì´ë¦„ (`paper_chunks`)

2. **langchain_pg_embedding í…Œì´ë¸”**: ì„ë² ë”© ë²¡í„° ë° ë¬¸ì„œ
   - `id`: ë¬¸ì„œ ê³ ìœ  ID
   - `collection_id`: ì»¬ë ‰ì…˜ UUID (FK)
   - `embedding`: ë²¡í„° (vector íƒ€ì…, 1536ì°¨ì›)
   - `document`: ì›ë³¸ í…ìŠ¤íŠ¸ (ë…¼ë¬¸ ì²­í¬)
   - `cmetadata`: JSON ë©”íƒ€ë°ì´í„° (arxiv_id, paper_id, chunk_id ë“±)

3. **ì½˜ì†” ì¶œë ¥**: ì €ì¥ëœ ë¬¸ì„œ ê°œìˆ˜ ë° ì§„í–‰ë¥ 

**ì €ì¥ ê°œìˆ˜ ì˜ˆì‹œ:**
- ì•½ 8,500ê°œì˜ ì„ë² ë”© ë²¡í„° (ë…¼ë¬¸ ìˆ˜ì— ë”°ë¼ ë‹¤ë¦„)

#### ì˜ˆìƒ ì†Œìš” ì‹œê°„
- ì•½ 30ë¶„-1ì‹œê°„ (ë…¼ë¬¸ ìˆ˜ì— ë”°ë¼ ë‹¤ë¦„)
- OpenAI API Rate Limitì— ë”°ë¼ ì†Œìš” ì‹œê°„ ì¦ê°€ ê°€ëŠ¥

#### ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ
```
============================================================
ì„ë² ë”© ìƒì„± ë° Vector DB ì €ì¥
============================================================
PDF ë””ë ‰í† ë¦¬: /home/ieyeppo/AI_Lab/langchain-project/data/raw/pdfs
ë©”íƒ€ë°ì´í„°: /home/ieyeppo/AI_Lab/langchain-project/data/raw/arxiv_papers_metadata.json
ë§¤í•‘ íŒŒì¼: /home/ieyeppo/AI_Lab/langchain-project/data/processed/paper_id_mapping.json

1ë‹¨ê³„: PDF ë¬¸ì„œ ë¡œë“œ ë° ì²­í¬ ë¶„í•  ì¤‘...
   âœ… 8901ê°œ ì²­í¬ ìƒì„± ì™„ë£Œ

2ë‹¨ê³„: paper_id ë§¤í•‘ íŒŒì¼ ë¡œë“œ ì¤‘...
   âœ… 105ê°œ ë§¤í•‘ ë¡œë“œ ì™„ë£Œ

3ë‹¨ê³„: ì„ë² ë”© ìƒì„± ë° Vector DB ì €ì¥ ì¤‘...
   (ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°°ì¹˜ ì²˜ë¦¬ ì¤‘...)

âœ… 8501ê°œ ë¬¸ì„œê°€ Vector DBì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
```

---

### ìš°ì„ ìˆœìœ„ 5: ì „ì²´ íŒŒì´í”„ë¼ì¸ ì¼ê´„ ì‹¤í–‰ (ì„ íƒì‚¬í•­)

#### ì‹¤í–‰ ëª…ë ¹ì–´
```bash
python scripts/data/run_full_pipeline.py
```

#### ì„¤ëª…
- ìš°ì„ ìˆœìœ„ 1~4ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ìë™ ì‹¤í–‰
- ê° ë‹¨ê³„ ì™„ë£Œ ì—¬ë¶€ í™•ì¸ í›„ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
- ì¤‘ê°„ì— ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ ë‹¨ê³„ì—ì„œ ì¤‘ë‹¨

#### í•„ìš” ì¡°ê±´
- ëª¨ë“  í™˜ê²½ ì„¤ì • ì™„ë£Œ
- PostgreSQL ì„œë²„ ì‹¤í–‰ ì¤‘
- OpenAI API í‚¤ ì„¤ì •
- ì¸í„°ë„· ì—°ê²°

#### ì‹¤í–‰ ë‹¨ê³„
1. **Phase 1**: arXiv ë…¼ë¬¸ ìˆ˜ì§‘
2. **Phase 2**: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
3. **Phase 3**: PDF ë¬¸ì„œ ë¡œë“œ ë° ì²­í¬ ë¶„í• 
4. **Phase 4**: ì„ë² ë”© ìƒì„± ë° Vector DB ì €ì¥

#### ì˜ˆìƒ ì†Œìš” ì‹œê°„
- ì•½ 1-2ì‹œê°„ (ì „ì²´ íŒŒì´í”„ë¼ì¸)

#### ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ
```
============================================================
ì „ì²´ ë°ì´í„° íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
============================================================

============================================================
Phase 1: arXiv ë…¼ë¬¸ ìˆ˜ì§‘
============================================================
âœ… Phase 1: arXiv ë…¼ë¬¸ ìˆ˜ì§‘ ì™„ë£Œ

============================================================
Phase 2: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
============================================================
âœ… Phase 2: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ì™„ë£Œ

============================================================
Phase 3: PDF ë¬¸ì„œ ë¡œë“œ ë° ì²­í¬ ë¶„í• 
============================================================
âœ… Phase 3: PDF ë¬¸ì„œ ë¡œë“œ ë° ì²­í¬ ë¶„í•  ì™„ë£Œ

============================================================
Phase 4: ì„ë² ë”© ìƒì„± ë° Vector DB ì €ì¥
============================================================
âœ… Phase 4: ì„ë² ë”© ìƒì„± ë° Vector DB ì €ì¥ ì™„ë£Œ

============================================================
âœ… ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ì™„ë£Œ!
============================================================
```

---

## ë°ì´í„° í™•ì¸ ë°©ë²•

### 1. ìˆ˜ì§‘ëœ PDF íŒŒì¼ í™•ì¸

```bash
# PDF ê°œìˆ˜ í™•ì¸
ls data/raw/pdfs/*.pdf | wc -l

# PDF íŒŒì¼ ëª©ë¡ í™•ì¸
ls -lh data/raw/pdfs/
```

### 2. ë©”íƒ€ë°ì´í„° JSON í™•ì¸

```bash
# ë…¼ë¬¸ ê°œìˆ˜ í™•ì¸
python -c "import json; data=json.load(open('data/raw/arxiv_papers_metadata.json', encoding='utf-8')); print(f'{len(data)}í¸')"

# ì²« ë²ˆì§¸ ë…¼ë¬¸ ì •ë³´ ì¶œë ¥
python -c "import json; data=json.load(open('data/raw/arxiv_papers_metadata.json', encoding='utf-8')); print(data[0])"
```

### 3. PostgreSQL ë°ì´í„° í™•ì¸

```bash
# papers í…Œì´ë¸” ë ˆì½”ë“œ ìˆ˜
PGPASSWORD=dusrufdmlalswhr psql -h localhost -U langchain -d papers -c "SELECT COUNT(*) FROM papers;"

# ìµœê·¼ ë…¼ë¬¸ 5ê°œ ì¡°íšŒ
PGPASSWORD=dusrufdmlalswhr psql -h localhost -U langchain -d papers -c "SELECT paper_id, title, category FROM papers ORDER BY created_at DESC LIMIT 5;"

# glossary í…Œì´ë¸” í™•ì¸ (ì´ˆê¸° seed ë°ì´í„° 3ê°œ)
PGPASSWORD=dusrufdmlalswhr psql -h localhost -U langchain -d papers -c "SELECT term, definition FROM glossary;"

# glossary ê°œìˆ˜ í™•ì¸
PGPASSWORD=dusrufdmlalswhr psql -h localhost -U langchain -d papers -c "SELECT COUNT(*) FROM glossary;"
```

ì‹¤ì œ ìš©ì–´ì§‘ì€ RAG ì‹œìŠ¤í…œì—ì„œ LLMì´ ë…¼ë¬¸ì„ ë¶„ì„í•˜ì—¬ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ê³  ì¶”ê°€í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.

### 4. pgvector ì„ë² ë”© í™•ì¸

**ğŸ“Œ pgvector í…Œì´ë¸”ëª…ì— ëŒ€í•˜ì—¬:**

PostgreSQLì— ì €ì¥ë˜ëŠ” pgvector í…Œì´ë¸”ì€ **LangChain ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìë™ìœ¼ë¡œ ìƒì„±**í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤:

- **`langchain_pg_collection`**: ë²¡í„° ì»¬ë ‰ì…˜ ë©”íƒ€ë°ì´í„° í…Œì´ë¸”
  - ì €ì¥ ë‚´ìš©: ì»¬ë ‰ì…˜ ì´ë¦„ (`paper_chunks`), UUID, ë©”íƒ€ë°ì´í„°
  - ì—­í• : ì—¬ëŸ¬ ë²¡í„° ì»¬ë ‰ì…˜ì„ ë…¼ë¦¬ì ìœ¼ë¡œ êµ¬ë¶„

- **`langchain_pg_embedding`**: ì‹¤ì œ ì„ë² ë”© ë²¡í„° ì €ì¥ í…Œì´ë¸”
  - ì €ì¥ ë‚´ìš©: ì„ë² ë”© ë²¡í„° (1536ì°¨ì›), ì›ë³¸ í…ìŠ¤íŠ¸, ë©”íƒ€ë°ì´í„°
  - ì—­í• : ë…¼ë¬¸ ì²­í¬ì˜ ë²¡í„° ì„ë² ë”© ë° ì›ë³¸ ë¬¸ì„œ ì €ì¥

**â— ì£¼ì˜:** ì´ í…Œì´ë¸”ëª…ì€ LangChain ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•˜ë“œì½”ë”©ìœ¼ë¡œ ì •ì˜í•œ ê²ƒìœ¼ë¡œ, **ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤**. ë°•ì¬í™ íŒ€ì›ì´ ì„¤ì •í•œ ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤.

```bash
# âœ… ì˜¬ë°”ë¥¸ ë°©ë²•: collectionê³¼ JOINí•˜ì—¬ ì¡°íšŒ
PGPASSWORD=dusrufdmlalswhr psql -h localhost -U langchain -d papers -c "
SELECT COUNT(*)
FROM langchain_pg_embedding e
JOIN langchain_pg_collection c ON e.collection_id = c.uuid
WHERE c.name = 'paper_chunks';"

# paper_chunks ì»¬ë ‰ì…˜ ì •ë³´ í™•ì¸
PGPASSWORD=dusrufdmlalswhr psql -h localhost -U langchain -d papers -c "SELECT * FROM langchain_pg_collection;"

# ì„ë² ë”© ìƒ˜í”Œ í™•ì¸ (ì²« 3ê°œ)
PGPASSWORD=dusrufdmlalswhr psql -h localhost -U langchain -d papers -c "
SELECT
    e.id,
    LEFT(e.document, 100) as document_preview,
    e.cmetadata->>'arxiv_id' as arxiv_id,
    e.cmetadata->>'paper_id' as paper_id,
    e.cmetadata->>'chunk_id' as chunk_id
FROM langchain_pg_embedding e
JOIN langchain_pg_collection c ON e.collection_id = c.uuid
WHERE c.name = 'paper_chunks'
LIMIT 3;"
```

**ì˜ˆìƒ ê²°ê³¼:**
- **8,500ê°œ ì´ìƒì˜ ì„ë² ë”© ë²¡í„°** (ë…¼ë¬¸ ìˆ˜ì— ë”°ë¼ ë‹¤ë¦„)
- ê° ì„ë² ë”©ì€ 1536ì°¨ì› ë²¡í„° (OpenAI text-embedding-3-small)
```

### 5. ë§¤í•‘ íŒŒì¼ í™•ì¸

```bash
# paper_id ë§¤í•‘ ê°œìˆ˜ í™•ì¸
python -c "import json; m=json.load(open('data/processed/paper_id_mapping.json', encoding='utf-8')); print(f'{len(m)}ê°œ ë§¤í•‘')"

# ë§¤í•‘ íŒŒì¼ ë‚´ìš© í™•ì¸
cat data/processed/paper_id_mapping.json | head -20
```

### 6. ì‹¤í—˜ ë¡œê·¸ í™•ì¸

```bash
# ê°€ì¥ ìµœê·¼ ì‹¤í—˜ í´ë” ì°¾ê¸°
ls -t experiments/$(date +%Y%m%d)/ | head -1

# ìµœê·¼ ë¡œê·¸ í™•ì¸
tail -50 experiments/$(date +%Y%m%d)/$(ls -t experiments/$(date +%Y%m%d)/ | head -1)/chatbot.log
```

---

## ì£¼ì˜ì‚¬í•­

### 1. ì‹¤í–‰ ìˆœì„œ ì¤€ìˆ˜
- **ë°˜ë“œì‹œ ìš°ì„ ìˆœìœ„ 1 â†’ 2 â†’ 3 â†’ 4 ìˆœì„œëŒ€ë¡œ ì‹¤í–‰**
- ìš°ì„ ìˆœìœ„ 5ëŠ” ì „ì²´ë¥¼ í•œ ë²ˆì— ì‹¤í–‰í•˜ëŠ” ì˜µì…˜ (ì²˜ìŒ ì‹¤í–‰ ì‹œ ê¶Œì¥)

### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- `.env` íŒŒì¼ì— ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- íŠ¹íˆ `OPENAI_API_KEY`ì™€ PostgreSQL ì ‘ì† ì •ë³´ëŠ” í•„ìˆ˜

### 3. OpenAI API Rate Limit
- ë¬´ë£Œ ê³„ì •ì€ Rate Limitì´ ë‚®ì•„ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆìŒ
- ìœ ë£Œ ê³„ì • ê¶Œì¥ (Tier 1 ì´ìƒ)
- Rate Limit ì˜¤ë¥˜ ë°œìƒ ì‹œ ìë™ìœ¼ë¡œ 5ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„

### 4. PostgreSQL ì—°ê²°
- PostgreSQL ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
- ë°ì´í„°ë² ì´ìŠ¤ `papers`ê°€ ìƒì„±ë˜ì–´ ìˆì–´ì•¼ í•¨ (ì—†ìœ¼ë©´ ìë™ ìƒì„±)

### 5. ë””ìŠ¤í¬ ê³µê°„
- PDF íŒŒì¼: ì•½ 200-500MB (100í¸ ê¸°ì¤€)
- PostgreSQL ë°ì´í„°: ì•½ 100-200MB
- ì—¬ìœ  ê³µê°„ 1GB ì´ìƒ ê¶Œì¥

### 6. ì¤‘ë³µ ì‹¤í–‰
- `collect_arxiv_papers.py`: ì´ë¯¸ ë‹¤ìš´ë¡œë“œëœ PDFëŠ” ê±´ë„ˆëœ€
- `setup_database.py`: `ON CONFLICT (url) DO NOTHING`ìœ¼ë¡œ ì¤‘ë³µ ë°©ì§€
- `load_embeddings.py`: ì¤‘ë³µ ì‹¤í–‰ ì‹œ ë™ì¼ ë°ì´í„°ê°€ ì¬ì‚½ì…ë  ìˆ˜ ìˆìŒ (ì£¼ì˜)

### 7. ë¹ˆ í´ë” ì •ë¦¬
- `ExperimentManager`ëŠ” ì„¸ì…˜ ì¢…ë£Œ ì‹œ ë¹ˆ í´ë”ë¥¼ ìë™ìœ¼ë¡œ ì •ë¦¬
- `experiments/` í´ë”ì— ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¹ˆ í´ë”ê°€ ìë™ ì‚­ì œë¨

---

## Streamlit UI ì‹¤í–‰

ë°•ì¬í™ íŒ€ì›ì´ êµ¬í˜„í•œ **ì‹¤í—˜ìš© Streamlit UI**ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### íŠ¹ì§•

**ê¸°ìˆ  ìŠ¤íƒ:**
- UI: Streamlit
- Vector DB: FAISS (ë¡œì»¬ íŒŒì¼)
- RDBMS: SQLite (ë¡œì»¬ íŒŒì¼)
- LLM: OpenAI ChatGPT (gpt-4o-mini)
- Embeddings: HuggingFace (sentence-transformers/all-MiniLM-L6-v2)

**ì£¼ìš” ê¸°ëŠ¥:**
1. **ê²€ìƒ‰/ìƒ‰ì¸**: arXiv ë…¼ë¬¸ ê²€ìƒ‰ ë° ë²¡í„° DB ì €ì¥
2. **ìš©ì–´ì§‘**: AI/ML ìš©ì–´ ìë™ ì¶”ì¶œ
3. **RAG Q&A**: EZ(ì´ˆì‹¬ì)/HARD(ëŒ€í•™ì›) ëª¨ë“œ ì§ˆì˜ì‘ë‹µ

### ì‹¤í–‰ ëª…ë ¹ì–´

```bash
# í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ ì‹¤í–‰
streamlit run ui/test/paper_review_app.py
```

### í•„ìš” ì¡°ê±´

#### 1. í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
pip install streamlit ddgs sentence-transformers faiss-cpu
```

#### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ì— OpenAI API í‚¤ ì„¤ì •:

```bash
OPENAI_API_KEY=sk-...
OPENAI_MODEL=gpt-4o-mini  # ì„ íƒì‚¬í•­ (ê¸°ë³¸ê°’: gpt-4o-mini)
```

### ì‹¤í–‰ ê²°ê³¼

```
  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://192.168.x.x:8501
```

ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:8501` ì ‘ì†í•˜ì—¬ UI ì‚¬ìš©

### UI í™”ë©´ êµ¬ì„±

**ì‚¬ì´ë“œë°”:**
- OpenAI ì—°ê²° ìƒíƒœ
- API í‚¤ ë¯¸ë¦¬ë³´ê¸°
- ëª¨ë¸ ì •ë³´
- ë°ì´í„° ê²½ë¡œ (FAISS, SQLite)

**ë©”ì¸ íƒ­:**
1. **ê²€ìƒ‰/ìƒ‰ì¸**:
   - í‚¤ì›Œë“œë¡œ arXiv ë…¼ë¬¸ ê²€ìƒ‰
   - ë…¼ë¬¸ ì„ íƒ í›„ FAISSì— ì €ì¥
   - SQLiteì— ë©”íƒ€ë°ì´í„° ì €ì¥

2. **ìš©ì–´ì§‘**:
   - LLM ê¸°ë°˜ ìš©ì–´ ì¶”ì¶œ
   - ë¹ˆë„ ê¸°ë°˜ íœ´ë¦¬ìŠ¤í‹± (fallback)
   - SQLiteì— ì €ì¥

3. **RAG Q&A**:
   - EZ ëª¨ë“œ: ë¹„ì „ê³µì ëŒ€ìƒ ì‰¬ìš´ ì„¤ëª…
   - HARD ëª¨ë“œ: ëŒ€í•™ì› ìˆ˜ì¤€ ê¸°ìˆ  ì„¤ëª…
   - FAISS Retriever + OpenAI GPT

### ë°ì´í„° ì €ì¥ ìœ„ì¹˜

```bash
# FAISS ë²¡í„° DB (ë¡œì»¬)
data/vectordb/papers_faiss/

# SQLite ë°ì´í„°ë² ì´ìŠ¤ (ë¡œì»¬)
data/rdbms/papers.db
```

### ì£¼ì˜ì‚¬í•­

**1. í”„ë¡œë•ì…˜ ë²„ì „ê³¼ì˜ ì°¨ì´ì **

| í•­ëª© | Streamlit UI (ì‹¤í—˜) | í”„ë¡œë•ì…˜ íŒŒì´í”„ë¼ì¸ |
|-----|-------------------|-------------------|
| Vector DB | FAISS (ë¡œì»¬) | PostgreSQL + pgvector |
| RDBMS | SQLite (ë¡œì»¬) | PostgreSQL |
| Embeddings | HuggingFace (ë¬´ë£Œ) | OpenAI (ìœ ë£Œ) |
| ìš©ë„ | ì‹¤í—˜/ë°ëª¨ | í”„ë¡œë•ì…˜ |

**2. OpenAI API í‚¤ í•„ìˆ˜**
- Streamlit UIëŠ” OpenAI API í‚¤ê°€ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤
- `.env` íŒŒì¼ì— ì˜¬ë°”ë¥¸ API í‚¤ ì„¤ì • í™•ì¸

**3. ë¡œì»¬ ë°ì´í„°**
- FAISSì™€ SQLiteëŠ” ë¡œì»¬ íŒŒì¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤
- í”„ë¡œë•ì…˜ íŒŒì´í”„ë¼ì¸ì˜ PostgreSQL ë°ì´í„°ì™€ëŠ” ë³„ê°œì…ë‹ˆë‹¤
- UIì—ì„œ ì €ì¥í•œ ë°ì´í„°ëŠ” í”„ë¡œë•ì…˜ DBì— ë°˜ì˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤

**4. í¬íŠ¸ ì¶©ëŒ**
- ê¸°ë³¸ í¬íŠ¸: 8501
- í¬íŠ¸ ë³€ê²½: `streamlit run ui/test/paper_review_app.py --server.port 8502`

### ì¢…ë£Œ ë°©ë²•

```bash
# í„°ë¯¸ë„ì—ì„œ Ctrl+C
```

---


## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì˜¤ë¥˜ 1: `ModuleNotFoundError: No module named 'src'`

**ì›ì¸**: í”„ë¡œì íŠ¸ ë£¨íŠ¸ ê²½ë¡œê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•**:
```bash
# í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ ì‹¤í–‰í•˜ëŠ”ì§€ í™•ì¸
pwd
# ì¶œë ¥: /home/ieyeppo/AI_Lab/langchain-project

# í”„ë¡œì íŠ¸ ë£¨íŠ¸ê°€ ì•„ë‹ˆë©´ ì´ë™
cd /home/ieyeppo/AI_Lab/langchain-project
```

### ì˜¤ë¥˜ 2: `psycopg2.OperationalError: FATAL: password authentication failed`

**ì›ì¸**: PostgreSQL ì ‘ì† ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•**:
```bash
# .env íŒŒì¼ í™•ì¸
cat .env | grep POSTGRES

# PostgreSQL ì ‘ì† í…ŒìŠ¤íŠ¸
PGPASSWORD=dusrufdmlalswhr psql -h localhost -U langchain -d papers -c "SELECT 1;"
```

### ì˜¤ë¥˜ 3: `openai.error.RateLimitError: Rate limit reached`

**ì›ì¸**: OpenAI API Rate Limit ì´ˆê³¼

**í•´ê²° ë°©ë²•**:
- ë°°ì¹˜ í¬ê¸°ë¥¼ ì¤„ì„: `batch_size=50` â†’ `batch_size=20`
- ëŒ€ê¸° ì‹œê°„ ì¦ê°€: `embeddings.py`ì˜ `time.sleep(0.1)` â†’ `time.sleep(0.5)`
- ìœ ë£Œ ê³„ì • Tier ì—…ê·¸ë ˆì´ë“œ

### ì˜¤ë¥˜ 4: `arxiv.arxiv.HTTPError: 429 Too Many Requests`

**ì›ì¸**: arXiv API Rate Limit ì´ˆê³¼

**í•´ê²° ë°©ë²•**:
- ì ì‹œ ëŒ€ê¸° í›„ ì¬ì‹¤í–‰
- í‚¤ì›Œë“œë‹¹ ìˆ˜ì§‘ ê°œìˆ˜ ì¤„ì´ê¸°: `per_keyword=15` â†’ `per_keyword=10`

### ì˜¤ë¥˜ 5: PDF ë¡œë”© ì‹¤íŒ¨ (`PyPDFLoader` ì˜¤ë¥˜)

**ì›ì¸**: ì†ìƒëœ PDF íŒŒì¼ ë˜ëŠ” ì•”í˜¸í™”ëœ PDF

**í•´ê²° ë°©ë²•**:
- í•´ë‹¹ PDF íŒŒì¼ ì‚­ì œ í›„ ì¬ìˆ˜ì§‘
- `document_loader.py`ëŠ” ì˜¤ë¥˜ ë°œìƒ ì‹œ í•´ë‹¹ íŒŒì¼ì„ ê±´ë„ˆëœ€ (ìë™ ì²˜ë¦¬)

---

## ê´€ë ¨ ë¬¸ì„œ

- [í”„ë¡œì íŠ¸ ê°œìš”](/docs/PRD/01_í”„ë¡œì íŠ¸_ê°œìš”.md)
- [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](/docs/PRD/11_ë°ì´í„°ë² ì´ìŠ¤_ì„¤ê³„.md)
- [RAG ì‹œìŠ¤í…œ ì„¤ê³„](/docs/PRD/13_RAG_ì‹œìŠ¤í…œ_ì„¤ê³„.md)
- [ë°•ì¬í™ ì—­í•  ë¬¸ì„œ](/docs/roles/ë‹´ë‹¹ì—­í• _03_ë°•ì¬í™_ë…¼ë¬¸ë°ì´í„°ìˆ˜ì§‘.md)
- [ì´ìŠˆ ë¬¸ì„œ 03-2](/docs/issues/03-2_data_pipeline_completion_report.md)
- [ì‹¤í—˜ ê²°ê³¼ ë³´ê³ ì„œ](/docs/experiments/20251031/paper_review_app_ml_brief.md)