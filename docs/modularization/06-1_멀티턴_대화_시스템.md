# 06-1. ë©€í‹°í„´ ëŒ€í™” ì‹œìŠ¤í…œ ìƒì„¸

## ğŸ“‹ ë¬¸ì„œ ì •ë³´
- **ìµœì´ˆ ì‘ì„±ì¼**: 2025-11-04
- **ìµœê·¼ ì—…ë°ì´íŠ¸**: 2025-11-04
- **ì‹œìŠ¤í…œëª…**: ë©€í‹°í„´ ëŒ€í™” ì‹œìŠ¤í…œ
- **êµ¬í˜„ íŒŒì¼**: `ui/components/chat_interface.py`
- **ìš°ì„ ìˆœìœ„**: â­â­â­ (ìµœìš°ì„ )
- **ì‘ì„±ì**: ìµœí˜„í™”[íŒ€ì¥]
- **ìƒìœ„ ë¬¸ì„œ**: [06_AI_Agent_ì‹œìŠ¤í…œ.md](./06_AI_Agent_ì‹œìŠ¤í…œ.md)

---

## ğŸ“Œ ê°œìš”

ë©€í‹°í„´ ëŒ€í™” ì‹œìŠ¤í…œì€ **ì´ì „ ëŒ€í™” ë‚´ì—­ì„ Agentì—ê²Œ ì „ë‹¬í•˜ì—¬ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìœ ì§€í•˜ê³  ì—°ì†ì ì¸ ì§ˆë¬¸ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤. 2025-11-04ì— êµ¬í˜„ë˜ì–´ ëŒ€ëª…ì‚¬ í•´ì„ ë° ì´ì „ ëŒ€í™” ì°¸ì¡°ê°€ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.

---

## ğŸ”´ ê°œì„  ì „ ë¬¸ì œì 

### ë¬¸ì œ ìƒí™©

**í˜„ìƒ**:
- ë§¤ ì§ˆë¬¸ë§ˆë‹¤ ë¹ˆ ë¦¬ìŠ¤íŠ¸(`messages=[]`)ë¥¼ Agentì—ê²Œ ì „ë‹¬
- ì´ì „ ëŒ€í™” ë‚´ì—­ ì°¸ì¡° ë¶ˆê°€

**ì½”ë“œ (ê°œì„  ì „)**:
```python
# ui/components/chat_interface.py (ê°œì„  ì „)
response = agent_executor.invoke(
    {
        "question": prompt,
        "difficulty": difficulty,
        "messages": []  # ë¹ˆ ë¦¬ìŠ¤íŠ¸ ì „ë‹¬ (ë¬¸ì œ!)
    },
    config={"callbacks": [st_callback]}
)
```

### ì‚¬ìš©ì ê²½í—˜ ë¬¸ì œ

**ì‹œë‚˜ë¦¬ì˜¤ 1: ëŒ€ëª…ì‚¬ í•´ì„ ë¶ˆê°€**
```
ì‚¬ìš©ì: "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜"
Agent: "Attention is All You Need ë…¼ë¬¸ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤..."

ì‚¬ìš©ì: "ê·¸ê±° ìš”ì•½í•´ì¤˜"
Agent: "ì£„ì†¡í•©ë‹ˆë‹¤. ì–´ë–¤ ê²ƒì„ ìš”ì•½í•´ë“œë¦´ê¹Œìš”?" âŒ
```

**ì‹œë‚˜ë¦¬ì˜¤ 2: ì´ì „ ë‹µë³€ ì°¸ì¡° ë¶ˆê°€**
```
ì‚¬ìš©ì: "BERTì™€ GPTì˜ ì°¨ì´ì ì€?"
Agent: "BERTëŠ” ì–‘ë°©í–¥ ì¸ì½”ë”ì´ê³  GPTëŠ” ë‹¨ë°©í–¥ ë””ì½”ë”ì…ë‹ˆë‹¤..."

ì‚¬ìš©ì: "ì²« ë²ˆì§¸ ëª¨ë¸ì˜ ì¥ì ì€?"
Agent: "ì£„ì†¡í•©ë‹ˆë‹¤. ì–´ë–¤ ëª¨ë¸ì„ ë§ì”€í•˜ì‹œëŠ” ê±´ê°€ìš”?" âŒ
```

**ë¬¸ì œì **:
- ì—°ì†ì ì¸ ëŒ€í™” ë¶ˆê°€
- ë§¤ë²ˆ ì „ì²´ ì •ë³´ë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ì•¼ í•¨
- ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™” íë¦„ ë‹¨ì ˆ

---

## âœ… ê°œì„  í›„ êµ¬ì¡°

### ì´ì „ ëŒ€í™” ì „ë‹¬ ë°©ì‹

**êµ¬í˜„ ìœ„ì¹˜**: `ui/components/chat_interface.py:192-204`

```python
# 1ë‹¨ê³„: ì´ì „ ëŒ€í™” íˆìŠ¤í† ë¦¬ ê°€ì ¸ì˜¤ê¸°
from ui.components.chat_manager import get_current_messages

previous_messages = get_current_messages()

# 2ë‹¨ê³„: Agent ì‹¤í–‰ ì‹œ ì „ë‹¬
response = agent_executor.invoke(
    {
        "question": prompt,
        "difficulty": difficulty,
        "messages": previous_messages  # ì´ì „ ëŒ€í™” ì „ë‹¬
    },
    config={"callbacks": [st_callback]}
)
```

### get_current_messages() í•¨ìˆ˜

**ì—­í• **:
- Streamlit `st.session_state.messages`ì—ì„œ í˜„ì¬ ëŒ€í™” ë‚´ì—­ ì¶”ì¶œ
- LangChain BaseMessage í˜•ì‹ìœ¼ë¡œ ë³€í™˜
- Agentê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë°˜í™˜

**êµ¬í˜„ ì˜ˆì‹œ**:
```python
# ui/components/chat_manager.py
def get_current_messages():
    """
    Streamlit ì„¸ì…˜ ìƒíƒœì—ì„œ í˜„ì¬ ëŒ€í™” ë©”ì‹œì§€ ì¶”ì¶œ

    Returns:
        list: ëŒ€í™” ë©”ì‹œì§€ ë¦¬ìŠ¤íŠ¸ (LangChain BaseMessage í˜•ì‹)
    """
    if "messages" not in st.session_state:
        return []

    messages = []
    for msg in st.session_state.messages:
        role = msg.get("role")
        content = msg.get("content", "")

        if role == "user":
            messages.append(HumanMessage(content=content))
        elif role == "assistant":
            messages.append(AIMessage(content=content))

    return messages
```

---

## ğŸ”„ ë™ì‘ íë¦„

### ì²« ë²ˆì§¸ ì§ˆë¬¸

```
1. ì‚¬ìš©ì ì…ë ¥: "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜"
   â†“
2. get_current_messages() í˜¸ì¶œ â†’ ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ (ì²« ì§ˆë¬¸ì´ë¯€ë¡œ)
   â†“
3. Agent ì‹¤í–‰: messages=[]
   â†“
4. Agent ë‹µë³€: "Attention is All You Need ë…¼ë¬¸ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤..."
   â†“
5. st.session_state.messages ì—…ë°ì´íŠ¸:
   [
     {"role": "user", "content": "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜"},
     {"role": "assistant", "content": "Attention is All You Need..."}
   ]
```

### ë‘ ë²ˆì§¸ ì§ˆë¬¸ (ì´ì „ ëŒ€í™” ì°¸ì¡°)

```
1. ì‚¬ìš©ì ì…ë ¥: "ê·¸ê±° ìš”ì•½í•´ì¤˜"
   â†“
2. get_current_messages() í˜¸ì¶œ â†’ ì´ì „ ëŒ€í™” ë°˜í™˜:
   [
     HumanMessage(content="Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜"),
     AIMessage(content="Attention is All You Need...")
   ]
   â†“
3. Agent ì‹¤í–‰: messages=[ì´ì „ ëŒ€í™”]
   â†“
4. LLMì´ ì´ì „ ëŒ€í™” ì°¸ì¡°í•˜ì—¬ "ê·¸ê±°" = "Attention is All You Need ë…¼ë¬¸" í•´ì„
   â†“
5. Agent ë‹µë³€: "Attention is All You Need ë…¼ë¬¸ì„ ìš”ì•½í•˜ê² ìŠµë‹ˆë‹¤..."
   â†“
6. st.session_state.messages ì—…ë°ì´íŠ¸:
   [
     {"role": "user", "content": "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜"},
     {"role": "assistant", "content": "Attention is All You Need..."},
     {"role": "user", "content": "ê·¸ê±° ìš”ì•½í•´ì¤˜"},
     {"role": "assistant", "content": "Attention is All You Need ë…¼ë¬¸ ìš”ì•½..."}
   ]
```

---

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

### 1. ëŒ€ëª…ì‚¬ í•´ì„

**ì§€ì›í•˜ëŠ” ëŒ€ëª…ì‚¬**:
- "ê·¸ê±°", "ê·¸ê²ƒ", "ì´ê±°", "ì €ê±°"
- "ê·¸ëŸ¼", "ê·¸ëŸ¬ë©´"
- "ì²« ë²ˆì§¸", "ë‘ ë²ˆì§¸"
- "ì•ì—ì„œ ë§í•œ"

**ì˜ˆì‹œ**:
```
ì‚¬ìš©ì: "BERT ë…¼ë¬¸ ì°¾ì•„ì¤˜"
Agent: "BERT ë…¼ë¬¸ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤..."

ì‚¬ìš©ì: "ê·¸ê±° ìš”ì•½í•´ì¤˜"  âœ… "BERT ë…¼ë¬¸"ìœ¼ë¡œ í•´ì„
Agent: "BERT ë…¼ë¬¸ì„ ìš”ì•½í•˜ê² ìŠµë‹ˆë‹¤..."
```

### 2. ì´ì „ ë‹µë³€ ì°¸ì¡°

**ì˜ˆì‹œ**:
```
ì‚¬ìš©ì: "BERTì™€ GPTì˜ ì°¨ì´ì ì€?"
Agent: "BERTëŠ” ì–‘ë°©í–¥ ì¸ì½”ë”ì´ê³  GPTëŠ” ë‹¨ë°©í–¥ ë””ì½”ë”ì…ë‹ˆë‹¤..."

ì‚¬ìš©ì: "ì²« ë²ˆì§¸ ëª¨ë¸ì˜ ì¥ì ì€?"  âœ… "BERT"ë¡œ í•´ì„
Agent: "BERTì˜ ì¥ì ì€ ì–‘ë°©í–¥ ì»¨í…ìŠ¤íŠ¸ë¥¼ í™œìš©í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤..."
```

### 3. ì»¨í…ìŠ¤íŠ¸ ìœ ì§€

**ì˜ˆì‹œ**:
```
ì‚¬ìš©ì: "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜"
Agent: "Attention is All You Need ë…¼ë¬¸ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤..."

ì‚¬ìš©ì: "ì €ìëŠ” ëˆ„êµ¬ì•¼?"  âœ… "Transformer ë…¼ë¬¸ì˜ ì €ì"ë¡œ í•´ì„
Agent: "Vaswani et al. (2017)ì…ë‹ˆë‹¤..."

ì‚¬ìš©ì: "ë°œí–‰ ì—°ë„ëŠ”?"  âœ… "Transformer ë…¼ë¬¸ì˜ ë°œí–‰ ì—°ë„"ë¡œ í•´ì„
Agent: "2017ë…„ì…ë‹ˆë‹¤..."
```

---

## ğŸ“Š ê°œì„  íš¨ê³¼

### ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ

**ê°œì„  ì „**:
```
ì‚¬ìš©ì: "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜"
Agent: "Attention is All You Need ë…¼ë¬¸..."

ì‚¬ìš©ì: "ê·¸ê±° ìš”ì•½í•´ì¤˜"
Agent: "ë¬´ì—‡ì„ ìš”ì•½í•´ë“œë¦´ê¹Œìš”?" âŒ

ì‚¬ìš©ì: "Attention is All You Need ë…¼ë¬¸ ìš”ì•½í•´ì¤˜" (ë‹¤ì‹œ ì „ì²´ ì…ë ¥)
Agent: "ë…¼ë¬¸ì„ ìš”ì•½í•˜ê² ìŠµë‹ˆë‹¤..."
```

**ê°œì„  í›„**:
```
ì‚¬ìš©ì: "Transformer ë…¼ë¬¸ ì°¾ì•„ì¤˜"
Agent: "Attention is All You Need ë…¼ë¬¸..."

ì‚¬ìš©ì: "ê·¸ê±° ìš”ì•½í•´ì¤˜" âœ…
Agent: "ë…¼ë¬¸ì„ ìš”ì•½í•˜ê² ìŠµë‹ˆë‹¤..."
```

**íš¨ê³¼**:
- ì…ë ¥ ì‹œê°„ 50% ë‹¨ì¶•
- ëŒ€í™” ìì—°ìŠ¤ëŸ¬ì›€ í–¥ìƒ
- ì‚¬ìš©ì ë§Œì¡±ë„ ì¦ê°€

### ì—°ì† ì§ˆë¬¸ ì²˜ë¦¬

**ê°€ëŠ¥í•œ ì‹œë‚˜ë¦¬ì˜¤**:
```
ì‚¬ìš©ì: "RAGê°€ ë­ì•¼?"
Agent: "RAGëŠ” Retrieval-Augmented Generation..."

ì‚¬ìš©ì: "ì–´ë””ì— ì‚¬ìš©ë¼?"
Agent: "RAGëŠ” ì§ˆì˜ì‘ë‹µ, ì±—ë´‡, ë¬¸ì„œ ê²€ìƒ‰ ë“±ì— ì‚¬ìš©ë©ë‹ˆë‹¤..."

ì‚¬ìš©ì: "ì¥ì ì€?"
Agent: "RAGì˜ ì¥ì ì€ ìµœì‹  ì •ë³´ í™œìš©, í™˜ê° ê°ì†Œ..."

ì‚¬ìš©ì: "ë‹¨ì ì€?"
Agent: "RAGì˜ ë‹¨ì ì€ ê²€ìƒ‰ í’ˆì§ˆ ì˜ì¡´ì„±, ì‘ë‹µ ì†ë„ ì €í•˜..."
```

**íš¨ê³¼**:
- ì—°ì† ì§ˆë¬¸ ë¬´ì œí•œ ì²˜ë¦¬
- ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™” íë¦„
- ê¹Šì´ ìˆëŠ” ì •ë³´ íƒìƒ‰ ê°€ëŠ¥

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. ëŒ€í™” íˆìŠ¤í† ë¦¬ ê¸¸ì´

**ë¬¸ì œ**:
- ëŒ€í™”ê°€ ê¸¸ì–´ì§€ë©´ í† í° ì‚¬ìš©ëŸ‰ ì¦ê°€
- LLM ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš° ì´ˆê³¼ ê°€ëŠ¥

**í•´ê²°ì±…**:
```python
# ìµœê·¼ Nê°œ ë©”ì‹œì§€ë§Œ ì „ë‹¬
MAX_MESSAGES = 10

def get_current_messages(max_messages=MAX_MESSAGES):
    """ìµœê·¼ Nê°œ ë©”ì‹œì§€ë§Œ ë°˜í™˜"""
    messages = []
    # ... (ë©”ì‹œì§€ ì¶”ì¶œ ë¡œì§)

    # ìµœê·¼ Nê°œë§Œ ë°˜í™˜
    return messages[-max_messages:] if len(messages) > max_messages else messages
```

### 2. ëª¨ë“œ ë³€ê²½ ì‹œ ëŒ€í™” íˆìŠ¤í† ë¦¬

**í˜„ì¬ ë™ì‘**:
- Easy â†’ Hard ëª¨ë“œ ë³€ê²½ ì‹œì—ë„ ì´ì „ ëŒ€í™” ìœ ì§€
- ëª¨ë“  ëŒ€í™” ë‚´ì—­ì´ Agentì—ê²Œ ì „ë‹¬ë¨

**í–¥í›„ ê°œì„ **:
- ëª¨ë“œ ë³€ê²½ ì‹œ ëŒ€í™” íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™” ì˜µì…˜ ì œê³µ
- ì‚¬ìš©ì ì„ íƒì— ë”°ë¼ ìœ ì§€/ì´ˆê¸°í™” ê²°ì •

### 3. Streamlit ì„¸ì…˜ ì´ˆê¸°í™”

**ë¬¸ì œ**:
- ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨ ì‹œ `st.session_state.messages` ì´ˆê¸°í™”
- ëŒ€í™” íˆìŠ¤í† ë¦¬ ì†ì‹¤

**í•´ê²°ì±…**:
- ExperimentManagerì˜ conversation íŒŒì¼ í™œìš©
- ì„¸ì…˜ ì¬ê°œ ì‹œ ì´ì „ ëŒ€í™” ë¡œë“œ (í–¥í›„ êµ¬í˜„)

---

## ğŸ”— í†µí•© ì‹œìŠ¤í…œ

### Conversation íŒŒì¼ ì €ì¥

ë©€í‹°í„´ ëŒ€í™”ëŠ” ìë™ìœ¼ë¡œ conversation íŒŒì¼ì— ì €ì¥ë©ë‹ˆë‹¤:

```python
# ui/components/chat_interface.py:462
if exp_manager:
    messages = get_current_messages()
    if messages:
        exp_manager.save_conversation(messages, difficulty=difficulty)
```

**ì €ì¥ ìœ„ì¹˜**: `outputs/conversation_{difficulty}_{timestamp}.json`

**ì¥ì **:
- ëŒ€í™” íˆìŠ¤í† ë¦¬ ì˜êµ¬ ë³´ì¡´
- í–¥í›„ ë¶„ì„ ë° í‰ê°€ ê°€ëŠ¥

### í‰ê°€ ì‹œìŠ¤í…œ í†µí•©

ë©€í‹°í„´ ëŒ€í™”ëŠ” í‰ê°€ ì‹œìŠ¤í…œì—ì„œ ì»¨í…ìŠ¤íŠ¸ë¡œ í™œìš©ë©ë‹ˆë‹¤:

```python
# í‰ê°€ ì‹œ ì´ì „ ëŒ€í™” ì°¸ì¡°
evaluation_result = evaluator.evaluate(
    question=question,
    answer=answer,
    reference_docs=reference_docs,
    difficulty=difficulty,
    conversation_history=previous_messages  # ë©€í‹°í„´ ëŒ€í™” í™œìš©
)
```

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- **[06_AI_Agent_ì‹œìŠ¤í…œ.md](./06_AI_Agent_ì‹œìŠ¤í…œ.md)** - ìƒìœ„ ë¬¸ì„œ
- **[03-1_Conversation_íŒŒì¼_ê´€ë¦¬.md](./03-1_Conversation_íŒŒì¼_ê´€ë¦¬.md)** - ëŒ€í™” ì €ì¥ ì‹œìŠ¤í…œ
- **[05_ëŒ€í™”_ë©”ëª¨ë¦¬_ì‹œìŠ¤í…œ.md](./05_ëŒ€í™”_ë©”ëª¨ë¦¬_ì‹œìŠ¤í…œ.md)** - ChatMemoryManager
- **[docs/issues/06_Session_010_ì‹¤í—˜_ë¶„ì„_ê¸°ë°˜_ì‹œìŠ¤í…œ_ê°œì„ .md](../issues/06_Session_010_ì‹¤í—˜_ë¶„ì„_ê¸°ë°˜_ì‹œìŠ¤í…œ_ê°œì„ .md)** - ê°œì„  ì´ìŠˆ

---

## ğŸ“ ìš”ì•½

### í•µì‹¬ ê°œì„ ì‚¬í•­

1. âœ… **ì´ì „ ëŒ€í™” ì „ë‹¬**: `messages=[]` â†’ `messages=previous_messages`
2. âœ… **ëŒ€ëª…ì‚¬ í•´ì„**: "ê·¸ê±°", "ì²« ë²ˆì§¸" ë“± ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™”
3. âœ… **ì»¨í…ìŠ¤íŠ¸ ìœ ì§€**: ì—°ì† ì§ˆë¬¸ ì²˜ë¦¬ ê°€ëŠ¥
4. âœ… **conversation íŒŒì¼ í†µí•©**: ëŒ€í™” íˆìŠ¤í† ë¦¬ ìë™ ì €ì¥

### ì‚¬ìš© íŒ¨í„´

```python
# Agent ì‹¤í–‰ ì‹œ ì´ì „ ëŒ€í™” ì „ë‹¬
from ui.components.chat_manager import get_current_messages

previous_messages = get_current_messages()

response = agent_executor.invoke(
    {
        "question": prompt,
        "difficulty": difficulty,
        "messages": previous_messages  # í•µì‹¬!
    },
    config={"callbacks": [st_callback]}
)
```

### í–¥í›„ ê°œì„  ì‚¬í•­

1. ëŒ€í™” íˆìŠ¤í† ë¦¬ ê¸¸ì´ ì œí•œ (ìµœê·¼ Nê°œë§Œ ì „ë‹¬)
2. ëª¨ë“œ ë³€ê²½ ì‹œ ëŒ€í™” ì´ˆê¸°í™” ì˜µì…˜
3. ì„¸ì…˜ ì¬ê°œ ì‹œ ì´ì „ ëŒ€í™” ë¡œë“œ
4. í† í° ì‚¬ìš©ëŸ‰ ìµœì í™” (ìš”ì•½ ê¸°ëŠ¥)
