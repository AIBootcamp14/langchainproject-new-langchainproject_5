# ì €ì¥ ë„êµ¬ ì•„í‚¤í…ì²˜

## ğŸ“‹ ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-11-07
- **ì‘ì„±ì**: ìµœí˜„í™”[íŒ€ì¥]
- **í”„ë¡œì íŠ¸ëª…**: ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡ (AI Agent + RAG)
- **íŒ€ëª…**: ì—°ê²°ì˜ ë¯¼ì¡±
- **ë¬¸ì„œ ë²„ì „**: 1.0

---

## ğŸ“‘ ëª©ì°¨
1. [ë„êµ¬ ê°œìš”](#ë„êµ¬-ê°œìš”)
2. [ë„êµ¬ ì‹¤í–‰ ì¡°ê±´](#ë„êµ¬-ì‹¤í–‰-ì¡°ê±´)
3. [ë„êµ¬ ë™ì‘ (Fallback ì—†ìŒ)](#ë„êµ¬-ë™ì‘-fallback-ì—†ìŒ)
4. [ë‹¨ìˆœ íë¦„ ì•„í‚¤í…ì²˜](#ë‹¨ìˆœ-íë¦„-ì•„í‚¤í…ì²˜)
5. [ìƒì„¸ ê¸°ëŠ¥ ë™ì‘ íë¦„ë„](#ìƒì„¸-ê¸°ëŠ¥-ë™ì‘-íë¦„ë„)
6. [ë™ì‘ ì„¤ëª…](#ë™ì‘-ì„¤ëª…)
7. [ì‚¬ìš© ì˜ˆì‹œ](#ì‚¬ìš©-ì˜ˆì‹œ)
8. [í•µì‹¬ í¬ì¸íŠ¸](#í•µì‹¬-í¬ì¸íŠ¸)
9. [ì°¸ê³  ì •ë³´](#ì°¸ê³ -ì •ë³´)

---

## ğŸ“Œ ë„êµ¬ ê°œìš”

### ëª©ì ê³¼ ì—­í• 

ì €ì¥ ë„êµ¬ëŠ” ì´ì „ ë„êµ¬ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œì— Markdown íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ìµœì¢… ë‹¨ê³„ ë„êµ¬ì…ë‹ˆë‹¤.

**í•µì‹¬ ì—­í• :**
- ì´ì „ ë„êµ¬ ì‹¤í–‰ ê²°ê³¼ë¥¼ íŒŒì¼ë¡œ ì˜êµ¬ ì €ì¥
- íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ ìë™ íŒŒì¼ëª… ìƒì„±
- ì„¸ì…˜ë³„ ì €ì¥ ì¹´ìš´í„° ê´€ë¦¬ (ì¤‘ë³µ ë°©ì§€)
- ì „ì²´ ëŒ€í™” ì €ì¥ vs ë‹¨ì¼ ë‹µë³€ ì €ì¥ ëª¨ë“œ ì§€ì›
- ë‚œì´ë„ë³„ ë‹¤ì¤‘ ë‹µë³€ ì €ì¥ (final_answers)

**ì €ì¥ ëŒ€ìƒ ë°ì´í„°:**
- **ë‹¨ì¼ ë‹µë³€**: ì´ì „ ë„êµ¬ì˜ ì‹¤í–‰ ê²°ê³¼ (tool_result, final_answer, messages)
- **ì „ì²´ ëŒ€í™”**: ì „ì²´ ëŒ€í™” ë‚´ì—­ (user/assistant ë©”ì‹œì§€ ì „ì²´)
- **ë‚œì´ë„ë³„ ë‹µë³€**: ìš”ì•½ ë„êµ¬ì˜ ë‹¤ì¤‘ ìˆ˜ì¤€ ë‹µë³€ (elementary/beginner/intermediate/advanced)

**ì €ì¥ ìœ„ì¹˜:**
- **ExperimentManager ì‚¬ìš©**: `experiments/<ë‚ ì§œ>/<ì„¸ì…˜>/outputs/save_data/`
- **ì§ì ‘ ì €ì¥**: `outputs/` (í…ŒìŠ¤íŠ¸ í™˜ê²½)

**ì €ì¥ í˜•ì‹:**
- **íŒŒì¼ í˜•ì‹**: Markdown (.md)
- **íŒŒì¼ëª… íŒ¨í„´**: `{YYYYMMDD}_{HHMMSS}_response_{ë²ˆí˜¸}.md`
- **ë‚œì´ë„ë³„ íŒŒì¼ëª…**: `{YYYYMMDD}_{HHMMSS}_response_{ë²ˆí˜¸}_{level}.md`
- **ì¸ì½”ë”©**: UTF-8

---

## ğŸ“‹ ë„êµ¬ ì‹¤í–‰ ì¡°ê±´

### ì–¸ì œ ì‹¤í–‰ë˜ëŠ”ê°€?

**1. ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ì €ì¥ì„ ìš”ì²­í•  ë•Œ**

**1-1. ì „ì²´ ëŒ€í™” ì €ì¥**
- "ì „ì²´ ì €ì¥í•´ì¤˜"
- "ì „ì²´ ëŒ€í™” ì €ì¥í•´ì¤˜"
- "ì „ì²´ ëŒ€í™” ë‚´ìš© ì €ì¥í•´ì¤˜"

**1-2. ë‹¨ì¼ ë‹µë³€ ì €ì¥**
- "ì €ì¥í•´ì¤˜"
- "ë‹µë³€ ì €ì¥í•´ì¤˜"
- "ê²°ê³¼ ì €ì¥í•´ì¤˜"

**2. ë‹¤ì¤‘ ìš”ì²­ì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ ì‹¤í–‰**
- "ë…¼ë¬¸ ì°¾ì•„ì„œ ì €ì¥í•´ì¤˜" â†’ search_paper â†’ save_file
- "Transformer ì„¤ëª…í•˜ê³  ì €ì¥í•´ì¤˜" â†’ glossary â†’ save_file
- "GPT ë…¼ë¬¸ ìš”ì•½í•´ì„œ ì €ì¥í•´ì¤˜" â†’ search_paper â†’ web_search â†’ general â†’ summarize â†’ save_file

**3. íŒ¨í„´ ë§¤ì¹­ ìš°ì„ ìˆœìœ„**

`configs/multi_request_patterns.yaml`ì—ì„œ ì •ì˜ëœ íŒ¨í„´ ì˜ˆì‹œ:

```yaml
# ì „ì²´ ëŒ€í™” ì €ì¥ (ìµœìš°ì„ )
- keywords:
  - ì „ì²´
  - ì €ì¥
  tools:
  - save_file
  priority: 150
  description: ì „ì²´ ëŒ€í™” ë‚´ìš© ì €ì¥

# ìš©ì–´ ì •ì˜ í›„ ì €ì¥
- keywords:
  - ì €ì¥
  any_of_keywords:
  - ë­ì•¼
  - ë­”ë°
  - ë­”ì§€
  exclude_keywords:
  - ì „ì²´
  - ë…¼ë¬¸
  tools:
  - glossary
  - save_file
  priority: 140

# ë…¼ë¬¸ ê²€ìƒ‰ í›„ ì €ì¥
- keywords:
  - ë…¼ë¬¸
  - ì°¾
  - ì €ì¥
  exclude_keywords:
  - ìš”ì•½
  tools:
  - search_paper
  - save_file
  priority: 110

# ë…¼ë¬¸ ìš”ì•½ í›„ ì €ì¥
- keywords:
  - ë…¼ë¬¸
  - ìš”ì•½
  - ì €ì¥
  tools:
  - search_paper
  - web_search
  - general
  - summarize
  - save_file
  priority: 100
```

**ì‹¤í–‰ ì¡°ê±´ ê²€ì¦:**
- `keywords`ì— `ì €ì¥` í¬í•¨ â†’ ì €ì¥ ë„êµ¬ í™œì„±í™”
- íŒŒì´í”„ë¼ì¸ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ `save_file` ë°°ì¹˜
- ì´ì „ ë„êµ¬(ë“¤)ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ `tool_result` ë˜ëŠ” `final_answer`ë¡œ ì „ë‹¬ë°›ìŒ

### ì €ì¥ ëª¨ë“œ ê²°ì • ë¡œì§

**íŒŒì¼**: `src/tools/save_file.py:34-39`

```python
# "ì „ì²´"ì™€ "ì €ì¥" í‚¤ì›Œë“œê°€ ë™ì‹œì— ìˆìœ¼ë©´ ì „ì²´ ëŒ€í™” ì €ì¥
is_full_save = "ì „ì²´" in question and "ì €ì¥" in question

if is_full_save and messages:
    # ì „ì²´ ëŒ€í™” ì €ì¥ ëª¨ë“œ
else:
    # ë‹¨ì¼ ë‹µë³€ ì €ì¥ ëª¨ë“œ
```

---

## ğŸ”„ ë„êµ¬ ë™ì‘ (Fallback ì—†ìŒ)

### ì €ì¥ ë„êµ¬ íë¦„

```
ì‚¬ìš©ì ì €ì¥ ìš”ì²­ (ì´ì „ ë‹¨ê³„ì˜ ê²°ê³¼ ë°ì´í„° ì „ë‹¬ë°›ìŒ)
  â†“
ì €ì¥ ëª¨ë“œ ê²°ì •
  â”œâ”€ ì „ì²´ ëŒ€í™” ì €ì¥?
  â”‚  â”œâ”€ Yes â†’ messages ì „ì²´ Markdown ë³€í™˜
  â”‚  â””â”€ No â†’ ë‹¨ì¼ ë‹µë³€ ì €ì¥
  â†“
ì €ì¥í•  ë‚´ìš© ìš°ì„ ìˆœìœ„ ê²°ì •
  â”œâ”€ 1ìˆœìœ„: final_answers (ë‚œì´ë„ë³„ ë‹¤ì¤‘ ë‹µë³€)
  â”œâ”€ 2ìˆœìœ„: tool_result (íŒŒì´í”„ë¼ì¸ ê²°ê³¼)
  â”œâ”€ 3ìˆœìœ„: final_answer (ìµœì¢… ë‹µë³€)
  â””â”€ 4ìˆœìœ„: messages (ë§ˆì§€ë§‰ assistant ë©”ì‹œì§€)
  â†“
íŒŒì¼ëª… ìƒì„±
  â””â”€ {YYYYMMDD}_{HHMMSS}_response_{ë²ˆí˜¸}.md
  â†“
íŒŒì¼ ì €ì¥ ì‹¤í–‰
  â”œâ”€ ì„±ê³µ â†’ "íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\níŒŒì¼ ê²½ë¡œ: {ê²½ë¡œ}"
  â””â”€ ì‹¤íŒ¨ â†’ Exception ë°œìƒ (í˜„ì¬ ë¯¸ì²˜ë¦¬)
  â†“
ìµœì¢… ë‹µë³€ ë°˜í™˜
  â””â”€ state["final_answer"] = ì„±ê³µ ë©”ì‹œì§€
  â†“
END
```

### ì €ì¥ ë„êµ¬ëŠ” Fallbackì´ ì—†ìŒ

**ì´ìœ :**
1. **ìµœì¢… ë‹¨ê³„ ë„êµ¬**: ì €ì¥ ë„êµ¬ëŠ” íŒŒì´í”„ë¼ì¸ì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ ì‹¤í–‰ë¨
2. **í•„ìˆ˜ ë™ì‘ ì•„ë‹˜**: ì €ì¥ ì‹¤íŒ¨ëŠ” ì‹œìŠ¤í…œ ì˜¤ë¥˜ì´ì§€ ë…¼ë¦¬ì  ì‹¤íŒ¨ê°€ ì•„ë‹˜
3. **ì¬ì‹œë„ ë¶ˆí•„ìš”**: íŒŒì¼ ì €ì¥ ì‹¤íŒ¨ëŠ” ë””ìŠ¤í¬ ë¬¸ì œ ë˜ëŠ” ê¶Œí•œ ë¬¸ì œì´ë¯€ë¡œ Fallbackìœ¼ë¡œ í•´ê²° ë¶ˆê°€

**ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬:**
- í˜„ì¬ ì½”ë“œì—ëŠ” Exception ì²˜ë¦¬ ì—†ìŒ
- ì‹¤íŒ¨ ì‹œ Python Exception ë°œìƒ â†’ Streamlit UIì— í‘œì‹œ
- ì‚¬ìš©ìì—ê²Œ ìˆ˜ë™ ì €ì¥ ì•ˆë‚´ (UI ë ˆë²¨ì—ì„œ ì²˜ë¦¬)

---

## ğŸ¨ ë‹¨ìˆœ íë¦„ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    subgraph MainFlow["ğŸ“‹ ì €ì¥ ë„êµ¬ ì‹¤í–‰ íë¦„"]
        direction TB

        subgraph UserInput["ğŸ”¸ ì‚¬ìš©ì ì…ë ¥"]
            direction LR
            A[ì‚¬ìš©ì ì§ˆë¬¸<br/>ì €ì¥ ìš”ì²­] --> B{íŒ¨í„´ ë§¤ì¹­<br/>ë˜ëŠ”<br/>LLM ë¼ìš°íŒ…}
            B -->|save_file ì„ íƒ| C[ë„êµ¬ ì‹¤í–‰<br/>ì‹œì‘]
        end

        subgraph ModeDecision["ğŸ”¹ ì €ì¥ ëª¨ë“œ ê²°ì •"]
            direction LR
            D[question ë¶„ì„<br/>'ì „ì²´' í¬í•¨?] --> E{ì „ì²´ ëŒ€í™”<br/>ì €ì¥?}
            E -->|Yes| F[messages ì „ì²´<br/>Markdown ë³€í™˜]
            E -->|No| G[ë‹¨ì¼ ë‹µë³€<br/>ì €ì¥]
        end

        subgraph ContentSelection["ğŸ”º ì €ì¥ ë‚´ìš© ì„ íƒ"]
            direction LR
            H[ìš°ì„ ìˆœìœ„ ê²€ì‚¬] --> I{final_answers<br/>ìˆìŒ?}
            I -->|Yes| J[ë‚œì´ë„ë³„<br/>ë‹¤ì¤‘ ì €ì¥]
            I -->|No| K{tool_result<br/>ìˆìŒ?}
            K -->|Yes| L[tool_result<br/>ì‚¬ìš©]
            K -->|No| M{final_answer<br/>ìˆìŒ?}
            M -->|Yes| N[final_answer<br/>ì‚¬ìš©]
            M -->|No| O[messagesì—ì„œ<br/>ë§ˆì§€ë§‰ assistant]
        end

        subgraph FileNaming["ğŸ”¶ íŒŒì¼ëª… ìƒì„±"]
            direction LR
            P[íƒ€ì„ìŠ¤íƒ¬í”„<br/>ìƒì„±] --> Q[save_counter<br/>ì¦ê°€]
            Q --> R[íŒŒì¼ëª… í˜•ì‹<br/>ì ìš©]
            R --> S[filename ì™„ì„±]
        end

        subgraph FileSave["ğŸ’¾ íŒŒì¼ ì €ì¥"]
            direction LR
            T{ExperimentManager<br/>ìˆìŒ?} -->|Yes| U[save_output<br/>ë©”ì„œë“œ í˜¸ì¶œ]
            T -->|No| V[outputs/<br/>ì§ì ‘ ì €ì¥]
            U --> W[save_data/<br/>í´ë” ì €ì¥]
            V --> W
            W --> X[íŒŒì¼ ì“°ê¸°<br/>UTF-8]
        end

        subgraph FinalAnswer["âœ… ìµœì¢… ì‘ë‹µ"]
            direction LR
            Y[ì„±ê³µ ë©”ì‹œì§€<br/>ìƒì„±] --> Z[íŒŒì¼ ê²½ë¡œ<br/>í¬í•¨]
            Z --> AA[final_answer<br/>ì €ì¥]
        end

        %% ë‹¨ê³„ ê°„ ì—°ê²°
        UserInput --> ModeDecision
        ModeDecision --> ContentSelection
        ContentSelection --> FileNaming
        FileNaming --> FileSave
        FileSave --> FinalAnswer
    end

    %% ë©”ì¸ ì›Œí¬í”Œë¡œìš° ë°°ê²½
    style MainFlow fill:#fffde7,stroke:#f9a825,stroke-width:4px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼
    style UserInput fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style ModeDecision fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style ContentSelection fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style FileNaming fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style FileSave fill:#e3f2fd,stroke:#1565c0,stroke-width:3px,color:#000
    style FinalAnswer fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì‚¬ìš©ì ì…ë ¥ - ì²­ë¡ ê³„ì—´)
    style A fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style B fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style C fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ëª¨ë“œ ê²°ì • - ë³´ë¼ ê³„ì—´)
    style D fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style E fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style F fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style G fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë‚´ìš© ì„ íƒ - ë…¹ìƒ‰ ê³„ì—´)
    style H fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style I fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style J fill:#66bb6a,stroke:#1b5e20,stroke-width:2px,color:#000
    style K fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style L fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style M fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style N fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style O fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (íŒŒì¼ëª… ìƒì„± - ì£¼í™© ê³„ì—´)
    style P fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style Q fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style R fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style S fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (íŒŒì¼ ì €ì¥ - íŒŒë‘ ê³„ì—´)
    style T fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style U fill:#64b5f6,stroke:#1565c0,stroke-width:2px,color:#000
    style V fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style W fill:#64b5f6,stroke:#1565c0,stroke-width:2px,color:#000
    style X fill:#64b5f6,stroke:#1565c0,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ìµœì¢… ì‘ë‹µ - ë…¹ìƒ‰ ê³„ì—´)
    style Y fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style Z fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style AA fill:#66bb6a,stroke:#1b5e20,stroke-width:2px,color:#000

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì‚¬ìš©ì ì…ë ¥ - ì²­ë¡ 0~1)
    linkStyle 0 stroke:#006064,stroke-width:2px
    linkStyle 1 stroke:#006064,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ëª¨ë“œ ê²°ì • - ë³´ë¼ 2~4)
    linkStyle 2 stroke:#7b1fa2,stroke-width:2px
    linkStyle 3 stroke:#7b1fa2,stroke-width:2px
    linkStyle 4 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë‚´ìš© ì„ íƒ - ë…¹ìƒ‰ 5~11)
    linkStyle 5 stroke:#2e7d32,stroke-width:2px
    linkStyle 6 stroke:#2e7d32,stroke-width:2px
    linkStyle 7 stroke:#2e7d32,stroke-width:2px
    linkStyle 8 stroke:#2e7d32,stroke-width:2px
    linkStyle 9 stroke:#2e7d32,stroke-width:2px
    linkStyle 10 stroke:#2e7d32,stroke-width:2px
    linkStyle 11 stroke:#2e7d32,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (íŒŒì¼ëª… ìƒì„± - ì£¼í™© 12~14)
    linkStyle 12 stroke:#e65100,stroke-width:2px
    linkStyle 13 stroke:#e65100,stroke-width:2px
    linkStyle 14 stroke:#e65100,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (íŒŒì¼ ì €ì¥ - íŒŒë‘ 15~19)
    linkStyle 15 stroke:#1976d2,stroke-width:2px
    linkStyle 16 stroke:#1976d2,stroke-width:2px
    linkStyle 17 stroke:#1976d2,stroke-width:2px
    linkStyle 18 stroke:#1976d2,stroke-width:2px
    linkStyle 19 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ìµœì¢… ì‘ë‹µ - ë…¹ìƒ‰ 20~21)
    linkStyle 20 stroke:#2e7d32,stroke-width:2px
    linkStyle 21 stroke:#2e7d32,stroke-width:2px

    %% ë‹¨ê³„ ê°„ ì—°ê²° (íšŒìƒ‰ 22~26)
    linkStyle 22 stroke:#616161,stroke-width:3px
    linkStyle 23 stroke:#616161,stroke-width:3px
    linkStyle 24 stroke:#616161,stroke-width:3px
    linkStyle 25 stroke:#616161,stroke-width:3px
    linkStyle 26 stroke:#616161,stroke-width:3px
```

---

## ğŸ” ìƒì„¸ ê¸°ëŠ¥ ë™ì‘ íë¦„ë„

```mermaid
graph TB
    subgraph MainFlow["ğŸ“‹ ì €ì¥ ë„êµ¬ ìƒì„¸ ì‹¤í–‰ íë¦„"]
        direction TB

        subgraph Init["ğŸ”¸ ì´ˆê¸°í™” & ë¼ìš°íŒ…"]
            direction LR
            A[main.py] --> B[ui/app.py<br/>initialize_agent]
            B --> C[src/agent/graph.py<br/>create_agent_graph]
            C --> D[src/agent/nodes.py<br/>router_node]
            D --> E{íŒ¨í„´ ë§¤ì¹­}
            E -->|ë§¤ì¹­ ì„±ê³µ| F[multi_request_patterns.yaml<br/>priority: 150/110/100]
            E -->|ë§¤ì¹­ ì‹¤íŒ¨| G[LLM ë¼ìš°íŒ…<br/>routing_prompts.json]
            F --> H[tool_choice =<br/>'save_file']
            G --> H
        end

        subgraph NodeExec["ğŸ”¹ ë…¸ë“œ ì‹¤í–‰"]
            direction LR
            I[src/tools/save_file.py<br/>save_file_node] --> J[state ì¶”ì¶œ<br/>question, messages]
            J --> K{ExperimentManager<br/>ìˆìŒ?}
            K -->|Yes| L[exp_manager.logger<br/>ë¡œê¹… ì‹œì‘]
            K -->|No| M[ë¡œê¹… ìƒëµ]
        end

        subgraph ModeCheck["ğŸ”º ì €ì¥ ëª¨ë“œ ì²´í¬"]
            direction LR
            N[is_full_save =<br/>'ì „ì²´' in question<br/>and 'ì €ì¥' in question] --> O{ì „ì²´ ëŒ€í™”<br/>ì €ì¥?}
            O -->|Yes| P[messages ì¡°íšŒ]
            O -->|No| Q[ë‹¨ì¼ ë‹µë³€<br/>ëª¨ë“œ]
        end

        subgraph FullSave["ğŸ”¶ ì „ì²´ ëŒ€í™” ì €ì¥"]
            direction LR
            R[content_lines ì´ˆê¸°í™”<br/>ëŒ€í™” ë‚´ìš© í—¤ë”] --> S[messages<br/>ìˆœíšŒ]
            S --> T[role í™•ì¸<br/>user/assistant]
            T --> U[í—¤ë” ìƒì„±<br/>ğŸ™‹/ğŸ¤–]
            U --> V[content_lines<br/>ì¶”ê°€]
            V --> W[Markdown<br/>ë³‘í•©]
        end

        subgraph ContentPriority["ğŸ’¾ ì €ì¥ ë‚´ìš© ìš°ì„ ìˆœìœ„"]
            direction LR
            X{final_answers<br/>ìˆìŒ?} -->|Yes| Y[ë‚œì´ë„ë³„<br/>ë‹¤ì¤‘ íŒŒì¼ ìƒì„±]
            X -->|No| Z{tool_result<br/>ìˆìŒ?}
            Z -->|Yes| AA[tool_result<br/>ì‚¬ìš©]
            Z -->|No| AB{final_answer<br/>ìˆìŒ?}
            AB -->|Yes| AC[final_answer<br/>ì‚¬ìš©]
            AB -->|No| AD[messagesì—ì„œ<br/>ë§ˆì§€ë§‰ assistant]
        end

        subgraph MultiLevelSave["âœ¨ ë‚œì´ë„ë³„ ë‹¤ì¤‘ ì €ì¥"]
            direction LR
            AE[save_counter<br/>ì¦ê°€] --> AF[íƒ€ì„ìŠ¤íƒ¬í”„<br/>ìƒì„±]
            AF --> AG[level_labels<br/>ì •ì˜]
            AG --> AH[final_answers<br/>ìˆœíšŒ]
            AH --> AI[filename ìƒì„±<br/>ë‚œì´ë„ë³„ íŒŒì¼ëª…]
            AI --> AJ[exp_manager<br/>save_output í˜¸ì¶œ]
            AJ --> AK[saved_files<br/>ë¦¬ìŠ¤íŠ¸ ì¶”ê°€]
        end

        subgraph FileNameGen["ğŸ”· íŒŒì¼ëª… ìƒì„±"]
            direction LR
            AL[datetime<br/>íƒ€ì„ìŠ¤íƒ¬í”„] --> AM[YYYYMMDD_HHMMSS<br/>í¬ë§·íŒ…]
            AM --> AN[save_counter<br/>ì¦ê°€]
            AN --> AO[filename<br/>íŒ¨í„´ ì ìš©]
        end

        subgraph FileSaveProcess["ğŸ’¡ íŒŒì¼ ì €ì¥ ì²˜ë¦¬"]
            direction LR
            AP{ExperimentManager<br/>ìˆìŒ?} -->|Yes| AQ[exp_manager<br/>save_output í˜¸ì¶œ]
            AP -->|No| AR[outputs í´ë”<br/>ìƒì„±]
            AQ --> AS[outputs_dir /<br/>save_data/]
            AR --> AT[file_path<br/>ìƒì„±]
            AS --> AU[íŒŒì¼ ì—´ê¸°<br/>UTF-8]
            AT --> AU
            AU --> AV[íŒŒì¼ ì“°ê¸°<br/>content]
        end

        subgraph SuccessMsg["âœ… ì„±ê³µ ë©”ì‹œì§€"]
            direction LR
            AW{ë‚œì´ë„ë³„<br/>ë‹¤ì¤‘?} -->|Yes| AX[saved_files<br/>ëª©ë¡ êµ¬ì„±]
            AW -->|No| AY[ë‹¨ì¼ íŒŒì¼<br/>ê²½ë¡œ]
            AX --> AZ[ì €ì¥ ì™„ë£Œ<br/>ë©”ì‹œì§€ + ëª©ë¡]
            AY --> BA[ì €ì¥ ì™„ë£Œ<br/>ë©”ì‹œì§€ + ê²½ë¡œ]
            AZ --> BB[state ì—…ë°ì´íŠ¸<br/>final_answer]
            BA --> BB
        end

        subgraph Return["âš ï¸ ìƒíƒœ ë°˜í™˜"]
            direction LR
            BC[save_counter<br/>ì—…ë°ì´íŠ¸] --> BD[state ë°˜í™˜]
        end

        %% ë‹¨ê³„ ê°„ ì—°ê²°
        Init --> NodeExec
        NodeExec --> ModeCheck
        ModeCheck --> FullSave
        ModeCheck --> ContentPriority
        ContentPriority --> MultiLevelSave
        ContentPriority --> FileNameGen
        FileNameGen --> FileSaveProcess
        FileSaveProcess --> SuccessMsg
        SuccessMsg --> Return
    end

    %% ë©”ì¸ ì›Œí¬í”Œë¡œìš° ë°°ê²½
    style MainFlow fill:#fffde7,stroke:#f9a825,stroke-width:4px,color:#000

    %% Subgraph ìŠ¤íƒ€ì¼
    style Init fill:#e0f7fa,stroke:#006064,stroke-width:3px,color:#000
    style NodeExec fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style ModeCheck fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style FullSave fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style ContentPriority fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style MultiLevelSave fill:#e3f2fd,stroke:#1565c0,stroke-width:3px,color:#000
    style FileNameGen fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style FileSaveProcess fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style SuccessMsg fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style Return fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì´ˆê¸°í™” - ì²­ë¡ ê³„ì—´)
    style A fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style B fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style C fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style D fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style E fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style F fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style G fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000
    style H fill:#4dd0e1,stroke:#006064,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë…¸ë“œ ì‹¤í–‰ - íŒŒë‘ ê³„ì—´)
    style I fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style J fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style K fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style L fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style M fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ëª¨ë“œ ì²´í¬ - ë³´ë¼ ê³„ì—´)
    style N fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style O fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000
    style P fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Q fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì „ì²´ ì €ì¥ - ì£¼í™© ê³„ì—´)
    style R fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style S fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style T fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style U fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style V fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style W fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë‚´ìš© ìš°ì„ ìˆœìœ„ - ë…¹ìƒ‰ ê³„ì—´)
    style X fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style Y fill:#66bb6a,stroke:#1b5e20,stroke-width:2px,color:#000
    style Z fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AA fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style AB fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AC fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style AD fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë‹¤ì¤‘ ì €ì¥ - íŒŒë‘ ê³„ì—´)
    style AE fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AF fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AG fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AH fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000
    style AI fill:#64b5f6,stroke:#1565c0,stroke-width:2px,color:#000
    style AJ fill:#64b5f6,stroke:#1565c0,stroke-width:2px,color:#000
    style AK fill:#90caf9,stroke:#1976d2,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (íŒŒì¼ëª… ìƒì„± - ë³´ë¼ ê³„ì—´)
    style AL fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AM fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AN fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AO fill:#ce93d8,stroke:#6a1b9a,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (íŒŒì¼ ì €ì¥ - ì£¼í™© ê³„ì—´)
    style AP fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AQ fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style AR fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style AS fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style AT fill:#ffb74d,stroke:#e65100,stroke-width:2px,color:#000
    style AU fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000
    style AV fill:#ffa726,stroke:#ef6c00,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì„±ê³µ ë©”ì‹œì§€ - ë…¹ìƒ‰ ê³„ì—´)
    style AW fill:#ce93d8,stroke:#7b1fa2,stroke-width:2px,color:#000
    style AX fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style AY fill:#81c784,stroke:#2e7d32,stroke-width:2px,color:#000
    style AZ fill:#66bb6a,stroke:#1b5e20,stroke-width:2px,color:#000
    style BA fill:#66bb6a,stroke:#1b5e20,stroke-width:2px,color:#000
    style BB fill:#66bb6a,stroke:#1b5e20,stroke-width:2px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ìƒíƒœ ë°˜í™˜ - ë¹¨ê°• ê³„ì—´)
    style BC fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000
    style BD fill:#ef9a9a,stroke:#c62828,stroke-width:2px,color:#000

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì´ˆê¸°í™” - ì²­ë¡ 0~7)
    linkStyle 0 stroke:#006064,stroke-width:2px
    linkStyle 1 stroke:#006064,stroke-width:2px
    linkStyle 2 stroke:#006064,stroke-width:2px
    linkStyle 3 stroke:#006064,stroke-width:2px
    linkStyle 4 stroke:#006064,stroke-width:2px
    linkStyle 5 stroke:#006064,stroke-width:2px
    linkStyle 6 stroke:#006064,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë…¸ë“œ ì‹¤í–‰ - íŒŒë‘ 8~11)
    linkStyle 7 stroke:#1976d2,stroke-width:2px
    linkStyle 8 stroke:#1976d2,stroke-width:2px
    linkStyle 9 stroke:#1976d2,stroke-width:2px
    linkStyle 10 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ëª¨ë“œ ì²´í¬ - ë³´ë¼ 12~14)
    linkStyle 11 stroke:#7b1fa2,stroke-width:2px
    linkStyle 12 stroke:#7b1fa2,stroke-width:2px
    linkStyle 13 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì „ì²´ ì €ì¥ - ì£¼í™© 15~20)
    linkStyle 14 stroke:#e65100,stroke-width:2px
    linkStyle 15 stroke:#e65100,stroke-width:2px
    linkStyle 16 stroke:#e65100,stroke-width:2px
    linkStyle 17 stroke:#e65100,stroke-width:2px
    linkStyle 18 stroke:#e65100,stroke-width:2px
    linkStyle 19 stroke:#e65100,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë‚´ìš© ìš°ì„ ìˆœìœ„ - ë…¹ìƒ‰ 21~27)
    linkStyle 20 stroke:#2e7d32,stroke-width:2px
    linkStyle 21 stroke:#2e7d32,stroke-width:2px
    linkStyle 22 stroke:#2e7d32,stroke-width:2px
    linkStyle 23 stroke:#2e7d32,stroke-width:2px
    linkStyle 24 stroke:#2e7d32,stroke-width:2px
    linkStyle 25 stroke:#2e7d32,stroke-width:2px
    linkStyle 26 stroke:#2e7d32,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ë‹¤ì¤‘ ì €ì¥ - íŒŒë‘ 28~33)
    linkStyle 27 stroke:#1976d2,stroke-width:2px
    linkStyle 28 stroke:#1976d2,stroke-width:2px
    linkStyle 29 stroke:#1976d2,stroke-width:2px
    linkStyle 30 stroke:#1976d2,stroke-width:2px
    linkStyle 31 stroke:#1976d2,stroke-width:2px
    linkStyle 32 stroke:#1976d2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (íŒŒì¼ëª… ìƒì„± - ë³´ë¼ 34~36)
    linkStyle 33 stroke:#7b1fa2,stroke-width:2px
    linkStyle 34 stroke:#7b1fa2,stroke-width:2px
    linkStyle 35 stroke:#7b1fa2,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (íŒŒì¼ ì €ì¥ - ì£¼í™© 37~43)
    linkStyle 36 stroke:#e65100,stroke-width:2px
    linkStyle 37 stroke:#e65100,stroke-width:2px
    linkStyle 38 stroke:#e65100,stroke-width:2px
    linkStyle 39 stroke:#e65100,stroke-width:2px
    linkStyle 40 stroke:#e65100,stroke-width:2px
    linkStyle 41 stroke:#e65100,stroke-width:2px
    linkStyle 42 stroke:#e65100,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ì„±ê³µ ë©”ì‹œì§€ - ë…¹ìƒ‰ 44~49)
    linkStyle 43 stroke:#2e7d32,stroke-width:2px
    linkStyle 44 stroke:#2e7d32,stroke-width:2px
    linkStyle 45 stroke:#2e7d32,stroke-width:2px
    linkStyle 46 stroke:#2e7d32,stroke-width:2px
    linkStyle 47 stroke:#2e7d32,stroke-width:2px
    linkStyle 48 stroke:#2e7d32,stroke-width:2px

    %% ì—°ê²°ì„  ìŠ¤íƒ€ì¼ (ìƒíƒœ ë°˜í™˜ - ë¹¨ê°• 50)
    linkStyle 49 stroke:#c62828,stroke-width:2px

    %% ë‹¨ê³„ ê°„ ì—°ê²° (íšŒìƒ‰ 51~58)
    linkStyle 50 stroke:#616161,stroke-width:3px
    linkStyle 51 stroke:#616161,stroke-width:3px
    linkStyle 52 stroke:#616161,stroke-width:3px
    linkStyle 53 stroke:#616161,stroke-width:3px
    linkStyle 54 stroke:#616161,stroke-width:3px
    linkStyle 55 stroke:#616161,stroke-width:3px
    linkStyle 56 stroke:#616161,stroke-width:3px
    linkStyle 57 stroke:#616161,stroke-width:3px
```

---

### ì „ì²´ íë¦„ ìš”ì•½ í‘œ

| ë‹¨ê³„ | íŒŒì¼ëª… | ë©”ì„œë“œëª… | ë™ì‘ ì„¤ëª… | ì…ë ¥ | ì¶œë ¥ | íŒŒì¼ ì‹œìŠ¤í…œ ì‚¬ìš© |
|------|--------|----------|-----------|------|------|------------------|
| 1 | `main.py` | - | Streamlit ì„œë²„ ì‹œì‘ | - | - | ì—†ìŒ |
| 2 | `ui/app.py` | `initialize_agent()` | Agent ê·¸ë˜í”„ ì´ˆê¸°í™” | - | agent_executor | ì—†ìŒ |
| 3 | `src/agent/graph.py` | `create_agent_graph()` | LangGraph ìƒíƒœ ë¨¸ì‹  ìƒì„± | exp_manager | CompiledGraph | ì—†ìŒ |
| 4 | `src/agent/nodes.py` | `router_node()` | ì§ˆë¬¸ ë¶„ì„ ë° ë„êµ¬ ì„ íƒ | state (question) | state (tool_choice) | ì—†ìŒ |
| 5 | `configs/multi_request_patterns.yaml` | - | íŒ¨í„´ ë§¤ì¹­ (ìš°ì„ ìˆœìœ„ 150/110/100) | question | tool_pipeline | ì—†ìŒ |
| 6 | `src/tools/save_file.py` | `save_file_node()` | íŒŒì¼ ì €ì¥ ë…¸ë“œ ì‹¤í–‰ | state (question, messages, final_answer) | state (final_answer) | outputs/save_data/ |
| 7 | `src/tools/save_file.py` | - | ì €ì¥ ëª¨ë“œ ê²°ì • | question | is_full_save (bool) | ì—†ìŒ |
| 8 | `src/tools/save_file.py` | - | ì „ì²´ ëŒ€í™” ì €ì¥ (ì „ì²´ ëª¨ë“œ) | messages | content_to_save | ì—†ìŒ |
| 9 | `src/tools/save_file.py` | - | final_answers í™•ì¸ (ë‹¨ì¼ ëª¨ë“œ) | state["final_answers"] | ë‚œì´ë„ë³„ ì €ì¥ ì—¬ë¶€ | ì—†ìŒ |
| 10 | `src/tools/save_file.py` | - | ì €ì¥ ë‚´ìš© ìš°ì„ ìˆœìœ„ ê²°ì • | tool_result, final_answer, messages | content_to_save | ì—†ìŒ |
| 11 | `src/tools/save_file.py` | - | save_counter ì¦ê°€ | state["save_counter"] | save_counter + 1 | ì—†ìŒ |
| 12 | `datetime` | `now().strftime()` | íƒ€ì„ìŠ¤íƒ¬í”„ ìƒì„± | - | YYYYMMDD_HHMMSS | ì—†ìŒ |
| 13 | `src/tools/save_file.py` | - | íŒŒì¼ëª… ìƒì„± | timestamp, save_counter | filename | ì—†ìŒ |
| 14 | `src/utils/experiment_manager.py` | `save_output()` | íŒŒì¼ ì €ì¥ (ExperimentManager) | filename, content | file_path | outputs/save_data/{filename} |
| 15 | `os` | `makedirs()` | ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„± (ì§ì ‘ ì €ì¥) | output_dir | - | outputs/ |
| 16 | `os.path` | `join()` | íŒŒì¼ ê²½ë¡œ ìƒì„± (ì§ì ‘ ì €ì¥) | output_dir, filename | file_path | ì—†ìŒ |
| 17 | `builtins` | `open()` | íŒŒì¼ ì—´ê¸° (ì“°ê¸° ëª¨ë“œ) | file_path, mode='w', encoding='utf-8' | file object | {file_path} |
| 18 | `file.write()` | - | íŒŒì¼ ë‚´ìš© ì“°ê¸° | content_to_save | - | {file_path} (WRITE) |
| 19 | `src/tools/save_file.py` | - | ì„±ê³µ ë©”ì‹œì§€ êµ¬ì„± | file_path | answer | ì—†ìŒ |
| 20 | `src/tools/save_file.py` | - | state ì—…ë°ì´íŠ¸ | answer, save_counter | state["final_answer"] | ì—†ìŒ |
| 21 | `src/tools/save_file.py` | - | ìƒíƒœ ë°˜í™˜ | state | updated state | ì—†ìŒ |

---

## ğŸ“ ë™ì‘ ì„¤ëª…

### ì €ì¥ í”„ë¡œì„¸ìŠ¤ ìƒì„¸ ì„¤ëª…

#### 1ë‹¨ê³„: ì €ì¥ ëª¨ë“œ ê²°ì •

**ëª©ì **: ì „ì²´ ëŒ€í™”ë¥¼ ì €ì¥í• ì§€, ë‹¨ì¼ ë‹µë³€ë§Œ ì €ì¥í• ì§€ ê²°ì •

**íŒŒì¼**: `src/tools/save_file.py:34-39`

**ë¡œì§**:
```python
is_full_save = "ì „ì²´" in question and "ì €ì¥" in question

if is_full_save and messages:
    # ì „ì²´ ëŒ€í™” ì €ì¥ ëª¨ë“œ
else:
    # ë‹¨ì¼ ë‹µë³€ ì €ì¥ ëª¨ë“œ
```

**ì „ì²´ ëŒ€í™” ì €ì¥ ì¡°ê±´**:
1. ì‚¬ìš©ì ì§ˆë¬¸ì— `"ì „ì²´"` í‚¤ì›Œë“œ í¬í•¨
2. ì‚¬ìš©ì ì§ˆë¬¸ì— `"ì €ì¥"` í‚¤ì›Œë“œ í¬í•¨
3. `state["messages"]`ì— ëŒ€í™” ë‚´ì—­ ì¡´ì¬

**ì „ì²´ ëŒ€í™” Markdown í˜•ì‹** (`src/tools/save_file.py:44-64`):
```markdown
# ëŒ€í™” ë‚´ìš©

## [1] ğŸ™‹ ì‚¬ìš©ì

Transformer ë…¼ë¬¸ ìš”ì•½í•´ì¤˜

## [2] ğŸ¤– AI

Transformer ë…¼ë¬¸ ìš”ì•½ ê²°ê³¼ì…ë‹ˆë‹¤...

## [3] ğŸ™‹ ì‚¬ìš©ì

ì €ì¥í•´ì¤˜

## [4] ğŸ¤– AI

íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤...
```

#### 2ë‹¨ê³„: ì €ì¥ ë‚´ìš© ìš°ì„ ìˆœìœ„ ê²°ì •

**ëª©ì **: ì–´ë–¤ ë°ì´í„°ë¥¼ ì €ì¥í• ì§€ ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ê²°ì •

**íŒŒì¼**: `src/tools/save_file.py:66-150`

**ìš°ì„ ìˆœìœ„**:

| ìˆœìœ„ | ë°ì´í„° ì¶œì²˜ | ì„¤ëª… | ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ |
|------|-------------|------|---------------|
| **0ìˆœìœ„** | `final_answers` (dict) | ë‚œì´ë„ë³„ ë‹¤ì¤‘ ë‹µë³€ | ìš”ì•½ ë„êµ¬ ì‹¤í–‰ í›„ ì €ì¥ |
| **1ìˆœìœ„** | `tool_result` | íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ê²°ê³¼ | ë‹¤ì¤‘ ìš”ì²­ íŒŒì´í”„ë¼ì¸ |
| **2ìˆœìœ„** | `final_answer` | ìµœì¢… ë‹µë³€ | ë‹¨ì¼ ë„êµ¬ ì‹¤í–‰ |
| **3ìˆœìœ„** | `messages` | ë§ˆì§€ë§‰ assistant ë©”ì‹œì§€ | ëŒ€í™” ì´ë ¥ì—ì„œ ì¶”ì¶œ |

**0ìˆœìœ„: final_answers (ë‚œì´ë„ë³„ ë‹¤ì¤‘ ì €ì¥)**

**ì¡°ê±´**: `final_answers`ê°€ dictì´ê³  ë¹„ì–´ìˆì§€ ì•Šì„ ë•Œ

**ë™ì‘** (`src/tools/save_file.py:69-116`):
```python
final_answers = state.get("final_answers", {})
if final_answers and isinstance(final_answers, dict) and len(final_answers) > 0:
    # ë‚œì´ë„ë³„ë¡œ ê°ê° ë³„ë„ íŒŒì¼ ì €ì¥
    for level, content in final_answers.items():
        filename = f"{timestamp}_response_{save_counter}_{level}.md"
        file_path = exp_manager.save_output(filename, content)
        saved_files.append(f"- {level_labels.get(level, level)}: {file_path}")

    answer = f"ë‚œì´ë„ë³„ ë‹µë³€ì´ ê°ê° ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\nì €ì¥ëœ íŒŒì¼:\n" + "\n".join(saved_files)
```

**ìƒì„±ë˜ëŠ” íŒŒì¼ ì˜ˆì‹œ**:
- `20251107_153000_response_1_elementary.md`
- `20251107_153000_response_1_beginner.md`
- `20251107_153000_response_1_intermediate.md`
- `20251107_153000_response_1_advanced.md`

**1ìˆœìœ„: tool_result**

**ì¡°ê±´**: íŒŒì´í”„ë¼ì¸ ëª¨ë“œì—ì„œ ì´ì „ ë„êµ¬ì˜ ê²°ê³¼ê°€ ìˆì„ ë•Œ

**ì˜ˆì‹œ ì‹œë‚˜ë¦¬ì˜¤**:
- "GPT ë…¼ë¬¸ ì°¾ì•„ì„œ ì €ì¥í•´ì¤˜" â†’ search_paper â†’ save_file
- `tool_result`ì— search_paperì˜ ê²€ìƒ‰ ê²°ê³¼ ì €ì¥

**2ìˆœìœ„: final_answer**

**ì¡°ê±´**: ë‹¨ì¼ ë„êµ¬ ì‹¤í–‰ í›„ ìµœì¢… ë‹µë³€ì´ ìˆì„ ë•Œ

**3ìˆœìœ„: messages**

**ì¡°ê±´**: ìœ„ ëª¨ë“  ì¶œì²˜ì—ì„œ ë°ì´í„°ë¥¼ ì°¾ì§€ ëª»í–ˆì„ ë•Œ

**ë™ì‘** (`src/tools/save_file.py:135-143`):
```python
if not content_to_save and messages:
    for msg in reversed(messages):
        if msg.get("role") == "assistant":
            content = msg.get("content", "")
            if content.strip():
                content_to_save = content
                break
```

#### 3ë‹¨ê³„: íŒŒì¼ëª… ìƒì„±

**ëª©ì **: íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ì¹´ìš´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê³ ìœ í•œ íŒŒì¼ëª… ìƒì„±

**íŒŒì¼**: `src/tools/save_file.py:154-162`

**íŒŒì¼ëª… íŒ¨í„´**:
```
{YYYYMMDD}_{HHMMSS}_response_{ë²ˆí˜¸}.md
```

**ì˜ˆì‹œ**:
- `20251107_153045_response_1.md`
- `20251107_153120_response_2.md`
- `20251107_153200_response_3.md`

**save_counter ê´€ë¦¬**:
```python
save_counter = state.get("save_counter", 0) + 1
state["save_counter"] = save_counter
```

- ì„¸ì…˜ë³„ë¡œ ëˆ„ì  ì¹´ìš´í„°
- 0ë¶€í„° ì‹œì‘í•˜ì—¬ ë§¤ ì €ì¥ë§ˆë‹¤ +1
- ê°™ì€ ì„¸ì…˜ ë‚´ì—ì„œ ì¤‘ë³µ ë°©ì§€

#### 4ë‹¨ê³„: íŒŒì¼ ì €ì¥ ì‹¤í–‰

**ëª©ì **: ìƒì„±ëœ ë‚´ìš©ì„ ì‹¤ì œ íŒŒì¼ ì‹œìŠ¤í…œì— ì €ì¥

**íŒŒì¼**: `src/tools/save_file.py:167-188`

**ExperimentManager ì‚¬ìš©** (ê¸°ë³¸):
```python
if exp_manager:
    file_path = exp_manager.save_output(filename, content_to_save)
```

**ì €ì¥ ê²½ë¡œ**: `experiments/{ë‚ ì§œ}/{ì„¸ì…˜}/outputs/save_data/{filename}`

**ì˜ˆì‹œ**:
```
experiments/20251107/20251107_153000_session_001/outputs/save_data/20251107_153045_response_1.md
```

**ì§ì ‘ ì €ì¥** (í…ŒìŠ¤íŠ¸ í™˜ê²½):
```python
else:
    output_dir = "outputs"
    os.makedirs(output_dir, exist_ok=True)
    file_path = os.path.join(output_dir, filename)
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content_to_save)
```

**ì €ì¥ ê²½ë¡œ**: `outputs/{filename}`

#### 5ë‹¨ê³„: ì„±ê³µ ë©”ì‹œì§€ ë°˜í™˜

**ëª©ì **: ì‚¬ìš©ìì—ê²Œ ì €ì¥ ì™„ë£Œë¥¼ ì•Œë¦¼

**íŒŒì¼**: `src/tools/save_file.py:174-191`

**ë‹¨ì¼ íŒŒì¼ ì €ì¥**:
```
íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
íŒŒì¼ ê²½ë¡œ: experiments/.../outputs/save_data/20251107_153045_response_1.md
```

**ë‚œì´ë„ë³„ ë‹¤ì¤‘ ì €ì¥**:
```
ë‚œì´ë„ë³„ ë‹µë³€ì´ ê°ê° ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
ì €ì¥ëœ íŒŒì¼:
- ì´ˆê¸‰ììš©(14-22ì„¸): experiments/.../20251107_153000_response_1_beginner.md
- ì¤‘ê¸‰ììš©(23-30ì„¸): experiments/.../20251107_153000_response_1_intermediate.md
```

### ì €ì¥ êµ¬ì¡° (íŒŒì¼ ì‹œìŠ¤í…œ)

#### ExperimentManager í´ë” êµ¬ì¡°

```
experiments/
â””â”€â”€ 20251107/                          # ë‚ ì§œë³„ í´ë”
    â””â”€â”€ 20251107_153000_session_001/   # ì„¸ì…˜ë³„ í´ë”
        â”œâ”€â”€ metadata.json              # ì„¸ì…˜ ë©”íƒ€ë°ì´í„°
        â”œâ”€â”€ chatbot.log                # ì „ì²´ ë¡œê·¸
        â”œâ”€â”€ tools/                     # ë„êµ¬ë³„ ë¡œê·¸
        â”œâ”€â”€ database/                  # DB ì¿¼ë¦¬ ê¸°ë¡
        â”œâ”€â”€ prompts/                   # í”„ë¡¬í”„íŠ¸ ê¸°ë¡
        â”œâ”€â”€ ui/                        # UI ì´ë²¤íŠ¸
        â”œâ”€â”€ evaluation/                # í‰ê°€ ì§€í‘œ
        â””â”€â”€ outputs/                   # ê²°ê³¼ë¬¼
            â”œâ”€â”€ save_data/             # save_file ë„êµ¬ë¡œ ì €ì¥ëœ íŒŒì¼
            â”‚   â”œâ”€â”€ 20251107_153045_response_1.md
            â”‚   â”œâ”€â”€ 20251107_153120_response_2.md
            â”‚   â””â”€â”€ 20251107_153200_response_3_beginner.md
            â””â”€â”€ summary/               # summarize ë„êµ¬ì˜ ìš”ì•½ ê²°ê³¼
                â””â”€â”€ Attention_Is_All_You_Need.md
```

#### save_data í´ë” ìë™ ìƒì„±

**íŒŒì¼**: `src/utils/experiment_manager.py:455-462`

```python
def save_output(self, filename: str, content: str):
    # save_file ë„êµ¬ë¥¼ í†µí•œ ì €ì¥ì¸ ê²½ìš° save_data í•˜ìœ„ í´ë”ì— ì €ì¥
    if filename.endswith('.md') and '_' in filename:
        save_data_dir = self.outputs_dir / "save_data"
        save_data_dir.mkdir(parents=True, exist_ok=True)
        output_path = save_data_dir / filename
    else:
        output_path = self.outputs_dir / filename
```

**ìë™ í´ë” ìƒì„± ì¡°ê±´**:
- íŒŒì¼ëª…ì´ `.md`ë¡œ ëë‚¨
- íŒŒì¼ëª…ì— `_`ê°€ í¬í•¨ë¨ (íƒ€ì„ìŠ¤íƒ¬í”„ íŒ¨í„´)

### ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥ ë°©ë²•

#### 1. ì„¸ì…˜ë³„ ì¹´ìš´í„° ê´€ë¦¬

**ë¬¸ì œ**: ê°™ì€ ì„¸ì…˜ì—ì„œ ì—¬ëŸ¬ ë²ˆ ì €ì¥ ì‹œ íŒŒì¼ëª… ì¤‘ë³µ ê°€ëŠ¥

**í•´ê²°**: `state["save_counter"]`ë¡œ ì„¸ì…˜ë³„ ëˆ„ì  ì¹´ìš´í„° ê´€ë¦¬

```python
save_counter = state.get("save_counter", 0) + 1
state["save_counter"] = save_counter
```

**íš¨ê³¼**:
- ê°™ì€ íƒ€ì„ìŠ¤íƒ¬í”„ì—¬ë„ ì¹´ìš´í„°ë¡œ êµ¬ë¶„
- ì„¸ì…˜ ë‚´ì—ì„œ ê³ ìœ ì„± ë³´ì¥

#### 2. íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ íŒŒì¼ëª…

**ë¬¸ì œ**: ë‹¤ë¥¸ ì„¸ì…˜ì—ì„œ íŒŒì¼ëª… ì¤‘ë³µ ê°€ëŠ¥

**í•´ê²°**: íƒ€ì„ìŠ¤íƒ¬í”„ (ì´ˆ ë‹¨ìœ„) í¬í•¨

```python
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
filename = f"{timestamp}_response_{save_counter}.md"
```

**íš¨ê³¼**:
- ì´ˆ ë‹¨ìœ„ ì •ë°€ë„ë¡œ ì¤‘ë³µ í™•ë¥  ê·¹íˆ ë‚®ìŒ
- ë‹¤ë¥¸ ì„¸ì…˜ ê°„ êµ¬ë¶„ ê°€ëŠ¥

#### 3. í´ë” ìë™ ìƒì„±

**ë¬¸ì œ**: í´ë”ê°€ ì—†ìœ¼ë©´ ì €ì¥ ì‹¤íŒ¨

**í•´ê²°**: `mkdir(parents=True, exist_ok=True)`

```python
save_data_dir.mkdir(parents=True, exist_ok=True)
os.makedirs(output_dir, exist_ok=True)
```

**íš¨ê³¼**:
- í´ë”ê°€ ì—†ì–´ë„ ìë™ ìƒì„±
- ì´ë¯¸ ìˆì–´ë„ ì˜¤ë¥˜ ë°œìƒ ì•ˆ í•¨

#### 4. UTF-8 ì¸ì½”ë”©

**ë¬¸ì œ**: í•œê¸€ ë“± ìœ ë‹ˆì½”ë“œ ë¬¸ì ê¹¨ì§ ê°€ëŠ¥

**í•´ê²°**: ëª…ì‹œì  UTF-8 ì¸ì½”ë”©

```python
with open(file_path, 'w', encoding='utf-8') as f:
    f.write(content_to_save)
```

**íš¨ê³¼**:
- ëª¨ë“  ì–¸ì–´ ë¬¸ì ì •ìƒ ì €ì¥
- í¬ë¡œìŠ¤ í”Œë«í¼ í˜¸í™˜ì„±

---

## ğŸ’¡ ì‚¬ìš© ì˜ˆì‹œ

### ì˜ˆì‹œ 1: ë‹¨ì¼ ë‹µë³€ ì €ì¥

**ì‚¬ìš©ì ì§ˆë¬¸:**
```
GPT ë…¼ë¬¸ ì°¾ì•„ì„œ ì €ì¥í•´ì¤˜
```

**ì‹¤í–‰ íë¦„:**

1. **íŒ¨í„´ ë§¤ì¹­**: `keywords: [ë…¼ë¬¸, ì°¾, ì €ì¥]` â†’ tool_pipeline
   ```python
   tool_pipeline = ["search_paper", "save_file"]
   ```
2. **search_paper ì‹¤í–‰**:
   - pgvector ê²€ìƒ‰: "GPT" ê´€ë ¨ ë…¼ë¬¸ 5í¸ ì¡°íšŒ
   - ê²€ìƒ‰ ê²°ê³¼ë¥¼ `tool_result`ì— ì €ì¥
   ```
   1. Improving Language Understanding by Generative Pre-Training (Radford et al., 2018)
      - GPT-1 ëª¨ë¸ ì œì•ˆ
      - Transformer decoder ê¸°ë°˜
      - ë¹„ì§€ë„ ì‚¬ì „ í•™ìŠµ + ì§€ë„ ë¯¸ì„¸ ì¡°ì •
      ...
   ```
3. **save_file ì‹¤í–‰**:
   - ì €ì¥ ëª¨ë“œ ê²°ì •: `is_full_save = False` (ë‹¨ì¼ ë‹µë³€)
   - ì €ì¥ ë‚´ìš© ì„ íƒ: `tool_result` ì‚¬ìš© (1ìˆœìœ„)
   - save_counter ì¦ê°€: `1`
   - íƒ€ì„ìŠ¤íƒ¬í”„ ìƒì„±: `20251107_153045`
   - íŒŒì¼ëª… ìƒì„±: `20251107_153045_response_1.md`
4. **íŒŒì¼ ì €ì¥** (ExperimentManager):
   ```
   experiments/20251107/20251107_150000_session_001/outputs/save_data/20251107_153045_response_1.md
   ```
5. **ì €ì¥ ë‚´ìš©**:
   ```markdown
   1. Improving Language Understanding by Generative Pre-Training (Radford et al., 2018)
      - GPT-1 ëª¨ë¸ ì œì•ˆ
      - Transformer decoder ê¸°ë°˜
      - ë¹„ì§€ë„ ì‚¬ì „ í•™ìŠµ + ì§€ë„ ë¯¸ì„¸ ì¡°ì •
      - BookCorpus ë°ì´í„°ì…‹ ì‚¬ìš©
      - ë‹¤ì–‘í•œ NLP íƒœìŠ¤í¬ì—ì„œ SOTA ë‹¬ì„±

   2. Language Models are Unsupervised Multitask Learners (Radford et al., 2019)
      - GPT-2 ëª¨ë¸ ì œì•ˆ
      - 15ì–µ íŒŒë¼ë¯¸í„°
      - WebText ë°ì´í„°ì…‹ (40GB)
      - Zero-shot ì„±ëŠ¥ í–¥ìƒ
      ...
   ```
6. **ìµœì¢… ë‹µë³€**:
   ```
   íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
   íŒŒì¼ ê²½ë¡œ: experiments/20251107/20251107_150000_session_001/outputs/save_data/20251107_153045_response_1.md
   ```

### ì˜ˆì‹œ 2: ë‚œì´ë„ë³„ ë‹¤ì¤‘ ì €ì¥

**ì‚¬ìš©ì ì§ˆë¬¸:**
```
Transformer ë…¼ë¬¸ ìš”ì•½í•´ì„œ ì €ì¥í•´ì¤˜
```

**ì‹¤í–‰ íë¦„:**

1. **íŒ¨í„´ ë§¤ì¹­**: `keywords: [ë…¼ë¬¸, ìš”ì•½, ì €ì¥]` â†’ tool_pipeline
   ```python
   tool_pipeline = ["search_paper", "web_search", "general", "summarize", "save_file"]
   ```
2. **summarize ì‹¤í–‰**:
   - ë…¼ë¬¸ ì œëª© ì¶”ì¶œ: "Attention Is All You Need"
   - PostgreSQL ê²€ìƒ‰: ë…¼ë¬¸ ë°œê²¬
   - pgvector ì²­í¬ ì¡°íšŒ: 48ê°œ ì²­í¬
   - ë‚œì´ë„ë³„ ìš”ì•½ ìƒì„± (easy ëª¨ë“œ):
     - `final_answers["elementary"]`: ì´ˆë“±í•™ìƒìš© ìš”ì•½
     - `final_answers["beginner"]`: ì´ˆê¸‰ììš© ìš”ì•½
3. **save_file ì‹¤í–‰**:
   - ì €ì¥ ëª¨ë“œ ê²°ì •: `is_full_save = False`
   - ì €ì¥ ë‚´ìš© ì„ íƒ: `final_answers` ë°œê²¬ (0ìˆœìœ„)
   - save_counter ì¦ê°€: `2`
   - íƒ€ì„ìŠ¤íƒ¬í”„ ìƒì„±: `20251107_153200`
   - ë‚œì´ë„ë³„ íŒŒì¼ëª… ìƒì„±:
     - `20251107_153200_response_2_elementary.md`
     - `20251107_153200_response_2_beginner.md`
4. **íŒŒì¼ ì €ì¥** (2ê°œ íŒŒì¼):
   - `experiments/.../outputs/save_data/20251107_153200_response_2_elementary.md`
   - `experiments/.../outputs/save_data/20251107_153200_response_2_beginner.md`
5. **ìµœì¢… ë‹µë³€**:
   ```
   ë‚œì´ë„ë³„ ë‹µë³€ì´ ê°ê° ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
   ì €ì¥ëœ íŒŒì¼:
   - ì´ˆë“±í•™ìƒìš©(8-13ì„¸): experiments/.../20251107_153200_response_2_elementary.md
   - ì´ˆê¸‰ììš©(14-22ì„¸): experiments/.../20251107_153200_response_2_beginner.md
   ```

### ì˜ˆì‹œ 3: ì „ì²´ ëŒ€í™” ì €ì¥

**ì‚¬ìš©ì ì§ˆë¬¸:**
```
ì „ì²´ ëŒ€í™” ì €ì¥í•´ì¤˜
```

**ì‹¤í–‰ íë¦„:**

1. **íŒ¨í„´ ë§¤ì¹­**: `keywords: [ì „ì²´, ì €ì¥]` â†’ save_file ë‹¨ì¼ ì‹¤í–‰
   ```python
   tool_pipeline = ["save_file"]
   ```
2. **save_file ì‹¤í–‰**:
   - ì €ì¥ ëª¨ë“œ ê²°ì •: `is_full_save = True` (ì „ì²´ ëŒ€í™”)
   - messages ì „ì²´ ì¡°íšŒ:
     ```python
     messages = [
         {"role": "user", "content": "Transformer ë…¼ë¬¸ ìš”ì•½í•´ì¤˜"},
         {"role": "assistant", "content": "Transformer ë…¼ë¬¸ ìš”ì•½ ê²°ê³¼..."},
         {"role": "user", "content": "ì €ì¥í•´ì¤˜"},
         {"role": "assistant", "content": "íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤..."},
         {"role": "user", "content": "ì „ì²´ ëŒ€í™” ì €ì¥í•´ì¤˜"}
     ]
     ```
   - Markdown ë³€í™˜:
     ```markdown
     # ëŒ€í™” ë‚´ìš©

     ## [1] ğŸ™‹ ì‚¬ìš©ì

     Transformer ë…¼ë¬¸ ìš”ì•½í•´ì¤˜

     ## [2] ğŸ¤– AI

     Transformer ë…¼ë¬¸ ìš”ì•½ ê²°ê³¼...

     ## [3] ğŸ™‹ ì‚¬ìš©ì

     ì €ì¥í•´ì¤˜

     ## [4] ğŸ¤– AI

     íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤...

     ## [5] ğŸ™‹ ì‚¬ìš©ì

     ì „ì²´ ëŒ€í™” ì €ì¥í•´ì¤˜
     ```
   - save_counter ì¦ê°€: `3`
   - íŒŒì¼ëª… ìƒì„±: `20251107_153300_response_3.md`
3. **íŒŒì¼ ì €ì¥**:
   ```
   experiments/.../outputs/save_data/20251107_153300_response_3.md
   ```
4. **ìµœì¢… ë‹µë³€**:
   ```
   íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
   íŒŒì¼ ê²½ë¡œ: experiments/.../20251107_153300_response_3.md
   ```

---

## ğŸ” í•µì‹¬ í¬ì¸íŠ¸

### 1. ì €ì¥ ë„êµ¬ëŠ” ìµœì¢… ë‹¨ê³„ ë„êµ¬

**íŠ¹ì§•**:
- íŒŒì´í”„ë¼ì¸ì˜ ë§ˆì§€ë§‰ì— ìœ„ì¹˜
- Fallback ì—†ìŒ (ì €ì¥ ì‹¤íŒ¨ëŠ” ì‹œìŠ¤í…œ ì˜¤ë¥˜)
- ì´ì „ ë„êµ¬ì˜ ê²°ê³¼ë¥¼ ì˜êµ¬ ë³´ì¡´

**ì¥ì **:
- ë‹¤ì¤‘ ìš”ì²­ì˜ ëª¨ë“  ê²°ê³¼ë¥¼ íŒŒì¼ë¡œ ì €ì¥
- ì„¸ì…˜ ì¢…ë£Œ í›„ì—ë„ ê²°ê³¼ ì¡°íšŒ ê°€ëŠ¥
- ì‹¤í—˜ ì¬í˜„ì„± í–¥ìƒ

### 2. ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ì €ì¥ ë‚´ìš© ì„ íƒ

**4ë‹¨ê³„ ìš°ì„ ìˆœìœ„**:
1. **final_answers**: ë‚œì´ë„ë³„ ë‹¤ì¤‘ ë‹µë³€ (ìš”ì•½ ë„êµ¬)
2. **tool_result**: íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ê²°ê³¼
3. **final_answer**: ìµœì¢… ë‹µë³€
4. **messages**: ëŒ€í™” ì´ë ¥

**ì™œ ì¤‘ìš”í•œê°€?**
- ê°€ì¥ í’ë¶€í•œ ì •ë³´ë¶€í„° ìš°ì„  ì €ì¥
- ë°ì´í„° ì†ì‹¤ ë°©ì§€
- ì‚¬ìš©ì ì˜ë„ì— ë§ëŠ” ì €ì¥

### 3. ì„¸ì…˜ë³„ ì¹´ìš´í„° + íƒ€ì„ìŠ¤íƒ¬í”„

**íŒŒì¼ëª… ì¤‘ë³µ ë°©ì§€**:
- **íƒ€ì„ìŠ¤íƒ¬í”„**: ë‹¤ë¥¸ ì„¸ì…˜ ê°„ êµ¬ë¶„
- **save_counter**: ê°™ì€ ì„¸ì…˜ ë‚´ êµ¬ë¶„

**ì˜ˆì‹œ**:
```
20251107_153000_response_1.md  # ì„¸ì…˜ 1, ì²« ë²ˆì§¸ ì €ì¥
20251107_153045_response_2.md  # ì„¸ì…˜ 1, ë‘ ë²ˆì§¸ ì €ì¥
20251107_160000_response_1.md  # ì„¸ì…˜ 2, ì²« ë²ˆì§¸ ì €ì¥
```

### 4. ExperimentManager í†µí•©

**ìë™ í´ë” ê´€ë¦¬**:
- `outputs/save_data/` ìë™ ìƒì„±
- ì„¸ì…˜ë³„ í´ë” êµ¬ì¡° ìœ ì§€
- ì‹¤í—˜ ì¶”ì  ìš©ì´

**ì‹¤í—˜ ì¬í˜„ì„±**:
- ëª¨ë“  ì €ì¥ íŒŒì¼ì´ ì„¸ì…˜ë³„ë¡œ ê´€ë¦¬ë¨
- metadata.jsonê³¼ ì—°ë™
- ì‹¤í—˜ ê²°ê³¼ ì²´ê³„ì  ë³´ê´€

---

## ğŸ“š ì°¸ê³  ì •ë³´

### ì£¼ìš” íŒŒì¼ ë° ìœ„ì¹˜

- **ë„êµ¬ êµ¬í˜„**: `src/tools/save_file.py`
- **ExperimentManager**: `src/utils/experiment_manager.py` > `save_output()`
- **íŒ¨í„´ ì„¤ì •**: `configs/multi_request_patterns.yaml` (priority: 150/140/110/100...)
- **ì¶œë ¥ í´ë”**: `experiments/{ë‚ ì§œ}/{ì„¸ì…˜}/outputs/save_data/`

### ê´€ë ¨ ê¸°ìˆ  ìŠ¤íƒ

- **íŒŒì´ì¬ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬**:
  - `datetime`: íƒ€ì„ìŠ¤íƒ¬í”„ ìƒì„±
  - `os`: íŒŒì¼ ì‹œìŠ¤í…œ ì¡°ì‘
  - `pathlib`: ê²½ë¡œ ê´€ë¦¬
- **LangGraph**: ìƒíƒœ ë¨¸ì‹  ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°
- **íŒŒì¼ ì‹œìŠ¤í…œ**: ë¡œì»¬ ë””ìŠ¤í¬ ì €ì¥

### ì €ì¥ ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

| í•­ëª© | ê°’ | ì„¤ëª… |
|------|------|------|
| **íŒŒì¼ í˜•ì‹** | Markdown (.md) | ê°€ë…ì„± ìš°ìˆ˜, ë²„ì „ ê´€ë¦¬ ìš©ì´ |
| **ì¸ì½”ë”©** | UTF-8 | ëª¨ë“  ì–¸ì–´ ì§€ì›, ë²”ìš©ì„± |
| **íŒŒì¼ëª… íŒ¨í„´** | íƒ€ì„ìŠ¤íƒ¬í”„_response_ë²ˆí˜¸ | ì¤‘ë³µ ë°©ì§€, ì •ë ¬ ìš©ì´ |
| **í´ë” êµ¬ì¡°** | ì„¸ì…˜ë³„ ë¶„ë¦¬ | ì‹¤í—˜ ì¶”ì , ì¬í˜„ì„± |
| **ì €ì¥ ì†ë„** | ì¦‰ì‹œ (< 10ms) | ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œ I/O |

### ì œì•½ ì‚¬í•­

1. **DB ì €ì¥ ì—†ìŒ**: íŒŒì¼ ì‹œìŠ¤í…œì—ë§Œ ì €ì¥ (DBì—ëŠ” ë¯¸ì €ì¥)
2. **í´ë¼ìš°ë“œ ì €ì¥ ë¯¸ì§€ì›**: ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œë§Œ ì§€ì› (S3, GCS ë“± ë¯¸ì§€ì›)
3. **ì €ì¥ ì‹¤íŒ¨ ì²˜ë¦¬ ë¶€ì¡±**: í˜„ì¬ Exception ì²˜ë¦¬ ì—†ìŒ (í–¥í›„ ê°œì„  í•„ìš”)
4. **íŒŒì¼ í¬ê¸° ì œí•œ ì—†ìŒ**: ë§¤ìš° í° ë‹µë³€ë„ ì €ì¥ (ë””ìŠ¤í¬ ê³µê°„ ê³ ë ¤)

### ê°œì„  ë°©í–¥

1. **Exception ì²˜ë¦¬ ì¶”ê°€**: ì €ì¥ ì‹¤íŒ¨ ì‹œ ëª…í™•í•œ ì˜¤ë¥˜ ë©”ì‹œì§€
2. **í´ë¼ìš°ë“œ ì €ì¥ ì§€ì›**: S3, GCS, Azure Blob ë“± í´ë¼ìš°ë“œ ìŠ¤í† ë¦¬ì§€
3. **DB ì €ì¥ ì˜µì…˜**: PostgreSQLì— ì €ì¥ ë‚´ìš© ë°±ì—…
4. **íŒŒì¼ ì••ì¶•**: í° íŒŒì¼ ìë™ ì••ì¶• (gzip)
5. **ì €ì¥ ì´ë ¥ ê´€ë¦¬**: ì €ì¥ íŒŒì¼ ë©”íƒ€ë°ì´í„° DB ê¸°ë¡

---

**ì‘ì„±ì¼**: 2025-11-07
**ë²„ì „**: 1.0
