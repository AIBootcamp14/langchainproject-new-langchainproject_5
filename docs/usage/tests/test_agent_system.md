# test_agent_system.py ì‚¬ìš©ë²•

## ê°œìš”

Phase 1: ê¸°ë°˜ ì‹œìŠ¤í…œ í†µí•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

**ëª©ì **: LLM í´ë¼ì´ì–¸íŠ¸, AgentState, Agent ê·¸ë˜í”„ì˜ ê¸°ë³¸ ê¸°ëŠ¥ì„ ê²€ì¦í•©ë‹ˆë‹¤.

**ìœ„ì¹˜**: `tests/integration/test_agent_system.py`

**ê´€ë ¨ ë¸Œëœì¹˜**: `feature/agent-system`

---

## ì‹¤í–‰ ë°©ë²•

### 1. ê¸°ë³¸ ì‹¤í–‰

```bash
python tests/integration/test_agent_system.py
```

### 2. pytestë¥¼ í†µí•œ ì‹¤í–‰

```bash
pytest tests/integration/test_agent_system.py -v
```

---

## ì‚¬ì „ ìš”êµ¬ì‚¬í•­

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

í…ŒìŠ¤íŠ¸ë¥¼ ì™„ì „íˆ í†µê³¼í•˜ë ¤ë©´ ë‹¤ìŒ í™˜ê²½ ë³€ìˆ˜ê°€ í•„ìš”í•©ë‹ˆë‹¤:

```bash
# .env íŒŒì¼
OPENAI_API_KEY=your_openai_api_key
SOLAR_API_KEY=your_SOLAR_API_KEY
```

**ì°¸ê³ **: í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•„ë„ Agent ê·¸ë˜í”„ êµ¬ì¡° ê²€ì¦ì€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## í…ŒìŠ¤íŠ¸ í•­ëª©

### 1. LLM í´ë¼ì´ì–¸íŠ¸ í…ŒìŠ¤íŠ¸

#### í…ŒìŠ¤íŠ¸ ë‚´ìš©
- **OpenAI í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”**:
  - `ChatOpenAI` ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
  - API í‚¤ ì—°ê²° í™•ì¸

- **Solar í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”**:
  - `ChatUpstage` ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
  - Upstage API í‚¤ ì—°ê²° í™•ì¸

- **get_llm_for_task() í•¨ìˆ˜**:
  - ì‘ì—… ìœ í˜•ë³„ LLM ì„ íƒ ê²€ì¦
  - `routing`: Solar (ë¹ ë¥¸ ì‘ë‹µ)
  - `generation`: GPT-4 (ë†’ì€ ì •í™•ë„)
  - `summarization`: GPT-4 (í’ˆì§ˆ ì¤‘ìš”)

#### ì˜ˆìƒ ê²°ê³¼
```
[1-1] OpenAI í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸...
âœ… OpenAI í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” ì„±ê³µ

[1-2] Solar í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸...
âœ… Solar í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” ì„±ê³µ

[1-3] get_llm_for_task() í•¨ìˆ˜ í…ŒìŠ¤íŠ¸...
âœ… get_llm_for_task() í•¨ìˆ˜ ì •ìƒ ì‘ë™
```

### 2. Agent ê·¸ë˜í”„ ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸

#### í…ŒìŠ¤íŠ¸ ë‚´ìš©
- **Agent ê·¸ë˜í”„ ìƒì„±**:
  - `create_agent_graph()` í•¨ìˆ˜ í˜¸ì¶œ
  - LangGraph StateGraph ì»´íŒŒì¼ ì„±ê³µ ì—¬ë¶€

- **ê·¸ë˜í”„ êµ¬ì¡° í™•ì¸**:
  - ê·¸ë˜í”„ ê°ì²´ ì •ìƒ ìƒì„±
  - Noneì´ ì•„ë‹Œ ìœ íš¨í•œ ê°ì²´ ë°˜í™˜

#### ì˜ˆìƒ ê²°ê³¼
```
[2-1] Agent ê·¸ë˜í”„ ìƒì„± í…ŒìŠ¤íŠ¸...
âœ… Agent ê·¸ë˜í”„ ìƒì„± ë° ì»´íŒŒì¼ ì„±ê³µ

[2-2] ê·¸ë˜í”„ êµ¬ì¡° í™•ì¸...
âœ… ê·¸ë˜í”„ ê°ì²´ ì •ìƒ ìƒì„±
```

### 3. ë¼ìš°í„° ë…¸ë“œ í…ŒìŠ¤íŠ¸

#### í…ŒìŠ¤íŠ¸ ë‚´ìš©
- **ë„êµ¬ ì„ íƒ ë¡œì§ ê²€ì¦**:
  - ì§ˆë¬¸ ë¶„ì„ ë° ì ì ˆí•œ ë„êµ¬ ì„ íƒ
  - ë¼ìš°í„° â†’ ë„êµ¬ ë…¸ë“œ ì¡°ê±´ë¶€ ë¶„ê¸°

#### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

| ì§ˆë¬¸ | ì˜ˆìƒ ë„êµ¬ | ë‚œì´ë„ |
|------|----------|--------|
| "Transformer ë…¼ë¬¸ì— ëŒ€í•´ ì•Œë ¤ì¤˜" | `search_paper` ë˜ëŠ” `general` | easy |
| "ì•ˆë…•í•˜ì„¸ìš”" | `general` | easy |

#### ì˜ˆìƒ ê²°ê³¼
```
[3-1] Agent ê·¸ë˜í”„ ìƒì„±...
âœ… Agent ê·¸ë˜í”„ ìƒì„± ì„±ê³µ

[3-2] í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1: Transformer ë…¼ë¬¸ì— ëŒ€í•´ ì•Œë ¤ì¤˜
   ì„ íƒëœ ë„êµ¬: search_paper
   âœ… ì˜ˆìƒ ë„êµ¬ ì¤‘ í•˜ë‚˜ ì„ íƒë¨
   ìµœì¢… ë‹µë³€: RAG ê²€ìƒ‰ ë…¸ë“œ (êµ¬í˜„ ì˜ˆì •)...
   âœ… í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1 í†µê³¼

[3-3] í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 2: ì•ˆë…•í•˜ì„¸ìš”
   ì„ íƒëœ ë„êµ¬: general
   âœ… ì˜ˆìƒ ë„êµ¬ ì¤‘ í•˜ë‚˜ ì„ íƒë¨
   ìµœì¢… ë‹µë³€: ì¼ë°˜ ë‹µë³€ ë…¸ë“œ (êµ¬í˜„ ì˜ˆì •)...
   âœ… í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 2 í†µê³¼
```

---

## ì „ì²´ í…ŒìŠ¤íŠ¸ ê²°ê³¼

### API í‚¤ê°€ ì„¤ì •ëœ ê²½ìš°

```
============================================================
Phase 1: ê¸°ë°˜ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œì‘
============================================================

[í™˜ê²½ë³€ìˆ˜ í™•ì¸]
âœ… OPENAI_API_KEY ì„¤ì •ë¨
âœ… SOLAR_API_KEY ì„¤ì •ë¨

============================================================
í…ŒìŠ¤íŠ¸ 1: LLM í´ë¼ì´ì–¸íŠ¸
============================================================
âœ… LLM í´ë¼ì´ì–¸íŠ¸ í…ŒìŠ¤íŠ¸ í†µê³¼

============================================================
í…ŒìŠ¤íŠ¸ 2: Agent ê·¸ë˜í”„ ì»´íŒŒì¼
============================================================
âœ… Agent ê·¸ë˜í”„ ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸ í†µê³¼

============================================================
í…ŒìŠ¤íŠ¸ 3: ë¼ìš°í„° ë…¸ë“œ (ë„êµ¬ ì„ íƒ ë¡œì§)
============================================================
âœ… ë¼ìš°í„° ë…¸ë“œ í…ŒìŠ¤íŠ¸ í†µê³¼

============================================================
í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½
============================================================
LLM í´ë¼ì´ì–¸íŠ¸: âœ… í†µê³¼
Agent ê·¸ë˜í”„ ì»´íŒŒì¼: âœ… í†µê³¼
ë¼ìš°í„° ë…¸ë“œ: âœ… í†µê³¼

============================================================
ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!
============================================================
```

### API í‚¤ê°€ ì—†ëŠ” ê²½ìš°

```
============================================================
Phase 1: ê¸°ë°˜ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œì‘
============================================================

[í™˜ê²½ë³€ìˆ˜ í™•ì¸]
âŒ OPENAI_API_KEY ë¯¸ì„¤ì •
âš ï¸  SOLAR_API_KEY ë¯¸ì„¤ì • (Solar í…ŒìŠ¤íŠ¸ ì œí•œ)

============================================================
í…ŒìŠ¤íŠ¸ 1: LLM í´ë¼ì´ì–¸íŠ¸
============================================================
âŒ OpenAI í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” ì‹¤íŒ¨: The api_key client option must be set...

============================================================
í…ŒìŠ¤íŠ¸ 2: Agent ê·¸ë˜í”„ ì»´íŒŒì¼
============================================================
âœ… Agent ê·¸ë˜í”„ ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸ í†µê³¼

============================================================
í…ŒìŠ¤íŠ¸ 3: ë¼ìš°í„° ë…¸ë“œ (ë„êµ¬ ì„ íƒ ë¡œì§)
============================================================
âœ… ë¼ìš°í„° ë…¸ë“œ í…ŒìŠ¤íŠ¸ í†µê³¼

============================================================
í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½
============================================================
LLM í´ë¼ì´ì–¸íŠ¸: âŒ ì‹¤íŒ¨
Agent ê·¸ë˜í”„ ì»´íŒŒì¼: âœ… í†µê³¼
ë¼ìš°í„° ë…¸ë“œ: âœ… í†µê³¼

============================================================
âš ï¸  ì¼ë¶€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨
============================================================
```

---

## ì£¼ì˜ ì‚¬í•­

1. **API í‚¤ ë¯¸ì„¤ì • ì‹œ**:
   - LLM í´ë¼ì´ì–¸íŠ¸ í…ŒìŠ¤íŠ¸ëŠ” ì‹¤íŒ¨
   - ê·¸ë˜í”„ êµ¬ì¡° ê²€ì¦ì€ ì •ìƒ ì‘ë™
   - ì‹¤ì œ LLM í˜¸ì¶œ ì—†ì´ êµ¬ì¡°ë§Œ í™•ì¸ ê°€ëŠ¥

2. **ë¸Œëœì¹˜ í™•ì¸**:
   - `feature/agent-system` ë¸Œëœì¹˜ì—ì„œ ì‹¤í–‰
   - ë‹¤ë¥¸ ë¸Œëœì¹˜ì—ì„œëŠ” íŒŒì¼ì´ ì—†ì„ ìˆ˜ ìˆìŒ

3. **ì˜ì¡´ì„± íŒ¨í‚¤ì§€**:
   - `langchain-openai>=0.3.35`
   - `langchain-upstage>=0.7.4`
   - `langgraph>=1.0.1`
   - `langchain-community>=0.3.31`
   - `langchain-core>=0.3.78`

4. **ì‹¤í–‰ ìœ„ì¹˜**:
   - í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰ ê¶Œì¥

---

## ê´€ë ¨ íŒŒì¼

- `src/llm/client.py`: LLM í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
- `src/agent/state.py`: AgentState ì •ì˜
- `src/agent/nodes.py`: Agent ë…¸ë“œ í•¨ìˆ˜
- `src/agent/graph.py`: Agent ê·¸ë˜í”„ êµ¬ì„±
