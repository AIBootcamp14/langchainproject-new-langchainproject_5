# 06. ë„êµ¬ ì‹œìŠ¤í…œ (7ê°€ì§€ ë„êµ¬)

## ğŸ“‹ ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-11-03
- **ì‘ì„±ì**: ìµœí˜„í™”[íŒ€ì¥]
- **ì‹œìŠ¤í…œëª…**: ë„êµ¬ ì‹œìŠ¤í…œ
- **êµ¬í˜„ íŒŒì¼**: `src/tools/` (7ê°œ íŒŒì¼)
- **ìš°ì„ ìˆœìœ„**: â­ (ë³´í†µ - ê¸°ëŠ¥ í™•ì¥)
- **ì°¸ê³  ë¬¸ì„œ**: [PRD/ìë£Œì¡°ì‚¬_05_AI_Agent_ë„êµ¬.md](../PRD/ìë£Œì¡°ì‚¬_05_AI_Agent_ë„êµ¬.md)

---

## ğŸ“Œ ì‹œìŠ¤í…œ ê°œìš”

### ëª©ì  ë° ë°°ê²½

ë„êµ¬ ì‹œìŠ¤í…œì€ **AI Agentê°€ ë‹¤ì–‘í•œ ì§ˆë¬¸ ìœ í˜•ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” 7ê°€ì§€ ë„êµ¬**ë¥¼ ì œê³µí•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤. `src/tools/` í´ë”ì— ê°ê° ë…ë¦½ëœ ëª¨ë“ˆë¡œ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë©°, LangGraphì˜ Router ë…¸ë“œê°€ ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ë„êµ¬ë¥¼ ìë™ìœ¼ë¡œ ì„ íƒí•©ë‹ˆë‹¤.

### ë„êµ¬(Tool)ì˜ ê°œë…

**ë„êµ¬(Tool)**ëŠ” AI Agentê°€ íŠ¹ì • ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” **í•¨ìˆ˜**ì…ë‹ˆë‹¤:

- LLMì´ ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì–´ë–¤ ë„êµ¬ë¥¼ ì‚¬ìš©í• ì§€ íŒë‹¨
- í•„ìš”í•œ ë„êµ¬ì˜ **arguments(ë§¤ê°œë³€ìˆ˜)**ë¥¼ ì¶”ì¶œ
- ë„êµ¬ë¥¼ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ ë°›ì•„ ìµœì¢… ë‹µë³€ ìƒì„±

**ì˜ˆì‹œ ë¼ìš°íŒ… íŒ¨í„´:**
- "ì•ˆë…•í•˜ì„¸ìš”" â†’ `general_answer` ë„êµ¬ ì‚¬ìš©
- "Transformer ë…¼ë¬¸ ì„¤ëª…í•´ì¤˜" â†’ `search_paper` ë„êµ¬ ì‚¬ìš©
- "2025ë…„ ìµœì‹  LLM ë…¼ë¬¸ì€?" â†’ `web_search` ë„êµ¬ ì‚¬ìš©

### OT ìë£Œ ìš”êµ¬ì‚¬í•­

| ìš”êµ¬ì‚¬í•­ | ì¶©ì¡± ì—¬ë¶€ | êµ¬í˜„ ë‚´ìš© |
|---------|-----------|-----------|
| **ì›¹ ê²€ìƒ‰ ê¸°ëŠ¥** | âœ… í•„ìˆ˜ | Tavily Search API í†µí•© |
| **íŒŒì¼ ì €ì¥ ê¸°ëŠ¥** | âœ… í•„ìˆ˜ | ExperimentManager í†µí•© ì €ì¥ |
| **3ê°œ ì´ìƒì˜ ë„êµ¬** | âœ… í•„ìˆ˜ | ì´ 7ê°œ ë„êµ¬ êµ¬í˜„ |
| **ì§ì ‘ êµ¬í˜„ ë„êµ¬** | âœ… í•„ìˆ˜ | RAG, ìš©ì–´ì§‘, ìš”ì•½, Text-to-SQL, íŒŒì¼ ì €ì¥ |
| **RAG ê¸°ëŠ¥** | âœ… ì„ íƒ (ê°€ì‚°ì ) | PostgreSQL + pgvector |
| **Text-to-SQL** | âœ… ì„ íƒ (ê°€ì‚°ì ) | ìì—°ì–´ â†’ SQL ë³€í™˜ |

---

## ğŸ—ï¸ 7ê°€ì§€ ë„êµ¬ ê°œìš”

### ë„êµ¬ ëª©ë¡

| ë„êµ¬ | íŒŒì¼ | ì„¤ëª… | DB ì—°ë™ | ë‚œì´ë„ ì§€ì› |
|------|------|------|---------|-------------|
| **ì¼ë°˜ ë‹µë³€** | `general_answer.py` | LLM ì§ì ‘ í˜¸ì¶œ | ì—†ìŒ | âœ… |
| **RAG ê²€ìƒ‰** | `search_paper.py` | ë…¼ë¬¸ DB ê²€ìƒ‰ (Top-5) | PostgreSQL + pgvector | âœ… |
| **ìš©ì–´ì§‘ ê²€ìƒ‰** | `glossary.py` | ìš©ì–´ ì •ì˜ ì¡°íšŒ | PostgreSQL | âœ… |
| **ì›¹ ê²€ìƒ‰** | `web_search.py` | Tavily API | ì—†ìŒ | âœ… |
| **ë…¼ë¬¸ ìš”ì•½** | `summarize.py` | ë…¼ë¬¸ ì „ì²´ ìš”ì•½ | PostgreSQL + pgvector | âœ… |
| **Text-to-SQL** | `text2sql.py` | ë…¼ë¬¸ í†µê³„ ì¡°íšŒ | PostgreSQL | âœ… |
| **íŒŒì¼ ì €ì¥** | `save_file.py` | ê²°ê³¼ë¬¼ ì €ì¥ | ExperimentManager | âŒ |

### ë„êµ¬ë³„ ë¼ìš°íŒ… íŒ¨í„´

| ì‚¬ìš©ì ì§ˆë¬¸ ì˜ˆì‹œ | ì„ íƒë˜ëŠ” ë„êµ¬ | ì„ íƒ ì´ìœ  |
|-----------------|---------------|----------|
| "ì•ˆë…•í•˜ì„¸ìš”" | `general_answer` | ê°„ë‹¨í•œ ì¸ì‚¬ |
| "Transformer ë…¼ë¬¸ ì„¤ëª…í•´ì¤˜" | `search_paper` | ë¡œì»¬ DB ë…¼ë¬¸ ê²€ìƒ‰ |
| "2025ë…„ ìµœì‹  LLM ë…¼ë¬¸ì€?" | `web_search` | ìµœì‹  ì •ë³´ í•„ìš” |
| "Attentionì´ ë­ì•¼?" | `glossary` | ìš©ì–´ ì •ì˜ ì§ˆë¬¸ |
| "BERT ë…¼ë¬¸ ìš”ì•½í•´ì¤˜" | `summarize` | íŠ¹ì • ë…¼ë¬¸ ìš”ì•½ |
| "2024ë…„ ë…¼ë¬¸ ëª‡ í¸?" | `text2sql` | í†µê³„ ì¡°íšŒ |
| "ì´ ë‚´ìš© ì €ì¥í•´ì¤˜" | `save_file` | íŒŒì¼ ì €ì¥ ìš”ì²­ |

---

## ğŸ”§ ë„êµ¬ 1: ì¼ë°˜ ë‹µë³€ (General Answer)

### ê¸°ëŠ¥

- LLM ìì²´ ì§€ì‹ìœ¼ë¡œ ì§ì ‘ ë‹µë³€
- ì¸ì‚¬, ì¼ë°˜ ìƒì‹ ì§ˆë¬¸ ì²˜ë¦¬
- ë‚œì´ë„ë³„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì ìš©

### ì‚¬ìš© ì‹œì 

- "ì•ˆë…•í•˜ì„¸ìš”"
- "RAGê°€ ë­ì•¼?"
- "AI Agentê°€ ë­ì•¼?"

### êµ¬í˜„ ìš”ì†Œ

**LLM ì„ íƒ:**
- **Easy ëª¨ë“œ**: Solar Pro2 (ë¹ ë¥´ê³  ê²½ì œì )
- **Hard ëª¨ë“œ**: GPT-5 (ì „ë¬¸ì  ë‹µë³€)

**í”„ë¡¬í”„íŠ¸ ì „ëµ:**
- Easy: "ì´ˆì‹¬ìë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì‰½ê³  ëª…í™•í•˜ê²Œ"
- Hard: "ê¸°ìˆ ì ì¸ ì„¸ë¶€ì‚¬í•­ì„ í¬í•¨í•˜ì—¬ ì •í™•í•˜ê³  ì „ë¬¸ì ìœ¼ë¡œ"

**íŠ¹ì§•:**
- DB ì—°ë™ ì—†ìŒ (ê°€ì¥ ë¹ ë¥¸ ì‘ë‹µ)
- Temperature: 0.7 (ìì—°ìŠ¤ëŸ¬ìš´ ë‹µë³€)
- ExperimentManager í†µí•© ë¡œê¹…

---

## ğŸ”§ ë„êµ¬ 2: RAG ê²€ìƒ‰ (Search Paper)

### ê¸°ëŠ¥

- ë…¼ë¬¸ DBì—ì„œ ìœ ì‚¬ë„ ê²€ìƒ‰ (Top-5)
- PostgreSQL papers í…Œì´ë¸” ì¡°íšŒ
- ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ êµ¬ì„±

### ì‚¬ìš© ì‹œì 

- "Transformer ë…¼ë¬¸ ì„¤ëª…í•´ì¤˜"
- "BERTì™€ GPTì˜ ì°¨ì´ì ì€?"
- "Attention ë©”ì»¤ë‹ˆì¦˜ì´ ë­ì•¼?"

### DB ì—°ë™

**Vector DB (pgvector):**
- í…Œì´ë¸”: `paper_chunks`
- ì„ë² ë”© ëª¨ë¸: `text-embedding-3-small`
- ê²€ìƒ‰ ë°©ì‹: ì½”ì‚¬ì¸ ìœ ì‚¬ë„ (Top-5)

**PostgreSQL:**
- í…Œì´ë¸”: `papers`
- ë©”íƒ€ë°ì´í„°: title, authors, publish_date, citation_count

### ì²˜ë¦¬ íë¦„

```
ì§ˆë¬¸ â†’ ì„ë² ë”© ë³€í™˜ â†’ pgvector ê²€ìƒ‰ (Top-5) â†’ ì»¨í…ìŠ¤íŠ¸ êµ¬ì„± â†’ LLM ë‹µë³€ ìƒì„±
```

### LLM ì„¤ì •

- ëª¨ë¸: GPT-5 (ë³µì¡í•œ ë…¼ë¬¸ ì„¤ëª…)
- Temperature: 0.7
- í”„ë¡¬í”„íŠ¸: ì°¸ê³  ë…¼ë¬¸ + ì§ˆë¬¸

---

## ğŸ”§ ë„êµ¬ 3: ìš©ì–´ì§‘ ê²€ìƒ‰ (Glossary)

### ê¸°ëŠ¥

- PostgreSQL glossary í…Œì´ë¸” ê²€ìƒ‰
- ë‚œì´ë„ë³„ ì„¤ëª… ì œê³µ (Easy/Hard)
- LLM ê¸°ë°˜ ìš©ì–´ ì¶”ì¶œ

### ì‚¬ìš© ì‹œì 

- "Attentionì´ ë­ì•¼?"
- "Fine-tuningì´ë€?"
- "BLEU ìŠ¤ì½”ì–´ ì„¤ëª…í•´ì¤˜"

### DB ìŠ¤í‚¤ë§ˆ

**glossary í…Œì´ë¸”:**
```sql
CREATE TABLE glossary (
    term VARCHAR PRIMARY KEY,
    definition TEXT,
    easy_explanation TEXT,
    hard_explanation TEXT,
    category VARCHAR
);
```

### ì²˜ë¦¬ íë¦„

```
ì§ˆë¬¸ â†’ LLM ìš©ì–´ ì¶”ì¶œ â†’ PostgreSQL ê²€ìƒ‰ â†’ ë‚œì´ë„ë³„ ì„¤ëª… ì„ íƒ â†’ ë‹µë³€ ë°˜í™˜
```

### ë‚œì´ë„ë³„ ì„¤ëª…

- **Easy**: `easy_explanation` í•„ë“œ ì‚¬ìš© (ì „ë¬¸ ìš©ì–´ ìµœì†Œí™”)
- **Hard**: `hard_explanation` í•„ë“œ ì‚¬ìš© (ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­)
- **Fallback**: ê¸°ë³¸ `definition` ì‚¬ìš©

### ìš©ì–´ ìë™ ì¶”ì¶œ ë° ì €ì¥

**ê¸°ëŠ¥:**

ìš©ì–´ì§‘ ê²€ìƒ‰ ë„êµ¬ì™€ ë³„ê°œë¡œ, **ë‹¤ë¥¸ ë„êµ¬ë“¤ì˜ LLM ë‹µë³€ì—ì„œ AI/ML ìš©ì–´ë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ glossary í…Œì´ë¸”ì— ì €ì¥**í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.

**ì²˜ë¦¬ íë¦„:**
```
ë„êµ¬ ì‹¤í–‰ â†’ LLM ë‹µë³€ ìƒì„± â†’ ìš©ì–´ ì¶”ì¶œ ëŒ€ìƒ ë„êµ¬ì¸ì§€ í™•ì¸
    â†“
(ëŒ€ìƒ ë„êµ¬ì¸ ê²½ìš°)
    â†“
ë‹µë³€ í…ìŠ¤íŠ¸ â†’ LLM ìš©ì–´ ì¶”ì¶œ â†’ ì •ì˜/ì„¤ëª… ìƒì„± â†’ glossary í…Œì´ë¸” ì €ì¥
```

**ìš©ì–´ ì¶”ì¶œ ëŒ€ìƒ ë„êµ¬ (í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸):**

| ë„êµ¬ | ìš©ì–´ ì¶”ì¶œ | ì´ìœ  |
|------|----------|------|
| `general_answer` | âœ… ì‹¤í–‰ | AI/ML ê°œë… ì„¤ëª… í¬í•¨ ê°€ëŠ¥ì„± ë†’ìŒ |
| `search_paper` | âœ… ì‹¤í–‰ | ë…¼ë¬¸ ì„¤ëª…ì— ì „ë¬¸ ìš©ì–´ ë‹¤ìˆ˜ í¬í•¨ |
| `web_search` | âœ… ì‹¤í–‰ | ìµœì‹  AI/ML ìš©ì–´ í¬í•¨ ê°€ëŠ¥ |
| `glossary` | âœ… ì‹¤í–‰ | ìš©ì–´ ì •ì˜ ë‹µë³€ ìì²´ê°€ ìš©ì–´ |
| `summarize` | âœ… ì‹¤í–‰ | ë…¼ë¬¸ ìš”ì•½ì— ì „ë¬¸ ìš©ì–´ í¬í•¨ |
| **`text2sql`** | **âŒ ì œì™¸** | **SQL ì¿¼ë¦¬ì™€ í†µê³„ ê²°ê³¼ë§Œ í¬í•¨ (ìš©ì–´ ì—†ìŒ)** |
| **`save_file`** | **âŒ ì œì™¸** | **íŒŒì¼ ì €ì¥ ì™„ë£Œ ë©”ì‹œì§€ë§Œ ë°˜í™˜ (ìš©ì–´ ì—†ìŒ)** |

**ì œì™¸ ì´ìœ :**

- **text2sql**: ë‹µë³€ì´ "ìƒì„±ëœ SQL: `SELECT COUNT(*) ...`" + "ê²°ê³¼: 42" í˜•íƒœë¡œ AI/ML ìš©ì–´ê°€ ì „í˜€ ì—†ìŒ
- **save_file**: ë‹µë³€ì´ "íŒŒì¼ ì €ì¥ ì™„ë£Œ" ë©”ì‹œì§€ë¿

**êµ¬í˜„ ìœ„ì¹˜:**

- **íŒŒì¼**: `ui/components/chat_interface.py` (298-318 ë¼ì¸)
- **í•¨ìˆ˜**: `handle_agent_response()`ì—ì„œ ë„êµ¬ ì‹¤í–‰ í›„ ìë™ í˜¸ì¶œ

**ì½”ë“œ ì˜ˆì‹œ:**
```python
# ìš©ì–´ ì¶”ì¶œì´ ì˜ë¯¸ ìˆëŠ” ë„êµ¬ë§Œ ì‹¤í–‰
GLOSSARY_ENABLED_TOOLS = {"general", "search_paper", "web_search", "glossary", "summarize"}

if tool_choice in GLOSSARY_ENABLED_TOOLS:
    saved_count = extract_and_save_terms(
        answer=answer,
        difficulty=difficulty,
        logger=exp_manager.logger
    )
    if saved_count > 0:
        st.toast(f"âœ… {saved_count}ê°œ ìš©ì–´ê°€ ìš©ì–´ì§‘ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
else:
    exp_manager.log_ui_interaction(f"ìš©ì–´ ì¶”ì¶œ ìŠ¤í‚µ (ë„êµ¬: {tool_choice})")
```

**ìš©ì–´ ì¶”ì¶œ í”„ë¡œì„¸ìŠ¤:**

1. LLMì—ê²Œ ë‹µë³€ í…ìŠ¤íŠ¸ ì „ë‹¬
2. AI/ML ê´€ë ¨ ì „ë¬¸ ìš©ì–´ ì‹ë³„ (ìµœëŒ€ 5ê°œ)
3. ê° ìš©ì–´ë³„ë¡œ ìƒì„±:
   - `term`: ìš©ì–´ëª…
   - `definition`: ê°„ë‹¨í•œ ì •ì˜ (1-2ë¬¸ì¥)
   - `easy_explanation`: ì´ˆë³´ììš© ì‰¬ìš´ ì„¤ëª… (ë¹„ìœ /ì˜ˆì‹œ í¬í•¨)
   - `hard_explanation`: ì „ë¬¸ê°€ìš© ìƒì„¸ ì„¤ëª… (ìˆ˜ì‹/ê¸°ìˆ  ì„¸ë¶€ì‚¬í•­)
   - `category`: ì¹´í…Œê³ ë¦¬ (ì˜ˆ: Deep Learning, NLP)
4. PostgreSQL glossary í…Œì´ë¸” ì €ì¥ (ì¤‘ë³µ ì²´í¬: `ON CONFLICT (term) DO NOTHING`)

**ì¥ì :**

- ìë™ìœ¼ë¡œ ìš©ì–´ì§‘ DB í™•ì¥
- í–¥í›„ glossary ë„êµ¬ ê²€ìƒ‰ ì‹œ í™œìš©
- ë¶ˆí•„ìš”í•œ LLM í˜¸ì¶œ ë°©ì§€ (text2sql, save_file ì œì™¸)
- ë¹„ìš© ì ˆê°

**ê´€ë ¨ íŒŒì¼:**

- `src/utils/glossary_extractor.py`: ìš©ì–´ ì¶”ì¶œ í•¨ìˆ˜ (`extract_and_save_terms()`)
- `ui/components/chat_interface.py`: ë„êµ¬ë³„ ì„ íƒì  í˜¸ì¶œ ë¡œì§

---

## ğŸ”§ ë„êµ¬ 4: ì›¹ ê²€ìƒ‰ (Web Search)

### ê¸°ëŠ¥

- Tavily Search API í˜¸ì¶œ
- ê²€ìƒ‰ ê²°ê³¼ LLM ì •ë¦¬
- ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ ì ìš©

### ì‚¬ìš© ì‹œì 

- "2025ë…„ ìµœì‹  LLM ë…¼ë¬¸ì€?"
- "GPT-5ê°€ ë‚˜ì™”ì–´?"
- "ì˜¤ëŠ˜ arXivì— ì˜¬ë¼ì˜¨ ë…¼ë¬¸ ì°¾ì•„ì¤˜"

### API ì„¤ì •

**Tavily Search API:**
- ìµœëŒ€ ê²€ìƒ‰ ê²°ê³¼: 5ê°œ
- API í‚¤: `.env` íŒŒì¼ í•„ìˆ˜ (`TAVILY_API_KEY`)

**ë˜ëŠ” DuckDuckGo (ë¬´ë£Œ ëŒ€ì•ˆ):**
- `langchain.tools.DuckDuckGoSearchRun` ì‚¬ìš© ê°€ëŠ¥

### ì²˜ë¦¬ íë¦„

```
ì§ˆë¬¸ â†’ Tavily API í˜¸ì¶œ â†’ ê²€ìƒ‰ ê²°ê³¼ í¬ë§·íŒ… â†’ LLM ì •ë¦¬ â†’ ë‹µë³€ ë°˜í™˜
```

### arXiv ë…¼ë¬¸ ìë™ ì €ì¥ ê¸°ëŠ¥

**ArxivPaperHandler í†µí•© (ì‹ ê·œ ê¸°ëŠ¥):**

ì›¹ ê²€ìƒ‰ ê²°ê³¼ì—ì„œ arXiv ë…¼ë¬¸ì„ ë°œê²¬í•˜ë©´ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  DBì— ì €ì¥í•©ë‹ˆë‹¤.

**ì²˜ë¦¬ ì›Œí¬í”Œë¡œìš°:**
```
ê²€ìƒ‰ ê²°ê³¼ â†’ arXiv URL ê°ì§€ â†’ ArxivPaperHandler í˜¸ì¶œ
    â†“
1. arXiv ID íŒŒì‹± (ì˜ˆ: "2301.12345")
    â†“
2. arXiv API ë©”íƒ€ë°ì´í„° ì¶”ì¶œ (ì œëª©, ì €ì, ì´ˆë¡, ë°œí–‰ì¼)
    â†“
3. PDF ë‹¤ìš´ë¡œë“œ (data/raw/ í´ë”)
    â†“
4. PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ (pypdf/PyPDF2/pdfplumber)
    â†“
5. papers í…Œì´ë¸” ì €ì¥ (ì¤‘ë³µ ì²´í¬ í¬í•¨)
    â†“
6. í…ìŠ¤íŠ¸ ì²­í‚¹ (1000ì ë‹¨ìœ„)
    â†“
7. ì„ë² ë”© ìƒì„± ë° pgvector ì €ì¥
    â†“
ë‹µë³€ì— ë…¼ë¬¸ ë§í¬ í¬í•¨ + DB ì €ì¥ ì™„ë£Œ
```

**êµ¬í˜„ íŒŒì¼:**
- `src/tools/arxiv_handler.py`: ArxivPaperHandler í´ë˜ìŠ¤
- `src/tools/web_search.py`: ArxivPaperHandler í†µí•© ë¡œì§

**ì£¼ìš” ë©”ì„œë“œ:**
- `parse_arxiv_url()`: URLì—ì„œ arXiv ID ì¶”ì¶œ
- `fetch_arxiv_metadata()`: arXiv API í˜¸ì¶œ
- `download_pdf()`: PDF ë‹¤ìš´ë¡œë“œ
- `extract_text_from_pdf()`: pypdfë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
- `save_to_papers_table()`: PostgreSQL papers í…Œì´ë¸” ì €ì¥
- `save_to_pgvector()`: ì„ë² ë”© ìƒì„± ë° ë²¡í„° DB ì €ì¥
- `process_arxiv_paper()`: ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰

**ì¥ì :**
- ì›¹ ê²€ìƒ‰ ì‹œ ìë™ìœ¼ë¡œ ë…¼ë¬¸ DB í™•ì¥
- í–¥í›„ RAG ê²€ìƒ‰ì—ì„œ í•´ë‹¹ ë…¼ë¬¸ ì‚¬ìš© ê°€ëŠ¥
- ì¤‘ë³µ ì²´í¬ë¡œ ë¶ˆí•„ìš”í•œ ì¬ë‹¤ìš´ë¡œë“œ ë°©ì§€
- ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ì›¹ ê²€ìƒ‰ ê²°ê³¼ëŠ” ì •ìƒ ë°˜í™˜

### íŠ¹í™” ê²€ìƒ‰ (ì„ íƒ)

- **arXiv API**: ë…¼ë¬¸ ì „ë¬¸ ê²€ìƒ‰ ì‚¬ì´íŠ¸ íŠ¹í™” âœ… **êµ¬í˜„ë¨** (ìë™ ì €ì¥)
- **Google Scholar API**: í•™ìˆ  ë…¼ë¬¸ ì „ìš© ê²€ìƒ‰

---

## ğŸ”§ ë„êµ¬ 5: ë…¼ë¬¸ ìš”ì•½ (Summarize) - 2025-11-04 ê°œì„ 

### ê¸°ëŠ¥

- PostgreSQL papers í…Œì´ë¸” ê²€ìƒ‰
- pgvector ë…¼ë¬¸ ì „ì²´ ì²­í¬ ì¡°íšŒ
- LangChain load_summarize_chain í†µí•©
- âœ… **summary.md ì €ì¥ ìœ„ì¹˜ ë³€ê²½** (ì‹ ê·œ)

### ì‚¬ìš© ì‹œì 

- "Attention is All You Need ë…¼ë¬¸ ìš”ì•½í•´ì¤˜"
- "BERT ë…¼ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì€?"
- "ì´ ë…¼ë¬¸ì˜ ì£¼ìš” ê¸°ì—¬ë„ëŠ” ë­ì•¼?"

### DB ì—°ë™

**PostgreSQL:**
- ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ì¡°íšŒ (title â†’ paper_id)

**pgvector:**
- `paper_id` í•„í„°ë¡œ ë…¼ë¬¸ ì „ì²´ ì²­í¬ ì¡°íšŒ (Top-10)
- ì²­í¬ë¥¼ ê²°í•©í•˜ì—¬ ì „ì²´ ë…¼ë¬¸ ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±

### ìš”ì•½ ì²´ì¸

**LangChain load_summarize_chain:**
- **chain_type**: "stuff" (ëª¨ë“  ì²­í¬ë¥¼ í•œ ë²ˆì— ì „ë‹¬)
- **ë‹¤ë¥¸ ì˜µì…˜**: "map_reduce", "refine" (ëŒ€ìš©ëŸ‰ ë…¼ë¬¸)

### ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸

**Easy ëª¨ë“œ:**
- ì „ë¬¸ ìš©ì–´ í’€ì–´ì„œ ì„¤ëª…
- í•µì‹¬ ì•„ì´ë””ì–´ 3ê°€ì§€
- ì‹¤ìƒí™œ ë¹„ìœ  í¬í•¨

**Hard ëª¨ë“œ:**
- ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ í¬í•¨
- ìˆ˜ì‹ ë° ì•Œê³ ë¦¬ì¦˜ ì„¤ëª…
- ê´€ë ¨ ì—°êµ¬ì™€ì˜ ë¹„êµ

### LLM ì„¤ì •

- ëª¨ë¸: GPT-5 (ì •í™•í•œ ìš”ì•½)
- Temperature: 0.0 (ì¼ê´€ì„± ì¤‘ì‹œ)

### summary.md ì €ì¥ (2025-11-04 ê°œì„ )

**ê°œì„  ë‚´ìš©**:
- âœ… **ì €ì¥ ìœ„ì¹˜ ë³€ê²½**: `outputs/summary.md` â†’ `outputs/summary/{ë…¼ë¬¸ì œëª©}.md`
- âœ… **ë…¼ë¬¸ ì œëª©ì„ íŒŒì¼ëª…ìœ¼ë¡œ ì‚¬ìš©**: íŠ¹ìˆ˜ë¬¸ì ì œê±° ë° ìµœëŒ€ 100ì ì œí•œ
- âœ… **summary í´ë” ìë™ ìƒì„±**: `outputs/summary/` í´ë” ìë™ ìƒì„±

**êµ¬í˜„ ì½”ë“œ** (`src/tools/summarize.py:255-268`):
```python
# summary í´ë”ì— ë…¼ë¬¸ ì œëª©ì„ íŒŒì¼ëª…ìœ¼ë¡œ ì €ì¥
summary_dir = exp_manager.outputs_dir / "summary"
summary_dir.mkdir(exist_ok=True)

# ë…¼ë¬¸ ì œëª©ì„ íŒŒì¼ëª…ìœ¼ë¡œ ì‚¬ìš© (íŠ¹ìˆ˜ë¬¸ì ì œê±°)
safe_title = "".join(c for c in title if c.isalnum() or c in (' ', '-', '_')).strip()
safe_title = safe_title.replace(' ', '_')[:100]  # ìµœëŒ€ 100ì

summary_file = summary_dir / f"{safe_title}.md"
with open(summary_file, 'w', encoding='utf-8') as f:
    f.write(summary_md)

if tool_logger:
    tool_logger.write(f"ë…¼ë¬¸ ìš”ì•½ ì €ì¥ ì™„ë£Œ: {summary_file.name}")
```

**íŒŒì¼ êµ¬ì¡° ì˜ˆì‹œ**:
```
outputs/
â””â”€â”€ summary/
    â”œâ”€â”€ Attention_is_All_You_Need.md
    â”œâ”€â”€ BERT_Pre-training_of_Deep_Bidirectional_Transformers.md
    â””â”€â”€ GPT-4_Technical_Report.md
```

**ë³€ê²½ ì „í›„ ë¹„êµ**:
- **ë³€ê²½ ì „**: `outputs/summary.md` (í•˜ë‚˜ì˜ íŒŒì¼ì— ë®ì–´ì“°ê¸°)
- **ë³€ê²½ í›„**: `outputs/summary/{ë…¼ë¬¸ì œëª©}.md` (ë…¼ë¬¸ë³„ ê°œë³„ íŒŒì¼)

**ì¥ì **:
- ì—¬ëŸ¬ ë…¼ë¬¸ ìš”ì•½ ì‹œ ê°ê° ë…ë¦½ íŒŒì¼ë¡œ ì €ì¥
- íŒŒì¼ëª…ë§Œ ë´ë„ ì–´ë–¤ ë…¼ë¬¸ì¸ì§€ í™•ì¸ ê°€ëŠ¥
- ìš”ì•½ ë‚´ì—­ ê´€ë¦¬ ìš©ì´

---

## ğŸ”§ ë„êµ¬ 6: íŒŒì¼ ì €ì¥ (Save File)

### ê¸°ëŠ¥

- ë‹µë³€ ë‚´ìš©ì„ íŒŒì¼ë¡œ ì €ì¥
- ExperimentManager.save_output() í†µí•©
- `experiments/{ë‚ ì§œ}/{ë‚ ì§œ}_{ì‹œê°„}_session_XXX/outputs/` í´ë”ì— ì €ì¥

### ì‚¬ìš© ì‹œì 

- "ì´ ìš”ì•½ ë‚´ìš© íŒŒì¼ë¡œ ì €ì¥í•´ì¤˜"
- "ì˜¤ëŠ˜ ëŒ€í™” ë‚´ìš© ì €ì¥í•˜ê³  ì‹¶ì–´"
- "ì°¾ì€ ë…¼ë¬¸ ë¦¬ìŠ¤íŠ¸ íŒŒì¼ë¡œ ë§Œë“¤ì–´ì¤˜"

### ì €ì¥ êµ¬ì¡°

**íŒŒì¼ ê²½ë¡œ ìƒì„±:**
```
experiments/20251103/20251103_103015_session_001/outputs/
â””â”€â”€ response_20251103_103015.txt
```

**ìë™ íŒŒì¼ëª… ìƒì„±:**
- íŒ¨í„´: `response_{YYYYMMDD}_{HHMMSS}.txt`
- ì‚¬ìš©ì ì§€ì • íŒŒì¼ëª…ë„ ì§€ì›

### ExperimentManager í†µí•©

```python
exp_manager.save_output(filename, content)
```

**ì¥ì :**
- ì„¸ì…˜ë³„ ìë™ í´ë” ê´€ë¦¬
- íŒŒì¼ ê²½ë¡œ ìë™ ì¶”ì  (metadata.json)
- ë¡œê¹… í†µí•©

---

## ğŸ”§ ë„êµ¬ 7: Text-to-SQL (ë…¼ë¬¸ í†µê³„ ì¡°íšŒ) - 2025-11-05 ê°œì„ 

### ê¸°ëŠ¥

- ìì—°ì–´ ì§ˆë¬¸ì„ SQL ì¿¼ë¦¬ë¡œ ìë™ ë³€í™˜
- PostgreSQL papers í…Œì´ë¸” í†µê³„ ì¡°íšŒ
- í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ë³´ì•ˆ ê²€ì¦
- âœ… **ë‚œì´ë„ë³„ ë‹µë³€ ìƒì„±** (ì‹ ê·œ - 2025-11-05)
- Markdown í‘œ í˜•ì‹ ê²°ê³¼ ë°˜í™˜

### ì‚¬ìš© ì‹œì 

- "2024ë…„ì— ë°œí‘œëœ ë…¼ë¬¸ ê°œìˆ˜ëŠ”?"
- "ì¹´í…Œê³ ë¦¬ë³„ ë…¼ë¬¸ ìˆ˜ë¥¼ ë³´ì—¬ì¤˜"
- "AI ê´€ë ¨ ë…¼ë¬¸ ì¤‘ ê°€ì¥ ì¸ìš©ì´ ë§ì€ ê±´?"
- "ì €ìê°€ 3ëª… ì´ìƒì¸ ë…¼ë¬¸ì€ ëª‡ í¸ì´ì•¼?"
- "2021ë…„ ì´í›„ ë°œí‘œëœ ë…¼ë¬¸ë“¤ì˜ í‰ê·  ì¸ìš©ìˆ˜ëŠ”?"

### ë³´ì•ˆ ê¸°ëŠ¥

**í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ì ‘ê·¼ ì œì–´:**

Text-to-SQLì€ ë³´ì•ˆì„ ìœ„í•´ **í—ˆìš©ëœ í…Œì´ë¸”ê³¼ ì»¬ëŸ¼ë§Œ** ì‚¬ìš©í•©ë‹ˆë‹¤.

**í—ˆìš© í…Œì´ë¸”:**
- `papers` (ë…¼ë¬¸ ë©”íƒ€ë°ì´í„°)

**í—ˆìš© ì»¬ëŸ¼:**
```python
{
    "paper_id", "title", "authors", "publish_date",
    "source", "url", "category", "citation_count",
    "abstract", "created_at", "updated_at"
}
```

**ê¸ˆì§€ íŒ¨í„´ (ìë™ ì°¨ë‹¨):**
- **DDL ëª…ë ¹**: `DROP`, `ALTER`, `TRUNCATE`, `CREATE`
- **DML ëª…ë ¹**: `INSERT`, `UPDATE`, `DELETE`
- **ê¶Œí•œ ëª…ë ¹**: `GRANT`, `REVOKE`
- **ê¸°íƒ€**: `COPY`, SQL ì£¼ì„ (`--`, `/* */`)

**ì½ê¸° ì „ìš© ì¿¼ë¦¬ë§Œ í—ˆìš©:**
- `SELECT` ì¿¼ë¦¬ë§Œ í—ˆìš©
- `WITH` (CTE) í—ˆìš©
- ì§‘ê³„ê°€ ì•„ë‹Œ ê²°ê³¼ëŠ” ìë™ìœ¼ë¡œ `LIMIT 100` ì ìš©

### DB ì—°ë™

**PostgreSQL papers í…Œì´ë¸”:**
```sql
CREATE TABLE papers (
    paper_id SERIAL PRIMARY KEY,
    title TEXT NOT NULL,
    authors TEXT,
    publish_date DATE,
    source VARCHAR(50),
    url TEXT,
    category VARCHAR(100),
    citation_count INTEGER,
    abstract TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**ìŠ¤í‚¤ë§ˆ ìë™ ì¶”ì¶œ:**
- `information_schema.columns`ì—ì„œ í—ˆìš© í…Œì´ë¸”/ì»¬ëŸ¼ë§Œ ì¶”ì¶œ
- LLMì—ê²Œ ìŠ¤í‚¤ë§ˆ ì •ë³´ ì œê³µí•˜ì—¬ ì •í™•í•œ SQL ìƒì„±

### ì²˜ë¦¬ íë¦„

```
ì‚¬ìš©ì ì§ˆë¬¸ â†’ ìŠ¤í‚¤ë§ˆ ì •ë³´ ìˆ˜ì§‘ â†’ LLM SQL ìƒì„± â†’ ë³´ì•ˆ ê²€ì¦
    â†“
SQL ì¶”ì¶œ (ì½”ë“œíœìŠ¤ ì œê±°) â†’ ê¸ˆì§€ íŒ¨í„´ ê²€ì‚¬ â†’ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦
    â†“
LIMIT ìë™ ì¶”ê°€ â†’ EXPLAIN ê²€ì¦ â†’ SQL ì‹¤í–‰ â†’ Markdown í‘œ ìƒì„±
    â†“
ê²°ê³¼ ë°˜í™˜ + query_logs í…Œì´ë¸” ë¡œê¹…
```

### LLM ì„¤ì •

**ëª¨ë¸ ì„ íƒ (config ê¸°ë°˜):**
- ê¸°ë³¸ ëª¨ë¸: **Solar Pro2** (`configs/model_config.yaml`)
- Provider: `solar` ë˜ëŠ” `openai`
- Temperature: **0.0** (ê²°ì •ë¡ ì  SQL ìƒì„±)

**Few-shot í•™ìŠµ:**

Text-to-SQLì€ 5ê°œì˜ Few-shot ì˜ˆì‹œë¥¼ LLMì—ê²Œ ì œê³µí•˜ì—¬ ì •í™•í•œ SQL ìƒì„±ì„ ìœ ë„í•©ë‹ˆë‹¤.

| ì§ˆë¬¸ | ìƒì„± SQL |
|------|---------|
| "2024ë…„ì— ë°œí‘œëœ ë…¼ë¬¸ ê°œìˆ˜ëŠ”?" | `SELECT COUNT(*) FROM papers WHERE EXTRACT(YEAR FROM publish_date)=2024;` |
| "ì¹´í…Œê³ ë¦¬ë³„ ë…¼ë¬¸ ìˆ˜ë¥¼ ë³´ì—¬ì¤˜" | `SELECT category, COUNT(*) FROM papers GROUP BY category ORDER BY COUNT(*) DESC LIMIT 100;` |
| "2021ë…„ ì´í›„ ë…¼ë¬¸ì˜ í‰ê·  ì¸ìš©ìˆ˜ëŠ”?" | `SELECT AVG(citation_count) FROM papers WHERE publish_date >= DATE '2021-01-01';` |
| "AI ê´€ë ¨ ë…¼ë¬¸ ì¤‘ ê°€ì¥ ì¸ìš©ì´ ë§ì€ ê±´?" | `SELECT title, citation_count FROM papers WHERE category ILIKE '%AI%' ORDER BY citation_count DESC LIMIT 1;` |
| "ì €ìê°€ 3ëª… ì´ìƒì¸ ë…¼ë¬¸ì€ ëª‡ í¸?" | `SELECT COUNT(*) FROM papers WHERE array_length(string_to_array(authors, ','), 1) >= 3;` |

**í”„ë¡¬í”„íŠ¸ ì „ëµ:**
```python
"""You are a careful Text-to-SQL generator for PostgreSQL.

Rules:
- Output ONLY a single SQL query with no extra prose.
- SELECT / WITH (CTE) only. No writes/DDL/GRANT.
- Use only whitelisted table and columns.
- Prefer COUNT/SUM/AVG/MAX/MIN for numeric answers.
- For year filters, use EXTRACT(YEAR FROM publish_date).
- Add LIMIT 100 when returning rows (non-aggregate).
"""
```

### ì•ˆì „ì„± ê²€ì¦

**1. SQL ì¶”ì¶œ:**
- LLM ì‘ë‹µì—ì„œ ì½”ë“œíœìŠ¤ ì œê±° (```` ```sql ... ``` ````)
- ë¶ˆí•„ìš”í•œ ì£¼ì„/ë¬¸ì¥ ì œê±°

**2. ê¸ˆì§€ íŒ¨í„´ ê²€ì‚¬:**
```python
_FORBIDDEN_PATTERNS = [
    r"\bdrop\b", r"\balter\b", r"\btruncate\b", r"\binsert\b",
    r"\bupdate\b", r"\bdelete\b", r"\bgrant\b", r"\brevoke\b",
    r"\bcopy\b", r"\bcreate\b", r";\s*--", r"/\*", r"\*/"
]
```

**3. í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦:**
- `FROM`/`JOIN` ì ˆì—ì„œ í…Œì´ë¸” ì¶”ì¶œ
- `ALLOWED_TABLES`ì— í¬í•¨ë˜ì§€ ì•Šì€ í…Œì´ë¸”ì€ ì¦‰ì‹œ ì°¨ë‹¨
- ê´„í˜¸ ì•ˆì˜ `FROM` (ì˜ˆ: `EXTRACT(YEAR FROM ...)`)ì€ ë¬´ì‹œ

**4. LIMIT ìë™ ì¶”ê°€:**
- ì§‘ê³„ í•¨ìˆ˜ (`COUNT`, `AVG`, `SUM` ë“±)ê°€ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ `LIMIT 100` ì¶”ê°€
- ì´ë¯¸ `LIMIT`ì´ ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ìœ ì§€

**5. EXPLAIN ê²€ì¦:**
- ì‹¤í–‰ ì „ `EXPLAIN` ëª…ë ¹ìœ¼ë¡œ ì‹¤í–‰ ê³„íš í™•ì¸
- ë„ˆë¬´ í° Seq Scan ê°ì§€ ì‹œ ì°¨ë‹¨ ê°€ëŠ¥ (í˜„ì¬ëŠ” í†µê³¼)

### ê²°ê³¼ ë°˜í™˜ í˜•ì‹

**ì„±ê³µ ì‹œ:**
```markdown
**ì§ˆë¬¸**: 2024ë…„ì— ë°œí‘œëœ ë…¼ë¬¸ ê°œìˆ˜ëŠ”?

**ìƒì„±ëœ SQL**:
```sql
SELECT COUNT(*) AS paper_count FROM papers WHERE EXTRACT(YEAR FROM publish_date)=2024;
```

**ê²°ê³¼**:

paper_count
---
42
```

**ì‹¤íŒ¨ ì‹œ:**
```markdown
**ì§ˆë¬¸**: papers í…Œì´ë¸” ì‚­ì œí•´ì¤˜

**ìƒì„±ëœ SQL(ê²€ì¦ ì „)**:
```sql
DROP TABLE papers;
```

ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:
```
ValueError: ê¸ˆì§€ëœ SQL íŒ¨í„´ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.
```
```

### ë¡œê¹…

**query_logs í…Œì´ë¸”:**
- ëª¨ë“  Text-to-SQL ìš”ì²­ì„ `query_logs` í…Œì´ë¸”ì— ê¸°ë¡
- ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€, ì‘ë‹µ ì‹œê°„, ì—ëŸ¬ ë©”ì‹œì§€ ì €ì¥

**ë¡œê·¸ ìŠ¤í‚¤ë§ˆ:**
```sql
CREATE TABLE query_logs (
    log_id SERIAL PRIMARY KEY,
    user_query TEXT,
    difficulty_mode VARCHAR(10),
    tool_used VARCHAR(50),
    response TEXT,
    response_time_ms INTEGER,
    success BOOLEAN,
    error_message TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### íŠ¹ì§• ë° ì¥ì 

**ì¥ì :**
- ìì—°ì–´ â†’ SQL ë³€í™˜ ìë™í™” (ì‚¬ìš©ì SQL ì§€ì‹ ë¶ˆí•„ìš”)
- í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ë³´ì•ˆ (DB ì†ìƒ ë°©ì§€)
- Few-shot í•™ìŠµìœ¼ë¡œ ì •í™•ë„ í–¥ìƒ
- Markdown í‘œ í˜•ì‹ìœ¼ë¡œ ê°€ë…ì„± ë†’ì€ ê²°ê³¼
- ìë™ ë¡œê¹…ìœ¼ë¡œ ì¿¼ë¦¬ ì¶”ì  ê°€ëŠ¥

**ì œì•½ì‚¬í•­:**
- í˜„ì¬ëŠ” `papers` í…Œì´ë¸”ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- ë³µì¡í•œ JOIN/ì„œë¸Œì¿¼ë¦¬ëŠ” ì œí•œì 
- `glossary` í…Œì´ë¸” ë“± ì¶”ê°€ í…Œì´ë¸”ì€ í–¥í›„ í™•ì¥ ì˜ˆì •

**ë¹„ìš©:**
- LLM í˜¸ì¶œ 2íšŒ (SQL ìƒì„± + ë‚œì´ë„ë³„ ë‹µë³€ ìƒì„±)
- í‰ê·  ì‘ë‹µ ì‹œê°„: 3-5ì´ˆ

### ë‚œì´ë„ë³„ ë‹µë³€ ìƒì„± (2025-11-05 ì‹ ê·œ)

**ê°œì„  ë‚´ìš©**:
âœ… **SQL ì‹¤í–‰ ê²°ê³¼ë¥¼ ë‚œì´ë„ì— ë§ê²Œ í•´ì„í•˜ì—¬ ë‹µë³€ ìƒì„±**

ê¸°ì¡´ì—ëŠ” SQL ì¿¼ë¦¬ì™€ Markdown í‘œë§Œ ë°˜í™˜í–ˆìœ¼ë‚˜, ì´ì œëŠ” ì‚¬ìš©ìì˜ ë‚œì´ë„ ìˆ˜ì¤€ì— ë§ëŠ” ì„¤ëª…ì„ ì¶”ê°€ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

**ì²˜ë¦¬ íë¦„**:
```
ì‚¬ìš©ì ì§ˆë¬¸ â†’ SQL ìƒì„± ë° ì‹¤í–‰ â†’ Markdown í‘œ ìƒì„±
    â†“
ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ ë¡œë“œ (prompts/tool_prompts.json)
    â†“
SQL + ê²°ê³¼ í…Œì´ë¸”ì„ LLMì—ê²Œ ì „ë‹¬
    â†“
ë‚œì´ë„ì— ë§ëŠ” ìµœì¢… ë‹µë³€ ìƒì„± (Elementary/Beginner/Intermediate/Advanced)
```

**ë‚œì´ë„ë³„ ë‹µë³€ ìŠ¤íƒ€ì¼**:

| ë‚œì´ë„ | ë‹µë³€ ìŠ¤íƒ€ì¼ | ì£¼ìš” íŠ¹ì§• |
|--------|------------|-----------|
| **Elementary** (ì´ˆë“±í•™ìƒ) | ì¬ë¯¸ìˆëŠ” ì„¤ëª… | ì´ëª¨ì§€, ë¹„ìœ , ì‹œê°ì  í‘œí˜„, ì§§ì€ ë¬¸ì¥ |
| **Beginner** (ì´ˆê¸‰ì) | ë³´ê¸° ì¢‹ê²Œ ì •ë¦¬ | í‘œ í˜•ì‹, ì¸ì‚¬ì´íŠ¸ ìš”ì•½, ì¹œê·¼í•œ í†¤ |
| **Intermediate** (ì¤‘ê¸‰ì) | ì „ë¬¸ ë¶„ì„ | Executive Summary, ì¶”ê°€ í†µê³„, ì¶”ì„¸ ë¶„ì„, ì‹œê°í™” ì œì•ˆ |
| **Advanced** (ê³ ê¸‰ì) | í•™ìˆ ì  ë¶„ì„ | í†µê³„ì  ë°©ë²•ë¡ , ê°€ì„¤ ê²€ì •, ì´ìƒì¹˜ ë¶„ì„, ì¶”ê°€ ì—°êµ¬ ë°©í–¥ |

**ì˜ˆì‹œ - "2024ë…„ì— ë°œí‘œëœ ë…¼ë¬¸ ê°œìˆ˜ëŠ”?"**:

Elementary ë‹µë³€:
```markdown
ì™€! ğŸ‰ **2024ë…„ì— ë°œí‘œëœ ë…¼ë¬¸ì€ ì´ 27ê°œ**ì˜ˆìš”! ğŸ“„ğŸ“š

> ğŸ“Š **ë§‰ëŒ€ ê·¸ë˜í”„ë¡œ ë³´ë©´?**
> ğŸ“ˆğŸ“ˆğŸ“ˆğŸ“ˆğŸ“ˆ (5ê°œ) Ã— 5ë²ˆ = **27ê°œ**

> ğŸŒŸ **ë¹„ìœ ë¡œ ì„¤ëª…í•´ìš”**
> "ìš°ë¦¬ ë°˜ì— í•™ìƒì´ 27ëª…ì´ë¼ë©´, ëª¨ë‘ê°€ 2024ë…„ì— ìƒˆ ë…¼ë¬¸ì„ ì“´ ì…ˆì´ì£ !"
```

Advanced ë‹µë³€:
```markdown
### 1. Abstract (í•µì‹¬ ìš”ì•½)
2024ë…„ì— ë°œí‘œëœ ë…¼ë¬¸ ìˆ˜ëŠ” ì´ **27í¸**ì…ë‹ˆë‹¤. ë³¸ ë¶„ì„ì€ ë‹¨ì¼ ì—°ë„ ê¸°ìˆ í†µê³„ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë¶„í¬ íŠ¹ì„±, í†µê³„ì  ìœ ì˜ì„±, ì´ìƒì¹˜ ê²€ì¶œ ë“±ì„ ìˆ˜í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

### 2. ë°ì´í„° ê¸°ìˆ í†µê³„ (Descriptive Statistics)
- **í‘œë³¸ í¬ê¸° (n)**: 1 (ë‹¨ì¼ ì—°ë„)
- **ë…¼ë¬¸ ìˆ˜**: 27í¸

> **ìˆ˜í•™ì  í‘œí˜„**: \( \text{Mean} = 27 \)

### 4. í†µê³„ì  ê²€ì • (Statistical Tests)
- **ê°€ì„¤ ì„¤ì •**: \( H_0 \): 2024ë…„ ë…¼ë¬¸ ìˆ˜ëŠ” ê³¼ê±° í‰ê· ê³¼ ì°¨ì´ ì—†ìŒ
- **ê²€ì • ë°©ë²•**: ë‹¨ì¼ í‘œë³¸ t-ê²€ì • í•„ìš” (ê³¼ê±° ë°ì´í„° í™•ë³´ ì‹œ)
```

**êµ¬í˜„ ì½”ë“œ** (`src/tools/text2sql.py:386-443`):
```python
# SQL ì‹¤í–‰ ë° í…Œì´ë¸” ìƒì„±
cols, rows = _run_query(sql_ready)
table_md = _to_markdown_table(cols, rows)

# ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ ë¡œë“œ
system_prompt = get_tool_prompt("text2sql", difficulty)

# ë°ì´í„°ë² ì´ìŠ¤ ê²°ê³¼ í¬ë§·íŒ…
db_results = f"**ìƒì„±ëœ SQL**:\n```sql\n{sql_ready}\n```\n\n**ê²°ê³¼ í…Œì´ë¸”**:\n{table_md}"

# user_prompt_template ë¡œë“œ
from src.prompts.loader import load_tool_prompts, map_difficulty
tool_prompts_data = load_tool_prompts()
mapped_diff = map_difficulty(difficulty)
complexity_level = "easy" if mapped_diff in ["elementary", "beginner"] else "hard"
user_template = tool_prompts_data["text2sql_prompts"][complexity_level][mapped_diff]["user_prompt_template"]

# LLM í˜¸ì¶œí•˜ì—¬ ìµœì¢… ë‹µë³€ ìƒì„±
final_answer_raw = llm_client.llm.invoke([
    SystemMessage(content=system_prompt),
    HumanMessage(content=user_template.format(db_results=db_results, question=user_question))
]).content
```

**í”„ë¡¬í”„íŠ¸ íŒŒì¼** (`prompts/tool_prompts.json:321-347`):
- Elementary: ì´ëª¨ì§€ì™€ ë¹„ìœ  ì‚¬ìš©, ì‹œê°ì  í‘œí˜„, ì§§ì€ ì„¤ëª…
- Beginner: í‘œ í˜•ì‹ ì •ë¦¬, ì¸ì‚¬ì´íŠ¸ ìš”ì•½, ì¹œê·¼í•œ í†¤
- Intermediate: ì „ë¬¸ ë¶„ì„, ì¶”ê°€ í†µê³„ ê³„ì‚° (í‰ê· , ë¹„ìœ¨), ì‹œê°í™” ì œì•ˆ
- Advanced: í•™ìˆ ì  ë¶„ì„, í†µê³„ì  ë°©ë²•ë¡  (t-test, ANOVA), ê°€ì„¤ ê²€ì •, ì´ìƒì¹˜ ë¶„ì„

**Fallback ì²˜ë¦¬**:
í”„ë¡¬í”„íŠ¸ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ ë°©ì‹(SQL + Markdown í‘œ)ìœ¼ë¡œ ìë™ ì „í™˜

**ê´€ë ¨ íŒŒì¼**:
- `prompts/tool_prompts.json` - text2sql_prompts ì •ì˜
- `src/tools/text2sql.py` - ë‚œì´ë„ë³„ ë‹µë³€ ìƒì„± ë¡œì§
- `src/agent/nodes.py` - text2sql_nodeì—ì„œ difficulty ì „ë‹¬

---

## ğŸ”„ ë¼ìš°íŒ… ì‹œìŠ¤í…œ

### LLM ê¸°ë°˜ ë„êµ¬ ì„ íƒ

AI Agentì˜ **Router ë…¸ë“œ**ê°€ ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ë„êµ¬ë¥¼ ìë™ìœ¼ë¡œ ì„ íƒí•©ë‹ˆë‹¤.

### LangGraph êµ¬ì¡°

```python
from langgraph.graph import StateGraph, END

class AgentState(TypedDict):
    question: str
    difficulty: str
    tool_choice: str  # ì„ íƒëœ ë„êµ¬ ì´ë¦„
    tool_result: str
    final_answer: str
    messages: Sequence[BaseMessage]

    # Fallback Chain í•„ë“œ (ì„ íƒì )
    retry_count: int              # ì¬ì‹œë„ íšŸìˆ˜
    failed_tools: List[str]       # ì‹¤íŒ¨í•œ ë„êµ¬ ë¦¬ìŠ¤íŠ¸
    question_type: str            # ì§ˆë¬¸ ìœ í˜• (7ê°€ì§€)
    fallback_chain: List[str]     # ë„êµ¬ ìš°ì„ ìˆœìœ„ ë¦¬ìŠ¤íŠ¸
    tool_status: str              # ë„êµ¬ ì‹¤í–‰ ìƒíƒœ
```

**ë…¸ë“œ êµ¬ì„±:**
- **router**: ì§ˆë¬¸ ë¶„ì„ ë° ë„êµ¬ ì„ íƒ
- **general_answer_node**: ì¼ë°˜ ë‹µë³€ ë„êµ¬ ì‹¤í–‰
- **search_paper_node**: RAG ê²€ìƒ‰ ë„êµ¬ ì‹¤í–‰
- **glossary_node**: ìš©ì–´ì§‘ ê²€ìƒ‰ ë„êµ¬ ì‹¤í–‰
- **web_search_node**: ì›¹ ê²€ìƒ‰ ë„êµ¬ ì‹¤í–‰
- **summarize_node**: ë…¼ë¬¸ ìš”ì•½ ë„êµ¬ ì‹¤í–‰
- **text2sql_node**: Text-to-SQL ë„êµ¬ ì‹¤í–‰
- **save_file_node**: íŒŒì¼ ì €ì¥ ë„êµ¬ ì‹¤í–‰
- **fallback_router** (ì‹ ê·œ): ë„êµ¬ ì‹¤íŒ¨ ì‹œ ë‹¤ìŒ ë„êµ¬ ì„ íƒ
- **validator** (ì‹ ê·œ): Router ì„ íƒ ê²€ì¦
- **final_fallback** (ì‹ ê·œ): ìµœì¢… Fallback (general ê°•ì œ ì‹¤í–‰)

**ì—£ì§€ ì—°ê²°:**
```python
# Fallback Chain ë¹„í™œì„±í™” ì‹œ (ê¸°ì¡´ ë™ì‘)
workflow.add_conditional_edges(
    "router",
    lambda state: state["tool_choice"],
    {
        "general_answer": "general_answer_node",
        "search_paper": "search_paper_node",
        "glossary": "glossary_node",
        "web_search": "web_search_node",
        "summarize": "summarize_node",
        "text2sql": "text2sql_node",
        "save_file": "save_file_node"
    }
)

# Fallback Chain í™œì„±í™” ì‹œ (ì‹ ê·œ)
# Router â†’ Validator â†’ ë„êµ¬ ì‹¤í–‰ â†’ Fallback ì²´í¬ â†’ Fallback Router
```

### Router ë¡œì§

**Solar Pro2 ì‚¬ìš©:**
- Temperature: 0.0 (ê²°ì •ë¡ ì  ë¼ìš°íŒ…)
- ë¹ ë¥´ê³  ì €ë ´ (ë¹„ìš© ì ˆê°)

**ë¼ìš°íŒ… ê²°ì • ê¸°ì¤€:**
| ì§ˆë¬¸ í‚¤ì›Œë“œ | ë„êµ¬ ì„ íƒ |
|------------|----------|
| "ì•ˆë…•", "ê³ ë§ˆì›Œ" | general_answer |
| "ë…¼ë¬¸", "ì„¤ëª…", "ì°¨ì´" | search_paper |
| "ì •ì˜", "ë­ì•¼", "ìš©ì–´" | glossary |
| "ìµœì‹ ", "2025ë…„", "ì›¹" | web_search |
| "ìš”ì•½", "í•µì‹¬ ë‚´ìš©" | summarize |
| "ê°œìˆ˜", "ëª‡ í¸", "í†µê³„" | text2sql |
| "ì €ì¥", "íŒŒì¼" | save_file |

### Fallback Chain ë©”ì»¤ë‹ˆì¦˜ (ì‹ ê·œ)

**ê°œìš”:**
ë„êµ¬ ì‹¤í–‰ ì‹¤íŒ¨ ì‹œ ìë™ìœ¼ë¡œ ë‹¤ìŒ ìš°ì„ ìˆœìœ„ ë„êµ¬ë¡œ ì „í™˜í•˜ì—¬ ì‚¬ìš©ì ì§ˆë¬¸ì— í•­ìƒ ì ì ˆí•œ ë‹µë³€ì„ ì œê³µí•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.

**í•µì‹¬ ê¸°ëŠ¥:**
1. **ë„êµ¬ ì‹¤í–‰ ì‹¤íŒ¨ ê°ì§€**: ë„êµ¬ ì‹¤í–‰ ê²°ê³¼ì—ì„œ ì‹¤íŒ¨ íŒ¨í„´ ìë™ ê°ì§€
2. **ì§ˆë¬¸ ìœ í˜• ë¶„ë¥˜**: 7ê°€ì§€ ì§ˆë¬¸ ìœ í˜•ìœ¼ë¡œ ìë™ ë¶„ë¥˜ (LLM ê¸°ë°˜)
3. **ìš°ì„ ìˆœìœ„ ê¸°ë°˜ Fallback**: ì§ˆë¬¸ ìœ í˜•ë³„ ë„êµ¬ ìš°ì„ ìˆœìœ„ ì²´ì¸ ì‹¤í–‰
4. **Router ê²€ì¦**: LLMì´ Routerì˜ ë„êµ¬ ì„ íƒì„ ê²€ì¦í•˜ì—¬ ì •í™•ë„ í–¥ìƒ
5. **ìµœì¢… Fallback**: ëª¨ë“  ë„êµ¬ ì‹¤íŒ¨ ì‹œ general ë„êµ¬ ê°•ì œ ì‹¤í–‰

**7ê°€ì§€ ì§ˆë¬¸ ìœ í˜• ë° ìš°ì„ ìˆœìœ„:**
- **term_definition** (ìš©ì–´ ì •ì˜): `glossary â†’ general`
- **paper_search** (ë…¼ë¬¸ ê²€ìƒ‰): `search_paper â†’ web_search â†’ general`
- **latest_research** (ìµœì‹  ì—°êµ¬): `web_search â†’ search_paper â†’ general`
- **paper_summary** (ë…¼ë¬¸ ìš”ì•½): `summarize â†’ search_paper â†’ general`
- **statistics** (í†µê³„ ì •ë³´): `text2sql â†’ general`
- **general_question** (ì¼ë°˜ ì§ˆë¬¸): `general`
- **file_save** (íŒŒì¼ ì €ì¥): `save_file`

**ì„¤ì • íŒŒì¼ (configs/model_config.yaml):**
```yaml
fallback_chain:
  enabled: true              # Fallback Chain í™œì„±í™”
  max_retries: 3             # ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜
  validation_enabled: true   # Router ê²€ì¦ í™œì„±í™”
  validation_retries: 2      # ê²€ì¦ ì¬ì‹œë„ íšŸìˆ˜
  priorities:
    term_definition:
      - glossary
      - general
    paper_search:
      - search_paper
      - web_search
      - general
    # ... (ë‚˜ë¨¸ì§€ ìš°ì„ ìˆœìœ„)
```

**Fallback ì‹¤í–‰ íë¦„ ì˜ˆì‹œ:**
```
ì‚¬ìš©ì: "mlì´ ë­ì•¼?"
    â†“
Router: glossary ì„ íƒ
    â†“
Glossary ì‹¤í–‰: "ê´€ë ¨ ìš©ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤." (ì‹¤íŒ¨)
    â†“
Fallback Router: ë‹¤ìŒ ë„êµ¬ ì„ íƒ (general)
    â†“
General ì‹¤í–‰: "MLì€ Machine Learningì˜ ì•½ìë¡œ..." (ì„±ê³µ)
    â†“
END
```

**êµ¬í˜„ íŒŒì¼:**
- `src/agent/graph.py` - Fallback Chain ê·¸ë˜í”„ êµ¬ì„±
- `src/agent/nodes.py` - fallback_router_node, validate_tool_choice_node
- `src/agent/failure_detector.py` - ì‹¤íŒ¨ íŒ¨í„´ ê°ì§€
- `src/agent/question_classifier.py` - ì§ˆë¬¸ ìœ í˜• ë¶„ë¥˜
- `src/agent/config_loader.py` - Fallback ì„¤ì • ë¡œë”
- `src/agent/tool_wrapper.py` - ë„êµ¬ ìƒíƒœ ìë™ ì„¤ì •

**ìƒì„¸ ë¬¸ì„œ:**
- **[09-1_ë„êµ¬_ìë™ì „í™˜_ê¸°ëŠ¥.md](./09-1_ë„êµ¬_ìë™ì „í™˜_ê¸°ëŠ¥.md)** - Fallback Chain ìƒì„¸ ì„¤ëª…

---

## ğŸ¯ ë‚œì´ë„ë³„ ë‹µë³€ ëª¨ë“œ

### Easy ëª¨ë“œ (ì´ˆì‹¬ì)

**íŠ¹ì§•:**
- ì „ë¬¸ ìš©ì–´ ìµœì†Œí™” â†’ ì‰¬ìš´ ë§ë¡œ í’€ì–´ì„œ ì„¤ëª…
- ë¹„ìœ ì™€ ì˜ˆì‹œ ë§ì´ ì‚¬ìš©
- ë‹¨ê³„ë³„ ì„¤ëª… (1, 2, 3 ìˆœì„œ)
- ìˆ˜ì‹ ìµœì†Œí™”

**í”„ë¡¬í”„íŠ¸ ì „ëµ:**
```
ë‹¹ì‹ ì€ AI/ML ì´ˆì‹¬ìë¥¼ ìœ„í•œ ë…¼ë¬¸ ë¦¬ë·° ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

ë‹µë³€ ê·œì¹™:
1. ì „ë¬¸ ìš©ì–´ê°€ ë‚˜ì˜¤ë©´ ë°˜ë“œì‹œ ì‰¬ìš´ ë§ë¡œ í’€ì–´ì„œ ì„¤ëª…
2. ì‹¤ìƒí™œ ë¹„ìœ  ì‚¬ìš© (ì˜ˆ: "Attentionì€ ì‚¬ëŒì´ ì±…ì„ ì½ì„ ë•Œ ì¤‘ìš”í•œ ë¶€ë¶„ì— ì§‘ì¤‘í•˜ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤")
3. ìˆ˜ì‹ì€ ìµœì†Œí™”í•˜ê³ , ë‚˜ì˜¤ë©´ ì§ê´€ì ìœ¼ë¡œ ì„¤ëª…
4. í•µì‹¬ ì•„ì´ë””ì–´ 3ê°€ì§€ ì´ë‚´ë¡œ ìš”ì•½
```

### Hard ëª¨ë“œ (ì „ë¬¸ê°€)

**íŠ¹ì§•:**
- ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ í¬í•¨
- ìˆ˜ì‹ ë° ì•Œê³ ë¦¬ì¦˜ ì„¤ëª…
- ê´€ë ¨ ë…¼ë¬¸ ë¹„êµ ë¶„ì„
- êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ ì œê³µ

**í”„ë¡¬í”„íŠ¸ ì „ëµ:**
```
ë‹¹ì‹ ì€ AI/ML ì „ë¬¸ê°€ë¥¼ ìœ„í•œ ë…¼ë¬¸ ë¦¬ë·° ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

ë‹µë³€ ê·œì¹™:
1. ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ ë° ìˆ˜ì‹ í¬í•¨
2. ì•Œê³ ë¦¬ì¦˜ì˜ ì‹œê°„/ê³µê°„ ë³µì¡ë„ ë¶„ì„
3. ê´€ë ¨ ë…¼ë¬¸ê³¼ì˜ ë¹„êµ (ì¥ë‹¨ì )
4. êµ¬í˜„ ì‹œ ê³ ë ¤ì‚¬í•­
5. ìµœì‹  ì—°êµ¬ ë™í–¥ê³¼ì˜ ì—°ê²°
```

### UI í†µí•©

**Streamlit ë‚œì´ë„ ì„ íƒ:**
```python
difficulty_mode = st.selectbox(
    "ë‹µë³€ ë‚œì´ë„ ì„ íƒ",
    ["Easy ëª¨ë“œ (ì´ˆì‹¬ììš©)", "Hard ëª¨ë“œ (ì „ë¬¸ê°€ìš©)"]
)
```

**AgentState ì „ë‹¬:**
```python
state = {
    "question": user_query,
    "difficulty": "easy" if "Easy" in difficulty_mode else "hard",
    "messages": []
}
```

---

## ğŸ“‹ ë„êµ¬ë³„ í†µí•© ìš”êµ¬ì‚¬í•­

### ê³µí†µ ìš”êµ¬ì‚¬í•­

**1. ExperimentManager í†µí•©**
- ëª¨ë“  ë„êµ¬ëŠ” `exp_manager` íŒŒë¼ë¯¸í„° ì§€ì›
- ë„êµ¬ë³„ Logger ìë™ ìƒì„± (`exp_manager.get_tool_logger()`)

**2. ë‚œì´ë„ ì§€ì›**
- íŒŒì¼ ì €ì¥ ë„êµ¬ë¥¼ ì œì™¸í•œ ëª¨ë“  ë„êµ¬ê°€ `difficulty` íŒŒë¼ë¯¸í„° ì§€ì›
- Easy/Hard ëª¨ë“œ í”„ë¡¬í”„íŠ¸ ë¶„ë¦¬

**3. ì—ëŸ¬ í•¸ë“¤ë§**
- DB ì—°ê²° ì‹¤íŒ¨ ì‹œ Fallback ì „ëµ
- API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ë¡œì§ (tenacity)

**4. ë¡œê¹… ì •ì±…**
- ë„êµ¬ ì‹¤í–‰ ì‹œì‘/ì¢…ë£Œ ë¡œê·¸
- ê²€ìƒ‰ ê²°ê³¼ ê°œìˆ˜ ê¸°ë¡
- DB ì¿¼ë¦¬ ì„±ëŠ¥ ì¶”ì 

### ë„êµ¬ë³„ DB ì„¤ì •

| ë„êµ¬ | DB ì—°ë™ | í™˜ê²½ ë³€ìˆ˜ | í•„ìˆ˜ ì„¤ì • |
|------|---------|----------|-----------|
| ì¼ë°˜ ë‹µë³€ | âŒ | `OPENAI_API_KEY` | âœ… |
| RAG ê²€ìƒ‰ | PostgreSQL + pgvector | `DATABASE_URL`, `OPENAI_API_KEY` | âœ… |
| ìš©ì–´ì§‘ ê²€ìƒ‰ | PostgreSQL | `DATABASE_URL`, `OPENAI_API_KEY` | âœ… |
| ì›¹ ê²€ìƒ‰ | âŒ | `TAVILY_API_KEY`, `OPENAI_API_KEY` | âœ… |
| ë…¼ë¬¸ ìš”ì•½ | PostgreSQL + pgvector | `DATABASE_URL`, `OPENAI_API_KEY` | âœ… |
| Text-to-SQL | PostgreSQL | `DATABASE_URL`, `SOLAR_API_KEY` | âœ… |
| íŒŒì¼ ì €ì¥ | ExperimentManager | ì—†ìŒ | âŒ |

### API í‚¤ ê´€ë¦¬

**`.env` íŒŒì¼ í•„ìˆ˜ ì„¤ì •:**
```bash
OPENAI_API_KEY=sk-...
TAVILY_API_KEY=tvly-...
DATABASE_URL=postgresql://user:pass@localhost:5432/dbname
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. DB ì—°ê²° ê´€ë¦¬

**PostgreSQL ì—°ê²° í’€ë§:**
- ë„êµ¬ ì‹¤í–‰ë§ˆë‹¤ ì—°ê²° ìƒì„±/ì¢…ë£Œ (ë¦¬ì†ŒìŠ¤ ëˆ„ìˆ˜ ë°©ì§€)
- ì—ëŸ¬ ë°œìƒ ì‹œ ìë™ ì¢…ë£Œ (try-finally ë¸”ë¡)

**pgvector ì¸ë±ìŠ¤:**
- `paper_chunks` í…Œì´ë¸”ì— IVF ì¸ë±ìŠ¤ ìƒì„± ê¶Œì¥
- ê²€ìƒ‰ ì†ë„ í–¥ìƒ (Top-5 ê²€ìƒ‰ 1ì´ˆ ì´ë‚´)

### 2. LLM ë¹„ìš© ê´€ë¦¬

**ë„êµ¬ë³„ ë¹„ìš©:**
| ë„êµ¬ | LLM í˜¸ì¶œ íšŸìˆ˜ | ì˜ˆìƒ ë¹„ìš© (1íšŒ) |
|------|--------------|----------------|
| ì¼ë°˜ ë‹µë³€ | 1íšŒ | $0.003 |
| RAG ê²€ìƒ‰ | 1íšŒ | $0.015 (GPT-5) |
| ìš©ì–´ì§‘ ê²€ìƒ‰ | 2íšŒ (ìš©ì–´ ì¶”ì¶œ + ë‹µë³€) | $0.005 |
| ì›¹ ê²€ìƒ‰ | 1íšŒ | $0.005 |
| ë…¼ë¬¸ ìš”ì•½ | 1íšŒ (ëŒ€ìš©ëŸ‰) | $0.08 |
| Text-to-SQL | 1íšŒ | $0.001 (Solar Pro2) |
| íŒŒì¼ ì €ì¥ | 0íšŒ | $0 |

**ë¹„ìš© ì ˆê° ì „ëµ:**
- ìš©ì–´ì§‘ ê²€ìƒ‰: ìš©ì–´ ì¶”ì¶œì— Solar Pro2 ì‚¬ìš©
- ì›¹ ê²€ìƒ‰: Solar Pro2ë¡œ ì •ë¦¬ (Easy ëª¨ë“œ)
- ë…¼ë¬¸ ìš”ì•½: ì²­í¬ ìˆ˜ ì œí•œ (10ê°œ)

### 3. ì—ëŸ¬ í•¸ë“¤ë§

**DB ì—ëŸ¬:**
- PostgreSQL ì—°ê²° ì‹¤íŒ¨ â†’ ì‚¬ìš©ìì—ê²Œ ì•ˆë‚´ ë©”ì‹œì§€
- pgvector ê²€ìƒ‰ ì‹¤íŒ¨ â†’ ì¼ë°˜ ë‹µë³€ ë„êµ¬ë¡œ Fallback

**API ì—ëŸ¬:**
- Tavily API í˜¸ì¶œ ì‹¤íŒ¨ â†’ ì¬ì‹œë„ 3íšŒ (exponential backoff)
- OpenAI API í˜¸ì¶œ ì‹¤íŒ¨ â†’ Solarë¡œ Fallback

**ìš©ì–´ì§‘ ì—†ìŒ:**
- glossary í…Œì´ë¸”ì— ìš©ì–´ ì—†ìŒ â†’ RAG ê²€ìƒ‰ìœ¼ë¡œ Fallback

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- **[09-1_ë„êµ¬_ìë™ì „í™˜_ê¸°ëŠ¥.md](./09-1_ë„êµ¬_ìë™ì „í™˜_ê¸°ëŠ¥.md)** - Fallback Chain ë©”ì»¤ë‹ˆì¦˜ ìƒì„¸ ì„¤ëª…
- **[03_AI_Agent_ì‹œìŠ¤í…œ.md](./03_AI_Agent_ì‹œìŠ¤í…œ.md)** - Agentì—ì„œ ë„êµ¬ í†µí•©
- **[02_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md](./02_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md)** - ExperimentManager í†µí•©
- **[04_LLM_í´ë¼ì´ì–¸íŠ¸.md](./04_LLM_í´ë¼ì´ì–¸íŠ¸.md)** - ë„êµ¬ì—ì„œ LLM ì‚¬ìš©
- **[PRD/ìë£Œì¡°ì‚¬_05_AI_Agent_ë„êµ¬.md](../PRD/ìë£Œì¡°ì‚¬_05_AI_Agent_ë„êµ¬.md)** - ë„êµ¬ ì‹œìŠ¤í…œ ì „ì²´ ëª…ì„¸

---

## ğŸ“ ìš”ì•½

### êµ¬í˜„ëœ í•µì‹¬ ê¸°ëŠ¥

1. âœ… 7ê°€ì§€ ë„êµ¬ êµ¬í˜„ (ì¼ë°˜ ë‹µë³€, RAG, ìš©ì–´ì§‘, ì›¹ ê²€ìƒ‰, ìš”ì•½, Text-to-SQL, íŒŒì¼ ì €ì¥)
2. âœ… LangGraph ë¼ìš°íŒ… í†µí•© (Router ë…¸ë“œ)
3. âœ… ë‚œì´ë„ë³„ ë‹µë³€ ëª¨ë“œ (Easy/Hard)
4. âœ… PostgreSQL + pgvector í†µí•© (RAG, ìš©ì–´ì§‘, ìš”ì•½)
5. âœ… Tavily Search API í†µí•© (ì›¹ ê²€ìƒ‰)
6. âœ… Text-to-SQL í†µí•© (ë…¼ë¬¸ í†µê³„ ì¡°íšŒ, ë³´ì•ˆ ê²€ì¦)
7. âœ… ExperimentManager í†µí•© (ë¡œê¹…, íŒŒì¼ ì €ì¥)

### ë„êµ¬ë³„ íŠ¹ì§• ìš”ì•½

| ë„êµ¬ | DB í•„ìš” | API í‚¤ í•„ìš” | ë‚œì´ë„ ì§€ì› | ë³µì¡ë„ | í‰ê·  ì‘ë‹µ ì‹œê°„ |
|------|---------|-------------|-------------|--------|----------------|
| ì¼ë°˜ ë‹µë³€ | âŒ | âœ… (OpenAI) | âœ… | ë‚®ìŒ | 2ì´ˆ |
| RAG ê²€ìƒ‰ | âœ… (pgvector) | âœ… (OpenAI) | âœ… | ë†’ìŒ | 5ì´ˆ |
| ìš©ì–´ì§‘ ê²€ìƒ‰ | âœ… (PostgreSQL) | âœ… (OpenAI) | âœ… | ì¤‘ê°„ | 3ì´ˆ |
| ì›¹ ê²€ìƒ‰ | âŒ | âœ… (Tavily) | âœ… | ì¤‘ê°„ | 4ì´ˆ |
| ë…¼ë¬¸ ìš”ì•½ | âœ… (pgvector) | âœ… (OpenAI) | âœ… | ë†’ìŒ | 10ì´ˆ |
| Text-to-SQL | âœ… (PostgreSQL) | âœ… (Solar) | âœ… | ì¤‘ê°„ | 3ì´ˆ |
| íŒŒì¼ ì €ì¥ | âŒ | âŒ | âŒ | ë‚®ìŒ | 0.1ì´ˆ |

### ì‚¬ìš© íŒ¨í„´

**Agentì—ì„œ ë„êµ¬ í˜¸ì¶œ:**
```python
# Router ë…¸ë“œê°€ ìë™ìœ¼ë¡œ ë„êµ¬ ì„ íƒ
state = {
    "question": "Transformer ë…¼ë¬¸ ì„¤ëª…í•´ì¤˜",
    "difficulty": "easy",
    "messages": []
}

result = agent.invoke(state)
# tool_choice: "search_paper"
# final_answer: "TransformerëŠ”..."
```

**ì§ì ‘ ë„êµ¬ í˜¸ì¶œ:**
```python
from src.tools.search_paper import search_paper_tool

answer = search_paper_tool(
    question="Transformer ë…¼ë¬¸ ì„¤ëª…í•´ì¤˜",
    difficulty="easy",
    exp_manager=exp_manager
)
```

### ëª¨ë²” ì‚¬ë¡€

1. **Router ë…¸ë“œ ì‹ ë¢°**: LLM ë¼ìš°íŒ… ê²°ì •ì„ ë”°ë¦„ (ìˆ˜ë™ ì˜¤ë²„ë¼ì´ë“œ ìµœì†Œí™”)
2. **ë‚œì´ë„ ì¼ê´€ì„±**: ì‚¬ìš©ì ì„ íƒ ë‚œì´ë„ë¥¼ ëª¨ë“  ë„êµ¬ì— ì „ë‹¬
3. **ExperimentManager í†µí•©**: ë„êµ¬ë³„ ë¡œê·¸ ë…ë¦½ ê´€ë¦¬
4. **ì—ëŸ¬ í•¸ë“¤ë§**: DB ì‹¤íŒ¨ ì‹œ Fallback ì „ëµ (RAG â†’ ì¼ë°˜ ë‹µë³€)
5. **ë¹„ìš© ê´€ë¦¬**: ë¼ìš°íŒ…ì— Solar Pro2, ë³µì¡í•œ ë‹µë³€ì—ë§Œ GPT-5
6. **ë„êµ¬ë³„ Logger**: `exp_manager.get_tool_logger(tool_name)` ì‚¬ìš©
7. **API í‚¤ ê´€ë¦¬**: `.env` íŒŒì¼ë¡œ ì¤‘ì•™ ê´€ë¦¬

### í–¥í›„ ê°œì„  ì‚¬í•­

- ë„êµ¬ ì²´ì´ë‹ (ì—¬ëŸ¬ ë„êµ¬ ìˆœì°¨ ì‹¤í–‰)
- ë…¼ë¬¸ ë¹„êµ ë„êµ¬ ì¶”ê°€ (BERT vs GPT)
- Text-to-SQL í™•ì¥ (glossary í…Œì´ë¸” ë“± ì¶”ê°€ í…Œì´ë¸” ì§€ì›)
- ì¸ìš© ì¶”ì¶œ ë„êµ¬ ì¶”ê°€
- ë„êµ¬ë³„ ì„±ëŠ¥ í‰ê°€ ì§€í‘œ ì¶”ì 
- Text-to-SQL ë³µì¡í•œ JOIN/ì„œë¸Œì¿¼ë¦¬ ì§€ì› ê°•í™”
